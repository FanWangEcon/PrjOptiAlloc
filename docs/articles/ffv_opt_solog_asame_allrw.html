<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Analytical Common Alpha • PrjOptiAlloc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Analytical Common Alpha">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PrjOptiAlloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ffv_opt_anlyz_rhgin.html">ANALYSIS--Optimal Allocations Planner Elasticity Vector and Ginis</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_dtgch_cbem4.html">DATA--Generate Data Cebu Four Category Test Regression Results</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rev.html">BINARY--REV Test One Resource Equivalent Variation Computation (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rev_two.html">BINARY--REV Test Two Resource Equivalent Variation Computation (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allfc_training_logit.html">BINARY--NSW Training EMPLOYMENT as Outcome Optimal Allocation Solution</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_car.html">BINARY--MPG and Shift Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_training.html">BINARY--NSW Training WAGE and EMPLOYMENT Optimal Allocation Analysis</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_training_wage.html">BINARY--NSW Training WAGE Optimal Allocation Solution</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_wgt.html">BINARY--Birth Weight and Doctors Visit Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sodis_rkone_casch_allfn.html">DISCRETE--Discrete Optimal Allocation California Teacher Student Ratio (Function)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sodis_rkone_casch_allrw.html">DISCRETE--Discrete Optimal Allocation California Teacher Student Ratio (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow.html">LINEAR--Optimal Linear Allocation based On Relative Allocation to Lowest</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allfn.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Function)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allrw.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solog_asame_allrw.html">LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Analytical Common Alpha</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solog_bisec_allrw.html">LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Implicit Bisection Solution (Line by Line)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ffv_opt_solog_asame_allrw_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>LOG-LINEAR–DRS (Log-Linear) Optimal Allocation Analytical Common Alpha</h1>
            
      
      
      <div class="hidden name"><code>ffv_opt_solog_asame_allrw.Rmd</code></div>

    </div>

    
    
<p>back to <strong><a href="https://fanwangecon.github.io/">fan</a></strong>’s optimal allocation homepage <strong><a href="https://fanwangecon.github.io/prjoptialloc/">table of content</a></strong></p>
<div id="objective" class="section level1">
<h1 class="hasAnchor">
<a href="#objective" class="anchor"></a>Objective</h1>
<ul>
<li>
<em>opt</em>: optimal allocation project</li>
<li>
<em>solog</em>: log linear production function</li>
<li>
<em>asame</em>: alpha is the same</li>
<li>
<em>allrw</em>: all code line by line raw original file</li>
</ul>
<p>When <span class="math inline">\(\alpha_i=\alpha\)</span>, the log–linear, decreasing returns to scale problem has analytical solution that is well known. The solution is programed and tested here. Perhaps what is new here is to compute the analytical REV expression as well from Corollary 5.</p>
</div>
<div id="load-packages-and-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-packages-and-data" class="anchor"></a>Load Packages and Data</h1>
<div id="load-dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#load-dependencies" class="anchor"></a>Load Dependencies</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="dt">all.names =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">knitr.duplicate.label =</span> <span class="st">'allow'</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PrjOptiAlloc)</a></code></pre></div>
</div>
<div id="common-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#common-parameters" class="anchor"></a>common parameters</h2>
<p>Some important shared, common fixed parameters specify them here:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># which params to test</span></a>
<a class="sourceLine" id="cb3-2" title="2">it_test =<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># parameters</span></a>
<a class="sourceLine" id="cb3-5" title="5">fl_rho =<span class="st"> </span><span class="fl">0.20</span></a>
<a class="sourceLine" id="cb3-6" title="6">svr_id_var =<span class="st"> 'indi_id'</span></a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co"># it_child_count = n, the number of children</span></a>
<a class="sourceLine" id="cb3-9" title="9">it_n_child_cnt =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co"># it_heter_param = q, number of parameters that are heterogeneous across children</span></a>
<a class="sourceLine" id="cb3-11" title="11">it_q_hetpa_cnt =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-12" title="12"></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co"># choice grid for nutritional feasible choices for each</span></a>
<a class="sourceLine" id="cb3-14" title="14">fl_n_agg =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb3-15" title="15">fl_n_min =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb3-16" title="16">it_n_choice_cnt_ttest =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb3-17" title="17">it_n_choice_cnt_dense =<span class="st"> </span><span class="dv">100</span></a></code></pre></div>
</div>
<div id="a-and-alpha-input-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#a-and-alpha-input-matrix" class="anchor"></a>A and alpha input matrix</h2>
<p>Different types of <em>alpha</em> and <em>a</em> combinations. the algorithm, solutions should work for any alpha and a.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="cf">if</span> (it_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="co"># A. test params 1</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="co"># these are initially what i tested with, positively correlated a and alpha, some have both higher tfp as well as elasticity.</span></a>
<a class="sourceLine" id="cb4-4" title="4">  ar_nn_a =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> it_n_child_cnt)</a>
<a class="sourceLine" id="cb4-5" title="5">  ar_nn_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="dt">length.out =</span> it_n_child_cnt)</a>
<a class="sourceLine" id="cb4-6" title="6">  mt_nn_by_nq_a_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_nn_a, ar_nn_alpha)</a>
<a class="sourceLine" id="cb4-7" title="7">} <span class="cf">else</span> <span class="cf">if</span> (it_test <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="co"># B. test params 2</span></a>
<a class="sourceLine" id="cb4-9" title="9">  ar_nn_a =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-10" title="10">  ar_nn_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb4-11" title="11">  mt_nn_by_nq_a_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_nn_a, ar_nn_alpha)</a>
<a class="sourceLine" id="cb4-12" title="12">} <span class="cf">else</span> <span class="cf">if</span> (it_test <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb4-13" title="13">  <span class="co"># C. test params 3</span></a>
<a class="sourceLine" id="cb4-14" title="14">  ar_nn_a =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-15" title="15">  ar_nn_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb4-16" title="16">  mt_nn_by_nq_a_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_nn_a, ar_nn_alpha)</a>
<a class="sourceLine" id="cb4-17" title="17">} <span class="cf">else</span> <span class="cf">if</span> (it_test <span class="op">==</span><span class="st"> </span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb4-18" title="18">  <span class="co"># D. test params 4</span></a>
<a class="sourceLine" id="cb4-19" title="19">  ar_nn_a =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-20" title="20">  ar_nn_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.006686704</span>,<span class="fl">0.009251407</span>)</a>
<a class="sourceLine" id="cb4-21" title="21">  mt_nn_by_nq_a_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_nn_a, ar_nn_alpha)</a>
<a class="sourceLine" id="cb4-22" title="22">} <span class="cf">else</span> <span class="cf">if</span> (it_test <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb4-23" title="23">  <span class="co"># E. test params 5</span></a>
<a class="sourceLine" id="cb4-24" title="24">  ar_nn_a =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.342501</span>, <span class="fl">4.359987</span>)</a>
<a class="sourceLine" id="cb4-25" title="25">  ar_nn_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.006686704</span>,<span class="fl">0.009251407</span>)</a>
<a class="sourceLine" id="cb4-26" title="26">  mt_nn_by_nq_a_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_nn_a, ar_nn_alpha)</a>
<a class="sourceLine" id="cb4-27" title="27">} <span class="cf">else</span> <span class="cf">if</span> (it_test <span class="op">==</span><span class="st"> </span><span class="dv">6</span>) {</a>
<a class="sourceLine" id="cb4-28" title="28">  <span class="co"># graph b</span></a>
<a class="sourceLine" id="cb4-29" title="29">  <span class="co"># input group two, from the project</span></a>
<a class="sourceLine" id="cb4-30" title="30">  ls_opti_alpha_a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ffy_opt_dtgch_cbem4.html">ffy_opt_dtgch_cbem4</a></span>()</a>
<a class="sourceLine" id="cb4-31" title="31">  df_esti &lt;-<span class="st"> </span>ls_opti_alpha_a<span class="op">$</span>df_esti</a>
<a class="sourceLine" id="cb4-32" title="32">  df_dtgch_cbem4_bisec &lt;-<span class="st"> </span>df_esti[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'A_log'</span>, <span class="st">'alpha_log'</span>)]</a>
<a class="sourceLine" id="cb4-33" title="33">  ar_nn_a &lt;-<span class="st"> </span>df_dtgch_cbem4_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(A_log)</a>
<a class="sourceLine" id="cb4-34" title="34">  ar_nn_alpha &lt;-<span class="st"> </span>df_dtgch_cbem4_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(alpha_log)</a>
<a class="sourceLine" id="cb4-35" title="35">  mt_nn_by_nq_a_alpha =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_nn_a, ar_nn_alpha)</a>
<a class="sourceLine" id="cb4-36" title="36">}</a></code></pre></div>
</div>
<div id="expand-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#expand-matrix" class="anchor"></a>expand matrix</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># choice grid for nutritional feasible choices for each</span></a>
<a class="sourceLine" id="cb5-2" title="2">it_n_choice_cnt_ttest =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb5-3" title="3">it_n_choice_cnt_dense =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb5-4" title="4">ar_n_choices_ttest =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(fl_n_min, fl_n_agg, <span class="dt">length.out =</span> it_n_choice_cnt_ttest)</a>
<a class="sourceLine" id="cb5-5" title="5">ar_n_choices_dense =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(fl_n_min, fl_n_agg, <span class="dt">length.out =</span> it_n_choice_cnt_dense)</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># mesh expand</span></a>
<a class="sourceLine" id="cb5-8" title="8">tb_states_choices &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_nn_by_nq_a_alpha) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rowid_to_column</span>(<span class="dt">var=</span>svr_id_var)</a>
<a class="sourceLine" id="cb5-9" title="9">tb_states_choices_ttest &lt;-<span class="st"> </span>tb_states_choices <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">9</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="st">                              </span><span class="kw">expand_grid</span>(<span class="dt">choices =</span> ar_n_choices_ttest)</a>
<a class="sourceLine" id="cb5-11" title="11">tb_states_choices_dense &lt;-<span class="st"> </span>tb_states_choices <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">9</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="st">                              </span><span class="kw">expand_grid</span>(<span class="dt">choices =</span> ar_n_choices_dense)</a>
<a class="sourceLine" id="cb5-13" title="13"></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co"># display</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_states_choices_dense)</a></code></pre></div>
<pre><code>##     indi_id         ar_nn_a       ar_nn_alpha          choices   
##  Min.   :330.0   Min.   :4.329   Min.   :0.006687   Min.   :  0  
##  1st Qu.:347.0   1st Qu.:4.336   1st Qu.:0.006687   1st Qu.: 25  
##  Median :402.0   Median :4.341   Median :0.012090   Median : 50  
##  Mean   :553.8   Mean   :4.342   Mean   :0.010700   Mean   : 50  
##  3rd Qu.:779.0   3rd Qu.:4.345   3rd Qu.:0.012090   3rd Qu.: 75  
##  Max.   :882.0   Max.   :4.361   Max.   :0.013940   Max.   :100</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">kable</span>(tb_states_choices_ttest) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:right;">
indi_id
</th>
<th style="text-align:right;">
ar_nn_a
</th>
<th style="text-align:right;">
ar_nn_alpha
</th>
<th style="text-align:right;">
choices
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
373
</td>
<td style="text-align:right;">
4.331798
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
373
</td>
<td style="text-align:right;">
4.331798
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
373
</td>
<td style="text-align:right;">
4.331798
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
435
</td>
<td style="text-align:right;">
4.356952
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
435
</td>
<td style="text-align:right;">
4.356952
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
435
</td>
<td style="text-align:right;">
4.356952
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
977
</td>
<td style="text-align:right;">
4.330612
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
977
</td>
<td style="text-align:right;">
4.330612
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
977
</td>
<td style="text-align:right;">
4.330612
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
4.340584
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
4.340584
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
4.340584
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
4.333402
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
4.333402
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
4.333402
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
859
</td>
<td style="text-align:right;">
4.330871
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
859
</td>
<td style="text-align:right;">
4.330871
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
859
</td>
<td style="text-align:right;">
4.330871
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
927
</td>
<td style="text-align:right;">
4.341908
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
927
</td>
<td style="text-align:right;">
4.341908
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
927
</td>
<td style="text-align:right;">
4.341908
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
933
</td>
<td style="text-align:right;">
4.335030
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
933
</td>
<td style="text-align:right;">
4.335030
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
933
</td>
<td style="text-align:right;">
4.335030
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="apply-same-function-all-rows-some-inputs-row-specific-other-shared" class="section level1">
<h1 class="hasAnchor">
<a href="#apply-same-function-all-rows-some-inputs-row-specific-other-shared" class="anchor"></a>Apply Same Function All Rows, some inputs row-specific, other shared</h1>
<div id="points-and-denser-dataframs-and-define-function" class="section level2">
<h2 class="hasAnchor">
<a href="#points-and-denser-dataframs-and-define-function" class="anchor"></a>3 points and denser dataframs and define function</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># convert matrix to tibble</span></a>
<a class="sourceLine" id="cb8-2" title="2">ar_st_col_names =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(svr_id_var,<span class="st">'fl_a'</span>, <span class="st">'fl_alpha'</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">tb_states_choices &lt;-<span class="st"> </span>tb_states_choices <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename_all</span>(<span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(ar_st_col_names))</a>
<a class="sourceLine" id="cb8-4" title="4">ar_st_col_names =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(svr_id_var,<span class="st">'fl_a'</span>, <span class="st">'fl_alpha'</span>, <span class="st">'fl_n'</span>)</a>
<a class="sourceLine" id="cb8-5" title="5">tb_states_choices_ttest &lt;-<span class="st"> </span>tb_states_choices_ttest <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename_all</span>(<span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(ar_st_col_names))</a>
<a class="sourceLine" id="cb8-6" title="6">tb_states_choices_dense &lt;-<span class="st"> </span>tb_states_choices_dense <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename_all</span>(<span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(ar_st_col_names))</a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co"># define implicit function</span></a>
<a class="sourceLine" id="cb8-9" title="9">ffi_nonlin_dplyrdo &lt;-<span class="st"> </span><span class="cf">function</span>(fl_a, fl_alpha, fl_n, ar_a, ar_alpha, fl_n_agg, fl_rho){</a>
<a class="sourceLine" id="cb8-10" title="10">  <span class="co"># scalar value that are row-specific, in dataframe already: *fl_a*, *fl_alpha*, *fl_n*</span></a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="co"># array and scalars not in dataframe, common all rows: *ar_a*, *ar_alpha*, *fl_n_agg*, *fl_rho*</span></a>
<a class="sourceLine" id="cb8-12" title="12"></a>
<a class="sourceLine" id="cb8-13" title="13">  <span class="co"># test parameters</span></a>
<a class="sourceLine" id="cb8-14" title="14">  <span class="co"># ar_a = ar_nn_a</span></a>
<a class="sourceLine" id="cb8-15" title="15">  <span class="co"># ar_alpha = ar_nn_alpha</span></a>
<a class="sourceLine" id="cb8-16" title="16">  <span class="co"># fl_n = 100</span></a>
<a class="sourceLine" id="cb8-17" title="17">  <span class="co"># fl_rho = -1</span></a>
<a class="sourceLine" id="cb8-18" title="18">  <span class="co"># fl_n_q = 10</span></a>
<a class="sourceLine" id="cb8-19" title="19"></a>
<a class="sourceLine" id="cb8-20" title="20">  <span class="co"># apply function</span></a>
<a class="sourceLine" id="cb8-21" title="21">  ar_p1_s1 =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>((fl_a <span class="op">-</span><span class="st"> </span>ar_a)<span class="op">*</span>fl_rho)</a>
<a class="sourceLine" id="cb8-22" title="22">  ar_p1_s2 =<span class="st"> </span>(fl_alpha<span class="op">/</span>ar_alpha)</a>
<a class="sourceLine" id="cb8-23" title="23">  ar_p1_s3 =<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>(ar_alpha<span class="op">*</span>fl_rho <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb8-24" title="24">  ar_p1 =<span class="st"> </span>(ar_p1_s1<span class="op">*</span>ar_p1_s2)<span class="op">^</span>ar_p1_s3</a>
<a class="sourceLine" id="cb8-25" title="25">  ar_p2 =<span class="st"> </span>fl_n<span class="op">^</span>((fl_alpha<span class="op">*</span>fl_rho<span class="dv">-1</span>)<span class="op">/</span>(ar_alpha<span class="op">*</span>fl_rho<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb8-26" title="26">  ar_overall =<span class="st"> </span>ar_p1<span class="op">*</span>ar_p2</a>
<a class="sourceLine" id="cb8-27" title="27">  fl_overall =<span class="st"> </span>fl_n_agg <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(ar_overall)</a>
<a class="sourceLine" id="cb8-28" title="28"></a>
<a class="sourceLine" id="cb8-29" title="29">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(fl_overall)</a>
<a class="sourceLine" id="cb8-30" title="30">}</a></code></pre></div>
</div>
<div id="evaluate-at-three-choice-points-and-show-table" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluate-at-three-choice-points-and-show-table" class="anchor"></a>evaluate at three choice points and show table</h2>
<p>in the example below, just show results evaluating over three choice points and show table.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># fl_a, fl_alpha are from columns of tb_nn_by_nq_a_alpha</span></a>
<a class="sourceLine" id="cb9-2" title="2">tb_states_choices_ttest_eval =<span class="st"> </span>tb_states_choices_ttest <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">                        </span><span class="kw">mutate</span>(<span class="dt">dplyr_eval =</span> <span class="kw">ffi_nonlin_dplyrdo</span>(fl_a, fl_alpha, fl_n,</a>
<a class="sourceLine" id="cb9-4" title="4">                                                               ar_nn_a, ar_nn_alpha,</a>
<a class="sourceLine" id="cb9-5" title="5">                                                               fl_n_agg, fl_rho))</a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co"># show</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">kable</span>(tb_states_choices_ttest_eval) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:right;">
indi_id
</th>
<th style="text-align:right;">
fl_a
</th>
<th style="text-align:right;">
fl_alpha
</th>
<th style="text-align:right;">
fl_n
</th>
<th style="text-align:right;">
dplyr_eval
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
373
</td>
<td style="text-align:right;">
4.331798
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
373
</td>
<td style="text-align:right;">
4.331798
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-44496.83
</td>
</tr>
<tr>
<td style="text-align:right;">
373
</td>
<td style="text-align:right;">
4.331798
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-89082.04
</td>
</tr>
<tr>
<td style="text-align:right;">
435
</td>
<td style="text-align:right;">
4.356952
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
435
</td>
<td style="text-align:right;">
4.356952
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-58052.13
</td>
</tr>
<tr>
<td style="text-align:right;">
435
</td>
<td style="text-align:right;">
4.356952
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-116234.97
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-80752.67
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-161705.70
</td>
</tr>
<tr>
<td style="text-align:right;">
977
</td>
<td style="text-align:right;">
4.330612
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
977
</td>
<td style="text-align:right;">
4.330612
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-44507.45
</td>
</tr>
<tr>
<td style="text-align:right;">
977
</td>
<td style="text-align:right;">
4.330612
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-89103.25
</td>
</tr>
<tr>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
4.340584
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
4.340584
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-80842.15
</td>
</tr>
<tr>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
4.340584
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-161884.77
</td>
</tr>
<tr>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
4.333402
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
4.333402
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-80958.76
</td>
</tr>
<tr>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
4.333402
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-162118.13
</td>
</tr>
<tr>
<td style="text-align:right;">
859
</td>
<td style="text-align:right;">
4.330871
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
859
</td>
<td style="text-align:right;">
4.330871
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-44505.13
</td>
</tr>
<tr>
<td style="text-align:right;">
859
</td>
<td style="text-align:right;">
4.330871
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-89098.61
</td>
</tr>
<tr>
<td style="text-align:right;">
927
</td>
<td style="text-align:right;">
4.341908
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
927
</td>
<td style="text-align:right;">
4.341908
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-80820.66
</td>
</tr>
<tr>
<td style="text-align:right;">
927
</td>
<td style="text-align:right;">
4.341908
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-161841.77
</td>
</tr>
<tr>
<td style="text-align:right;">
933
</td>
<td style="text-align:right;">
4.335030
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
933
</td>
<td style="text-align:right;">
4.335030
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-80932.31
</td>
</tr>
<tr>
<td style="text-align:right;">
933
</td>
<td style="text-align:right;">
4.335030
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-162065.20
</td>
</tr>
</tbody>
</table>
</div>
<div id="evaluate-at-many-choice-points-and-show-graphically" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluate-at-many-choice-points-and-show-graphically" class="anchor"></a>evaluate at many choice points and show graphically</h2>
<p>same as above, but now we evaluate the function over the individuals at many choice points so that we can graph things out.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># fl_a, fl_alpha are from columns of tb_nn_by_nq_a_alpha</span></a>
<a class="sourceLine" id="cb10-2" title="2">tb_states_choices_dense_eval =<span class="st"> </span>tb_states_choices_dense <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">                        </span><span class="kw">mutate</span>(<span class="dt">dplyr_eval =</span> <span class="kw">ffi_nonlin_dplyrdo</span>(fl_a, fl_alpha, fl_n,</a>
<a class="sourceLine" id="cb10-4" title="4">                                                               ar_nn_a, ar_nn_alpha,</a>
<a class="sourceLine" id="cb10-5" title="5">                                                               fl_n_agg, fl_rho))</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># show</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(tb_states_choices_dense_eval)</a></code></pre></div>
<pre><code>## [1] 900   5</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_states_choices_dense_eval)</a></code></pre></div>
<pre><code>##     indi_id           fl_a          fl_alpha             fl_n    
##  Min.   :330.0   Min.   :4.329   Min.   :0.006687   Min.   :  0  
##  1st Qu.:347.0   1st Qu.:4.336   1st Qu.:0.006687   1st Qu.: 25  
##  Median :402.0   Median :4.341   Median :0.012090   Median : 50  
##  Mean   :553.8   Mean   :4.342   Mean   :0.010700   Mean   : 50  
##  3rd Qu.:779.0   3rd Qu.:4.345   3rd Qu.:0.012090   3rd Qu.: 75  
##  Max.   :882.0   Max.   :4.361   Max.   :0.013940   Max.   :100  
##    dplyr_eval     
##  Min.   :-162261  
##  1st Qu.: -75443  
##  Median : -50293  
##  Mean   : -55238  
##  3rd Qu.: -24759  
##  Max.   :    100</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">lineplot &lt;-<span class="st"> </span>tb_states_choices_dense_eval <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>fl_n, <span class="dt">y=</span>dplyr_eval)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">        </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">        </span><span class="kw">facet_wrap</span>( . <span class="op">~</span><span class="st"> </span>indi_id, <span class="dt">scales =</span> <span class="st">"free"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype=</span><span class="st">"dashed"</span>,</a>
<a class="sourceLine" id="cb15-6" title="6">                <span class="dt">color =</span> <span class="st">"red"</span>, <span class="dt">size=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-7" title="7">        <span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">'evaluate non-linear functions to search for roots'</span>,</a>
<a class="sourceLine" id="cb15-8" title="8">             <span class="dt">x =</span> <span class="st">'x values'</span>,</a>
<a class="sourceLine" id="cb15-9" title="9">             <span class="dt">y =</span> <span class="st">'f(x)'</span>,</a>
<a class="sourceLine" id="cb15-10" title="10">             <span class="dt">caption =</span> <span class="st">'evaluating the function'</span>)</a></code></pre></div>
<pre><code>## $x
## [1] "x values"
## 
## $y
## [1] "f(x)"
## 
## $title
## [1] "evaluate non-linear functions to search for roots"
## 
## $caption
## [1] "evaluating the function"
## 
## attr(,"class")
## [1] "labels"</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(lineplot)</a></code></pre></div>
<p><img src="ffv_opt_solog_asame_allrw_files/figure-html/graph%20many%20evaluations-1.png" width="700"></p>
</div>
</div>
<div id="bisection-solve-optimal-choice-for-each-individual" class="section level1">
<h1 class="hasAnchor">
<a href="#bisection-solve-optimal-choice-for-each-individual" class="anchor"></a>bisection solve optimal choice for each individual</h1>
<div id="bisection-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#bisection-algorithm" class="anchor"></a>bisection algorithm</h2>
</div>
<div id="dplyr-implementation-of-bisection" class="section level2">
<h2 class="hasAnchor">
<a href="#dplyr-implementation-of-bisection" class="anchor"></a>dplyr implementation of bisection</h2>
<div id="initialize-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#initialize-matrix" class="anchor"></a>initialize matrix</h3>
<p>first, initialize the matrix with <span class="math inline">\(a_0\)</span> and <span class="math inline">\(b_0\)</span>, the initial min and max points:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># common prefix to make reshaping easier</span></a>
<a class="sourceLine" id="cb18-2" title="2">st_bisec_prefix &lt;-<span class="st"> 'bisec_'</span></a>
<a class="sourceLine" id="cb18-3" title="3">svr_a_lst &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'a_0'</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">svr_b_lst &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'b_0'</span>)</a>
<a class="sourceLine" id="cb18-5" title="5">svr_fa_lst &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'fa_0'</span>)</a>
<a class="sourceLine" id="cb18-6" title="6">svr_fb_lst &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'fb_0'</span>)</a>
<a class="sourceLine" id="cb18-7" title="7"></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co"># add initial a and b</span></a>
<a class="sourceLine" id="cb18-9" title="9">tb_states_choices_bisec &lt;-<span class="st"> </span>tb_states_choices <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">                            </span><span class="kw">mutate</span>(<span class="op">!!</span><span class="kw">sym</span>(svr_a_lst) <span class="op">:</span><span class="er">=</span><span class="st"> </span>fl_n_min, <span class="op">!!</span><span class="kw">sym</span>(svr_b_lst) <span class="op">:</span><span class="er">=</span><span class="st"> </span>fl_n_agg)</a>
<a class="sourceLine" id="cb18-11" title="11"></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co"># evaluate function f(a_0) and f(b_0)</span></a>
<a class="sourceLine" id="cb18-13" title="13">tb_states_choices_bisec &lt;-<span class="st"> </span>tb_states_choices_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="st">                            </span><span class="kw">mutate</span>(<span class="op">!!</span><span class="kw">sym</span>(svr_fa_lst) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ffi_nonlin_dplyrdo</span>(fl_a, fl_alpha, <span class="op">!!</span><span class="kw">sym</span>(svr_a_lst),</a>
<a class="sourceLine" id="cb18-15" title="15">                                                                          ar_nn_a, ar_nn_alpha,</a>
<a class="sourceLine" id="cb18-16" title="16">                                                                          fl_n_agg, fl_rho),</a>
<a class="sourceLine" id="cb18-17" title="17">                                   <span class="op">!!</span><span class="kw">sym</span>(svr_fb_lst) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ffi_nonlin_dplyrdo</span>(fl_a, fl_alpha, <span class="op">!!</span><span class="kw">sym</span>(svr_b_lst),</a>
<a class="sourceLine" id="cb18-18" title="18">                                                                          ar_nn_a, ar_nn_alpha,</a>
<a class="sourceLine" id="cb18-19" title="19">                                                                          fl_n_agg, fl_rho))</a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co"># summarize</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(tb_states_choices_bisec)</a></code></pre></div>
<pre><code>## [1] 1043    7</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_states_choices_bisec)</a></code></pre></div>
<pre><code>##     indi_id            fl_a          fl_alpha          bisec_a_0   bisec_b_0  
##  Min.   :   1.0   Min.   :4.287   Min.   :0.006687   Min.   :0   Min.   :100  
##  1st Qu.: 261.5   1st Qu.:4.334   1st Qu.:0.006687   1st Qu.:0   1st Qu.:100  
##  Median : 522.0   Median :4.343   Median :0.012090   Median :0   Median :100  
##  Mean   : 522.0   Mean   :4.343   Mean   :0.010321   Mean   :0   Mean   :100  
##  3rd Qu.: 782.5   3rd Qu.:4.351   3rd Qu.:0.012090   3rd Qu.:0   3rd Qu.:100  
##  Max.   :1043.0   Max.   :4.417   Max.   :0.013940   Max.   :0   Max.   :100  
##    bisec_fa_0    bisec_fb_0     
##  Min.   :100   Min.   :-163379  
##  1st Qu.:100   1st Qu.:-161838  
##  Median :100   Median : -89227  
##  Mean   :100   Mean   :-114259  
##  3rd Qu.:100   3rd Qu.: -88801  
##  Max.   :100   Max.   : -76145</code></pre>
</div>
<div id="iterate-and-solve-for-fp-update-fa-and-fb" class="section level3">
<h3 class="hasAnchor">
<a href="#iterate-and-solve-for-fp-update-fa-and-fb" class="anchor"></a>iterate and solve for f(p), update f(a) and f(b)</h3>
<p>implement the dplyr based concurrent bisection algorithm.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># fl_tol = float tolerance criteria</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co"># it_tol = number of interations to allow at most</span></a>
<a class="sourceLine" id="cb22-3" title="3">fl_tol &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb22-4" title="4">it_tol &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co"># fl_p_dist2zr = distance to zero to initalize</span></a>
<a class="sourceLine" id="cb22-6" title="6">fl_p_dist2zr &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb22-7" title="7">it_cur &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="cf">while</span> (it_cur <span class="op">&lt;=</span><span class="st"> </span>it_tol <span class="op">&amp;&amp;</span><span class="st"> </span>fl_p_dist2zr <span class="op">&gt;=</span><span class="st"> </span>fl_tol ) {</a>
<a class="sourceLine" id="cb22-9" title="9"></a>
<a class="sourceLine" id="cb22-10" title="10">  it_cur &lt;-<span class="st"> </span>it_cur <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb22-11" title="11"></a>
<a class="sourceLine" id="cb22-12" title="12">  <span class="co"># new variables</span></a>
<a class="sourceLine" id="cb22-13" title="13">  svr_a_cur &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'a_'</span>, it_cur)</a>
<a class="sourceLine" id="cb22-14" title="14">  svr_b_cur &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'b_'</span>, it_cur)</a>
<a class="sourceLine" id="cb22-15" title="15">  svr_fa_cur &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'fa_'</span>, it_cur)</a>
<a class="sourceLine" id="cb22-16" title="16">  svr_fb_cur &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">'fb_'</span>, it_cur)</a>
<a class="sourceLine" id="cb22-17" title="17"></a>
<a class="sourceLine" id="cb22-18" title="18">  <span class="co"># evaluate function f(a_0) and f(b_0)</span></a>
<a class="sourceLine" id="cb22-19" title="19">  <span class="co"># 1. generate p</span></a>
<a class="sourceLine" id="cb22-20" title="20">  <span class="co"># 2. generate f_p</span></a>
<a class="sourceLine" id="cb22-21" title="21">  <span class="co"># 3. generate f_p*f_a</span></a>
<a class="sourceLine" id="cb22-22" title="22">  tb_states_choices_bisec &lt;-<span class="st"> </span>tb_states_choices_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-23" title="23"><span class="st">                              </span><span class="kw">mutate</span>(<span class="dt">p =</span> ((<span class="op">!!</span><span class="kw">sym</span>(svr_a_lst) <span class="op">+</span><span class="st"> </span><span class="op">!!</span><span class="kw">sym</span>(svr_b_lst))<span class="op">/</span><span class="dv">2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-24" title="24"><span class="st">                              </span><span class="kw">mutate</span>(<span class="dt">f_p =</span> <span class="kw">ffi_nonlin_dplyrdo</span>(fl_a, fl_alpha, p,</a>
<a class="sourceLine" id="cb22-25" title="25">                                                              ar_nn_a, ar_nn_alpha,</a>
<a class="sourceLine" id="cb22-26" title="26">                                                              fl_n_agg, fl_rho)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-27" title="27"><span class="st">                              </span><span class="kw">mutate</span>(<span class="dt">f_p_t_f_a =</span> f_p<span class="op">*!!</span><span class="kw">sym</span>(svr_fa_lst))</a>
<a class="sourceLine" id="cb22-28" title="28">  <span class="co"># fl_p_dist2zr = sum(abs(p))</span></a>
<a class="sourceLine" id="cb22-29" title="29">  fl_p_dist2zr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(tb_states_choices_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(f_p)))</a>
<a class="sourceLine" id="cb22-30" title="30"></a>
<a class="sourceLine" id="cb22-31" title="31">  <span class="co"># update a and b</span></a>
<a class="sourceLine" id="cb22-32" title="32">  tb_states_choices_bisec &lt;-<span class="st"> </span>tb_states_choices_bisec <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-33" title="33"><span class="st">                              </span><span class="kw">mutate</span>(<span class="op">!!</span><span class="kw">sym</span>(svr_a_cur) <span class="op">:</span><span class="er">=</span></a>
<a class="sourceLine" id="cb22-34" title="34"><span class="st">                                       </span><span class="kw">case_when</span>(f_p_t_f_a <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="op">!!</span><span class="kw">sym</span>(svr_a_lst),</a>
<a class="sourceLine" id="cb22-35" title="35">                                                 <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>p)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-36" title="36"><span class="st">                              </span><span class="kw">mutate</span>(<span class="op">!!</span><span class="kw">sym</span>(svr_b_cur) <span class="op">:</span><span class="er">=</span></a>
<a class="sourceLine" id="cb22-37" title="37"><span class="st">                                       </span><span class="kw">case_when</span>(f_p_t_f_a <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span>p,</a>
<a class="sourceLine" id="cb22-38" title="38">                                                 <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="op">!!</span><span class="kw">sym</span>(svr_b_lst)))</a>
<a class="sourceLine" id="cb22-39" title="39">  <span class="co"># update f(a) and f(b)</span></a>
<a class="sourceLine" id="cb22-40" title="40">  tb_states_choices_bisec &lt;-<span class="st"> </span>tb_states_choices_bisec <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-41" title="41"><span class="st">                              </span><span class="kw">mutate</span>(<span class="op">!!</span><span class="kw">sym</span>(svr_fa_cur) <span class="op">:</span><span class="er">=</span></a>
<a class="sourceLine" id="cb22-42" title="42"><span class="st">                                       </span><span class="kw">case_when</span>(f_p_t_f_a <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="op">!!</span><span class="kw">sym</span>(svr_fa_lst),</a>
<a class="sourceLine" id="cb22-43" title="43">                                                 <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>f_p)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-44" title="44"><span class="st">                              </span><span class="kw">mutate</span>(<span class="op">!!</span><span class="kw">sym</span>(svr_fb_cur) <span class="op">:</span><span class="er">=</span></a>
<a class="sourceLine" id="cb22-45" title="45"><span class="st">                                       </span><span class="kw">case_when</span>(f_p_t_f_a <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span>f_p,</a>
<a class="sourceLine" id="cb22-46" title="46">                                                 <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="op">!!</span><span class="kw">sym</span>(svr_fb_lst)))</a>
<a class="sourceLine" id="cb22-47" title="47">  <span class="co"># save from last</span></a>
<a class="sourceLine" id="cb22-48" title="48">  svr_a_lst &lt;-<span class="st"> </span>svr_a_cur</a>
<a class="sourceLine" id="cb22-49" title="49">  svr_b_lst &lt;-<span class="st"> </span>svr_b_cur</a>
<a class="sourceLine" id="cb22-50" title="50">  svr_fa_lst &lt;-<span class="st"> </span>svr_fa_cur</a>
<a class="sourceLine" id="cb22-51" title="51">  svr_fb_lst &lt;-<span class="st"> </span>svr_fb_cur</a>
<a class="sourceLine" id="cb22-52" title="52"></a>
<a class="sourceLine" id="cb22-53" title="53">  <span class="co"># summar current round</span></a>
<a class="sourceLine" id="cb22-54" title="54">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'it_cur:'</span>, it_cur, <span class="st">', fl_p_dist2zr:'</span>, fl_p_dist2zr))</a>
<a class="sourceLine" id="cb22-55" title="55">  <span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_states_choices_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">one_of</span>(svr_a_cur, svr_b_cur, svr_fa_cur, svr_fb_cur)))</a>
<a class="sourceLine" id="cb22-56" title="56">}</a></code></pre></div>
<pre><code>## [1] "it_cur:1, fl_p_dist2zr:57065.8515924507"
## [1] "it_cur:2, fl_p_dist2zr:28476.0859665553"
## [1] "it_cur:3, fl_p_dist2zr:14184.6282193769"
## [1] "it_cur:4, fl_p_dist2zr:7040.60930196585"
## [1] "it_cur:5, fl_p_dist2zr:3469.45353361675"
## [1] "it_cur:6, fl_p_dist2zr:1684.30185106396"
## [1] "it_cur:7, fl_p_dist2zr:791.938788974897"
## [1] "it_cur:8, fl_p_dist2zr:345.863486789484"
## [1] "it_cur:9, fl_p_dist2zr:122.878869797614"
## [1] "it_cur:10, fl_p_dist2zr:30.3977559686063"
## [1] "it_cur:11, fl_p_dist2zr:25.3181374761203"
## [1] "it_cur:12, fl_p_dist2zr:12.0886419051021"
## [1] "it_cur:13, fl_p_dist2zr:2.06815551406747"
## [1] "it_cur:14, fl_p_dist2zr:4.89604753960856"
## [1] "it_cur:15, fl_p_dist2zr:1.93331480031098"
## [1] "it_cur:16, fl_p_dist2zr:0.614579561133518"
## [1] "it_cur:17, fl_p_dist2zr:0.314081026590978"
## [1] "it_cur:18, fl_p_dist2zr:0.207595932727363"
## [1] "it_cur:19, fl_p_dist2zr:0.112869498156886"
## [1] "it_cur:20, fl_p_dist2zr:0.0559799114586833"
## [1] "it_cur:21, fl_p_dist2zr:0.027032944900061"
## [1] "it_cur:22, fl_p_dist2zr:0.0132672918026609"
## [1] "it_cur:23, fl_p_dist2zr:0.00680454432702988"
## [1] "it_cur:24, fl_p_dist2zr:0.00333360097714742"
## [1] "it_cur:25, fl_p_dist2zr:0.00168437455159884"
## [1] "it_cur:26, fl_p_dist2zr:0.000848467303071653"
## [1] "it_cur:27, fl_p_dist2zr:0.000427696340068737"
## [1] "it_cur:28, fl_p_dist2zr:0.000218673312373287"
## [1] "it_cur:29, fl_p_dist2zr:0.000108180725121156"
## [1] "it_cur:30, fl_p_dist2zr:5.24326238874592e-05"
## [1] "it_cur:31, fl_p_dist2zr:2.67010139017832e-05"
## [1] "it_cur:32, fl_p_dist2zr:1.33128324107031e-05"
## [1] "it_cur:33, fl_p_dist2zr:6.65284808581866e-06"
## [1] "it_cur:34, fl_p_dist2zr:3.34008954068542e-06"
## [1] "it_cur:35, fl_p_dist2zr:1.65812727955474e-06"
## [1] "it_cur:36, fl_p_dist2zr:8.52063209322296e-07"</code></pre>
</div>
<div id="reshape-wide-to-long-to-wide" class="section level3">
<h3 class="hasAnchor">
<a href="#reshape-wide-to-long-to-wide" class="anchor"></a>Reshape wide to long to wide</h3>
<div id="table-onevery-wide" class="section level4">
<h4 class="hasAnchor">
<a href="#table-onevery-wide" class="anchor"></a>Table One–very wide</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tb_states_choices_bisec, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## Source: local data frame [10 x 154]
## Groups: &lt;by row&gt;
## 
## # A tibble: 10 x 154
##    indi_id  fl_a fl_alpha bisec_a_0 bisec_b_0 bisec_fa_0 bisec_fb_0      p
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1       1  4.34  0.00669         0       100        100   -161823. 0.0622
##  2       2  4.36  0.00925         0       100        100   -116164. 0.0862
##  3       3  4.35  0.00925         0       100        100   -116436. 0.0860
##  4       4  4.37  0.0139          0       100        100    -76535. 0.130 
##  5       5  4.34  0.00669         0       100        100   -162038. 0.0621
##  6       6  4.36  0.0139          0       100        100    -76706. 0.130 
##  7       7  4.34  0.00669         0       100        100   -162025. 0.0621
##  8       8  4.34  0.00669         0       100        100   -161980. 0.0621
##  9       9  4.36  0.0139          0       100        100    -76632. 0.130 
## 10      10  4.33  0.0121          0       100        100    -89034. 0.112 
## # ... with 146 more variables: f_p &lt;dbl&gt;, f_p_t_f_a &lt;dbl&gt;, bisec_a_1 &lt;dbl&gt;,
## #   bisec_b_1 &lt;dbl&gt;, bisec_fa_1 &lt;dbl&gt;, bisec_fb_1 &lt;dbl&gt;, bisec_a_2 &lt;dbl&gt;,
## #   bisec_b_2 &lt;dbl&gt;, bisec_fa_2 &lt;dbl&gt;, bisec_fb_2 &lt;dbl&gt;, bisec_a_3 &lt;dbl&gt;,
## #   bisec_b_3 &lt;dbl&gt;, bisec_fa_3 &lt;dbl&gt;, bisec_fb_3 &lt;dbl&gt;, bisec_a_4 &lt;dbl&gt;,
## #   bisec_b_4 &lt;dbl&gt;, bisec_fa_4 &lt;dbl&gt;, bisec_fb_4 &lt;dbl&gt;, bisec_a_5 &lt;dbl&gt;,
## #   bisec_b_5 &lt;dbl&gt;, bisec_fa_5 &lt;dbl&gt;, bisec_fb_5 &lt;dbl&gt;, bisec_a_6 &lt;dbl&gt;,
## #   bisec_b_6 &lt;dbl&gt;, bisec_fa_6 &lt;dbl&gt;, bisec_fb_6 &lt;dbl&gt;, bisec_a_7 &lt;dbl&gt;,
## #   bisec_b_7 &lt;dbl&gt;, bisec_fa_7 &lt;dbl&gt;, bisec_fb_7 &lt;dbl&gt;, bisec_a_8 &lt;dbl&gt;,
## #   bisec_b_8 &lt;dbl&gt;, bisec_fa_8 &lt;dbl&gt;, bisec_fb_8 &lt;dbl&gt;, bisec_a_9 &lt;dbl&gt;,
## #   bisec_b_9 &lt;dbl&gt;, bisec_fa_9 &lt;dbl&gt;, bisec_fb_9 &lt;dbl&gt;, bisec_a_10 &lt;dbl&gt;,
## #   bisec_b_10 &lt;dbl&gt;, bisec_fa_10 &lt;dbl&gt;, bisec_fb_10 &lt;dbl&gt;, bisec_a_11 &lt;dbl&gt;,
## #   bisec_b_11 &lt;dbl&gt;, bisec_fa_11 &lt;dbl&gt;, bisec_fb_11 &lt;dbl&gt;, bisec_a_12 &lt;dbl&gt;,
## #   bisec_b_12 &lt;dbl&gt;, bisec_fa_12 &lt;dbl&gt;, bisec_fb_12 &lt;dbl&gt;, bisec_a_13 &lt;dbl&gt;,
## #   bisec_b_13 &lt;dbl&gt;, bisec_fa_13 &lt;dbl&gt;, bisec_fb_13 &lt;dbl&gt;, bisec_a_14 &lt;dbl&gt;,
## #   bisec_b_14 &lt;dbl&gt;, bisec_fa_14 &lt;dbl&gt;, bisec_fb_14 &lt;dbl&gt;, bisec_a_15 &lt;dbl&gt;,
## #   bisec_b_15 &lt;dbl&gt;, bisec_fa_15 &lt;dbl&gt;, bisec_fb_15 &lt;dbl&gt;, bisec_a_16 &lt;dbl&gt;,
## #   bisec_b_16 &lt;dbl&gt;, bisec_fa_16 &lt;dbl&gt;, bisec_fb_16 &lt;dbl&gt;, bisec_a_17 &lt;dbl&gt;,
## #   bisec_b_17 &lt;dbl&gt;, bisec_fa_17 &lt;dbl&gt;, bisec_fb_17 &lt;dbl&gt;, bisec_a_18 &lt;dbl&gt;,
## #   bisec_b_18 &lt;dbl&gt;, bisec_fa_18 &lt;dbl&gt;, bisec_fb_18 &lt;dbl&gt;, bisec_a_19 &lt;dbl&gt;,
## #   bisec_b_19 &lt;dbl&gt;, bisec_fa_19 &lt;dbl&gt;, bisec_fb_19 &lt;dbl&gt;, bisec_a_20 &lt;dbl&gt;,
## #   bisec_b_20 &lt;dbl&gt;, bisec_fa_20 &lt;dbl&gt;, bisec_fb_20 &lt;dbl&gt;, bisec_a_21 &lt;dbl&gt;,
## #   bisec_b_21 &lt;dbl&gt;, bisec_fa_21 &lt;dbl&gt;, bisec_fb_21 &lt;dbl&gt;, bisec_a_22 &lt;dbl&gt;,
## #   bisec_b_22 &lt;dbl&gt;, bisec_fa_22 &lt;dbl&gt;, bisec_fb_22 &lt;dbl&gt;, bisec_a_23 &lt;dbl&gt;,
## #   bisec_b_23 &lt;dbl&gt;, bisec_fa_23 &lt;dbl&gt;, bisec_fb_23 &lt;dbl&gt;, bisec_a_24 &lt;dbl&gt;,
## #   bisec_b_24 &lt;dbl&gt;, bisec_fa_24 &lt;dbl&gt;, bisec_fb_24 &lt;dbl&gt;, bisec_a_25 &lt;dbl&gt;,
## #   bisec_b_25 &lt;dbl&gt;, ...</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'input allocated total sum: '</span>, <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(tb_states_choices_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(p))))</a></code></pre></div>
<pre><code>## [1] "input allocated total sum: 100.000000033469"</code></pre>
</div>
<div id="table-twovery-wide-to-very-long" class="section level4">
<h4 class="hasAnchor">
<a href="#table-twovery-wide-to-very-long" class="anchor"></a>Table Two–very wide to very long</h4>
<p>we want to treat the iteration count information that is the suffix of variable names as a variable by itself. additionally, we want to treat the a,b,fa,fb as a variable. structuring the data very long like this allows for easy graphing and other types of analysis. rather than dealing with many many variables, we have only 3 core variables that store bisection iteration information.</p>
<p>here we use the very nice <em>pivot_longer</em> function. note that to achieve this, we put a common prefix in front of the variables we wanted to convert to long. this is helpful, because we can easily identify which variables need to be reshaped.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># new variables</span></a>
<a class="sourceLine" id="cb28-2" title="2">svr_bisect_iter &lt;-<span class="st"> 'biseciter'</span></a>
<a class="sourceLine" id="cb28-3" title="3">svr_abfafb_long_name &lt;-<span class="st"> 'varname'</span></a>
<a class="sourceLine" id="cb28-4" title="4">svr_number_col &lt;-<span class="st"> 'value'</span></a>
<a class="sourceLine" id="cb28-5" title="5">svr_id_bisect_iter &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(svr_id_var, <span class="st">'_bisect_ier'</span>)</a>
<a class="sourceLine" id="cb28-6" title="6"></a>
<a class="sourceLine" id="cb28-7" title="7"><span class="co"># pivot wide to very long</span></a>
<a class="sourceLine" id="cb28-8" title="8">tb_states_choices_bisec_long &lt;-<span class="st"> </span>tb_states_choices_bisec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">9</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="st">  </span><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb28-10" title="10">    <span class="dt">cols =</span> <span class="kw">starts_with</span>(st_bisec_prefix),</a>
<a class="sourceLine" id="cb28-11" title="11">    <span class="dt">names_to =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(svr_abfafb_long_name, svr_bisect_iter),</a>
<a class="sourceLine" id="cb28-12" title="12">    <span class="dt">names_pattern =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">"(.*)_(.*)"</span>),</a>
<a class="sourceLine" id="cb28-13" title="13">    <span class="dt">values_to =</span> svr_number_col</a>
<a class="sourceLine" id="cb28-14" title="14">  )</a>
<a class="sourceLine" id="cb28-15" title="15"></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="co"># print</span></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_states_choices_bisec_long)</a></code></pre></div>
<pre><code>##     indi_id            fl_a          fl_alpha              p          
##  Min.   :  90.0   Min.   :4.324   Min.   :0.006687   Min.   :0.06212  
##  1st Qu.: 145.0   1st Qu.:4.339   1st Qu.:0.006687   1st Qu.:0.06225  
##  Median : 391.0   Median :4.342   Median :0.012090   Median :0.11211  
##  Mean   : 485.7   Mean   :4.343   Mean   :0.010700   Mean   :0.09937  
##  3rd Qu.: 798.0   3rd Qu.:4.349   3rd Qu.:0.012090   3rd Qu.:0.11236  
##  Max.   :1040.0   Max.   :4.361   Max.   :0.013940   Max.   :0.12981  
##       f_p               f_p_t_f_a            varname         
##  Min.   :-2.245e-06   Min.   :-4.153e-13   Length:1332       
##  1st Qu.:-1.015e-06   1st Qu.:-2.125e-13   Class :character  
##  Median :-7.406e-07   Median :-1.066e-13   Mode  :character  
##  Mean   :-6.420e-07   Mean   : 1.315e-13                     
##  3rd Qu.: 1.029e-07   3rd Qu.: 1.441e-13                     
##  Max.   : 4.735e-07   Max.   : 1.334e-12                     
##   biseciter             value           
##  Length:1332        Min.   :-161932.64  
##  Class :character   1st Qu.:      0.00  
##  Mode  :character   Median :      0.06  
##                     Mean   :  -1478.67  
##                     3rd Qu.:      0.13  
##                     Max.   :    100.00</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tb_states_choices_bisec_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">one_of</span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="dv">30</span>)</a></code></pre></div>
<pre><code>## # A tibble: 30 x 6
##    indi_id  fl_a fl_alpha varname biseciter   value
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;
##  1     798  4.34   0.0121 a       0              0 
##  2     798  4.34   0.0121 b       0            100 
##  3     798  4.34   0.0121 fa      0            100 
##  4     798  4.34   0.0121 fb      0         -88981.
##  5     798  4.34   0.0121 a       1              0 
##  6     798  4.34   0.0121 b       1             50 
##  7     798  4.34   0.0121 fa      1            100 
##  8     798  4.34   0.0121 fb      1         -44446.
##  9     798  4.34   0.0121 a       2              0 
## 10     798  4.34   0.0121 b       2             25 
## # ... with 20 more rows</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(tb_states_choices_bisec_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">one_of</span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="dv">30</span>)</a></code></pre></div>
<pre><code>## # A tibble: 30 x 6
##    indi_id  fl_a fl_alpha varname biseciter       value
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;
##  1     116  4.34  0.00669 fa      29         0.000232  
##  2     116  4.34  0.00669 fb      29        -0.0000675 
##  3     116  4.34  0.00669 a       30         0.0622    
##  4     116  4.34  0.00669 b       30         0.0622    
##  5     116  4.34  0.00669 fa      30         0.0000825 
##  6     116  4.34  0.00669 fb      30        -0.0000675 
##  7     116  4.34  0.00669 a       31         0.0622    
##  8     116  4.34  0.00669 b       31         0.0622    
##  9     116  4.34  0.00669 fa      31         0.00000750
## 10     116  4.34  0.00669 fb      31        -0.0000675 
## # ... with 20 more rows</code></pre>
</div>
<div id="table-twovery-very-long-to-wider-again" class="section level4">
<h4 class="hasAnchor">
<a href="#table-twovery-very-long-to-wider-again" class="anchor"></a>Table Two–very very long to wider again</h4>
<p>but the previous results are too long, with the a, b, fa, and fb all in one column as different categories, they are really not different categories, they are in fact different types of variables. so we want to spread those four categories of this variable into four columns, each one representing the a, b, fa, and fb values. the rows would then be uniquly identified by the iteration counter and individual id.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># pivot wide to very long to a little wide</span></a>
<a class="sourceLine" id="cb34-2" title="2">tb_states_choices_bisec_wider &lt;-<span class="st"> </span>tb_states_choices_bisec_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">  </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb34-4" title="4">    <span class="dt">names_from =</span> <span class="op">!!</span><span class="kw">sym</span>(svr_abfafb_long_name),</a>
<a class="sourceLine" id="cb34-5" title="5">    <span class="dt">values_from =</span> svr_number_col</a>
<a class="sourceLine" id="cb34-6" title="6">  )</a>
<a class="sourceLine" id="cb34-7" title="7"></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="co"># print</span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_states_choices_bisec_wider)</a></code></pre></div>
<pre><code>##     indi_id            fl_a          fl_alpha              p          
##  Min.   :  90.0   Min.   :4.324   Min.   :0.006687   Min.   :0.06212  
##  1st Qu.: 145.0   1st Qu.:4.339   1st Qu.:0.006687   1st Qu.:0.06225  
##  Median : 391.0   Median :4.342   Median :0.012090   Median :0.11211  
##  Mean   : 485.7   Mean   :4.343   Mean   :0.010700   Mean   :0.09937  
##  3rd Qu.: 798.0   3rd Qu.:4.349   3rd Qu.:0.012090   3rd Qu.:0.11236  
##  Max.   :1040.0   Max.   :4.361   Max.   :0.013940   Max.   :0.12981  
##       f_p               f_p_t_f_a           biseciter               a          
##  Min.   :-2.245e-06   Min.   :-4.153e-13   Length:333         Min.   :0.00000  
##  1st Qu.:-1.015e-06   1st Qu.:-2.125e-13   Class :character   1st Qu.:0.00000  
##  Median :-7.406e-07   Median :-1.066e-13   Mode  :character   Median :0.06225  
##  Mean   :-6.420e-07   Mean   : 1.315e-13                      Mean   :0.07054  
##  3rd Qu.: 1.029e-07   3rd Qu.: 1.441e-13                      3rd Qu.:0.11220  
##  Max.   : 4.735e-07   Max.   : 1.334e-12                      Max.   :0.12981  
##        b                   fa                  fb            
##  Min.   :  0.06212   Min.   :  0.00000   Min.   :-161932.64  
##  1st Qu.:  0.11180   1st Qu.:  0.00023   1st Qu.:   -200.73  
##  Median :  0.11292   Median :  0.12260   Median :     -0.19  
##  Mean   :  5.47595   Mean   : 29.33242   Mean   :  -5949.54  
##  3rd Qu.:  0.19531   3rd Qu.:100.00000   3rd Qu.:      0.00  
##  Max.   :100.00000   Max.   :100.00000   Max.   :      0.00</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tb_states_choices_bisec_wider <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">one_of</span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="dv">30</span>)</a></code></pre></div>
<pre><code>## # A tibble: 30 x 8
##    indi_id  fl_a fl_alpha biseciter     a       b    fa       fb
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1     798  4.34   0.0121 0             0 100       100 -88981. 
##  2     798  4.34   0.0121 1             0  50       100 -44446. 
##  3     798  4.34   0.0121 2             0  25       100 -22176. 
##  4     798  4.34   0.0121 3             0  12.5     100 -11039. 
##  5     798  4.34   0.0121 4             0   6.25    100  -5470. 
##  6     798  4.34   0.0121 5             0   3.12    100  -2686. 
##  7     798  4.34   0.0121 6             0   1.56    100  -1293. 
##  8     798  4.34   0.0121 7             0   0.781   100   -597. 
##  9     798  4.34   0.0121 8             0   0.391   100   -248. 
## 10     798  4.34   0.0121 9             0   0.195   100    -74.2
## # ... with 20 more rows</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(tb_states_choices_bisec_wider <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">one_of</span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="dv">30</span>)</a></code></pre></div>
<pre><code>## # A tibble: 30 x 8
##    indi_id  fl_a fl_alpha biseciter      a      b     fa        fb
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
##  1     116  4.34  0.00669 7         0      0.781  100    -1160.   
##  2     116  4.34  0.00669 8         0      0.391  100     -529.   
##  3     116  4.34  0.00669 9         0      0.195  100     -215.   
##  4     116  4.34  0.00669 10        0      0.0977 100      -57.2  
##  5     116  4.34  0.00669 11        0.0488 0.0977  21.5    -57.2  
##  6     116  4.34  0.00669 12        0.0488 0.0732  21.5    -17.8  
##  7     116  4.34  0.00669 13        0.0610 0.0732   1.81   -17.8  
##  8     116  4.34  0.00669 14        0.0610 0.0671   1.81    -8.02 
##  9     116  4.34  0.00669 15        0.0610 0.0641   1.81    -3.10 
## 10     116  4.34  0.00669 16        0.0610 0.0626   1.81    -0.645
## # ... with 20 more rows</code></pre>
</div>
</div>
<div id="graph-bisection-iteration-results" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-bisection-iteration-results" class="anchor"></a>Graph Bisection Iteration results</h3>
<p>actually we want to graph based on the long results, not the wider. wider easier to view in table.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># graph results</span></a>
<a class="sourceLine" id="cb40-2" title="2">lineplot &lt;-<span class="st"> </span>tb_states_choices_bisec_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="op">!!</span><span class="kw">sym</span>(svr_bisect_iter) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="op">!!</span><span class="kw">sym</span>(svr_bisect_iter))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!!</span><span class="kw">sym</span>(svr_abfafb_long_name) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'a'</span>, <span class="st">'b'</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="op">!!</span><span class="kw">sym</span>(svr_bisect_iter), <span class="dt">y=</span><span class="op">!!</span><span class="kw">sym</span>(svr_number_col),</a>
<a class="sourceLine" id="cb40-6" title="6">               <span class="dt">colour=</span><span class="op">!!</span><span class="kw">sym</span>(svr_abfafb_long_name),</a>
<a class="sourceLine" id="cb40-7" title="7">               <span class="dt">linetype=</span><span class="op">!!</span><span class="kw">sym</span>(svr_abfafb_long_name),</a>
<a class="sourceLine" id="cb40-8" title="8">               <span class="dt">shape=</span><span class="op">!!</span><span class="kw">sym</span>(svr_abfafb_long_name))) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="st">        </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>indi_id) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-10" title="10"><span class="st">        </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb40-11" title="11"><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st">    </span></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">'bisection iteration over individuals until convergence'</span>,</a>
<a class="sourceLine" id="cb40-13" title="13">             <span class="dt">x =</span> <span class="st">'bisection iteration'</span>,</a>
<a class="sourceLine" id="cb40-14" title="14">             <span class="dt">y =</span> <span class="st">'a (left side point) and b (right side point) values'</span>,</a>
<a class="sourceLine" id="cb40-15" title="15">             <span class="dt">caption =</span> <span class="st">'dplyr concurrent bisection nonlinear multple individuals'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-16" title="16"><span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb40-17" title="17"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(lineplot)</a></code></pre></div>
<p><img src="ffv_opt_solog_asame_allrw_files/figure-html/reshape%20solution%20for%20graphing-1.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#objective">Objective</a></li>
      <li>
<a href="#load-packages-and-data">Load Packages and Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#load-dependencies">Load Dependencies</a></li>
      <li><a href="#common-parameters">common parameters</a></li>
      <li><a href="#a-and-alpha-input-matrix">A and alpha input matrix</a></li>
      <li><a href="#expand-matrix">expand matrix</a></li>
      </ul>
</li>
      <li>
<a href="#apply-same-function-all-rows-some-inputs-row-specific-other-shared">Apply Same Function All Rows, some inputs row-specific, other shared</a><ul class="nav nav-pills nav-stacked">
<li><a href="#points-and-denser-dataframs-and-define-function">3 points and denser dataframs and define function</a></li>
      <li><a href="#evaluate-at-three-choice-points-and-show-table">evaluate at three choice points and show table</a></li>
      <li><a href="#evaluate-at-many-choice-points-and-show-graphically">evaluate at many choice points and show graphically</a></li>
      </ul>
</li>
      <li>
<a href="#bisection-solve-optimal-choice-for-each-individual">bisection solve optimal choice for each individual</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bisection-algorithm">bisection algorithm</a></li>
      <li><a href="#dplyr-implementation-of-bisection">dplyr implementation of bisection</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Fan Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
