<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resource Equivalent Variation with Two Individuals Analytical Example â€¢ Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Resource Equivalent Variation with Two Individuals Analytical Example">
<meta property="og:description" content="With two individuals of heterogeneous A and alpha, demonstrate the REV comparisons between
the actual allocation and optimal allocations by various planners. Work out core concepts.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Papers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3839890" class="external-link">Optimal Allocations to Heterogeneous Agents with An Application to Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3691091" class="external-link">Optimal Allocation of the COVID-19 Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3547706" class="external-link">The Optimal Allocation of Resources among Heterogeneous Individuals</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/" class="external-link">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/" class="external-link">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/" class="external-link">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/" class="external-link">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/" class="external-link">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/" class="external-link">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/" class="external-link">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/" class="external-link">Python Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Resource Equivalent Variation with Two Individuals Analytical Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/HEAD/vignettes/ffv_opt_sobin_rev_concept.Rmd" class="external-link"><code>vignettes/ffv_opt_sobin_rev_concept.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_sobin_rev_concept.Rmd</code></div>

    </div>

    
    
<p>In this file, we demonstrate the concept of Resource Equivalent Variations (REV), when there are two individuals</p>
<div class="section level2">
<h2 id="load-dependencies">Load Dependencies<a class="anchor" aria-label="anchor" href="#load-dependencies"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>all.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.duplicate.label <span class="op">=</span> <span class="st">'allow'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/PrjOptiAlloc/">PrjOptiAlloc</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="two-individuals-and-stimulus-checks">Two Individuals and Stimulus Checks<a class="anchor" aria-label="anchor" href="#two-individuals-and-stimulus-checks"></a>
</h2>
<p>There are two individuals with heterogeneous consumption in the absence of stimulus checks <span class="math inline">\(A\)</span>. Each has constant <span class="math inline">\(\alpha_i\)</span> that is constant over units of allocation, which means constant marginal propensity to consume. <span class="math inline">\(\alpha_i=\text{MPC}*\text{check_size}\)</span>.</p>
<p>Specifically, for these two people, <span class="math inline">\(i=1\)</span> has low income, with <span class="math inline">\(A=1\)</span>. This means consumption for this low income individual is 1 dollar in the absence of the allocations. The high income individual, <span class="math inline">\(i=2\)</span>, has <span class="math inline">\(A=4\)</span>.</p>
<p>Suppose that the high income person spends 100% of the money given, the low income person only 50%. This means, for a check of 1 dollar, <span class="math inline">\(\alpha_{i=1} = 0.5\)</span> and <span class="math inline">\(\alpha_{i=2} = 1\)</span></p>
<div class="section level3">
<h3 id="the-welfare-function">The Welfare Function<a class="anchor" aria-label="anchor" href="#the-welfare-function"></a>
</h3>
<p>Suppose we have a planner that cares about the value of consumption form the two individuals with different weights. Suppose the poorer person gets <span class="math inline">\(\beta_1\)</span> weight, and the richer person gets <span class="math inline">\(\beta_2\)</span> percent. The planner uses the CES/Atkinson function to aggregate over individual welfare.</p>
<p><span class="math display">\[
U^{Util} = 
\left(
\beta_1\cdot\left(A_1 + \alpha_1\cdot\text{TR}_1\right)^{\rho} + 
\beta_2\cdot\left(A_2 + \alpha_2\cdot\text{TR}_2\right)^{\rho}
\right)^{\frac{1}{\rho}}
\]</span></p>
<p>The function that implements the CES index above.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ffi_ces_welfare</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fl_alloc_1</span>, <span class="va">fl_alloc_2</span>, 
                            <span class="va">fl_rho</span>, 
                            <span class="va">fl_A_1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">fl_A_2</span> <span class="op">=</span> <span class="fl">4</span>,
                            <span class="va">fl_alpha_1</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="va">fl_alpha_2</span> <span class="op">=</span> <span class="fl">1</span>,
                            <span class="va">fl_beta_1</span> <span class="op">=</span> <span class="fl">0.55</span>, <span class="va">fl_beta_2</span> <span class="op">=</span> <span class="fl">0.45</span>, 
                            <span class="va">bl_verbose</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="co"># fl_alpha_1 and fl_alpha_2 are consumption increases from 1 dollar of check</span>
  
  <span class="va">fl_planner_U</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">fl_beta_1</span><span class="op">*</span><span class="op">(</span><span class="va">fl_A_1</span> <span class="op">+</span> <span class="va">fl_alpha_1</span><span class="op">*</span><span class="va">fl_alloc_1</span><span class="op">)</span><span class="op">^</span><span class="va">fl_rho</span> <span class="op">+</span> 
    <span class="va">fl_beta_2</span><span class="op">*</span><span class="op">(</span><span class="va">fl_A_2</span> <span class="op">+</span> <span class="va">fl_alpha_2</span><span class="op">*</span><span class="va">fl_alloc_2</span><span class="op">)</span><span class="op">^</span><span class="va">fl_rho</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">fl_rho</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="va">bl_verbose</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">st_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'fl_planner_U='</span>, <span class="va">fl_planner_U</span>,
                        <span class="st">', rho='</span>, <span class="va">fl_rho</span>, 
                        <span class="st">', fl_alloc_1='</span>, <span class="va">fl_alloc_1</span>, 
                        <span class="st">', fl_alloc_2='</span>, <span class="va">fl_alloc_2</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">st_output</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">fl_planner_U</span><span class="op">)</span>  
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-actual-allocation">The Actual Allocation<a class="anchor" aria-label="anchor" href="#the-actual-allocation"></a>
</h2>
<p>Suppose under the actual allocation rule the government gives 1 dollar to the low income person and 1 dollar to the high income person. This would be a uniform allocation rule.</p>
<p>Under the actual allocation, out of the 2 dollar of stimulus, we get 1.5 dollar of consumption boost.</p>
<p><span class="math display">\[
\text{STIMULUS EFFECTS} = 1 \cdot 0.5 + 1 \cdot 1.0 = 1.5
\]</span></p>
<div class="section level3">
<h3 id="utilitarian-welfare-under-actual-allocation">Utilitarian Welfare under Actual Allocation<a class="anchor" aria-label="anchor" href="#utilitarian-welfare-under-actual-allocation"></a>
</h3>
<p>The welfare for the Utilitarian planner is, under the actual allocation:</p>
<p><span class="math display">\[
U = \left(\frac{55}{100}\cdot\left(1 + 0.5\right)^1 + \frac{45}{100}\cdot\left(4 + 1\right)^1\right)^{1}
=3.075
\]</span> Evaluate:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fl_u_actual_utilitarian</span> <span class="op">&lt;-</span> <span class="fu">ffi_ces_welfare</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, bl_verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "fl_planner_U=3.075, rho=1, fl_alloc_1=1, fl_alloc_2=1"</span></code></pre>
</div>
<div class="section level3">
<h3 id="intermediate-planner-welfare-under-actual-allocation">Intermediate Planner Welfare under Actual Allocation<a class="anchor" aria-label="anchor" href="#intermediate-planner-welfare-under-actual-allocation"></a>
</h3>
<p>The welfare for the <span class="math inline">\(\rho=-1\)</span>, which means elasticity is <span class="math inline">\(2\)</span> planner is:</p>
<p><span class="math display">\[
U = 
\left(
  \frac{55}{100}\cdot\left(1 + 0.5\right)^{-1} + 
  \frac{45}{100}\cdot\left(4 + 1\right)^{-1}
\right)^{-1}
=2.189781
\]</span> Evaluate:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fl_u_actual_rho_neg1</span> <span class="op">&lt;-</span> <span class="fu">ffi_ces_welfare</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, bl_verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "fl_planner_U=2.18978102189781, rho=-1, fl_alloc_1=1, fl_alloc_2=1"</span></code></pre>
</div>
<div class="section level3">
<h3 id="close-to-rawlsian-planner-welfare-under-actual-allocation">Close to Rawlsian Planner Welfare under Actual Allocation<a class="anchor" aria-label="anchor" href="#close-to-rawlsian-planner-welfare-under-actual-allocation"></a>
</h3>
<p>The welfare for the <span class="math inline">\(\rho=-99\)</span>, which means elasticity is <span class="math inline">\(0.01\)</span> planner is:</p>
<p><span class="math display">\[
U = 
\left(
  \frac{55}{100}\cdot\left(1 + 0.5\right)^{-99} + 
  \frac{45}{100}\cdot\left(4 + 1\right)^{-99}
\right)^{\frac{1}{-99}}
=1.509086
\]</span> Evaluate:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fl_u_actual_rho_neg99</span> <span class="op">&lt;-</span> <span class="fu">ffi_ces_welfare</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">99</span>, bl_verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "fl_planner_U=1.50908554145639, rho=-99, fl_alloc_1=1, fl_alloc_2=1"</span></code></pre>
<p>Note that for the actual Rawlsian, only the <span class="math inline">\(A\)</span> matters, <span class="math inline">\(\alpha\)</span> does not matter, nor do <span class="math inline">\(\beta\)</span>. The relative value of <span class="math inline">\(\beta\)</span> is irrelevant as <span class="math inline">\(\rho \rightarrow -\infty\)</span> welfare is:</p>
<p><span class="math display">\[
\min\left(1+0.5, 4+1 \right)=1.5
\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="the-utilitarian-optimal-allocation-problem">The Utilitarian Optimal Allocation Problem<a class="anchor" aria-label="anchor" href="#the-utilitarian-optimal-allocation-problem"></a>
</h2>
<div class="section level3">
<h3 id="utilitarian-optimal-allocation">Utilitarian Optimal Allocation<a class="anchor" aria-label="anchor" href="#utilitarian-optimal-allocation"></a>
</h3>
<p>We only have 2 dollars, where would planner welfare be maximized for the Utilitarian? Despite our slight bias towards the poorer individual, our optimal choice, is to allocate all to the second individual</p>
<p><span class="math display">\[
\arg\max_{0 \le \text{TR}_1 \le 2} 
\left(
  \frac{55}{100}\cdot\left(1 + 0.5\cdot\text{TR}_1\right)^1 + 
  \frac{45}{100}\cdot\left(4 + 1\cdot\left(2-\text{TR}_1\right)\right)^1
\right)^{1}
=\text{TR}^{\ast}_1 = 0\\
U\left(\text{TR}^{\ast}_1=0\right)=3.25
\]</span> Solve for optimal welfare over find grid of <span class="math inline">\(\text{TR}_1\)</span> chocies, we will create a function first:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ffi_planner_optimal_choice</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fl_rho</span> <span class="op">=</span> <span class="fl">1</span>,
                                        <span class="va">fl_max_resource</span> <span class="op">=</span> <span class="fl">2</span>,
                                        <span class="va">it_tr_len</span> <span class="op">=</span> <span class="fl">1000</span>, 
                                        <span class="va">bl_graph</span> <span class="op">=</span> <span class="cn">FALSE</span>, 
                                        <span class="va">bl_verbose</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># 1000 transfer points</span>
  <span class="va">ar_TR1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">fl_max_resource</span>, length.out <span class="op">=</span> <span class="va">it_tr_len</span><span class="op">)</span>
  
  <span class="co"># Evaluate</span>
  <span class="va">ar_U</span> <span class="op">&lt;-</span> <span class="fu">ffi_ces_welfare</span><span class="op">(</span><span class="va">ar_TR1</span>, <span class="va">fl_max_resource</span><span class="op">-</span><span class="va">ar_TR1</span>, <span class="va">fl_rho</span><span class="op">)</span>
  
  <span class="co"># max</span>
  <span class="va">it_max_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">ar_U</span><span class="op">)</span>
  <span class="va">fl_TR1_max</span> <span class="op">&lt;-</span> <span class="va">ar_TR1</span><span class="op">[</span><span class="va">it_max_idx</span><span class="op">]</span>
  <span class="va">fl_U_max</span> <span class="op">&lt;-</span> <span class="va">ar_U</span><span class="op">[</span><span class="va">it_max_idx</span><span class="op">]</span>
  
  <span class="co"># Print</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">bl_verbose</span><span class="op">)</span> <span class="op">{</span>
   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'fl_TR1_max='</span>,<span class="va">fl_TR1_max</span>,<span class="st">',fl_U_max='</span>,<span class="va">fl_U_max</span><span class="op">)</span><span class="op">)</span> 
  <span class="op">}</span>
  
  <span class="co"># Visualize</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">bl_graph</span><span class="op">)</span> <span class="op">{</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ar_TR1</span>, <span class="va">ar_U</span><span class="op">)</span> 
  <span class="op">}</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fl_TR1_max<span class="op">=</span><span class="va">fl_TR1_max</span>, fl_U_max<span class="op">=</span><span class="va">fl_U_max</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Call the function to solve for the Utilitarian problem:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ffi_planner_optimal_choice</span><span class="op">(</span>fl_rho<span class="op">=</span><span class="fl">1</span>, bl_graph<span class="op">=</span><span class="cn">TRUE</span>, bl_verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "fl_TR1_max=0,fl_U_max=3.25"</span></code></pre>
<p><img src="ffv_opt_sobin_rev_concept_files/figure-html/unnamed-chunk-6-1.png" width="700" style="display: block; margin: auto;"></p>
<pre><code><span class="co">## $fl_TR1_max</span>
<span class="co">## [1] 0</span>
<span class="co">## </span>
<span class="co">## $fl_U_max</span>
<span class="co">## [1] 3.25</span></code></pre>
</div>
<div class="section level3">
<h3 id="rev-for-utilitarian">REV for Utilitarian<a class="anchor" aria-label="anchor" href="#rev-for-utilitarian"></a>
</h3>
<p>How much less resources is needed by the Utilitarian to achieve the same welfare as under the actual allocation if allocations are optimal?</p>
<p>We now solve an alternative problem, where we reduce the amount of resource available until we find the level of resources that would achieve the same welfare as under the actual allocation.</p>
<p>We will create a function for this:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ffi_planner_rev</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fl_alter_U</span>, 
                                        <span class="va">fl_rho</span> <span class="op">=</span> <span class="fl">1</span>,
                                        <span class="va">fl_max_resource</span> <span class="op">=</span> <span class="fl">2</span>,
                                        <span class="va">it_res_len</span> <span class="op">=</span> <span class="fl">1000</span>,
                                        <span class="va">it_tr_len</span> <span class="op">=</span> <span class="fl">1000</span>, 
                                        <span class="va">bl_graph</span> <span class="op">=</span> <span class="cn">FALSE</span>, 
                                        <span class="va">bl_verbose</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># 1000 transfer points</span>
  <span class="va">ar_resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1e-5</span>, <span class="va">fl_max_resource</span>, length.out <span class="op">=</span> <span class="va">it_res_len</span><span class="op">)</span>
  <span class="va">ar_opti_U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="va">it_res_len</span><span class="op">)</span>
  
  <span class="co"># Evaluate</span>
  <span class="va">it_ctr</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">bl_notpassed</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">fl_max_resource</span> <span class="kw">in</span> <span class="va">ar_resources</span><span class="op">)</span><span class="op">{</span>
    <span class="co"># counter</span>
    <span class="va">it_ctr</span> <span class="op">&lt;-</span> <span class="va">it_ctr</span> <span class="op">+</span> <span class="fl">1</span>
    <span class="co"># solve for optimal</span>
    <span class="va">ls_optimal</span> <span class="op">&lt;-</span> <span class="fu">ffi_planner_optimal_choice</span><span class="op">(</span>fl_rho <span class="op">=</span> <span class="va">fl_rho</span>,
                                              fl_max_resource <span class="op">=</span> <span class="va">fl_max_resource</span>,
                                              it_tr_len <span class="op">=</span> <span class="va">it_tr_len</span>, 
                                              bl_graph <span class="op">=</span> <span class="cn">FALSE</span>, 
                                              bl_verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
    <span class="co"># Umax</span>
    <span class="va">fl_U_max</span> <span class="op">&lt;-</span> <span class="va">ls_optimal</span><span class="op">$</span><span class="va">fl_U_max</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">fl_U_max</span> <span class="op">&lt;=</span> <span class="va">fl_alter_U</span><span class="op">)</span> <span class="op">{</span>
      <span class="kw">if</span> <span class="op">(</span><span class="va">bl_notpassed</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">fl_U_threshold</span> <span class="op">&lt;-</span> <span class="va">fl_U_max</span>
        <span class="va">fl_res_threshold</span> <span class="op">&lt;-</span> <span class="va">fl_max_resource</span>
        <span class="va">bl_notpassed</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>
      <span class="op">}</span>
    <span class="op">}</span> 
    <span class="co"># store</span>
    <span class="va">ar_opti_U</span><span class="op">[</span><span class="va">it_ctr</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ls_optimal</span><span class="op">$</span><span class="va">fl_U_max</span>
  <span class="op">}</span>
  
  <span class="co"># REV</span>
  <span class="va">fl_REV</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">fl_res_threshold</span><span class="op">/</span><span class="va">fl_max_resource</span>
  
  <span class="co"># Print</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">bl_verbose</span><span class="op">)</span> <span class="op">{</span>
   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'fl_REV='</span>,<span class="va">fl_REV</span>,<span class="st">',fl_res_threshold='</span>,<span class="va">fl_res_threshold</span>,
                <span class="st">',fl_U_threshold='</span>,<span class="va">fl_U_threshold</span>,<span class="st">',fl_alter_U='</span>,<span class="va">fl_alter_U</span><span class="op">)</span><span class="op">)</span> 
  <span class="op">}</span>
  
  <span class="co"># Visualize</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">bl_graph</span><span class="op">)</span> <span class="op">{</span>
   <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ar_resources</span>, <span class="va">ar_opti_U</span><span class="op">)</span> 
  <span class="op">}</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">fl_REV</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Use the function for the utilitarian:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ffi_planner_rev</span><span class="op">(</span><span class="va">fl_u_actual_utilitarian</span>, fl_rho <span class="op">=</span> <span class="fl">1</span>,
                bl_graph <span class="op">=</span> <span class="cn">TRUE</span>, bl_verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "fl_REV=0.999995,fl_res_threshold=1e-05,fl_U_threshold=2.3500045,fl_alter_U=3.075"</span></code></pre>
<p><img src="ffv_opt_sobin_rev_concept_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
<pre><code><span class="co">## [1] 0.999995</span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://fanwangecon.github.io" class="external-link">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
