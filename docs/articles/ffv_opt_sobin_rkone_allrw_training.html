<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wage and Employment Comparison Binary Allocation Lalonde Training Example • Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Wage and Employment Comparison Binary Allocation Lalonde Training Example">
<meta property="og:description" content="Welfare, Resource Equivalent Variation (REV), comparisons between wage and employment allocation results.
Wage and Employment allocation space parameters comparison.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Papers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3839890" class="external-link">Optimal Allocations to Heterogeneous Agents with An Application to Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3691091" class="external-link">Optimal Allocation of the COVID-19 Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3547706" class="external-link">The Optimal Allocation of Resources among Heterogeneous Individuals</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/" class="external-link">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/" class="external-link">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/" class="external-link">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/" class="external-link">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/" class="external-link">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/" class="external-link">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/" class="external-link">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/" class="external-link">Python Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Wage and Employment Comparison Binary Allocation Lalonde Training Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/HEAD/vignettes/ffv_opt_sobin_rkone_allrw_training.Rmd" class="external-link"><code>vignettes/ffv_opt_sobin_rkone_allrw_training.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_sobin_rkone_allrw_training.Rmd</code></div>

    </div>

    
    
<p>Test binary allocation queue with Lalonde training dataset. There are 722 observations, 297 in the treatment group, 425 in the control group.</p>
<p>Already completed optimal ranking analysis and regressions for <a href="https://fanwangecon.github.io/PrjOptiAlloc/articles/ffv_opt_sobin_rkone_allfc_training_wage.html">wage</a> and <a href="https://fanwangecon.github.io/PrjOptiAlloc/articles/ffv_opt_sobin_rkone_allfc_training_logit.html">employment</a>. Here, I combine the results together and generate some joint graphs analyzing:</p>
<ol style="list-style-type: decimal">
<li>The relationship between expected probability of employment and wage (<span class="math inline">\(A_i\)</span>) without training, and the expected return to training for employment and wage (<span class="math inline">\(\alpha_i\)</span>).</li>
<li>For each individual, does their optimal allocation ranking change under the Rawlsian to Utilitarian planner? For wage vs employment based rankings</li>
<li>Who are those ranked in top 10 to receive? Along the spectrum</li>
<li>Resource Equivalent Variation along the spectrum</li>
</ol>
<div class="section level2">
<h2 id="load-dependencies">Load Dependencies<a class="anchor" aria-label="anchor" href="#load-dependencies"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>all.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.duplicate.label <span class="op">=</span> <span class="st">'allow'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org" class="external-link">forcats</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/REconTools/" class="external-link">REconTools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/PrjOptiAlloc/">PrjOptiAlloc</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span>

<span class="va">bl_save_img</span> <span class="op">=</span> <span class="cn">FALSE</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merge-the-wage-and-employmennt-rsults">Merge the Wage and Employmennt Rsults<a class="anchor" aria-label="anchor" href="#merge-the-wage-and-employmennt-rsults"></a>
</h2>
<p>Generate four categories by initial height and mother’s education levels combinations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spt_img_save</span> <span class="op">&lt;-</span> <span class="st">'../_img/'</span>
<span class="va">spt_img_save_draft</span> <span class="op">&lt;-</span> <span class="st">'C:/Users/fan/Documents/Dropbox (UH-ECON)/repos/HgtOptiAlloDraft/_img/'</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load Data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training_wage</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training_employ</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training_empage</span><span class="op">)</span>

<span class="co"># dfj, dataframe joint</span>
<span class="va">dfj</span> <span class="op">&lt;-</span> <span class="va">df_opt_lalonde_training_employ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training_wage</span>, by <span class="op">=</span> <span class="st">'id'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training_empage</span>, by <span class="op">=</span> <span class="st">'id'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>id<span class="op">=</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">re74</span>, <span class="va">re75</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = "id"</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># drop the .y variables, clean the .x out</span>
<span class="va">dfj</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">".y"</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">".x"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># %&gt;%</span>
<span class="co">#           rename_at(vars(ends_with(".x")), funs(str_replace(., ".x", "")))</span>

<span class="co"># order and organize variables</span>
<span class="va">dfj</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>,
                      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"A_"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"alpha_"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"beta_"</span><span class="op">)</span>,
                      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"rank"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,
                      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># treatment column to numeric</span>
<span class="va">dfj</span><span class="op">$</span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dfj</span><span class="op">$</span><span class="va">trt</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>

<span class="co"># Summarize</span>
<span class="co"># str(dfj)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dfj</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##        id           A_i_employ        A_i_wage       A_i_empage    </span>
<span class="co">##  Min.   :   1.0   Min.   :0.5186   Min.   :3.319   Min.   :0.6514  </span>
<span class="co">##  1st Qu.: 181.2   1st Qu.:0.6271   1st Qu.:4.466   1st Qu.:0.6604  </span>
<span class="co">##  Median : 361.5   Median :0.6994   Median :5.036   Median :0.7063  </span>
<span class="co">##  Mean   : 854.4   Mean   :0.7004   Mean   :5.160   Mean   :0.6965  </span>
<span class="co">##  3rd Qu.:1458.5   3rd Qu.:0.7432   3rd Qu.:5.735   3rd Qu.:0.7311  </span>
<span class="co">##  Max.   :4110.0   Max.   :0.9267   Max.   :8.980   Max.   :0.7987  </span>
<span class="co">##                                                                    </span>
<span class="co">##  alpha_i_employ     alpha_i_wage    alpha_i_empage    beta_i_employ     </span>
<span class="co">##  Min.   :0.01994   Min.   :0.3794   Min.   :0.04831   Min.   :0.001385  </span>
<span class="co">##  1st Qu.:0.06453   1st Qu.:0.3794   1st Qu.:0.07047   1st Qu.:0.001385  </span>
<span class="co">##  Median :0.07509   Median :0.3794   Median :0.08088   Median :0.001385  </span>
<span class="co">##  Mean   :0.06926   Mean   :0.4928   Mean   :0.07779   Mean   :0.001385  </span>
<span class="co">##  3rd Qu.:0.08062   3rd Qu.:0.3794   3rd Qu.:0.08571   3rd Qu.:0.001385  </span>
<span class="co">##  Max.   :0.09506   Max.   :1.0795   Max.   :0.09012   Max.   :0.001385  </span>
<span class="co">##                                                                         </span>
<span class="co">##   beta_i_wage       beta_i_empage      rank_min_employ rank_max_employ </span>
<span class="co">##  Min.   :0.001385   Min.   :0.001385   Min.   : 88     Min.   :  1.00  </span>
<span class="co">##  1st Qu.:0.001385   1st Qu.:0.001385   1st Qu.:262     1st Qu.: 99.25  </span>
<span class="co">##  Median :0.001385   Median :0.001385   Median :430     Median :273.00  </span>
<span class="co">##  Mean   :0.001385   Mean   :0.001385   Mean   :413     Mean   :307.39  </span>
<span class="co">##  3rd Qu.:0.001385   3rd Qu.:0.001385   3rd Qu.:554     3rd Qu.:493.00  </span>
<span class="co">##  Max.   :0.001385   Max.   :0.001385   Max.   :722     Max.   :722.00  </span>
<span class="co">##                                                                        </span>
<span class="co">##  avg_rank_employ  rank_min_wage   rank_max_wage    avg_rank_wage  </span>
<span class="co">##  Min.   : 37.63   Min.   : 75.0   Min.   :  1.00   Min.   : 21.1  </span>
<span class="co">##  1st Qu.:178.53   1st Qu.:277.0   1st Qu.: 90.25   1st Qu.:199.0  </span>
<span class="co">##  Median :356.60   Median :429.0   Median :260.00   Median :338.8  </span>
<span class="co">##  Mean   :360.21   Mean   :425.6   Mean   :294.81   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:528.20   3rd Qu.:575.0   3rd Qu.:473.00   3rd Qu.:519.4  </span>
<span class="co">##  Max.   :722.00   Max.   :722.0   Max.   :722.00   Max.   :722.0  </span>
<span class="co">##                                                                   </span>
<span class="co">##  rank_min_empage rank_max_empage avg_rank_empage rho_c1_rk_employ</span>
<span class="co">##  Min.   :343.0   Min.   :  1     Min.   :127.6   Min.   :  1.0   </span>
<span class="co">##  1st Qu.:429.0   1st Qu.: 84     1st Qu.:256.9   1st Qu.:177.5   </span>
<span class="co">##  Median :528.0   Median :179     Median :333.1   Median :354.0   </span>
<span class="co">##  Mean   :517.5   Mean   :163     Mean   :340.3   Mean   :360.2   </span>
<span class="co">##  3rd Qu.:591.0   3rd Qu.:245     3rd Qu.:430.4   3rd Qu.:540.0   </span>
<span class="co">##  Max.   :722.0   Max.   :722     Max.   :722.0   Max.   :722.0   </span>
<span class="co">##                                                                  </span>
<span class="co">##  rho_c2_rk_employ rho_c3_rk_employ rho_c4_rk_employ rho_c5_rk_employ</span>
<span class="co">##  Min.   :  1.0    Min.   :  1.0    Min.   :  1.0    Min.   :  1.0   </span>
<span class="co">##  1st Qu.:177.5    1st Qu.:177.0    1st Qu.:181.0    1st Qu.:181.2   </span>
<span class="co">##  Median :358.0    Median :358.0    Median :358.0    Median :359.0   </span>
<span class="co">##  Mean   :360.2    Mean   :360.2    Mean   :360.2    Mean   :360.2   </span>
<span class="co">##  3rd Qu.:540.0    3rd Qu.:540.0    3rd Qu.:540.0    3rd Qu.:540.0   </span>
<span class="co">##  Max.   :722.0    Max.   :722.0    Max.   :722.0    Max.   :722.0   </span>
<span class="co">##                                                                     </span>
<span class="co">##  rho_c6_rk_employ rho_c7_rk_employ rho_c8_rk_employ rho_c9_rk_employ</span>
<span class="co">##  Min.   :  1.0    Min.   :  1.0    Min.   :  1.0    Min.   :  1.0   </span>
<span class="co">##  1st Qu.:181.2    1st Qu.:181.2    1st Qu.:181.2    1st Qu.:178.0   </span>
<span class="co">##  Median :359.0    Median :359.0    Median :352.0    Median :360.0   </span>
<span class="co">##  Mean   :360.2    Mean   :360.2    Mean   :360.2    Mean   :360.2   </span>
<span class="co">##  3rd Qu.:540.0    3rd Qu.:541.2    3rd Qu.:541.2    3rd Qu.:541.2   </span>
<span class="co">##  Max.   :722.0    Max.   :722.0    Max.   :722.0    Max.   :722.0   </span>
<span class="co">##                                                                     </span>
<span class="co">##  rho_c10_rk_employ rho_c11_rk_employ rho_c12_rk_employ rho_c13_rk_employ</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:181.0     1st Qu.:178.0     1st Qu.:181.0     1st Qu.:181.2    </span>
<span class="co">##  Median :361.5     Median :357.0     Median :361.0     Median :361.5    </span>
<span class="co">##  Mean   :360.2     Mean   :360.2     Mean   :360.2     Mean   :360.2    </span>
<span class="co">##  3rd Qu.:540.0     3rd Qu.:541.0     3rd Qu.:541.8     3rd Qu.:541.8    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c14_rk_employ rho_c15_rk_employ rho_c16_rk_employ rho_c17_rk_employ</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:181.2     1st Qu.:181.2     1st Qu.:181.2     1st Qu.:181.0    </span>
<span class="co">##  Median :352.0     Median :354.0     Median :361.5     Median :360.0    </span>
<span class="co">##  Mean   :360.2     Mean   :360.2     Mean   :360.2     Mean   :360.2    </span>
<span class="co">##  3rd Qu.:541.8     3rd Qu.:541.8     3rd Qu.:541.8     3rd Qu.:541.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c18_rk_employ rho_c19_rk_employ rho_c20_rk_employ rho_c21_rk_employ</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:179.0     1st Qu.:180.0     1st Qu.:180.0     1st Qu.:181.0    </span>
<span class="co">##  Median :360.0     Median :359.0     Median :361.0     Median :358.0    </span>
<span class="co">##  Mean   :360.2     Mean   :360.2     Mean   :360.2     Mean   :360.2    </span>
<span class="co">##  3rd Qu.:541.0     3rd Qu.:541.8     3rd Qu.:541.0     3rd Qu.:541.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c22_rk_employ rho_c23_rk_employ rho_c24_rk_employ rho_c25_rk_employ</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:181.0     1st Qu.:181.0     1st Qu.:181.0     1st Qu.:181.0    </span>
<span class="co">##  Median :357.0     Median :360.0     Median :361.5     Median :361.5    </span>
<span class="co">##  Mean   :360.2     Mean   :360.2     Mean   :360.2     Mean   :360.2    </span>
<span class="co">##  3rd Qu.:541.2     3rd Qu.:541.2     3rd Qu.:534.0     3rd Qu.:535.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c26_rk_employ rho_c27_rk_employ rho_c28_rk_employ rho_c29_rk_employ</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:180.5     1st Qu.:180.5     1st Qu.:180.5     1st Qu.:180.5    </span>
<span class="co">##  Median :361.5     Median :361.5     Median :361.5     Median :361.5    </span>
<span class="co">##  Mean   :360.2     Mean   :360.2     Mean   :360.2     Mean   :360.2    </span>
<span class="co">##  3rd Qu.:535.0     3rd Qu.:536.0     3rd Qu.:536.0     3rd Qu.:536.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c30_rk_employ rho_c1_rk_wage  rho_c2_rk_wage  rho_c3_rk_wage </span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  </span>
<span class="co">##  1st Qu.:180.5     1st Qu.:181.2   1st Qu.:181.2   1st Qu.:181.2  </span>
<span class="co">##  Median :361.5     Median :361.0   Median :361.0   Median :361.0  </span>
<span class="co">##  Mean   :360.2     Mean   :360.2   Mean   :360.2   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:536.0     3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0  </span>
<span class="co">##  Max.   :722.0     Max.   :722.0   Max.   :722.0   Max.   :722.0  </span>
<span class="co">##                                                                   </span>
<span class="co">##  rho_c4_rk_wage  rho_c5_rk_wage  rho_c6_rk_wage  rho_c7_rk_wage </span>
<span class="co">##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  </span>
<span class="co">##  1st Qu.:181.2   1st Qu.:181.2   1st Qu.:181.2   1st Qu.:181.2  </span>
<span class="co">##  Median :361.0   Median :361.0   Median :361.0   Median :361.0  </span>
<span class="co">##  Mean   :360.2   Mean   :360.2   Mean   :360.2   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0  </span>
<span class="co">##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  </span>
<span class="co">##                                                                 </span>
<span class="co">##  rho_c8_rk_wage  rho_c9_rk_wage  rho_c10_rk_wage rho_c11_rk_wage</span>
<span class="co">##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  </span>
<span class="co">##  1st Qu.:181.2   1st Qu.:181.2   1st Qu.:181.2   1st Qu.:181.2  </span>
<span class="co">##  Median :361.0   Median :361.0   Median :361.0   Median :361.0  </span>
<span class="co">##  Mean   :360.2   Mean   :360.2   Mean   :360.2   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0  </span>
<span class="co">##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  </span>
<span class="co">##                                                                 </span>
<span class="co">##  rho_c12_rk_wage rho_c13_rk_wage rho_c14_rk_wage rho_c15_rk_wage</span>
<span class="co">##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  </span>
<span class="co">##  1st Qu.:181.2   1st Qu.:181.2   1st Qu.:181.2   1st Qu.:181.2  </span>
<span class="co">##  Median :361.0   Median :361.0   Median :361.0   Median :361.0  </span>
<span class="co">##  Mean   :360.2   Mean   :360.2   Mean   :360.2   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0  </span>
<span class="co">##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  </span>
<span class="co">##                                                                 </span>
<span class="co">##  rho_c16_rk_wage rho_c17_rk_wage rho_c18_rk_wage rho_c19_rk_wage</span>
<span class="co">##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  </span>
<span class="co">##  1st Qu.:181.2   1st Qu.:180.5   1st Qu.:178.2   1st Qu.:181.0  </span>
<span class="co">##  Median :361.0   Median :361.0   Median :361.0   Median :361.5  </span>
<span class="co">##  Mean   :360.2   Mean   :360.2   Mean   :360.2   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:538.0   3rd Qu.:541.8  </span>
<span class="co">##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  </span>
<span class="co">##                                                                 </span>
<span class="co">##  rho_c20_rk_wage rho_c21_rk_wage rho_c22_rk_wage rho_c23_rk_wage</span>
<span class="co">##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  </span>
<span class="co">##  1st Qu.:179.0   1st Qu.:181.0   1st Qu.:179.8   1st Qu.:181.2  </span>
<span class="co">##  Median :361.5   Median :361.5   Median :361.5   Median :360.0  </span>
<span class="co">##  Mean   :360.2   Mean   :360.2   Mean   :360.2   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:541.8   3rd Qu.:541.8   3rd Qu.:541.0   3rd Qu.:541.0  </span>
<span class="co">##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  </span>
<span class="co">##                                                                 </span>
<span class="co">##  rho_c24_rk_wage rho_c25_rk_wage rho_c26_rk_wage rho_c27_rk_wage</span>
<span class="co">##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  </span>
<span class="co">##  1st Qu.:180.0   1st Qu.:178.0   1st Qu.:178.2   1st Qu.:178.2  </span>
<span class="co">##  Median :361.5   Median :361.0   Median :361.0   Median :361.0  </span>
<span class="co">##  Mean   :360.2   Mean   :360.2   Mean   :360.2   Mean   :360.2  </span>
<span class="co">##  3rd Qu.:541.0   3rd Qu.:541.5   3rd Qu.:541.5   3rd Qu.:541.8  </span>
<span class="co">##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  </span>
<span class="co">##                                                                 </span>
<span class="co">##  rho_c28_rk_wage rho_c29_rk_wage rho_c30_rk_wage rho_c1_rk_empage</span>
<span class="co">##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   </span>
<span class="co">##  1st Qu.:178.2   1st Qu.:178.2   1st Qu.:178.2   1st Qu.:138.5   </span>
<span class="co">##  Median :361.0   Median :361.0   Median :361.0   Median :320.0   </span>
<span class="co">##  Mean   :360.2   Mean   :360.2   Mean   :360.2   Mean   :340.3   </span>
<span class="co">##  3rd Qu.:541.8   3rd Qu.:541.8   3rd Qu.:541.8   3rd Qu.:503.0   </span>
<span class="co">##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0   </span>
<span class="co">##                                                                  </span>
<span class="co">##  rho_c2_rk_empage rho_c3_rk_empage rho_c4_rk_empage rho_c5_rk_empage</span>
<span class="co">##  Min.   :  1.0    Min.   :  1.0    Min.   :  1.0    Min.   :  1.0   </span>
<span class="co">##  1st Qu.:138.5    1st Qu.:138.5    1st Qu.:138.5    1st Qu.:138.5   </span>
<span class="co">##  Median :320.0    Median :320.0    Median :320.0    Median :320.0   </span>
<span class="co">##  Mean   :340.3    Mean   :340.3    Mean   :340.3    Mean   :340.3   </span>
<span class="co">##  3rd Qu.:503.0    3rd Qu.:503.0    3rd Qu.:503.0    3rd Qu.:503.0   </span>
<span class="co">##  Max.   :722.0    Max.   :722.0    Max.   :722.0    Max.   :722.0   </span>
<span class="co">##                                                                     </span>
<span class="co">##  rho_c6_rk_empage rho_c7_rk_empage rho_c8_rk_empage rho_c9_rk_empage</span>
<span class="co">##  Min.   :  1.0    Min.   :  1.0    Min.   :  1.0    Min.   :  1.0   </span>
<span class="co">##  1st Qu.:138.5    1st Qu.:138.5    1st Qu.:138.5    1st Qu.:138.5   </span>
<span class="co">##  Median :320.0    Median :320.0    Median :320.0    Median :320.0   </span>
<span class="co">##  Mean   :340.3    Mean   :340.3    Mean   :340.3    Mean   :340.3   </span>
<span class="co">##  3rd Qu.:503.0    3rd Qu.:503.0    3rd Qu.:503.0    3rd Qu.:503.0   </span>
<span class="co">##  Max.   :722.0    Max.   :722.0    Max.   :722.0    Max.   :722.0   </span>
<span class="co">##                                                                     </span>
<span class="co">##  rho_c10_rk_empage rho_c11_rk_empage rho_c12_rk_empage rho_c13_rk_empage</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:138.5     1st Qu.:138.5     1st Qu.:138.5     1st Qu.:138.5    </span>
<span class="co">##  Median :320.0     Median :320.0     Median :320.0     Median :320.0    </span>
<span class="co">##  Mean   :340.3     Mean   :340.3     Mean   :340.3     Mean   :340.3    </span>
<span class="co">##  3rd Qu.:503.0     3rd Qu.:503.0     3rd Qu.:503.0     3rd Qu.:503.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c14_rk_empage rho_c15_rk_empage rho_c16_rk_empage rho_c17_rk_empage</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:138.5     1st Qu.:138.5     1st Qu.:138.5     1st Qu.:138.5    </span>
<span class="co">##  Median :320.0     Median :320.0     Median :359.0     Median :313.0    </span>
<span class="co">##  Mean   :340.3     Mean   :340.3     Mean   :340.3     Mean   :340.3    </span>
<span class="co">##  3rd Qu.:503.0     3rd Qu.:503.0     3rd Qu.:501.0     3rd Qu.:468.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c18_rk_empage rho_c19_rk_empage rho_c20_rk_empage rho_c21_rk_empage</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:177.0     1st Qu.:173.0     1st Qu.:179.8     1st Qu.:179.8    </span>
<span class="co">##  Median :340.0     Median :307.0     Median :326.0     Median :329.0    </span>
<span class="co">##  Mean   :340.3     Mean   :340.3     Mean   :340.3     Mean   :340.3    </span>
<span class="co">##  3rd Qu.:529.0     3rd Qu.:515.0     3rd Qu.:517.0     3rd Qu.:524.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c22_rk_empage rho_c23_rk_empage rho_c24_rk_empage rho_c25_rk_empage</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:179.8     1st Qu.:179.8     1st Qu.:179.8     1st Qu.:179.8    </span>
<span class="co">##  Median :334.0     Median :336.0     Median :340.0     Median :340.0    </span>
<span class="co">##  Mean   :340.3     Mean   :340.3     Mean   :340.3     Mean   :340.3    </span>
<span class="co">##  3rd Qu.:527.0     3rd Qu.:527.0     3rd Qu.:527.0     3rd Qu.:527.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c26_rk_empage rho_c27_rk_empage rho_c28_rk_empage rho_c29_rk_empage</span>
<span class="co">##  Min.   :  1.0     Min.   :  1.0     Min.   :  1.0     Min.   :  1.0    </span>
<span class="co">##  1st Qu.:179.8     1st Qu.:179.8     1st Qu.:179.8     1st Qu.:179.8    </span>
<span class="co">##  Median :343.0     Median :343.0     Median :343.0     Median :343.0    </span>
<span class="co">##  Mean   :340.3     Mean   :340.3     Mean   :340.3     Mean   :340.3    </span>
<span class="co">##  3rd Qu.:527.0     3rd Qu.:528.0     3rd Qu.:528.0     3rd Qu.:528.0    </span>
<span class="co">##  Max.   :722.0     Max.   :722.0     Max.   :722.0     Max.   :722.0    </span>
<span class="co">##                                                                         </span>
<span class="co">##  rho_c30_rk_empage      trt              age             educ      </span>
<span class="co">##  Min.   :  1.0     Min.   :0.0000   Min.   :17.00   Min.   : 3.00  </span>
<span class="co">##  1st Qu.:179.8     1st Qu.:0.0000   1st Qu.:19.00   1st Qu.: 9.00  </span>
<span class="co">##  Median :343.0     Median :0.0000   Median :23.00   Median :10.00  </span>
<span class="co">##  Mean   :340.3     Mean   :0.4114   Mean   :24.52   Mean   :10.27  </span>
<span class="co">##  3rd Qu.:528.0     3rd Qu.:1.0000   3rd Qu.:27.00   3rd Qu.:11.00  </span>
<span class="co">##  Max.   :722.0     Max.   :1.0000   Max.   :55.00   Max.   :16.00  </span>
<span class="co">##                                                                    </span>
<span class="co">##       marr           nodeg             re78            race      </span>
<span class="co">##  Min.   :0.000   Min.   :0.0000   Min.   :    0   Min.   :0.000  </span>
<span class="co">##  1st Qu.:0.000   1st Qu.:1.0000   1st Qu.:    0   1st Qu.:1.000  </span>
<span class="co">##  Median :0.000   Median :1.0000   Median : 3952   Median :1.000  </span>
<span class="co">##  Mean   :0.162   Mean   :0.7798   Mean   : 5455   Mean   :1.011  </span>
<span class="co">##  3rd Qu.:0.000   3rd Qu.:1.0000   3rd Qu.: 8772   3rd Qu.:1.000  </span>
<span class="co">##  Max.   :1.000   Max.   :1.0000   Max.   :60308   Max.   :2.000  </span>
<span class="co">##                                                                  </span>
<span class="co">##       re74              re75        </span>
<span class="co">##  Min.   :    0.0   Min.   :    0.0  </span>
<span class="co">##  1st Qu.:    0.0   1st Qu.:    0.0  </span>
<span class="co">##  Median :    0.0   Median :  936.3  </span>
<span class="co">##  Mean   : 2102.3   Mean   : 3042.9  </span>
<span class="co">##  3rd Qu.:  824.4   3rd Qu.: 3993.2  </span>
<span class="co">##  Max.   :39570.7   Max.   :37431.7  </span>
<span class="co">##  NA's   :277</span></code></pre>
</div>
<div class="section level2">
<h2 id="compute-rev">Compute REV<a class="anchor" aria-label="anchor" href="#compute-rev"></a>
</h2>
<div class="section level3">
<h3 id="alternative-allocations">Alternative Allocations<a class="anchor" aria-label="anchor" href="#alternative-allocations"></a>
</h3>
<p>The observed random allocation, number of spots available.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ar_bin_observed</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span>
<span class="va">it_total_spots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ar_bin_observed</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">it_total_spots</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 297</span></code></pre>
<p>There are 297 training spots.</p>
<p>A simple allocation rule is to just give training spots to those who had the lowest levels of wage in the initial year. This kind of simple initial condition based allocation rule is often used in practice.</p>
<p>There happen to be 289 individuals with zero wages in 1975. So the Naive allocation could provision to these individuals plus 8 additional individuals with the lowest non-zero wages in 1975.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1975 mean wage</span>
<span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarize_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">'re'</span><span class="op">)</span><span class="op">)</span>,
               .funs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 2 x 4</span></span>
<span class="co">##     trt re78_mean re74_mean re75_mean</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span>     0     <span style="text-decoration: underline;">5</span>090.        <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">3</span>027.</span>
<span class="co">## <span style="color: #BCBCBC;">2</span>     1     <span style="text-decoration: underline;">5</span>976.        <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">3</span>066.</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 1974 Wage the number of zeros:</span>
<span class="va">re75_n297</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">re75</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">it_total_spots</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">re75</span><span class="op">)</span>
<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">re75_n297</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: `funs()` was deprecated in dplyr 0.8.0.</span>
<span class="co">## Please use a list of either functions or lambdas: </span>
<span class="co">## </span>
<span class="co">##   # Simple named list: </span>
<span class="co">##   list(mean = mean, median = median)</span>
<span class="co">## </span>
<span class="co">##   # Auto named with `tibble::lst()`: </span>
<span class="co">##   tibble::lst(mean, median)</span>
<span class="co">## </span>
<span class="co">##   # Using lambdas</span>
<span class="co">##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## Warning: `as.tibble()` was deprecated in tibble 2.0.0.</span>
<span class="co">## Please use `as_tibble()` instead.</span>
<span class="co">## The signature and semantics have changed, see `?as_tibble`.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.</span>
<span class="co">## Using compatibility `.name_repair`.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 18 x 3</span></span>
<span class="co">##    stats   id           re75        </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> n       <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> unique  <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>  8<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> NAobs   <span style="color: #949494;">"</span>0<span style="color: #949494;">"</span>          <span style="color: #949494;">"</span>0<span style="color: #949494;">"</span>         </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ZEROobs <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>289<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> mean    <span style="color: #949494;">"</span>593.329966<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  3.839997<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> sd      <span style="color: #949494;">"</span>833.38918<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 23.99207<span style="color: #949494;">"</span> </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> cv      <span style="color: #949494;">"</span>1.404596<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>6.247941<span style="color: #949494;">"</span>  </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> min     <span style="color: #949494;">"</span>1<span style="color: #949494;">"</span>          <span style="color: #949494;">"</span>0<span style="color: #949494;">"</span>         </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> p01     <span style="color: #949494;">"</span>4.92<span style="color: #949494;">"</span>       <span style="color: #949494;">"</span>0.00<span style="color: #949494;">"</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> p05     <span style="color: #949494;">"</span>26.4<span style="color: #949494;">"</span>       <span style="color: #949494;">"</span> 0.0<span style="color: #949494;">"</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> p10     <span style="color: #949494;">"</span>46.8<span style="color: #949494;">"</span>       <span style="color: #949494;">"</span> 0.0<span style="color: #949494;">"</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> p25     <span style="color: #949494;">"</span>110<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;">13</span> p50     <span style="color: #949494;">"</span>228<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;">14</span> p75     <span style="color: #949494;">"</span>781<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;">15</span> p90     <span style="color: #949494;">"</span>1430.4<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>   0.0<span style="color: #949494;">"</span>    </span>
<span class="co">## <span style="color: #BCBCBC;">16</span> p95     <span style="color: #949494;">"</span>2730<span style="color: #949494;">"</span>       <span style="color: #949494;">"</span>   0<span style="color: #949494;">"</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">17</span> p99     <span style="color: #949494;">"</span>3814.0000<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 160.0976<span style="color: #949494;">"</span> </span>
<span class="co">## <span style="color: #BCBCBC;">18</span> max     <span style="color: #949494;">"</span>4110.0000<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 192.7995<span style="color: #949494;">"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The 297 lowest wages in 1975</span>
<span class="va">dfj</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">re75</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>re75_zero <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">re75</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">re75</span> <span class="op">!=</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>re75_rank <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>alloc_naive <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">re75_rank</span> <span class="op">&lt;=</span> <span class="va">it_total_spots</span> <span class="op">~</span> <span class="fl">1</span>,
                                 <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">re75_zero</span>, <span class="va">re75_rank</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 18 x 3</span></span>
<span class="co">##    stats   re75.rank     re75.zero    </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> n       <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span>         <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span>        </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> unique  <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span>         <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span>        </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> NAobs   <span style="color: #949494;">"</span>0<span style="color: #949494;">"</span>           <span style="color: #949494;">"</span>0<span style="color: #949494;">"</span>          </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ZEROobs <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>         <span style="color: #949494;">"</span>433<span style="color: #949494;">"</span>        </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> mean    <span style="color: #949494;">"</span>361.500000<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span>  0.400277<span style="color: #949494;">"</span> </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> sd      <span style="color: #949494;">"</span>208.5677348<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0.4902941<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> cv      <span style="color: #949494;">"</span>0.5769509<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>1.2248869<span style="color: #949494;">"</span>  </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> min     <span style="color: #949494;">"</span>1<span style="color: #949494;">"</span>           <span style="color: #949494;">"</span>0<span style="color: #949494;">"</span>          </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> p01     <span style="color: #949494;">"</span>8.21<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span>0.00<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> p05     <span style="color: #949494;">"</span>37.05<span style="color: #949494;">"</span>       <span style="color: #949494;">"</span> 0.00<span style="color: #949494;">"</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> p10     <span style="color: #949494;">"</span>73.1<span style="color: #949494;">"</span>        <span style="color: #949494;">"</span> 0.0<span style="color: #949494;">"</span>       </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> p25     <span style="color: #949494;">"</span>181.25<span style="color: #949494;">"</span>      <span style="color: #949494;">"</span>  0.00<span style="color: #949494;">"</span>     </span>
<span class="co">## <span style="color: #BCBCBC;">13</span> p50     <span style="color: #949494;">"</span>361.5<span style="color: #949494;">"</span>       <span style="color: #949494;">"</span>  0.0<span style="color: #949494;">"</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">14</span> p75     <span style="color: #949494;">"</span>541.75<span style="color: #949494;">"</span>      <span style="color: #949494;">"</span>  1.00<span style="color: #949494;">"</span>     </span>
<span class="co">## <span style="color: #BCBCBC;">15</span> p90     <span style="color: #949494;">"</span>649.9<span style="color: #949494;">"</span>       <span style="color: #949494;">"</span>  1.0<span style="color: #949494;">"</span>      </span>
<span class="co">## <span style="color: #BCBCBC;">16</span> p95     <span style="color: #949494;">"</span>685.95<span style="color: #949494;">"</span>      <span style="color: #949494;">"</span>  1.00<span style="color: #949494;">"</span>     </span>
<span class="co">## <span style="color: #BCBCBC;">17</span> p99     <span style="color: #949494;">"</span>714.79<span style="color: #949494;">"</span>      <span style="color: #949494;">"</span>  1.00<span style="color: #949494;">"</span>     </span>
<span class="co">## <span style="color: #BCBCBC;">18</span> max     <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span>         <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="compute-rev-1">Compute REV<a class="anchor" aria-label="anchor" href="#compute-rev-1"></a>
</h3>
<p>Compute Resource Equivalent Variations. Assume here that i use here the same ar_rho vector as used in <a href="C:%5CUsers%5Cfan%5CPrjOptiAlloc%5Cvignettes%5Cffv_opt_sobin_rkone_allfc_training_logit.Rmd">emloyment</a> and <a href="C:%5CUsers%5Cfan%5CPrjOptiAlloc%5Cvignettes%5Cffv_opt_sobin_rkone_allrw_training_wage.Rmd">wage</a> regressions.</p>
<p>Note that for each rho, the optimal ranking is different, and there are different optimal rankings for wage and employment outcomes.</p>
<p>Prepare for Various Inputs.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plann Preference Array</span>
<span class="va">ar_rho</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">0.001</span>,  <span class="fl">0.95</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>, length.out<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span>

<span class="co"># Sort all Individuals</span>
<span class="va">dfj</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>

<span class="co"># Alternative Allocationc</span>
<span class="va">ar_bin_observed</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span>
<span class="va">ar_bin_alloc_naive</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">alloc_naive</span><span class="op">)</span>

<span class="co"># A and alpha Parameter</span>
<span class="va">ar_A_wage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">A_i_wage</span><span class="op">)</span>
<span class="va">ar_A_employ</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">A_i_employ</span><span class="op">)</span>
<span class="va">ar_A_empage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">A_i_empage</span><span class="op">)</span>

<span class="va">ar_alpha_wage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">alpha_i_wage</span><span class="op">)</span>
<span class="va">ar_alpha_employ</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">alpha_i_employ</span><span class="op">)</span>
<span class="va">ar_alpha_empage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">alpha_i_empage</span><span class="op">)</span>

<span class="co"># Relative Preference Weights</span>
<span class="va">ar_beta_wage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">beta_i_wage</span><span class="op">)</span>
<span class="va">ar_beta_employ</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">beta_i_employ</span><span class="op">)</span>
<span class="va">ar_beta_empage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">beta_i_empage</span><span class="op">)</span></code></pre></div>
<p>Solve for Resource Equivalent Variations:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># REV Results Storage</span>
<span class="va">ar_rev_wage_v_rand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_rev_employ_v_rand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_rev_empage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_rev_employ_v_re75rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Loop Over</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">it_rho_ctr</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>

  <span class="va">fl_rho</span> <span class="op">&lt;-</span> <span class="va">ar_rho</span><span class="op">[</span><span class="va">it_rho_ctr</span><span class="op">]</span>

  <span class="va">svr_rho_employ</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'rho_c'</span>, <span class="va">it_rho_ctr</span>, <span class="st">'_rk_employ'</span><span class="op">)</span>
  <span class="va">svr_rho_wage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'rho_c'</span>, <span class="va">it_rho_ctr</span>, <span class="st">'_rk_wage'</span><span class="op">)</span>
  <span class="va">svr_rho_empage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'rho_c'</span>, <span class="va">it_rho_ctr</span>, <span class="st">'_rk_empage'</span><span class="op">)</span>

  <span class="va">ar_queue_optimal_wage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">svr_rho_wage</span><span class="op">)</span>
  <span class="va">ar_queue_optimal_employ</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">svr_rho_employ</span><span class="op">)</span>
  <span class="va">ar_queue_optimal_empage</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">svr_rho_empage</span><span class="op">)</span>

  <span class="co"># 1. REV of Optimal All X Wage Regression relative to random observed</span>
  <span class="va">ar_rev_wage_v_rand</span><span class="op">[</span><span class="va">it_rho_ctr</span><span class="op">]</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/ffp_opt_sobin_rev.html">ffp_opt_sobin_rev</a></span><span class="op">(</span><span class="va">ar_queue_optimal_wage</span>, <span class="va">ar_bin_observed</span>,
                      <span class="va">ar_A_wage</span>, <span class="va">ar_alpha_wage</span>, <span class="va">ar_beta_wage</span>,
                      <span class="va">fl_rho</span><span class="op">)</span>

  <span class="co"># 2. REV of Optimal Age X only Employment Regression relative to random observed</span>
  <span class="va">ar_rev_empage</span><span class="op">[</span><span class="va">it_rho_ctr</span><span class="op">]</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/ffp_opt_sobin_rev.html">ffp_opt_sobin_rev</a></span><span class="op">(</span><span class="va">ar_queue_optimal_empage</span>, <span class="va">ar_bin_observed</span>,
                      <span class="va">ar_A_empage</span>, <span class="va">ar_alpha_empage</span>, <span class="va">ar_beta_empage</span>,
                      <span class="va">fl_rho</span><span class="op">)</span>

  <span class="co"># 3. REV of Optimal All X Employment Regression relative to random observed</span>
  <span class="va">ar_rev_employ_v_rand</span><span class="op">[</span><span class="va">it_rho_ctr</span><span class="op">]</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/ffp_opt_sobin_rev.html">ffp_opt_sobin_rev</a></span><span class="op">(</span><span class="va">ar_queue_optimal_employ</span>, <span class="va">ar_bin_observed</span>,
                      <span class="va">ar_A_employ</span>, <span class="va">ar_alpha_employ</span>, <span class="va">ar_beta_employ</span>,
                      <span class="va">fl_rho</span><span class="op">)</span>

  <span class="co"># 4. REV of Optimal All X Employment Regression relative to NAIVE ALLOCATION by Initial</span>
  <span class="va">ar_rev_employ_v_re75rank</span><span class="op">[</span><span class="va">it_rho_ctr</span><span class="op">]</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="../reference/ffp_opt_sobin_rev.html">ffp_opt_sobin_rev</a></span><span class="op">(</span><span class="va">ar_queue_optimal_employ</span>, <span class="va">ar_bin_alloc_naive</span>,
                      <span class="va">ar_A_employ</span>, <span class="va">ar_alpha_employ</span>, <span class="va">ar_beta_employ</span>,
                      <span class="va">fl_rho</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Print results</span>
<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_sup_lst2str.html" class="external-link">ff_sup_lst2str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ar_rev_wage_v_rand</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "round(ar_rev_wage_v_rand, 2):=0.42;=0.42;=0.42;=0.42;=0.42;=0.42;=0.42;=0.42;=0.41;=0.41;=0.41;=0.41;=0.41;=0.4;=0.4;=0.4;=0.41;=0.45;=0.49;=0.6;=0.72;=0.82;=0.9;=0.95;=0.97;=0.98;=0.99;=1;=1;=1"</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_sup_lst2str.html" class="external-link">ff_sup_lst2str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ar_rev_employ_v_rand</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "round(ar_rev_employ_v_rand, 2):=0.19;=0.19;=0.19;=0.19;=0.19;=0.2;=0.19;=0.2;=0.2;=0.22;=0.21;=0.22;=0.23;=0.25;=0.26;=0.29;=0.33;=0.38;=0.45;=0.55;=0.67;=0.78;=0.85;=0.9;=0.93;=0.95;=0.97;=0.98;=0.99;=1"</span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_sup_lst2str.html" class="external-link">ff_sup_lst2str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ar_rev_empage</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "round(ar_rev_empage, 2):=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.18;=0.15;=0.07;=0.14;=0.11;=0.25;=0.25;=0.39;=0.39;=0.56;=0.56;=0.68;=0.71;=0.79;=0.79;=0.82"</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_sup_lst2str.html" class="external-link">ff_sup_lst2str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ar_rev_employ_v_re75rank</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "round(ar_rev_employ_v_re75rank, 2):=0.08;=0.08;=0.07;=0.07;=0.07;=0.07;=0.08;=0.08;=0.08;=0.08;=0.08;=0.09;=0.09;=0.09;=0.09;=0.11;=0.13;=0.13;=0.16;=0.19;=0.22;=0.25;=0.29;=0.33;=0.36;=0.41;=0.45;=0.49;=0.5;=0.52"</span></code></pre>
<p>Combine REV results to one dataframe:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># combine results</span>
<span class="va">mt_combine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ar_rho</span>,
                    <span class="va">ar_rev_wage_v_rand</span><span class="op">*</span><span class="fl">100</span>,
                    <span class="va">ar_rev_employ_v_rand</span><span class="op">*</span><span class="fl">100</span>,
                    <span class="va">ar_rev_empage</span><span class="op">*</span><span class="fl">100</span>,
                    <span class="va">ar_rev_employ_v_re75rank</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mt_combine</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'rho'</span>,
                          <span class="st">'rev_expected_wage'</span>,
                          <span class="st">'rev_employment_prob'</span>,
                          <span class="st">'rev_employage_prob'</span>,
                          <span class="st">'rev_employ_v_re75rank'</span><span class="op">)</span>
<span class="va">tb_rev_wage_employ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">mt_combine</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rowid_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"eval"</span><span class="op">)</span>
<span class="co"># Transform x-scale to 1-rho</span>
<span class="va">tb_rev_wage_employ</span> <span class="op">&lt;-</span> <span class="va">tb_rev_wage_employ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>one_minus_rho <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">)</span>

<span class="co"># Reshape to long</span>
<span class="va">tb_rev_wage_employ_long</span> <span class="op">&lt;-</span> <span class="va">tb_rev_wage_employ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'rev'</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Outcome'</span><span class="op">)</span>,
    names_pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'rev'</span>, <span class="st">"_(.*)"</span><span class="op">)</span>,
    values_to <span class="op">=</span> <span class="st">'rev'</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tb_rev_wage_employ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rand_v_init <span class="op">=</span> <span class="va">rev_employment_prob</span><span class="op">/</span><span class="va">rev_employ_v_re75rank</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 30 x 8</span></span>
<span class="co">##     eval   rho rev_expected_wage rev_employment_prob rev_employage_prob</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span>     1  0.99              41.8                18.9               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span>     2  0.99              41.8                18.9               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span>     3  0.98              41.8                18.9               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span>     4  0.97              41.8                18.9               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span>     5  0.96              41.8                18.9               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span>     6  0.95              41.8                20.2               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span>     7  0.93              41.8                19.2               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span>     8  0.91              41.8                20.2               17.5</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span>     9  0.87              41.1                19.5               17.5</span>
<span class="co">## <span style="color: #BCBCBC;">10</span>    10  0.83              41.1                21.9               17.5</span>
<span class="co">## <span style="color: #949494;"># ... with 20 more rows, and 3 more variables: rev_employ_v_re75rank &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   one_minus_rho &lt;dbl&gt;, rand_v_init &lt;dbl&gt;</span></span></code></pre>
<p>Draw the REV graph. Following this <a href="https://fanwangecon.github.io/Stat4Econ/probability/samplespacedice.html" class="external-link">graph code</a>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># x-labels</span>
<span class="va">x.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'λ=0.99'</span>, <span class="st">'λ=0.90'</span>, <span class="st">'λ=0'</span>, <span class="st">'λ=-10'</span>, <span class="st">'λ=-100'</span><span class="op">)</span>
<span class="va">x.breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.10</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>

<span class="co"># title line 2</span>
<span class="co"># title_line1 &lt;- sprintf("Percentage of Training Spots Misallocated, NSW Lalonde (AER, 1986)")</span>
<span class="co"># title_line2 &lt;- sprintf("REV (Resource Equivalent Variation) Along Planner Spectrum")</span>

<span class="va">st_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'How much Fewer Resources are Needed (Shares) to Achieve the Same Welfare'</span><span class="op">)</span><span class="op">)</span>
<span class="va">title_line1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Compare alternative allocations to optimal allocations given observables and estimates"</span><span class="op">)</span>
<span class="va">title_line2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Solid Red Line: train 297 random NSW treatment individuals vs. optimally allocating 297 spots"</span><span class="op">)</span>
<span class="va">title_line3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Dashed Blue Line: train 297 lowest baseline wage individuals vs. optimally allocating 297 spots"</span><span class="op">)</span>

<span class="co"># Relabel Variable</span>
<span class="va">Outcome_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"random (RCT)"</span> <span class="op">=</span> <span class="st">"employment_prob"</span>, <span class="st">"baseline wage"</span> <span class="op">=</span> <span class="st">"employ_v_re75rank"</span><span class="op">)</span>
<span class="va">tb_rev_wage_employ_long_fig</span> <span class="op">&lt;-</span> <span class="va">tb_rev_wage_employ_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Outcome</span> <span class="op">==</span> <span class="st">'employment_prob'</span> <span class="op">|</span> <span class="va">Outcome</span> <span class="op">==</span> <span class="st">'employ_v_re75rank'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Outcome <span class="op">=</span> <span class="fu"><a href="https://haven.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">Outcome</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Outcome <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">Outcome</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">Outcome_levels</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Graph Results--Draw</span>
<span class="va">line.plot</span> <span class="op">&lt;-</span> <span class="va">tb_rev_wage_employ_long_fig</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">one_minus_rho</span>, y<span class="op">=</span><span class="va">rev</span>,
             group<span class="op">=</span><span class="va">Outcome</span>,
             colour<span class="op">=</span><span class="va">Outcome</span>,
             linetype<span class="op">=</span><span class="va">Outcome</span>,
             shape<span class="op">=</span><span class="va">Outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># geom_vline(xintercept=c(1), linetype="dotted") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">st_title</span>,
       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">title_line1</span>, <span class="st">'\n'</span>, <span class="va">title_line2</span>, <span class="st">'\n'</span>, <span class="va">title_line3</span><span class="op">)</span>,
       x <span class="op">=</span> <span class="st">'log10 Rescale of λ, Log10(1-λ)\nλ=1 Utilitarian (Maximize Average), λ=-infty Rawlsian (Maximize Minimum)'</span>,
       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'100 x REV (Resource Equivalent Variations)'</span><span class="op">)</span>,
       caption <span class="op">=</span> <span class="st">'Based on a logistic regression of the employment effects of a training RCT. Data: Lalonde (AER, 1986).'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>trans<span class="op">=</span><span class="st">'log10'</span>, labels <span class="op">=</span> <span class="va">x.labels</span>, breaks <span class="op">=</span> <span class="va">x.breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>
<span class="co"># +</span>
<span class="co">#   guides(colour=FALSE)</span>


<span class="co"># Labeling</span>
<span class="va">line.plot</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">linetype</span> <span class="op">&lt;-</span> <span class="st">"REV\nOptimal\nvs.\nAlternatives"</span>
<span class="va">line.plot</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">colour</span> <span class="op">&lt;-</span> <span class="st">"REV\nOptimal\nvs.\nAlternatives"</span>
<span class="va">line.plot</span><span class="op">$</span><span class="va">labels</span><span class="op">$</span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="st">"REV\nOptimal\nvs.\nAlternatives"</span>

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">line.plot</span><span class="op">)</span></code></pre></div>
<p><img src="ffv_opt_sobin_rkone_allrw_training_files/figure-html/graph%20REV-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">bl_save_img</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">snm_cnts</span> <span class="op">&lt;-</span> <span class="st">'Lalonde_employ_rev.png'</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">spt_img_save</span>, <span class="va">snm_cnts</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">135</span>, height <span class="op">=</span> <span class="fl">96</span>, units<span class="op">=</span><span class="st">'mm'</span>, res <span class="op">=</span> <span class="fl">300</span>, pointsize<span class="op">=</span><span class="fl">7</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">line.plot</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">spt_img_save_draft</span>, <span class="va">snm_cnts</span><span class="op">)</span>,
      width <span class="op">=</span> <span class="fl">135</span>, height <span class="op">=</span> <span class="fl">96</span>, units<span class="op">=</span><span class="st">'mm'</span>, res <span class="op">=</span> <span class="fl">300</span>,
      pointsize<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">line.plot</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analysis-of-a-and-alpha">Analysis of A and alpha<a class="anchor" aria-label="anchor" href="#analysis-of-a-and-alpha"></a>
</h2>
<p>Generate some tables where the distributions of <span class="math inline">\(A\)</span> and <span class="math inline">\(\alpha\)</span> are compared.</p>
<div class="section level3">
<h3 id="scatter-plots">Scatter Plots<a class="anchor" aria-label="anchor" href="#scatter-plots"></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Binary Marginal Effects and Prediction without Binary</span>
<span class="va">ggplot.A.alpha</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">svr_alpha</span> <span class="op">=</span> <span class="st">'alpha_i'</span>, <span class="va">svr_A</span> <span class="op">=</span> <span class="st">"A_i"</span>,
                           <span class="va">slb_title</span> <span class="op">=</span> <span class="st">'A_i and alpha_i (red)'</span><span class="op">)</span><span class="op">{</span>
  <span class="va">scatter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">svr_A</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">svr_alpha</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">4</span>, shape<span class="op">=</span><span class="fl">4</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">slb_title</span><span class="op">)</span>,
         x <span class="op">=</span> <span class="st">'A_i = Prob Employ no Training'</span>,
         y <span class="op">=</span> <span class="st">'alpha_i = Effect of Training of Prob Employ'</span>,
         caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Logit Regression on training. Control for age, educ, race. Age &lt;= 23 or &gt; 23 interaction.'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">scatter</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Plot over multiple</span>
<span class="fu">ggplot.A.alpha</span><span class="op">(</span>df <span class="op">=</span> <span class="va">dfj</span>,
               svr_alpha <span class="op">=</span> <span class="st">'alpha_i_wage'</span>, svr_A <span class="op">=</span> <span class="st">"A_i_wage"</span>,
               slb_title <span class="op">=</span> <span class="st">'A_i and alpha_i, wage'</span><span class="op">)</span></code></pre></div>
<p><img src="ffv_opt_sobin_rkone_allrw_training_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot.A.alpha</span><span class="op">(</span>df <span class="op">=</span> <span class="va">dfj</span>,
               svr_alpha <span class="op">=</span> <span class="st">'alpha_i_employ'</span>, svr_A <span class="op">=</span> <span class="st">"A_i_employ"</span>,
               slb_title <span class="op">=</span> <span class="st">'Employment A_i and alpha_i Joint Distribution'</span><span class="op">)</span></code></pre></div>
<p><img src="ffv_opt_sobin_rkone_allrw_training_files/figure-html/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="histogram-plots">Histogram Plots<a class="anchor" aria-label="anchor" href="#histogram-plots"></a>
</h3>
<p>What is the distribution of A given alpha. This is relevant in the linear regression case</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Keep only relevant columns, and reshape data</span>
<span class="va">dfj_hist</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">A_i_wage</span>, <span class="va">alpha_i_wage</span><span class="op">)</span>
<span class="va">dfj_hist</span><span class="op">$</span><span class="va">alpha_i_wage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dfj_hist</span><span class="op">$</span><span class="va">alpha_i_wage</span><span class="op">)</span>
<span class="va">dfj_hist</span><span class="op">$</span><span class="va">alpha_i_wage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dfj_hist</span><span class="op">$</span><span class="va">alpha_i_wage</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Age &lt;= 23\nalpha_i=$454'</span>, <span class="st">'Age &gt; 23\nalpha_i=$1071'</span><span class="op">)</span><span class="op">)</span>


<span class="va">title_line1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Wage A_i Distribution (Linear Wage), NSW Training Lalonde (AER, 1986)"</span><span class="op">)</span>
<span class="va">title_line2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"By Two Unique Levels of alpha_i: for Age &lt;= 23 and for Age &gt; 23"</span><span class="op">)</span>

<span class="co"># Graph</span>
<span class="va">dfj_hist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">A_i_wage</span>, fill<span class="op">=</span><span class="va">alpha_i_wage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span> color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#69b3a2"</span>, <span class="st">"#404080"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">title_line1</span>, <span class="st">'\n'</span>, <span class="va">title_line2</span><span class="op">)</span>,
       x <span class="op">=</span> <span class="st">'A_i = Expected Wage no Training (in thousands, 1979)'</span>,
       y <span class="op">=</span> <span class="st">'density'</span>,
       caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Linear Wage Regression on training. Control for age, educ, race. Age &lt;= 23 or &gt; 23 interaction.'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ffv_opt_sobin_rkone_allrw_training_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="min-and-max-rank-change-across-rho">Min and Max Rank Change Across rho<a class="anchor" aria-label="anchor" href="#min-and-max-rank-change-across-rho"></a>
</h2>
<p>The max calculated by ffp_opt_anlyz_rhgin_bin is the top rank, small in number. The min calculated by the function is the lowest ranked, largest number.</p>
<div class="section level3">
<h3 id="histogram-plots-and-table-highest-rank-reached">Histogram Plots and Table highest Rank Reached<a class="anchor" aria-label="anchor" href="#histogram-plots-and-table-highest-rank-reached"></a>
</h3>
<p>Looked highest rank reached for each (highest rank (smallest number ever reached)).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generate min and max gaps</span>
<span class="va">dfj_highest</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">rank_max_wage</span>, <span class="va">rank_max_employ</span><span class="op">)</span>

<span class="co"># Wide to long</span>
<span class="va">st_gap_prefix</span> <span class="op">&lt;-</span> <span class="st">'rank_max'</span>
<span class="va">dfj_highest_long</span> <span class="op">&lt;-</span> <span class="va">dfj_highest</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="va">st_gap_prefix</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'employvswwage'</span><span class="op">)</span>,
    names_pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">st_gap_prefix</span>, <span class="st">"_(.*)"</span><span class="op">)</span>,
    values_to <span class="op">=</span> <span class="st">'highestrank'</span>
  <span class="op">)</span>

<span class="co"># Rank change to categories</span>
<span class="va">dfj_highest_long</span> <span class="op">&lt;-</span> <span class="va">dfj_highest_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>highestrank_grp <span class="op">=</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">highestrank</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Top A 1"</span>,
                     <span class="va">highestrank</span> <span class="op">&lt;=</span> <span class="fl">10</span>  <span class="op">&amp;</span> <span class="va">highestrank</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Top B 10"</span>,
                     <span class="va">highestrank</span> <span class="op">&lt;=</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">highestrank</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">~</span> <span class="st">"Top C 11 to 50"</span>,
                     <span class="va">highestrank</span> <span class="op">&lt;=</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">highestrank</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"Top D 51 to 100"</span>,
                     <span class="va">highestrank</span> <span class="op">&lt;=</span> <span class="fl">297</span> <span class="op">&amp;</span> <span class="va">highestrank</span> <span class="op">&gt;</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"Top E 101 to 297"</span>,
                     <span class="va">highestrank</span> <span class="op">&gt;</span> <span class="fl">297</span> <span class="op">~</span> <span class="st">"Top F &gt; 297"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Graph</span>
<span class="va">dfj_highest_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">highestrank</span>, fill<span class="op">=</span><span class="va">employvswwage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#69b3a2"</span>, <span class="st">"#404080"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre>
<p><img src="ffv_opt_sobin_rkone_allrw_training_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Table</span>
<span class="va">dfj_highest_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">employvswwage</span>, <span class="va">highestrank_grp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'employvswwage'. You can override using the `.groups` argument.</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 x 3</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   employvswwage [2]</span></span>
<span class="co">##    employvswwage highestrank_grp  count</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> employ        Top A 1              7</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> employ        Top B 10            14</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> employ        Top C 11 to 50      84</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> employ        Top D 51 to 100     77</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> employ        Top E 101 to 297   198</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> employ        Top F &gt; 297        342</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> wage          Top A 1              3</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> wage          Top B 10            17</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> wage          Top C 11 to 50      80</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> wage          Top D 51 to 100     99</span>
<span class="co">## <span style="color: #BCBCBC;">11</span> wage          Top E 101 to 297   194</span>
<span class="co">## <span style="color: #BCBCBC;">12</span> wage          Top F &gt; 297        329</span></code></pre>
</div>
<div class="section level3">
<h3 id="histogram-plots-and-table-min-and-max-change">Histogram Plots and Table Min and Max Change<a class="anchor" aria-label="anchor" href="#histogram-plots-and-table-min-and-max-change"></a>
</h3>
<p>From the wage and employment analysis, each generates min and max rank</p>
<ol style="list-style-type: decimal">
<li>generate rank min max gap for wage and employment: min minus max because min number is actually the larger number (lower rank)</li>
<li>reshape wide to long, gap one variable, wage vs employment categorical</li>
<li>show table summary statistics differences</li>
<li>show graph differences</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generate min and max gaps</span>
<span class="va">dfj_gap</span> <span class="op">&lt;-</span> <span class="va">dfj</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rank_gap_wage <span class="op">=</span> <span class="va">rank_min_wage</span> <span class="op">-</span> <span class="va">rank_max_wage</span>,
                          rank_gap_employ <span class="op">=</span> <span class="va">rank_min_employ</span> <span class="op">-</span> <span class="va">rank_max_employ</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">rank_gap_wage</span>, <span class="va">rank_gap_employ</span><span class="op">)</span>

<span class="co"># Wide to long</span>
<span class="va">st_gap_prefix</span> <span class="op">&lt;-</span> <span class="st">'rank_gap'</span>
<span class="va">dfj_gap_long</span> <span class="op">&lt;-</span> <span class="va">dfj_gap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="va">st_gap_prefix</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'employvswwage'</span><span class="op">)</span>,
    names_pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">st_gap_prefix</span>, <span class="st">"_(.*)"</span><span class="op">)</span>,
    values_to <span class="op">=</span> <span class="st">'rank_gap'</span>
  <span class="op">)</span>

<span class="co"># Rank change to categories</span>
<span class="va">dfj_gap_long</span> <span class="op">&lt;-</span> <span class="va">dfj_gap_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rank_gap_grp <span class="op">=</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">rank_gap</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"change A no change"</span>,
                     <span class="va">rank_gap</span> <span class="op">&lt;=</span> <span class="fl">50</span>  <span class="op">&amp;</span> <span class="va">rank_gap</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"change B 50 positions"</span>,
                     <span class="va">rank_gap</span> <span class="op">&lt;=</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">rank_gap</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"change C 51 to 100"</span>,
                     <span class="va">rank_gap</span> <span class="op">&lt;=</span> <span class="fl">200</span> <span class="op">&amp;</span> <span class="va">rank_gap</span> <span class="op">&gt;</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"change D 101 to 200"</span>,
                     <span class="va">rank_gap</span> <span class="op">&lt;=</span> <span class="fl">400</span> <span class="op">&amp;</span> <span class="va">rank_gap</span> <span class="op">&gt;</span> <span class="fl">200</span> <span class="op">~</span> <span class="st">"change E 201 to 400"</span>,
                     <span class="va">rank_gap</span> <span class="op">&gt;</span> <span class="fl">400</span> <span class="op">~</span> <span class="st">"change F more than 401"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Graph</span>
<span class="va">dfj_gap_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">rank_gap</span>, fill<span class="op">=</span><span class="va">employvswwage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"#e9ecef"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">'identity'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#69b3a2"</span>, <span class="st">"#404080"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre>
<p><img src="ffv_opt_sobin_rkone_allrw_training_files/figure-html/unnamed-chunk-10-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Table</span>
<span class="va">dfj_gap_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">employvswwage</span>, <span class="va">rank_gap_grp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'employvswwage'. You can override using the `.groups` argument.</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 11 x 3</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   employvswwage [2]</span></span>
<span class="co">##    employvswwage rank_gap_grp           count</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> employ        change A no change         2</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> employ        change B 50 positions    175</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> employ        change C 51 to 100       151</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> employ        change D 101 to 200      391</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> employ        change E 201 to 400        3</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> wage          change A no change         2</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> wage          change B 50 positions    155</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> wage          change C 51 to 100       205</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> wage          change D 101 to 200      255</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> wage          change E 201 to 400       38</span>
<span class="co">## <span style="color: #BCBCBC;">11</span> wage          change F more than 401    67</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="table-of-top-10-individuals">Table of Top 10 Individuals<a class="anchor" aria-label="anchor" href="#table-of-top-10-individuals"></a>
</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#</span>
<span class="co"># # Calculat the maximum rank reached by each from all the rhos we have</span>
<span class="co"># # The difference between this and the other max, this computes across all rhos, employment and wage</span>
<span class="co">#</span>
<span class="co"># dfj_top10 &lt;- dfj %&gt;%</span>
<span class="co">#     select(contains("rho_")) %&gt;%</span>
<span class="co">#     reduce(pmin) %&gt;%</span>
<span class="co">#     mutate(dfj, max_rank_rhos = .)</span>
<span class="co">#</span>
<span class="co"># dfj_top10 &lt;- dfj_top10 %&gt;% filter(max_rank_rhos &lt;= 10) %&gt;%</span>
<span class="co">#   select(id, age, educ, black, race,</span>
<span class="co">#          rho_c1_rk_employ, rho_c16_rk_employ, rho_c30_rk_employ,</span>
<span class="co">#          rho_c1_rk_wage, rho_c16_rk_wage, rho_c30_rk_wage) %&gt;%</span>
<span class="co">#   rename(emp_util = rho_c1_rk_employ,</span>
<span class="co">#          emp_CD   = rho_c16_rk_employ,</span>
<span class="co">#          emp_rawl = rho_c30_rk_employ,</span>
<span class="co">#          wag_util = rho_c1_rk_wage,</span>
<span class="co">#          wag_CD   = rho_c16_rk_wage,</span>
<span class="co">#          wag_rawl = rho_c30_rk_wage,</span>
<span class="co">#          ) %&gt;%</span>
<span class="co">#   arrange(age, educ, race)</span>
<span class="co">#</span>
<span class="co"># dim(dfj_top10)</span>
<span class="co">#</span>
<span class="co"># # Graphing Library</span>
<span class="co"># library(kableExtra)</span>
<span class="co"># # Load Data</span>
<span class="co"># dt &lt;- mtcars[1:5, 1:6]</span>
<span class="co"># # Generate latex string variable</span>
<span class="co"># st_out_tex &lt;- kable(dfj_top10, "latex")</span>
<span class="co"># print(st_out_tex)</span>
<span class="co"># # File out</span>
<span class="co"># # fileConn &lt;- file("./../../_file/tex/tex_sample_a_tab.tex")</span>
<span class="co"># fileConn &lt;- file("C:/users/fan/HgtOptiAlloDraft/_tab/Lalonde_wage_employ_top10.tex")</span>
<span class="co"># writeLines(st_out_tex, fileConn)</span>
<span class="co"># close(fileConn)</span>
<span class="co">#</span>
<span class="co"># # Display results here</span>
<span class="co"># dfj_top10 %&gt;%</span>
<span class="co">#     kable() %&gt;%</span>
<span class="co">#     kable_styling(bootstrap_options = c("striped", "hover", "responsive"))</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://fanwangecon.github.io" class="external-link">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
