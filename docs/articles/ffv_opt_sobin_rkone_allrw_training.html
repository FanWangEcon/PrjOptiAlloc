<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BINARY--NSW Training WAGE Optimal Allocation Solution (Line by Line) • PrjOptiAlloc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BINARY--NSW Training WAGE Optimal Allocation Solution (Line by Line)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PrjOptiAlloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ffv_opt_anlyz_rhgin.html">ANALYSIS--Optimal Allocations Planner Elasticity Vector and Ginis</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_dtgch_cbem4.html">DATA--Generate Data Cebu Four Category Test Regression Results</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allfc_training_logit.html">BINARY--NSW Training EMPLOYMENT as Outcome Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_car.html">BINARY--MPG and Shift Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_training.html">BINARY--NSW Training WAGE Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_wgt.html">BINARY--Birth Weight and Doctors Visit Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sodis_rkone_allrw_casch.html">DISCRETE--Discrete Provision Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow.html">LINEAR--Optimal Linear Allocation based On Relative Allocation to Lowest</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allfn.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Function)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allrw.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solog_bisec_allrw.html">LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Implicit Bisection Solution (Line by Line)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>BINARY–NSW Training WAGE Optimal Allocation Solution (Line by Line)</h1>
            
      
      
      <div class="hidden name"><code>ffv_opt_sobin_rkone_allrw_training.Rmd</code></div>

    </div>

    
    
<p>Back to <strong><a href="https://fanwangecon.github.io/">Fan</a></strong>’s Optimal Allocation Homepage <strong><a href="https://fanwangecon.github.io/PrjOptiAllo==c/">Table of Content</a></strong></p>
<div id="objective" class="section level1">
<h1 class="hasAnchor">
<a href="#objective" class="anchor"></a>Objective</h1>
<p>Test binary allocation queue with Lalonde training dataset. There are 722 observations, 297 in the treatment group, 425 in the control group.</p>
<p>Following Lalonda, regressions are in terms of wage levels (not log wage)</p>
</div>
<div id="load-packages-and-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-packages-and-data" class="anchor"></a>Load Packages and Data</h1>
<div id="load-dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#load-dependencies" class="anchor"></a>Load Dependencies</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="dt">all.names =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">knitr.duplicate.label =</span> <span class="st">'allow'</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tibble)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stringr)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(broom)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(REconTools)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PrjOptiAlloc)</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra)</a></code></pre></div>
</div>
<div id="load-data-and-generate-new-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data-and-generate-new-variables" class="anchor"></a>Load Data and Generate New Variables</h2>
<p>Generate four categories by initial height and mother’s education levels combinations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Load Data</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(df_opt_lalonde_training)</a>
<a class="sourceLine" id="cb3-3" title="3">dft &lt;-<span class="st"> </span>df_opt_lalonde_training <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id =</span> X) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">           </span><span class="kw">select</span>(<span class="op">-</span>X) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">           </span><span class="kw">select</span>(id, <span class="kw">everything</span>()) </a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co"># Summarize</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(dft)</a></code></pre></div>
<pre><code>## 'data.frame':    722 obs. of  11 variables:
##  $ id   : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ trt  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ age  : int  23 26 22 34 18 45 18 27 24 34 ...
##  $ educ : int  10 12 9 9 9 11 9 12 8 11 ...
##  $ black: int  1 0 1 1 1 1 1 1 0 1 ...
##  $ hisp : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ marr : int  0 0 0 0 0 0 0 0 0 1 ...
##  $ nodeg: int  1 0 1 1 1 1 1 0 1 1 ...
##  $ re74 : num  0 0 0 NA 0 0 0 NA 0 0 ...
##  $ re75 : num  0 0 0 4368 0 ...
##  $ re78 : num  0 12384 0 14051 10740 ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(dft)</a></code></pre></div>
<pre><code>##        id              trt              age             educ      
##  Min.   :   1.0   Min.   :0.0000   Min.   :17.00   Min.   : 3.00  
##  1st Qu.: 181.2   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.: 9.00  
##  Median : 361.5   Median :0.0000   Median :23.00   Median :10.00  
##  Mean   : 854.4   Mean   :0.4114   Mean   :24.52   Mean   :10.27  
##  3rd Qu.:1458.5   3rd Qu.:1.0000   3rd Qu.:27.00   3rd Qu.:11.00  
##  Max.   :4110.0   Max.   :1.0000   Max.   :55.00   Max.   :16.00  
##                                                                   
##      black             hisp             marr           nodeg       
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.000   Min.   :0.0000  
##  1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:1.0000  
##  Median :1.0000   Median :0.0000   Median :0.000   Median :1.0000  
##  Mean   :0.8006   Mean   :0.1053   Mean   :0.162   Mean   :0.7798  
##  3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.000   3rd Qu.:1.0000  
##  Max.   :1.0000   Max.   :1.0000   Max.   :1.000   Max.   :1.0000  
##                                                                    
##       re74              re75              re78      
##  Min.   :    0.0   Min.   :    0.0   Min.   :    0  
##  1st Qu.:    0.0   1st Qu.:    0.0   1st Qu.:    0  
##  Median :    0.0   Median :  936.3   Median : 3952  
##  Mean   : 2102.3   Mean   : 3042.9   Mean   : 5455  
##  3rd Qu.:  824.4   3rd Qu.: 3993.2   3rd Qu.: 8772  
##  Max.   :39570.7   Max.   :37431.7   Max.   :60308  
##  NA's   :277</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Generate Employment 0 or 1 status Variable, and non-zero wages variable</span></a>
<a class="sourceLine" id="cb7-2" title="2">dft &lt;-<span class="st"> </span>dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">emp78 =</span></a>
<a class="sourceLine" id="cb7-3" title="3">                      <span class="kw">case_when</span>(re78 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb7-4" title="4">                                <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">               </span><span class="kw">mutate</span>(<span class="dt">emp75 =</span></a>
<a class="sourceLine" id="cb7-6" title="6">                      <span class="kw">case_when</span>(re75 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb7-7" title="7">                                <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="st">               </span><span class="kw">mutate</span>(<span class="dt">emp74 =</span></a>
<a class="sourceLine" id="cb7-9" title="9">                      <span class="kw">case_when</span>(re74 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb7-10" title="10">                                <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co"># Generate combine black + hispanic status</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co"># 0 = white, 1 = black, 2 = hispanics</span></a>
<a class="sourceLine" id="cb7-14" title="14">dft &lt;-<span class="st"> </span>dft <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">race =</span></a>
<a class="sourceLine" id="cb7-16" title="16">             <span class="kw">case_when</span>(black <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-17" title="17">                       hisp <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb7-18" title="18">                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span>)) </a>
<a class="sourceLine" id="cb7-19" title="19"></a>
<a class="sourceLine" id="cb7-20" title="20">dft &lt;-<span class="st"> </span>dft <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">age_m2 =</span></a>
<a class="sourceLine" id="cb7-22" title="22">             <span class="kw">case_when</span>(age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">23</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-23" title="23">                       age <span class="op">&gt;</span><span class="st">  </span><span class="dv">23</span><span class="op">~</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">age_m3 =</span></a>
<a class="sourceLine" id="cb7-25" title="25">             <span class="kw">case_when</span>(age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-26" title="26">                       age <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">26</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb7-27" title="27">                       age <span class="op">&gt;</span><span class="st"> </span><span class="dv">26</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb7-28" title="28"> </a>
<a class="sourceLine" id="cb7-29" title="29"></a>
<a class="sourceLine" id="cb7-30" title="30"></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co"># filter(re78 != 0) %&gt;%</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co"># mutate(re78_log = log(re78))</span></a>
<a class="sourceLine" id="cb7-33" title="33"></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co"># Exclude zeros</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co"># when this is on, both linear and log linear results exclude wage = 0</span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co"># dft &lt;- dft %&gt;%</span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#     filter(re78 &gt; 0)</span></a>
<a class="sourceLine" id="cb7-38" title="38"></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co"># Generate Discrete Version of continuous variables</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co"># dft &lt;- dft %&gt;%</span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#     mutate(momwgtLowHigh = cut(lwt,</span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#                                breaks=c(-Inf, 129, Inf),</span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#                                labels=c("LW","HW"))) %&gt;%</span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#     mutate(mombirthage = cut(age,</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">#                                breaks=c(-Inf, 24, Inf),</span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">#                                labels=c("young","older")))</span></a></code></pre></div>
</div>
</div>
<div id="regression-with-data-and-construct-input-arrays" class="section level1">
<h1 class="hasAnchor">
<a href="#regression-with-data-and-construct-input-arrays" class="anchor"></a>Regression with Data and Construct Input Arrays</h1>
<div id="tabulate-and-summarize-averages" class="section level2">
<h2 class="hasAnchor">
<a href="#tabulate-and-summarize-averages" class="anchor"></a>Tabulate and Summarize Averages</h2>
<p>What is the average difference in wage between treatment and control, do they match what is reported in Lalonda (1986)?</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Summarize average for all variables grouping by treatment status</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co"># re78 is significantly different</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trt) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">        </span><span class="kw">summarise_if</span>(is.numeric, <span class="kw">funs</span>(<span class="dt">mean =</span> mean), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), <span class="dt">digits=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## Warning: funs() is soft deprecated as of dplyr 0.8.0
## Please use a list of either functions or lambdas: 
## 
##   # Simple named list: 
##   list(mean = mean, median = median)
## 
##   # Auto named with `tibble::lst()`: 
##   tibble::lst(mean, median)
## 
##   # Using lambdas
##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
## This warning is displayed once per session.</code></pre>
<pre><code>##                 [,1]     [,2]
## trt            0.000    1.000
## id_mean      213.000 1772.316
## age_mean      24.447   24.626
## educ_mean     10.188   10.380
## black_mean     0.800    0.801
## hisp_mean      0.113    0.094
## marr_mean      0.158    0.168
## nodeg_mean     0.814    0.731
## re74_mean   2107.027 2095.574
## re75_mean   3026.683 3066.098
## re78_mean   5090.048 5976.352
## emp78_mean     0.696    0.774
## emp75_mean     0.581    0.626
## emp74_mean     0.541    0.559
## race_mean      1.026    0.990
## age_m2_mean    1.489    1.481
## age_m3_mean    1.948    1.990</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(marr, age_m2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">        </span><span class="kw">summarise_if</span>(is.numeric, <span class="kw">funs</span>(<span class="dt">mean =</span> mean), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), <span class="dt">digits=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                 [,1]     [,2]     [,3]     [,4]
## marr           0.000    0.000    1.000    1.000
## age_m2         1.000    2.000    1.000    2.000
## id_mean      840.140  823.626 1083.179  928.270
## trt_mean       0.411    0.405    0.464    0.416
## age_mean      19.569   29.485   20.929   30.124
## educ_mean     10.105   10.412   10.143   10.506
## black_mean     0.778    0.824    0.607    0.876
## hisp_mean      0.134    0.069    0.250    0.056
## nodeg_mean     0.845    0.698    0.821    0.753
## re74_mean   1991.445 1509.914 2758.832 3996.214
## re75_mean   2304.886 2950.030 5827.808 5284.371
## re78_mean   5219.173 5516.690 7153.395 5644.975
## emp78_mean     0.752    0.683    0.893    0.719
## emp75_mean     0.650    0.511    0.786    0.607
## emp74_mean     0.615    0.447    0.714    0.539
## race_mean      1.047    0.962    1.107    0.989
## age_m3_mean    1.309    2.630    1.607    2.652</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># Summarize by finer sub groups: RACE</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co"># big increase for black, but not for other group</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trt, race) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">        </span><span class="kw">summarise_if</span>(is.numeric, <span class="kw">funs</span>(<span class="dt">mean =</span> mean), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), <span class="dt">digits=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                 [,1]     [,2]     [,3]     [,4]     [,5]     [,6]
## trt            0.000    0.000    0.000    1.000    1.000    1.000
## race           0.000    1.000    2.000    0.000    1.000    2.000
## id_mean      233.027  209.679  221.083 1700.129 1782.723 1763.786
## age_mean      23.351   24.812   22.708   25.677   24.853   21.536
## educ_mean     10.486   10.285    9.271   10.839   10.382    9.857
## black_mean     0.000    1.000    0.000    0.000    1.000    0.000
## hisp_mean      0.000    0.000    1.000    0.000    0.000    1.000
## marr_mean      0.135    0.162    0.146    0.161    0.168    0.179
## nodeg_mean     0.649    0.821    0.896    0.548    0.739    0.857
## re74_mean   3791.631 2086.477 1242.022 1305.037 2155.013 2546.219
## re75_mean   5373.717 2862.948 2377.296 4038.830 2785.916 4370.691
## re78_mean   7114.471 4654.996 6611.178 7034.041 5814.419 6181.772
## emp78_mean     0.838    0.659    0.854    0.935    0.739    0.893
## emp75_mean     0.757    0.565    0.562    0.677    0.597    0.821
## emp74_mean     0.676    0.521    0.583    0.548    0.534    0.786
## age_m2_mean    1.514    1.506    1.354    1.484    1.513    1.214
## age_m3_mean    1.946    1.988    1.667    2.065    2.021    1.643</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Summarize by finer sub groups: MARRIAGE</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># big increase for black, but not for other group</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trt, marr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">        </span><span class="kw">summarise_if</span>(is.numeric, <span class="kw">funs</span>(<span class="dt">mean =</span> mean), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), <span class="dt">digits=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                 [,1]     [,2]     [,3]     [,4]
## trt            0.000    0.000    1.000    1.000
## marr           0.000    1.000    0.000    1.000
## id_mean      210.176  228.090 1735.688 1953.260
## age_mean      23.933   27.194   23.761   28.900
## educ_mean     10.131   10.493   10.393   10.320
## black_mean     0.796    0.821    0.802    0.800
## hisp_mean      0.115    0.104    0.093    0.100
## nodeg_mean     0.818    0.791    0.729    0.740
## re74_mean   1834.893 3603.759 1646.427 4020.488
## re75_mean   2465.121 6027.269 2756.966 4593.212
## re78_mean   5105.237 5008.892 5699.897 7342.041
## emp78_mean     0.701    0.672    0.753    0.880
## emp75_mean     0.573    0.627    0.615    0.680
## emp74_mean     0.534    0.582    0.555    0.580
## race_mean      1.025    1.030    0.988    1.000
## age_m2_mean    1.436    1.776    1.429    1.740
## age_m3_mean    1.866    2.388    1.903    2.420</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># Summarize by finer sub groups: AGE GROUPS</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trt, age_m2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">        </span><span class="kw">summarise_if</span>(is.numeric, <span class="kw">funs</span>(<span class="dt">mean =</span> mean), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), <span class="dt">digits=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                 [,1]     [,2]     [,3]     [,4]
## trt            0.000    0.000    1.000    1.000
## age_m2         1.000    2.000    1.000    2.000
## id_mean      241.908  182.841 1727.292 1820.804
## age_mean      19.539   29.567   19.857   29.762
## educ_mean      9.977   10.409   10.292   10.476
## black_mean     0.774    0.827    0.753    0.853
## hisp_mean      0.143    0.082    0.143    0.042
## marr_mean      0.069    0.250    0.084    0.259
## nodeg_mean     0.899    0.726    0.766    0.692
## re74_mean   2333.261 1900.754 1571.490 2486.164
## re75_mean   2313.545 3770.677 2933.215 3209.204
## re78_mean   5095.991 5083.849 5744.425 6226.119
## emp78_mean     0.728    0.663    0.812    0.734
## emp75_mean     0.618    0.543    0.721    0.524
## emp74_mean     0.590    0.490    0.669    0.441
## race_mean      1.060    0.990    1.039    0.937
## age_m3_mean    1.290    2.635    1.390    2.636</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trt, age_m3) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">        </span><span class="kw">summarise_if</span>(is.numeric, <span class="kw">funs</span>(<span class="dt">mean =</span> mean), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), <span class="dt">digits=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                 [,1]     [,2]     [,3]     [,4]     [,5]     [,6]
## trt            0.000    0.000    0.000    1.000    1.000    1.000
## age_m3         1.000    2.000    3.000    1.000    2.000    3.000
## id_mean      261.675  180.475  190.462 1646.723 1918.705 1721.879
## age_mean      18.532   23.626   32.212   18.479   23.402   32.484
## educ_mean      9.877   10.209   10.530    9.851   10.902   10.286
## black_mean     0.740    0.835    0.833    0.777    0.777    0.857
## hisp_mean      0.175    0.072    0.083    0.160    0.071    0.055
## marr_mean      0.039    0.209    0.242    0.053    0.170    0.286
## nodeg_mean     0.922    0.806    0.697    0.883    0.607    0.725
## re74_mean    827.694 3297.704 2095.804 1466.314 2840.083 1794.839
## re75_mean   1564.343 3604.432 4124.358 2302.777 4136.499 2537.167
## re78_mean   4987.829 5320.403 4966.734 5498.803 5744.032 6755.577
## emp78_mean     0.760    0.676    0.644    0.777    0.795    0.747
## emp75_mean     0.617    0.547    0.576    0.734    0.634    0.505
## emp74_mean     0.584    0.532    0.500    0.670    0.598    0.396
## race_mean      1.091    0.978    1.000    1.096    0.920    0.967
## age_m2_mean    1.000    1.547    2.000    1.000    1.464    2.000</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(dft <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trt, marr, age_m2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">        </span><span class="kw">summarise_if</span>(is.numeric, <span class="kw">funs</span>(<span class="dt">mean =</span> mean), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), <span class="dt">digits=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                 [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]
## trt            0.000    0.000    0.000    0.000    1.000    1.000    1.000
## marr           0.000    0.000    1.000    1.000    0.000    0.000    1.000
## age_m2         1.000    2.000    1.000    2.000    1.000    2.000    1.000
## id_mean      243.302  167.282  223.133  229.519 1695.184 1789.566 2075.538
## age_mean      19.450   29.737   20.733   29.058   19.738   29.113   21.154
## educ_mean      9.965   10.346   10.133   10.596   10.305   10.509   10.154
## black_mean     0.782    0.814    0.667    0.865    0.773    0.840    0.538
## hisp_mean      0.139    0.083    0.200    0.077    0.128    0.047    0.308
## nodeg_mean     0.896    0.718    0.933    0.750    0.773    0.670    0.692
## re74_mean   2215.155 1386.863 5144.184 3383.698 1621.704 1669.249 1055.009
## re75_mean   2033.499 3024.016 6084.840 6010.662 2693.681 2841.146 5531.232
## re78_mean   5009.475 5229.235 6261.061 4647.690 5519.591 5939.737 8183.010
## emp78_mean     0.723    0.673    0.800    0.635    0.794    0.698    1.000
## emp75_mean     0.609    0.526    0.733    0.596    0.709    0.491    0.846
## emp74_mean     0.579    0.474    0.733    0.538    0.667    0.406    0.692
## race_mean      1.059    0.981    1.067    1.019    1.028    0.934    1.154
## age_m3_mean    1.267    2.641    1.600    2.615    1.369    2.613    1.615
##                 [,8]
## trt            1.000
## marr           1.000
## age_m2         2.000
## id_mean     1910.297
## age_mean      31.622
## educ_mean     10.378
## black_mean     0.892
## hisp_mean      0.027
## nodeg_mean     0.757
## re74_mean   4761.858
## re75_mean   4263.638
## re78_mean   7046.565
## emp78_mean     0.838
## emp75_mean     0.622
## emp74_mean     0.541
## race_mean      0.946
## age_m3_mean    2.703</code></pre>
</div>
<div id="tabulate" class="section level2">
<h2 class="hasAnchor">
<a href="#tabulate" class="anchor"></a>Tabulate</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># Tabulate groups, how many in each group, enough for group heterogeneity in effects?</span></a>
<a class="sourceLine" id="cb23-2" title="2">dft <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(trt, marr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> trt, <span class="dt">values_from =</span> freq)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##    marr   `0`   `1`
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     0   358   247
## 2     1    67    50</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># Tabulate groups, how many in each group, enough for group heterogeneity in effects?</span></a>
<a class="sourceLine" id="cb25-2" title="2">dft <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(trt, age_m2, marr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> trt, <span class="dt">values_from =</span> freq)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 4
## # Groups:   age_m2 [2]
##   age_m2  marr   `0`   `1`
##    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1      1     0   202   141
## 2      1     1    15    13
## 3      2     0   156   106
## 4      2     1    52    37</code></pre>
</div>
<div id="regression-testing" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-testing" class="anchor"></a>Regression Testing</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># As noted in Lalonda (1986), functional form assumptions do not matter much</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co"># Dummies, treatment effect average about 801 dollars</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(re78 <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(age) </a>
<a class="sourceLine" id="cb27-4" title="4">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(educ)</a>
<a class="sourceLine" id="cb27-5" title="5">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)</a>
<a class="sourceLine" id="cb27-6" title="6">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr) </a>
<a class="sourceLine" id="cb27-7" title="7">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(nodeg)</a>
<a class="sourceLine" id="cb27-8" title="8">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(trt) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb27-9" title="9">                  <span class="dt">data =</span> dft))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = re78 ~ factor(age) + factor(educ) + factor(race) + 
##     factor(marr) + factor(nodeg) + factor(trt) - 1, data = dft)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -14412  -4409  -1265   3139  54012 
## 
## Coefficients: (2 not defined because of singularities)
##                Estimate Std. Error t value Pr(&gt;|t|)  
## factor(age)17    2290.8     6400.4   0.358   0.7205  
## factor(age)18    2445.2     6380.0   0.383   0.7016  
## factor(age)19    3540.8     6384.6   0.555   0.5794  
## factor(age)20    3558.8     6389.4   0.557   0.5777  
## factor(age)21    4670.1     6412.9   0.728   0.4667  
## factor(age)22    2975.7     6262.4   0.475   0.6348  
## factor(age)23    2278.3     6416.7   0.355   0.7227  
## factor(age)24    2362.0     6417.2   0.368   0.7129  
## factor(age)25    2430.8     6395.4   0.380   0.7040  
## factor(age)26    4223.8     6419.2   0.658   0.5108  
## factor(age)27    2720.7     6413.6   0.424   0.6716  
## factor(age)28    4311.2     6428.8   0.671   0.5027  
## factor(age)29    2895.7     6475.4   0.447   0.6549  
## factor(age)30    2044.7     6593.6   0.310   0.7566  
## factor(age)31    3847.6     6471.3   0.595   0.5523  
## factor(age)32    4379.5     6762.9   0.648   0.5175  
## factor(age)33    3880.4     6645.4   0.584   0.5595  
## factor(age)34    2741.6     6613.4   0.415   0.6786  
## factor(age)35    2397.2     6770.4   0.354   0.7234  
## factor(age)36    4081.3     6758.7   0.604   0.5461  
## factor(age)37    1315.2     7296.6   0.180   0.8570  
## factor(age)38    1610.3     6740.8   0.239   0.8113  
## factor(age)39    -545.5     6937.2  -0.079   0.9374  
## factor(age)40   14642.9     7741.1   1.892   0.0590 .
## factor(age)41   -1436.5     6972.1  -0.206   0.8368  
## factor(age)42    3079.3     6992.4   0.440   0.6598  
## factor(age)43    1562.5     7719.2   0.202   0.8397  
## factor(age)44    3459.6     7062.6   0.490   0.6244  
## factor(age)45    6597.1     7347.2   0.898   0.3696  
## factor(age)46   -1436.8     7354.4  -0.195   0.8452  
## factor(age)48    5423.7     9353.1   0.580   0.5622  
## factor(age)49   12421.9     8898.2   1.396   0.1632  
## factor(age)50    2091.2     7718.9   0.271   0.7865  
## factor(age)54    6628.8     8864.7   0.748   0.4549  
## factor(age)55    7456.5     6243.0   1.194   0.2328  
## factor(educ)4    1939.6     6912.8   0.281   0.7791  
## factor(educ)5    2173.8     6919.6   0.314   0.7535  
## factor(educ)6     496.9     6723.6   0.074   0.9411  
## factor(educ)7    3107.2     6476.6   0.480   0.6316  
## factor(educ)8    2867.3     6322.4   0.454   0.6503  
## factor(educ)9    3836.5     6298.3   0.609   0.5426  
## factor(educ)10   3028.1     6288.2   0.482   0.6303  
## factor(educ)11   2796.4     6283.5   0.445   0.6564  
## factor(educ)12   3351.0     6291.2   0.533   0.5945  
## factor(educ)13   4125.2     6420.0   0.643   0.5207  
## factor(educ)14  11173.8     6586.6   1.696   0.0903 .
## factor(educ)15   9616.1     7679.7   1.252   0.2110  
## factor(educ)16       NA         NA      NA       NA  
## factor(race)1   -1612.7      822.1  -1.962   0.0502 .
## factor(race)2     -95.0     1082.8  -0.088   0.9301  
## factor(marr)1     626.9      670.8   0.935   0.3504  
## factor(nodeg)1       NA         NA      NA       NA  
## factor(trt)1      801.0      488.2   1.641   0.1013  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6189 on 671 degrees of freedom
## Multiple R-squared:  0.4826, Adjusted R-squared:  0.4433 
## F-statistic: 12.27 on 51 and 671 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># cts Controls and treatment effects about 761 dollars</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(re78 <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(age<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">                   </span>educ <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(educ<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">                  </span><span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)</a>
<a class="sourceLine" id="cb29-5" title="5">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr) </a>
<a class="sourceLine" id="cb29-6" title="6">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(nodeg)</a>
<a class="sourceLine" id="cb29-7" title="7">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(trt) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb29-8" title="8">                  <span class="dt">data =</span> dft))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = re78 ~ age + I(age^2) + educ + I(educ^2) + +factor(race) + 
##     factor(marr) + factor(nodeg) + factor(trt) - 1, data = dft)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -9154  -4677  -1556   3246  54687 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)  
## age              -29.1127   213.9845  -0.136   0.8918  
## I(age^2)           0.6658     3.5882   0.186   0.8529  
## educ           -1150.6075  1021.2110  -1.127   0.2602  
## I(educ^2)         76.1351    56.0966   1.357   0.1751  
## factor(race)0  10204.2957  5360.7995   1.904   0.0574 .
## factor(race)1   8421.7101  5328.1587   1.581   0.1144  
## factor(race)2  10059.7028  5298.4854   1.899   0.0580 .
## factor(marr)1    579.8210   650.3352   0.892   0.3729  
## factor(nodeg)1   175.0729   913.5232   0.192   0.8481  
## factor(trt)1     761.4122   472.5196   1.611   0.1075  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6206 on 712 degrees of freedom
## Multiple R-squared:  0.448,  Adjusted R-squared:  0.4402 
## F-statistic: 57.78 on 10 and 712 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># Treatment interactions by marriage status, 476 unmarried, vs 2216 for married</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(re78 <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(age<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="st">                   </span>educ <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(educ<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="st">                  </span><span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)</a>
<a class="sourceLine" id="cb31-5" title="5">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr) </a>
<a class="sourceLine" id="cb31-6" title="6">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(nodeg)</a>
<a class="sourceLine" id="cb31-7" title="7">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(trt) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb31-8" title="8">                  <span class="dt">data =</span> dft))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = re78 ~ age + I(age^2) + educ + I(educ^2) + +factor(race) + 
##     factor(marr) + factor(nodeg) + factor(marr):factor(trt) - 
##     1, data = dft)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -9999  -4554  -1552   3132  54838 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)  
## age                          -14.6509   214.1161  -0.068   0.9455  
## I(age^2)                       0.3773     3.5922   0.105   0.9164  
## educ                       -1124.9544  1020.7625  -1.102   0.2708  
## I(educ^2)                     75.1305    56.0673   1.340   0.1807  
## factor(race)0               9986.4688  5359.9102   1.863   0.0628 .
## factor(race)1               8214.9578  5327.0673   1.542   0.1235  
## factor(race)2               9845.8189  5297.5758   1.859   0.0635 .
## factor(marr)1               -156.2047   844.1521  -0.185   0.8532  
## factor(nodeg)1               176.8634   912.9685   0.194   0.8464  
## factor(marr)0:factor(trt)1   476.6372   516.1797   0.923   0.3561  
## factor(marr)1:factor(trt)1  2216.3634  1164.8513   1.903   0.0575 .
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6202 on 711 degrees of freedom
## Multiple R-squared:  0.4494, Adjusted R-squared:  0.4409 
## F-statistic: 52.76 on 11 and 711 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># Treatment interactions by marriage status, 453 vs 1070 each age group</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(re78 <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(age<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(age_m2) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">                   </span>educ <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(educ<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="st">                  </span><span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)</a>
<a class="sourceLine" id="cb33-5" title="5">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr) </a>
<a class="sourceLine" id="cb33-6" title="6">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(nodeg)</a>
<a class="sourceLine" id="cb33-7" title="7">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(age_m2)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(trt) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb33-8" title="8">                  <span class="dt">data =</span> dft))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = re78 ~ age + I(age^2) + factor(age_m2) + educ + 
##     I(educ^2) + +factor(race) + factor(marr) + factor(nodeg) + 
##     factor(age_m2):factor(trt) - 1, data = dft)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -9281  -4664  -1521   3260  54557 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)  
## age                             73.5664   317.3603   0.232    0.817  
## I(age^2)                        -0.7038     4.7486  -0.148    0.882  
## factor(age_m2)1               8890.8921  6129.7194   1.450    0.147  
## factor(age_m2)2               8237.1456  6661.6040   1.237    0.217  
## educ                         -1137.5178  1025.7038  -1.109    0.268  
## I(educ^2)                       75.1320    56.3181   1.334    0.183  
## factor(race)1                -1782.6432   804.4433  -2.216    0.027 *
## factor(race)2                 -130.3132  1055.7904  -0.123    0.902  
## factor(marr)1                  590.5769   651.5151   0.906    0.365  
## factor(nodeg)1                 139.6452   916.7444   0.152    0.879  
## factor(age_m2)1:factor(trt)1   453.7963   659.7260   0.688    0.492  
## factor(age_m2)2:factor(trt)1  1070.8127   677.9949   1.579    0.115  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6212 on 710 degrees of freedom
## Multiple R-squared:  0.4484, Adjusted R-squared:  0.4391 
## F-statistic:  48.1 on 12 and 710 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Treatment interactions by marriage status, greater effect for older married + younger married</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(re78 <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(age<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(age_m2) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="st">                   </span>educ <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(educ<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="st">                  </span><span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)</a>
<a class="sourceLine" id="cb35-5" title="5">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr) </a>
<a class="sourceLine" id="cb35-6" title="6">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(nodeg)</a>
<a class="sourceLine" id="cb35-7" title="7">                  <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(age_m2)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(trt) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb35-8" title="8">                  <span class="dt">data =</span> dft))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = re78 ~ age + I(age^2) + factor(age_m2) + educ + 
##     I(educ^2) + +factor(race) + factor(marr) + factor(nodeg) + 
##     factor(marr):factor(age_m2):factor(trt) - 1, data = dft)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -9725  -4576  -1573   3089  54691 
## 
## Coefficients: (3 not defined because of singularities)
##                                              Estimate Std. Error t value
## age                                           37.3770   319.8439   0.117
## I(age^2)                                      -0.2698     4.7852  -0.056
## factor(age_m2)1                            10519.8273  6563.8924   1.603
## factor(age_m2)2                             9557.6915  6655.2092   1.436
## educ                                       -1107.2556  1026.5070  -1.079
## I(educ^2)                                     74.1506    56.3551   1.316
## factor(race)1                              -1732.3553   806.1276  -2.149
## factor(race)2                               -143.3612  1056.8346  -0.136
## factor(marr)1                               1217.5255  1196.2563   1.018
## factor(nodeg)1                               164.2353   918.1533   0.179
## factor(age_m2)1:factor(marr)0:factor(trt)0 -1378.9391  2164.2994  -0.637
## factor(age_m2)2:factor(marr)0:factor(trt)0  -640.4138   785.5838  -0.815
## factor(age_m2)1:factor(marr)1:factor(trt)0 -1595.6462  2363.5262  -0.675
## factor(age_m2)2:factor(marr)1:factor(trt)0 -2339.1547  1346.3197  -1.737
## factor(age_m2)1:factor(marr)0:factor(trt)1 -1029.3096  2177.4284  -0.473
## factor(age_m2)2:factor(marr)0:factor(trt)1         NA         NA      NA
## factor(age_m2)1:factor(marr)1:factor(trt)1         NA         NA      NA
## factor(age_m2)2:factor(marr)1:factor(trt)1         NA         NA      NA
##                                            Pr(&gt;|t|)  
## age                                          0.9070  
## I(age^2)                                     0.9551  
## factor(age_m2)1                              0.1095  
## factor(age_m2)2                              0.1514  
## educ                                         0.2811  
## I(educ^2)                                    0.1887  
## factor(race)1                                0.0320 *
## factor(race)2                                0.8921  
## factor(marr)1                                0.3091  
## factor(nodeg)1                               0.8581  
## factor(age_m2)1:factor(marr)0:factor(trt)0   0.5242  
## factor(age_m2)2:factor(marr)0:factor(trt)0   0.4152  
## factor(age_m2)1:factor(marr)1:factor(trt)0   0.4998  
## factor(age_m2)2:factor(marr)1:factor(trt)0   0.0827 .
## factor(age_m2)1:factor(marr)0:factor(trt)1   0.6366  
## factor(age_m2)2:factor(marr)0:factor(trt)1       NA  
## factor(age_m2)1:factor(marr)1:factor(trt)1       NA  
## factor(age_m2)2:factor(marr)1:factor(trt)1       NA  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6215 on 707 degrees of freedom
## Multiple R-squared:  0.4502, Adjusted R-squared:  0.4386 
## F-statistic:  38.6 on 15 and 707 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="regress-wage-on-training-status" class="section level2">
<h2 class="hasAnchor">
<a href="#regress-wage-on-training-status" class="anchor"></a>Regress Wage on Training Status</h2>
<div id="linear-binary-problem" class="section level3">
<h3 class="hasAnchor">
<a href="#linear-binary-problem" class="anchor"></a>Linear Binary Problem</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># Store Regression Results</span></a>
<a class="sourceLine" id="cb37-2" title="2">mt_model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>( <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(age<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(age_m2) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">                            </span>educ <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(educ<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="st">                          </span><span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)</a>
<a class="sourceLine" id="cb37-5" title="5">                          <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr) </a>
<a class="sourceLine" id="cb37-6" title="6">                          <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(nodeg)</a>
<a class="sourceLine" id="cb37-7" title="7">                          <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(age_m2)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(trt),</a>
<a class="sourceLine" id="cb37-8" title="8">                          <span class="dt">data =</span> dft)</a>
<a class="sourceLine" id="cb37-9" title="9">rs_wage_on_trt =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(re78 <span class="op">~</span><span class="st"> </span>mt_model <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> dft)</a>
<a class="sourceLine" id="cb37-10" title="10"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(rs_wage_on_trt))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = re78 ~ mt_model - 1, data = dft)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -9281  -4664  -1521   3260  54557 
## 
## Coefficients:
##                                        Estimate Std. Error t value Pr(&gt;|t|)  
## mt_model(Intercept)                   8890.8921  6129.7194   1.450    0.147  
## mt_modelage                             73.5664   317.3603   0.232    0.817  
## mt_modelI(age^2)                        -0.7038     4.7486  -0.148    0.882  
## mt_modelfactor(age_m2)2               -653.7465  1032.5521  -0.633    0.527  
## mt_modeleduc                         -1137.5178  1025.7038  -1.109    0.268  
## mt_modelI(educ^2)                       75.1320    56.3181   1.334    0.183  
## mt_modelfactor(race)1                -1782.6432   804.4433  -2.216    0.027 *
## mt_modelfactor(race)2                 -130.3132  1055.7904  -0.123    0.902  
## mt_modelfactor(marr)1                  590.5769   651.5151   0.906    0.365  
## mt_modelfactor(nodeg)1                 139.6452   916.7444   0.152    0.879  
## mt_modelfactor(age_m2)1:factor(trt)1   453.7963   659.7260   0.688    0.492  
## mt_modelfactor(age_m2)2:factor(trt)1  1070.8127   677.9949   1.579    0.115  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 6212 on 710 degrees of freedom
## Multiple R-squared:  0.4484, Adjusted R-squared:  0.4391 
## F-statistic:  48.1 on 12 and 710 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">rs_wage_on_trt_tidy =<span class="st"> </span><span class="kw">tidy</span>(rs_wage_on_trt)</a>
<a class="sourceLine" id="cb39-2" title="2">rs_wage_on_trt_tidy</a></code></pre></div>
<pre><code>## # A tibble: 12 x 5
##    term                                  estimate std.error statistic p.value
##    &lt;chr&gt;                                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 mt_model(Intercept)                   8891.      6130.       1.45   0.147 
##  2 mt_modelage                             73.6      317.       0.232  0.817 
##  3 mt_modelI(age^2)                        -0.704      4.75    -0.148  0.882 
##  4 mt_modelfactor(age_m2)2               -654.      1033.      -0.633  0.527 
##  5 mt_modeleduc                         -1138.      1026.      -1.11   0.268 
##  6 mt_modelI(educ^2)                       75.1       56.3      1.33   0.183 
##  7 mt_modelfactor(race)1                -1783.       804.      -2.22   0.0270
##  8 mt_modelfactor(race)2                 -130.      1056.      -0.123  0.902 
##  9 mt_modelfactor(marr)1                  591.       652.       0.906  0.365 
## 10 mt_modelfactor(nodeg)1                 140.       917.       0.152  0.879 
## 11 mt_modelfactor(age_m2)1:factor(trt)1   454.       660.       0.688  0.492 
## 12 mt_modelfactor(age_m2)2:factor(trt)1  1071.       678.       1.58   0.115</code></pre>
</div>
</div>
<div id="construct-input-arrays-a_i-and-alpha_i" class="section level2">
<h2 class="hasAnchor">
<a href="#construct-input-arrays-a_i-and-alpha_i" class="anchor"></a>Construct Input Arrays <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span>
</h2>
<div id="linear-binary-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#linear-binary-regression" class="anchor"></a>Linear Binary Regression</h3>
<p>Multiply coefficient vector by covariate matrix to generate <em>A</em> vector that is child/individual specific.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co"># Estimates Table</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(rs_wage_on_trt_tidy, <span class="dv">6</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   term                     estimate std.error statistic p.value
##   &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 mt_model(Intercept)      8891.      6130.       1.45    0.147
## 2 mt_modelage                73.6      317.       0.232   0.817
## 3 mt_modelI(age^2)           -0.704      4.75    -0.148   0.882
## 4 mt_modelfactor(age_m2)2  -654.      1033.      -0.633   0.527
## 5 mt_modeleduc            -1138.      1026.      -1.11    0.268
## 6 mt_modelI(educ^2)          75.1       56.3      1.33    0.183</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># Covariates</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(mt_model, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##   (Intercept) age I(age^2) factor(age_m2)2 educ I(educ^2) factor(race)1
## 1           1  23      529               0   10       100             1
## 2           1  26      676               1   12       144             0
## 3           1  22      484               0    9        81             1
## 4           1  34     1156               1    9        81             1
## 5           1  18      324               0    9        81             1
##   factor(race)2 factor(marr)1 factor(nodeg)1 factor(age_m2)1:factor(trt)1
## 1             0             0              1                            0
## 2             0             0              0                            0
## 3             0             0              1                            0
## 4             0             0              1                            0
## 5             0             0              1                            0
##   factor(age_m2)2:factor(trt)1
## 1                            0
## 2                            0
## 3                            0
## 4                            0
## 5                            0</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># Covariates coefficients from regression (including constant)</span></a>
<a class="sourceLine" id="cb45-2" title="2">ar_fl_cova_esti &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(rs_wage_on_trt_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="kw">str_detect</span>(term, <span class="st">'trt'</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(estimate))</a>
<a class="sourceLine" id="cb45-3" title="3">ar_fl_main_esti &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(rs_wage_on_trt_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">str_detect</span>(term, <span class="st">'trt'</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(estimate))</a>
<a class="sourceLine" id="cb45-4" title="4"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_fl_cova_esti, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##           estimate
## [1,]  8890.8920639
## [2,]    73.5663594
## [3,]    -0.7038167
## [4,]  -653.7464536
## [5,] -1137.5178067</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_fl_main_esti, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##       estimate
## [1,]  453.7963
## [2,] 1070.8127</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># Select Matrix subcomponents</span></a>
<a class="sourceLine" id="cb49-2" title="2">mt_cova &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw">as_tibble</span>(mt_model) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">contains</span>(<span class="st">"trt"</span>)))</a>
<a class="sourceLine" id="cb49-3" title="3">mt_intr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(marr) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> dft)</a>
<a class="sourceLine" id="cb49-4" title="4"></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="co"># Generate A_i, use mt_cova_wth_const</span></a>
<a class="sourceLine" id="cb49-6" title="6">ar_A_m &lt;-<span class="st"> </span>mt_cova <span class="op">%*%</span><span class="st"> </span>ar_fl_cova_esti</a>
<a class="sourceLine" id="cb49-7" title="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_A_m, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##      estimate
## [1,] 4705.623
## [2,] 6842.885
## [3,] 4373.738
## [4,] 4129.823
## [5,] 4192.084</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co"># Generate alpha_i</span></a>
<a class="sourceLine" id="cb51-2" title="2">ar_alpha_m &lt;-<span class="st"> </span>mt_intr <span class="op">%*%</span><span class="st"> </span>ar_fl_main_esti</a>
<a class="sourceLine" id="cb51-3" title="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_alpha_m, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##   estimate
## 1 453.7963
## 2 453.7963
## 3 453.7963
## 4 453.7963
## 5 453.7963</code></pre>
</div>
</div>
<div id="individual-weight" class="section level2">
<h2 class="hasAnchor">
<a href="#individual-weight" class="anchor"></a>Individual Weight</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># Child Weight</span></a>
<a class="sourceLine" id="cb53-2" title="2">ar_beta_m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_A_m), <span class="dt">times=</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_A_m))</a></code></pre></div>
</div>
<div id="matrix-with-required-inputs-for-allocation" class="section level2">
<h2 class="hasAnchor">
<a href="#matrix-with-required-inputs-for-allocation" class="anchor"></a>Matrix with Required Inputs for Allocation</h2>
<div id="linear-binary-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#linear-binary-matrix" class="anchor"></a>Linear Binary Matrix</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># Initate Dataframe that will store all estimates and optimal allocation relevant information</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co"># combine identifying key information along with estimation A, alpha results</span></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="co"># note that we only need indi.id as key</span></a>
<a class="sourceLine" id="cb54-4" title="4">mt_opti &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_alpha_m, ar_A_m, ar_beta_m)</a>
<a class="sourceLine" id="cb54-5" title="5">ar_st_varnames &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'alpha'</span>, <span class="st">'A'</span>, <span class="st">'beta'</span>)</a>
<a class="sourceLine" id="cb54-6" title="6">df_esti_alpha_A_beta &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_opti) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename_all</span>(<span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(ar_st_varnames))</a></code></pre></div>
<pre><code>## Warning: `as_tibble.matrix()` requires a matrix with column names or a `.name_repair` argument. Using compatibility `.name_repair`.
## This warning is displayed once per session.</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">tb_key_alpha_A_beta &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(dft, df_esti_alpha_A_beta) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="st">              </span><span class="kw">select</span>(<span class="kw">one_of</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'id'</span>, <span class="st">'trt'</span>, <span class="st">'age'</span>, <span class="st">'educ'</span>, <span class="st">'race'</span>, <span class="st">'marr'</span>, <span class="st">'nodeg'</span>, <span class="st">'re78'</span>,</a>
<a class="sourceLine" id="cb56-3" title="3">                              ar_st_varnames)))</a>
<a class="sourceLine" id="cb56-4" title="4"></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="co"># Rescale A and alpha to deal more easily with large powers</span></a>
<a class="sourceLine" id="cb56-6" title="6">tb_key_alpha_A_beta &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-7" title="7"><span class="st">                          </span><span class="kw">mutate</span>(<span class="dt">alpha =</span> alpha<span class="op">/</span><span class="dv">1000</span>, <span class="dt">A =</span> A<span class="op">/</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb56-8" title="8"></a>
<a class="sourceLine" id="cb56-9" title="9"><span class="co"># Need to only include the smokers here</span></a>
<a class="sourceLine" id="cb56-10" title="10"><span class="co"># tb_key_alpha_A_beta &lt;- tb_key_alpha_A_beta %&gt;% filter(trt == 0)</span></a>
<a class="sourceLine" id="cb56-11" title="11"></a>
<a class="sourceLine" id="cb56-12" title="12"><span class="co"># Unique beta, A, and alpha check</span></a>
<a class="sourceLine" id="cb56-13" title="13">tb_opti_unique &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="op">!!!</span><span class="kw">syms</span>(ar_st_varnames)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-14" title="14"><span class="st">                    </span><span class="kw">arrange</span>(<span class="op">!!!</span><span class="kw">syms</span>(ar_st_varnames)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-15" title="15"><span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">n_obs_group=</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb56-16" title="16"></a>
<a class="sourceLine" id="cb56-17" title="17"><span class="co"># Show cars</span></a>
<a class="sourceLine" id="cb56-18" title="18"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tb_key_alpha_A_beta, <span class="dv">32</span>)</a></code></pre></div>
<pre><code>##    id trt age educ race marr nodeg      re78     alpha        A        beta
## 1   1   0  23   10    1    0     1     0.000 0.4537963 4.705623 0.001385042
## 2   2   0  26   12    0    0     0 12383.680 0.4537963 6.842885 0.001385042
## 3   3   0  22    9    1    0     1     0.000 0.4537963 4.373738 0.001385042
## 4   4   0  34    9    1    0     1 14051.160 0.4537963 4.129823 0.001385042
## 5   5   0  18    9    1    0     1 10740.080 0.4537963 4.192084 0.001385042
## 6   6   0  45   11    1    0     1 11796.470 0.4537963 5.057681 0.001385042
## 7   7   0  18    9    1    0     1  9227.052 0.4537963 4.192084 0.001385042
## 8   8   0  27   12    1    0     0  3552.268 0.4537963 5.096506 0.001385042
## 9   9   0  24    8    0    0     1 10569.270 0.4537963 5.445291 0.001385042
## 10 10   0  34   11    1    1     1  6040.335 1.0708127 5.450645 0.001385042
## 11 11   0  20   13    1    0     0  9199.563 0.4537963 6.207626 0.001385042
## 12 12   0  24    4    2    0     1  3880.833 0.4537963 6.258713 0.001385042
## 13 13   0  36   10    1    0     1     0.000 0.4537963 4.468412 0.001385042
## 14 14   0  21   10    1    0     1     0.000 0.4537963 4.620426 0.001385042
## 15 15   0  28   12    1    1     0 10067.430 1.0708127 5.721940 0.001385042
## 16 16   0  21   14    1    0     0  5775.062 0.4537963 7.143382 0.001385042
## 17 17   0  28    9    1    0     1     0.000 0.4537963 3.950245 0.001385042
## 18 18   0  21   11    1    1     1  8976.826 1.0708127 5.651258 0.001385042
## 19 19   0  27    7    1    1     1     0.000 1.0708127 4.376777 0.001385042
## 20 20   0  18   12    0    0     0  2502.526 0.4537963 7.155844 0.001385042
## 21 21   0  19   11    0    0     1     0.000 0.4537963 6.752496 0.001385042
## 22 22   0  30   13    1    0     0     0.000 0.4537963 5.937635 0.001385042
## 23 23   0  26   11    2    0     1     0.000 0.4537963 6.261699 0.001385042
## 24 24   0  20    8    1    0     1     0.000 0.4537963 4.146000 0.001385042
## 25 25   0  31    4    0    0     1     0.000 0.4537963 6.633021 0.001385042
## 26 26   0  18   12    1    0     0 14444.710 0.4537963 5.373201 0.001385042
## 27 27   0  34   12    1    0     0  2113.722 0.4537963 5.310941 0.001385042
## 28 28   0  24   10    1    0     1  7618.639 0.4537963 4.092364 0.001385042
## 29 29   0  22    8    2    0     1  9920.945 0.4537963 5.886342 0.001385042
## 30 30   0  28    8    1    0     1  4623.188 0.4537963 3.810519 0.001385042
## 31 31   0  25   11    1    0     1  4196.375 0.4537963 4.571697 0.001385042
## 32 32   0  39    9    1    0     1     0.000 0.4537963 4.240762 0.001385042</code></pre>
</div>
</div>
</div>
<div id="optimal-linear-allocations" class="section level1">
<h1 class="hasAnchor">
<a href="#optimal-linear-allocations" class="anchor"></a>Optimal Linear Allocations</h1>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># Child Count</span></a>
<a class="sourceLine" id="cb58-2" title="2">it_obs =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(tb_opti_unique)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb58-3" title="3"></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="co"># Vector of Planner Preference</span></a>
<a class="sourceLine" id="cb58-5" title="5">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb58-6" title="6">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">-25</span>, <span class="dv">-10</span>)</a>
<a class="sourceLine" id="cb58-7" title="7">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-5</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb58-8" title="8">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">200</span>, <span class="dv">-100</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-25</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">-5</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">-1</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">-0.01</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.01</span>, <span class="fl">0.25</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.25</span>, <span class="fl">0.90</span>, <span class="dt">length.out=</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb58-9" title="9"><span class="co"># ar_rho &lt;- c(-100, -5, -1, 0.1, 0.6, 0.99)</span></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="co"># ar_rho &lt;- c(-20, -1, 0.05, 0.9)</span></a>
<a class="sourceLine" id="cb58-11" title="11"><span class="co"># ar_rho &lt;- c(-50, -40, -30, -20, -15, -10, -7.5, -5,-3,-2,-1)</span></a>
<a class="sourceLine" id="cb58-12" title="12"><span class="co"># ar_rho = c(-100, -0.001,  0.95)</span></a>
<a class="sourceLine" id="cb58-13" title="13">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(ar_rho)</a>
<a class="sourceLine" id="cb58-14" title="14"></a>
<a class="sourceLine" id="cb58-15" title="15">ls_bin_solu_all_rhos &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb58-16" title="16"><span class="st">  </span><span class="kw"><a href="../reference/ffp_opt_anlyz_rhgin_bin.html">ffp_opt_anlyz_rhgin_bin</a></span>(tb_key_alpha_A_beta, <span class="dt">svr_id_i =</span> <span class="st">'id'</span>,</a>
<a class="sourceLine" id="cb58-17" title="17">                          <span class="dt">svr_A_i =</span> <span class="st">'A'</span>, <span class="dt">svr_alpha_i =</span> <span class="st">'alpha'</span>, <span class="dt">svr_beta_i =</span> <span class="st">'beta'</span>,</a>
<a class="sourceLine" id="cb58-18" title="18">                          <span class="dt">ar_rho =</span> ar_rho,</a>
<a class="sourceLine" id="cb58-19" title="19">                          <span class="dt">svr_inpalc =</span> <span class="st">'opti_alloc_queue'</span>,</a>
<a class="sourceLine" id="cb58-20" title="20">                          <span class="dt">svr_expout =</span> <span class="st">'opti_exp_outcome'</span>)</a></code></pre></div>
<pre><code>##        id              trt              age             educ      
##  Min.   :   1.0   Min.   :0.0000   Min.   :17.00   Min.   : 3.00  
##  1st Qu.: 181.2   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.: 9.00  
##  Median : 361.5   Median :0.0000   Median :23.00   Median :10.00  
##  Mean   : 854.4   Mean   :0.4114   Mean   :24.52   Mean   :10.27  
##  3rd Qu.:1458.5   3rd Qu.:1.0000   3rd Qu.:27.00   3rd Qu.:11.00  
##  Max.   :4110.0   Max.   :1.0000   Max.   :55.00   Max.   :16.00  
##       race            marr           nodeg             re78      
##  Min.   :0.000   Min.   :0.000   Min.   :0.0000   Min.   :    0  
##  1st Qu.:1.000   1st Qu.:0.000   1st Qu.:1.0000   1st Qu.:    0  
##  Median :1.000   Median :0.000   Median :1.0000   Median : 3952  
##  Mean   :1.011   Mean   :0.162   Mean   :0.7798   Mean   : 5455  
##  3rd Qu.:1.000   3rd Qu.:0.000   3rd Qu.:1.0000   3rd Qu.: 8772  
##  Max.   :2.000   Max.   :1.000   Max.   :1.0000   Max.   :60308  
##      alpha              A              beta            rho_c1_rk    
##  Min.   :0.4538   Min.   :3.673   Min.   :0.001385   Min.   :  2.0  
##  1st Qu.:0.4538   1st Qu.:4.433   1st Qu.:0.001385   1st Qu.:183.0  
##  Median :0.4538   Median :4.970   Median :0.001385   Median :364.0  
##  Mean   :0.5538   Mean   :5.146   Mean   :0.001385   Mean   :363.8  
##  3rd Qu.:0.4538   3rd Qu.:5.687   3rd Qu.:0.001385   3rd Qu.:543.0  
##  Max.   :1.0708   Max.   :9.420   Max.   :0.001385   Max.   :722.0  
##    rho_c2_rk       rho_c3_rk       rho_c4_rk       rho_c5_rk    
##  Min.   :  2.0   Min.   :  2.0   Min.   :  2.0   Min.   :  2.0  
##  1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0  
##  Median :364.0   Median :364.0   Median :364.0   Median :364.0  
##  Mean   :363.8   Mean   :363.8   Mean   :363.8   Mean   :363.8  
##  3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0  
##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  
##    rho_c6_rk       rho_c7_rk       rho_c8_rk       rho_c9_rk    
##  Min.   :  2.0   Min.   :  2.0   Min.   :  2.0   Min.   :  2.0  
##  1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0  
##  Median :364.0   Median :364.0   Median :364.0   Median :364.0  
##  Mean   :363.8   Mean   :363.8   Mean   :363.8   Mean   :363.8  
##  3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0  
##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  
##    rho_c10_rk      rho_c11_rk      rho_c12_rk      rho_c13_rk   
##  Min.   :  2.0   Min.   :  2.0   Min.   :  2.0   Min.   :  2.0  
##  1st Qu.:183.0   1st Qu.:183.0   1st Qu.:185.0   1st Qu.:184.0  
##  Median :366.0   Median :366.0   Median :370.0   Median :363.0  
##  Mean   :363.8   Mean   :363.8   Mean   :363.8   Mean   :363.8  
##  3rd Qu.:542.0   3rd Qu.:543.0   3rd Qu.:546.0   3rd Qu.:543.0  
##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  
##    rho_c14_rk      rho_c15_rk      rho_c16_rk      rho_c17_rk   
##  Min.   :  2.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  
##  1st Qu.:181.8   1st Qu.:181.2   1st Qu.:181.2   1st Qu.:197.0  
##  Median :362.0   Median :363.0   Median :362.0   Median :365.0  
##  Mean   :363.8   Mean   :363.8   Mean   :363.8   Mean   :363.8  
##  3rd Qu.:541.8   3rd Qu.:544.0   3rd Qu.:543.0   3rd Qu.:542.0  
##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  
##    rho_c18_rk      rho_c19_rk      rho_c20_rk      rho_c21_rk   
##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  
##  1st Qu.:182.0   1st Qu.:182.0   1st Qu.:182.0   1st Qu.:183.0  
##  Median :367.0   Median :362.0   Median :363.0   Median :363.0  
##  Mean   :363.8   Mean   :363.8   Mean   :363.8   Mean   :363.8  
##  3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0  
##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  
##    rho_c22_rk      rho_c23_rk      rho_c24_rk      rho_c25_rk   
##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  
##  1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0  
##  Median :363.0   Median :363.0   Median :363.0   Median :363.0  
##  Mean   :363.8   Mean   :363.8   Mean   :363.8   Mean   :363.8  
##  3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0  
##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  
##    rho_c26_rk      rho_c27_rk      rho_c28_rk      rho_c29_rk   
##  Min.   :  1.0   Min.   :  1.0   Min.   :  1.0   Min.   :  1.0  
##  1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0   1st Qu.:183.0  
##  Median :363.0   Median :363.0   Median :363.0   Median :363.0  
##  Mean   :363.8   Mean   :363.8   Mean   :363.8   Mean   :363.8  
##  3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0   3rd Qu.:543.0  
##  Max.   :722.0   Max.   :722.0   Max.   :722.0   Max.   :722.0  
##    rho_c30_rk   
##  Min.   :  1.0  
##  1st Qu.:183.0  
##  Median :363.0  
##  Mean   :363.8  
##  3rd Qu.:543.0  
##  Max.   :722.0  
## 'data.frame':    722 obs. of  41 variables:
##  $ id        : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ trt       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ age       : int  23 26 22 34 18 45 18 27 24 34 ...
##  $ educ      : int  10 12 9 9 9 11 9 12 8 11 ...
##  $ race      : num  1 0 1 1 1 1 1 1 0 1 ...
##  $ marr      : int  0 0 0 0 0 0 0 0 0 1 ...
##  $ nodeg     : int  1 0 1 1 1 1 1 0 1 1 ...
##  $ re78      : num  0 12384 0 14051 10740 ...
##  $ alpha     : num  0.454 0.454 0.454 0.454 0.454 ...
##  $ A         : num  4.71 6.84 4.37 4.13 4.19 ...
##  $ beta      : num  0.00139 0.00139 0.00139 0.00139 0.00139 ...
##  $ rho_c1_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c2_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c3_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c4_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c5_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c6_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c7_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c8_rk : int  284 673 163 61 106 399 106 416 495 496 ...
##  $ rho_c9_rk : int  289 673 164 61 106 400 106 418 496 494 ...
##  $ rho_c10_rk: int  289 674 164 61 106 401 106 419 497 491 ...
##  $ rho_c11_rk: int  294 674 166 61 106 403 106 423 498 485 ...
##  $ rho_c12_rk: int  303 675 167 61 108 415 108 436 504 481 ...
##  $ rho_c13_rk: int  316 684 184 68 114 436 114 453 515 380 ...
##  $ rho_c14_rk: int  339 688 192 69 121 450 121 466 519 351 ...
##  $ rho_c15_rk: int  345 689 202 90 137 453 137 469 522 309 ...
##  $ rho_c16_rk: int  362 689 231 115 172 460 172 477 530 199 ...
##  $ rho_c17_rk: int  378 689 255 150 197 478 197 494 544 68 ...
##  $ rho_c18_rk: int  387 689 263 156 205 482 205 498 545 68 ...
##  $ rho_c19_rk: int  391 689 273 164 214 483 214 499 545 68 ...
##  $ rho_c20_rk: int  392 689 278 177 223 483 223 499 545 68 ...
##  $ rho_c21_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c22_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c23_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c24_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c25_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c26_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c27_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c28_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c29_rk: int  392 689 278 178 223 483 223 499 545 68 ...
##  $ rho_c30_rk: int  392 689 278 178 223 483 223 499 545 68 ...</code></pre>
<pre><code>## Joining, by = "id"</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">df_all_rho &lt;-<span class="st"> </span>ls_bin_solu_all_rhos<span class="op">$</span>df_all_rho</a>
<a class="sourceLine" id="cb61-2" title="2">df_all_rho_long &lt;-<span class="st"> </span>ls_bin_solu_all_rhos<span class="op">$</span>df_all_rho_long</a>
<a class="sourceLine" id="cb61-3" title="3"></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co"># How many people have different ranks across rhos</span></a>
<a class="sourceLine" id="cb61-5" title="5">it_how_many_vary_rank &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(df_all_rho<span class="op">$</span>rank_max <span class="op">-</span><span class="st"> </span>df_all_rho<span class="op">$</span>rank_min)</a>
<a class="sourceLine" id="cb61-6" title="6">it_how_many_vary_rank</a></code></pre></div>
<pre><code>## [1] 98120</code></pre>
<div id="bump-plot-for-optimal-binary-allocations" class="section level2">
<h2 class="hasAnchor">
<a href="#bump-plot-for-optimal-binary-allocations" class="anchor"></a>Bump Plot for Optimal Binary Allocations</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># tb_opti_alloc_all_rho_long %&gt;%</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="co">#   ggplot(aes(x = rho, y = rank, group = id)) +</span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="co">#     geom_line(aes(color = race, alpha = 1), size = 2) +</span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="co">#     geom_point(aes(color = race, alpha = 1), size = 4) +</span></a>
<a class="sourceLine" id="cb63-5" title="5"><span class="co">#     scale_x_discrete(expand = c(0.85,0))+</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="co">#     scale_y_reverse(breaks = 1:nrow(tb_opti_alloc_all_rho_long))+</span></a>
<a class="sourceLine" id="cb63-7" title="7"><span class="co">#     theme(legend.position = "none") +</span></a>
<a class="sourceLine" id="cb63-8" title="8"><span class="co">#     labs(x = "Equality vs Efficiency",</span></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="co">#          y = "Rank",</span></a>
<a class="sourceLine" id="cb63-10" title="10"><span class="co">#          title = "Binary Allocation Rank, which untrained to receive training first") +</span></a>
<a class="sourceLine" id="cb63-11" title="11"><span class="co">#     ffy_opt_ghthm_dk() +</span></a>
<a class="sourceLine" id="cb63-12" title="12"><span class="co">#     geom_text(data =tb_opti_alloc_all_rho,aes(y=rho_c1_rk,x=0.6,label=id),hjust="right")</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#objective">Objective</a></li>
      <li>
<a href="#load-packages-and-data">Load Packages and Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#load-dependencies">Load Dependencies</a></li>
      <li><a href="#load-data-and-generate-new-variables">Load Data and Generate New Variables</a></li>
      </ul>
</li>
      <li>
<a href="#regression-with-data-and-construct-input-arrays">Regression with Data and Construct Input Arrays</a><ul class="nav nav-pills nav-stacked">
<li><a href="#tabulate-and-summarize-averages">Tabulate and Summarize Averages</a></li>
      <li><a href="#tabulate">Tabulate</a></li>
      <li><a href="#regression-testing">Regression Testing</a></li>
      <li><a href="#regress-wage-on-training-status">Regress Wage on Training Status</a></li>
      <li><a href="#construct-input-arrays-a_i-and-alpha_i">Construct Input Arrays <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span></a></li>
      <li><a href="#individual-weight">Individual Weight</a></li>
      <li><a href="#matrix-with-required-inputs-for-allocation">Matrix with Required Inputs for Allocation</a></li>
      </ul>
</li>
      <li>
<a href="#optimal-linear-allocations">Optimal Linear Allocations</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bump-plot-for-optimal-binary-allocations">Bump Plot for Optimal Binary Allocations</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Fan Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
