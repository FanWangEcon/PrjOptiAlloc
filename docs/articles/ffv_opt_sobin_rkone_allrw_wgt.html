<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BINARY--Birth Weight and Doctors Visit Optimal Allocation Solution (Line by Line) • PrjOptiAlloc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BINARY--Birth Weight and Doctors Visit Optimal Allocation Solution (Line by Line)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PrjOptiAlloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ffv_opt_anlyz_rhgin.html">ANALYSIS--Optimal Allocations Planner Elasticity Vector and Ginis</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_dtgch_cbem4.html">DATA--Generate Data Cebu Four Category Test Regression Results</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allfc_training_logit.html">BINARY--NSW Training EMPLOYMENT as Outcome Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_car.html">BINARY--MPG and Shift Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_training.html">BINARY--NSW Training WAGE Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_wgt.html">BINARY--Birth Weight and Doctors Visit Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sodis_rkone_allrw_casch.html">DISCRETE--Discrete Provision Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow.html">LINEAR--Optimal Linear Allocation based On Relative Allocation to Lowest</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allfn.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Function)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allrw.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solog_bisec_allrw.html">LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Implicit Bisection Solution (Line by Line)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>BINARY–Birth Weight and Doctors Visit Optimal Allocation Solution (Line by Line)</h1>
            
      
      
      <div class="hidden name"><code>ffv_opt_sobin_rkone_allrw_wgt.Rmd</code></div>

    </div>

    
    
<p>Back to <strong><a href="https://fanwangecon.github.io/">Fan</a></strong>’s Optimal Allocation Homepage <strong><a href="https://fanwangecon.github.io/PrjOptiAllo==c/">Table of Content</a></strong></p>
<div id="objective" class="section level1">
<h1 class="hasAnchor">
<a href="#objective" class="anchor"></a>Objective</h1>
<p>The effects of mother’s smoking status on birth weight. If we aim to improve health outcomes, what is the priority sequence of mothers whom we would want to discourage from smoking.</p>
</div>
<div id="load-packages-and-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-packages-and-data" class="anchor"></a>Load Packages and Data</h1>
<div id="load-dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#load-dependencies" class="anchor"></a>Load Dependencies</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="dt">all.names =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">knitr.duplicate.label =</span> <span class="st">'allow'</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tibble)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stringr)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(broom)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(REconTools)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PrjOptiAlloc)</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra)</a></code></pre></div>
</div>
<div id="load-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load Data</h2>
<p>Generate four categories by initial height and mother’s education levels combinations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Load Data</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(df_opt_birthwt)</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># Summarize</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(df_opt_birthwt)</a></code></pre></div>
<pre><code>## 'data.frame':    189 obs. of  11 variables:
##  $ Index: int  85 86 87 88 89 91 92 93 94 95 ...
##  $ low  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ age  : int  19 33 20 21 18 21 22 17 29 26 ...
##  $ lwt  : int  182 155 105 108 107 124 118 103 123 113 ...
##  $ race : int  2 3 1 1 1 3 1 3 1 1 ...
##  $ smoke: int  0 0 1 1 1 0 0 0 1 1 ...
##  $ ptl  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ht   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ui   : int  1 0 0 1 1 0 0 0 0 0 ...
##  $ ftv  : int  0 3 1 2 0 0 1 1 1 0 ...
##  $ bwt  : int  2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(df_opt_birthwt)</a></code></pre></div>
<pre><code>##      Index            low              age             lwt       
##  Min.   :  4.0   Min.   :0.0000   Min.   :14.00   Min.   : 80.0  
##  1st Qu.: 68.0   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0  
##  Median :123.0   Median :0.0000   Median :23.00   Median :121.0  
##  Mean   :121.1   Mean   :0.3122   Mean   :23.24   Mean   :129.8  
##  3rd Qu.:176.0   3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0  
##  Max.   :226.0   Max.   :1.0000   Max.   :45.00   Max.   :250.0  
##       race           smoke             ptl               ht         
##  Min.   :1.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  
##  1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000  
##  Median :1.000   Median :0.0000   Median :0.0000   Median :0.00000  
##  Mean   :1.847   Mean   :0.3915   Mean   :0.1958   Mean   :0.06349  
##  3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.00000  
##  Max.   :3.000   Max.   :1.0000   Max.   :3.0000   Max.   :1.00000  
##        ui              ftv              bwt      
##  Min.   :0.0000   Min.   :0.0000   Min.   : 709  
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2414  
##  Median :0.0000   Median :0.0000   Median :2977  
##  Mean   :0.1481   Mean   :0.7937   Mean   :2945  
##  3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:3487  
##  Max.   :1.0000   Max.   :6.0000   Max.   :4990</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Generate Discrete Version of continuous variables</span></a>
<a class="sourceLine" id="cb7-2" title="2">df_opt_birthwt &lt;-<span class="st"> </span>df_opt_birthwt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">momwgtLowHigh =</span> <span class="kw"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(lwt,</a>
<a class="sourceLine" id="cb7-4" title="4">                               <span class="dt">breaks=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="dv">129</span>, <span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb7-5" title="5">                               <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"LW"</span>,<span class="st">"HW"</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">mombirthage =</span> <span class="kw"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(age,</a>
<a class="sourceLine" id="cb7-7" title="7">                               <span class="dt">breaks=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="dv">24</span>, <span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb7-8" title="8">                               <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"young"</span>,<span class="st">"older"</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">ftvm3 =</span> <span class="kw"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(ftv,</a>
<a class="sourceLine" id="cb7-10" title="10">                               <span class="dt">breaks=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb7-11" title="11">                               <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"novisit"</span>,<span class="st">"1visit"</span>,<span class="st">"morevisit"</span>)))</a>
<a class="sourceLine" id="cb7-12" title="12"></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(df_opt_birthwt)</a>
<a class="sourceLine" id="cb7-14" title="14"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(df_opt_birthwt)</a></code></pre></div>
<pre><code>##      Index            low              age             lwt       
##  Min.   :  4.0   Min.   :0.0000   Min.   :14.00   Min.   : 80.0  
##  1st Qu.: 68.0   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0  
##  Median :123.0   Median :0.0000   Median :23.00   Median :121.0  
##  Mean   :121.1   Mean   :0.3122   Mean   :23.24   Mean   :129.8  
##  3rd Qu.:176.0   3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0  
##  Max.   :226.0   Max.   :1.0000   Max.   :45.00   Max.   :250.0  
##       race           smoke             ptl               ht         
##  Min.   :1.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  
##  1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000  
##  Median :1.000   Median :0.0000   Median :0.0000   Median :0.00000  
##  Mean   :1.847   Mean   :0.3915   Mean   :0.1958   Mean   :0.06349  
##  3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.00000  
##  Max.   :3.000   Max.   :1.0000   Max.   :3.0000   Max.   :1.00000  
##        ui              ftv              bwt       momwgtLowHigh mombirthage
##  Min.   :0.0000   Min.   :0.0000   Min.   : 709   LW:110        young:120  
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2414   HW: 79        older: 69  
##  Median :0.0000   Median :0.0000   Median :2977                            
##  Mean   :0.1481   Mean   :0.7937   Mean   :2945                            
##  3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:3487                            
##  Max.   :1.0000   Max.   :6.0000   Max.   :4990                            
##        ftvm3    
##  novisit  :147  
##  1visit   : 30  
##  morevisit: 12  
##                 
##                 
## </code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># tabulate</span></a>
<a class="sourceLine" id="cb9-2" title="2">df_opt_birthwt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(race, smoke, ftv) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">freq =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> race, <span class="dt">values_from =</span> freq)</a></code></pre></div>
<pre><code>## # A tibble: 11 x 5
## # Groups:   smoke [2]
##    smoke   ftv   `1`   `2`   `3`
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     0     0    13     8    34
##  2     0     1    20     4    11
##  3     0     2     9     3     7
##  4     0     3     1    NA     2
##  5     0     4     1     1     1
##  6     1     0    30     6     9
##  7     1     1     9     2     1
##  8     1     2     9     1     1
##  9     1     3     3     1    NA
## 10     1     4     1    NA    NA
## 11     1     6    NA    NA     1</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(mombirthage) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ht) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ui)))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(mombirthage) + factor(race) + 
##     factor(ht) + factor(ui))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1594.45  -453.35    40.06   468.89  1891.04 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              2572.173    237.094  10.849  &lt; 2e-16 ***
## lwt                         5.216      1.735   3.006  0.00302 ** 
## factor(mombirthage)older -114.841    102.918  -1.116  0.26596    
## factor(race)2            -453.756    150.971  -3.006  0.00302 ** 
## factor(race)3            -216.550    108.069  -2.004  0.04657 *  
## factor(ht)1              -633.028    205.271  -3.084  0.00236 ** 
## factor(ui)1              -563.302    138.153  -4.077  6.8e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 664.4 on 182 degrees of freedom
## Multiple R-squared:  0.1964, Adjusted R-squared:  0.1699 
## F-statistic: 7.412 on 6 and 182 DF,  p-value: 4.131e-07</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2360.77  -434.48    42.18   469.28  1710.36 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                             3.711      1.739   2.134 0.034154 *  
## age                            -4.760     10.054  -0.473 0.636500    
## factor(race)1                3037.381    339.863   8.937 4.55e-16 ***
## factor(race)2                2394.843    344.390   6.954 6.25e-11 ***
## factor(race)3                2480.085    293.002   8.464 8.57e-15 ***
## factor(race)1:factor(smoke)1 -570.605    143.546  -3.975 0.000102 ***
## factor(race)2:factor(smoke)1 -305.314    277.419  -1.101 0.272553    
## factor(race)3:factor(smoke)1  -75.981    216.468  -0.351 0.725994    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 678.9 on 181 degrees of freedom
## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 
## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2360.77  -434.48    42.18   469.28  1710.36 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                             3.711      1.739   2.134 0.034154 *  
## age                            -4.760     10.054  -0.473 0.636500    
## factor(race)1                3037.381    339.863   8.937 4.55e-16 ***
## factor(race)2                2394.843    344.390   6.954 6.25e-11 ***
## factor(race)3                2480.085    293.002   8.464 8.57e-15 ***
## factor(race)1:factor(smoke)1 -570.605    143.546  -3.975 0.000102 ***
## factor(race)2:factor(smoke)1 -305.314    277.419  -1.101 0.272553    
## factor(race)3:factor(smoke)1  -75.981    216.468  -0.351 0.725994    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 678.9 on 181 degrees of freedom
## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 
## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ftv) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ factor(ftv) - 1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2156.1  -484.1     0.0   578.9  1882.0 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## factor(ftv)0  2865.14      72.57  39.481  &lt; 2e-16 ***
## factor(ftv)1  3108.00     105.85  29.361  &lt; 2e-16 ***
## factor(ftv)2  3010.33     132.49  22.721  &lt; 2e-16 ***
## factor(ftv)3  2521.86     274.29   9.194  &lt; 2e-16 ***
## factor(ftv)4  3167.75     362.85   8.730 1.57e-15 ***
## factor(ftv)6  3303.00     725.70   4.551 9.69e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 725.7 on 183 degrees of freedom
## Multiple R-squared:  0.9446, Adjusted R-squared:  0.9428 
## F-statistic: 519.8 on 6 and 183 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ftv) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ht) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ui) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ptl) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ factor(ftv) + factor(ht) + factor(ui) + factor(ptl) - 
##     1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1549.7  -443.4    30.2   490.4  1689.2 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## factor(ftv)0  3046.85      75.04  40.605  &lt; 2e-16 ***
## factor(ftv)1  3300.80     104.23  31.669  &lt; 2e-16 ***
## factor(ftv)2  3138.61     124.69  25.172  &lt; 2e-16 ***
## factor(ftv)3  2668.40     255.84  10.430  &lt; 2e-16 ***
## factor(ftv)4  3419.95     343.36   9.960  &lt; 2e-16 ***
## factor(ftv)6  3303.00     669.62   4.933 1.85e-06 ***
## factor(ht)1   -457.90     203.35  -2.252 0.025560 *  
## factor(ui)1   -567.88     143.45  -3.959 0.000109 ***
## factor(ptl)1  -504.40     152.28  -3.312 0.001121 ** 
## factor(ptl)2  -154.48     308.71  -0.500 0.617411    
## factor(ptl)3  1158.03     684.48   1.692 0.092428 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 669.6 on 178 degrees of freedom
## Multiple R-squared:  0.9541, Adjusted R-squared:  0.9513 
## F-statistic: 336.3 on 11 and 178 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span>(ftv) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(race) + (ftv) - 1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2088.45  -445.67    49.21   489.85  1927.65 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## lwt              4.609      1.769   2.605  0.00993 ** 
## factor(race)1 2483.595    243.002  10.220  &lt; 2e-16 ***
## factor(race)2 2033.475    292.413   6.954 5.99e-11 ***
## factor(race)3 2244.345    227.567   9.862  &lt; 2e-16 ***
## ftv             11.821     49.171   0.240  0.81028    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 704.9 on 184 degrees of freedom
## Multiple R-squared:  0.9474, Adjusted R-squared:  0.946 
## F-statistic: 663.1 on 5 and 184 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div id="regression-with-data-and-construct-input-arrays" class="section level1">
<h1 class="hasAnchor">
<a href="#regression-with-data-and-construct-input-arrays" class="anchor"></a>Regression with Data and Construct Input Arrays</h1>
<div id="binary-problem-regress-birth-weight-on-mothers-smoking-status" class="section level2">
<h2 class="hasAnchor">
<a href="#binary-problem-regress-birth-weight-on-mothers-smoking-status" class="anchor"></a>Binary Problem Regress Birth Weight on Mother’s Smoking Status</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># A. Regress child birth weight on mother's age, race and mother's weight</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(mombirthage) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race))))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(mombirthage) + factor(race))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2032.96  -430.84    31.49   454.21  1985.68 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              2494.551    242.319  10.294  &lt; 2e-16 ***
## lwt                         4.910      1.774   2.767  0.00623 ** 
## factor(mombirthage)older  -94.175    108.852  -0.865  0.38808    
## factor(race)2            -473.966    159.734  -2.967  0.00340 ** 
## factor(race)3            -247.629    114.199  -2.168  0.03141 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 703.5 on 184 degrees of freedom
## Multiple R-squared:  0.08898,    Adjusted R-squared:  0.06918 
## F-statistic: 4.493 on 4 and 184 DF,  p-value: 0.001736</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(mombirthage) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ht) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ui))))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(mombirthage) + factor(race) + 
##     factor(ht) + factor(ui))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1594.45  -453.35    40.06   468.89  1891.04 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              2572.173    237.094  10.849  &lt; 2e-16 ***
## lwt                         5.216      1.735   3.006  0.00302 ** 
## factor(mombirthage)older -114.841    102.918  -1.116  0.26596    
## factor(race)2            -453.756    150.971  -3.006  0.00302 ** 
## factor(race)3            -216.550    108.069  -2.004  0.04657 *  
## factor(ht)1              -633.028    205.271  -3.084  0.00236 ** 
## factor(ui)1              -563.302    138.153  -4.077  6.8e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 664.4 on 182 degrees of freedom
## Multiple R-squared:  0.1964, Adjusted R-squared:  0.1699 
## F-statistic: 7.412 on 6 and 182 DF,  p-value: 4.131e-07</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ht) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ui) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ptl))))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(ht) + factor(ui) + 
##     factor(ptl))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1657.31  -411.29    36.18   456.73  1767.04 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2579.886    300.172   8.595 4.05e-15 ***
## lwt              4.764      1.734   2.748  0.00661 ** 
## age              1.269      9.530   0.133  0.89423    
## factor(race)2 -395.097    150.621  -2.623  0.00946 ** 
## factor(race)3 -180.030    107.653  -1.672  0.09621 .  
## factor(ht)1   -600.670    202.597  -2.965  0.00344 ** 
## factor(ui)1   -557.704    140.164  -3.979  0.00010 ***
## factor(ptl)1  -378.084    146.938  -2.573  0.01089 *  
## factor(ptl)2   -85.706    300.941  -0.285  0.77613    
## factor(ptl)3  1130.511    672.124   1.682  0.09431 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 654.1 on 179 degrees of freedom
## Multiple R-squared:  0.2339, Adjusted R-squared:  0.1954 
## F-statistic: 6.072 on 9 and 179 DF,  p-value: 1.975e-07</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke))))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(smoke))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2281.9  -449.1    24.3   474.1  1746.2 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2839.433    321.435   8.834  8.2e-16 ***
## lwt               4.000      1.738   2.301  0.02249 *  
## age              -1.948      9.820  -0.198  0.84299    
## factor(race)2  -510.501    157.077  -3.250  0.00137 ** 
## factor(race)3  -398.644    119.579  -3.334  0.00104 ** 
## factor(smoke)1 -401.720    109.241  -3.677  0.00031 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 682.1 on 183 degrees of freedom
## Multiple R-squared:  0.1483, Adjusted R-squared:  0.125 
## F-statistic: 6.373 on 5 and 183 DF,  p-value: 1.758e-05</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ht) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ui) <span class="op">+</span><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke))))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(ht) + factor(ui) + 
##     factor(smoke))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1819.85  -452.86    59.91   460.49  1726.15 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2933.466    310.773   9.439  &lt; 2e-16 ***
## lwt               4.396      1.707   2.575 0.010815 *  
## age              -4.673      9.337  -0.500 0.617383    
## factor(race)2  -490.638    149.188  -3.289 0.001209 ** 
## factor(race)3  -356.613    113.856  -3.132 0.002024 ** 
## factor(ht)1    -590.029    200.290  -2.946 0.003644 ** 
## factor(ui)1    -528.534    135.088  -3.913 0.000129 ***
## factor(smoke)1 -360.708    104.027  -3.467 0.000656 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 647.3 on 181 degrees of freedom
## Multiple R-squared:  0.2414, Adjusted R-squared:  0.2121 
## F-statistic:  8.23 on 7 and 181 DF,  p-value: 1.057e-08</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(momwgtLowHigh)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(momwgtLowHigh):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2075.34  -433.57    33.95   512.59  1781.49 
## 
## Coefficients:
##                                        Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                                       4.639      2.584   1.795   0.0743 .  
## age                                       7.426     10.009   0.742   0.4591    
## factor(momwgtLowHigh)LW:factor(smoke)0 2303.715    360.918   6.383 1.39e-09 ***
## factor(momwgtLowHigh)HW:factor(smoke)0 2236.467    462.299   4.838 2.78e-06 ***
## factor(momwgtLowHigh)LW:factor(smoke)1 2019.699    358.516   5.634 6.57e-08 ***
## factor(momwgtLowHigh)HW:factor(smoke)1 1987.478    473.861   4.194 4.26e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 712.3 on 183 degrees of freedom
## Multiple R-squared:  0.9466, Adjusted R-squared:  0.9448 
## F-statistic: 540.6 on 6 and 183 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ht) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ui) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke))))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(ht) + factor(ui) + factor(race) + 
##     factor(race):factor(smoke))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1866.50  -416.40    20.14   404.49  1678.65 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  3103.394    329.074   9.431  &lt; 2e-16 ***
## lwt                             3.950      1.714   2.305  0.02234 *  
## age                            -6.177      9.543  -0.647  0.51833    
## factor(ht)1                  -543.753    200.920  -2.706  0.00746 ** 
## factor(ui)1                  -550.326    136.026  -4.046 7.75e-05 ***
## factor(race)2                -544.929    199.565  -2.731  0.00695 ** 
## factor(race)3                -500.559    138.465  -3.615  0.00039 ***
## factor(race)1:factor(smoke)1 -497.444    137.338  -3.622  0.00038 ***
## factor(race)2:factor(smoke)1 -414.559    264.495  -1.567  0.11880    
## factor(race)3:factor(smoke)1  -13.101    207.582  -0.063  0.94975    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 644 on 179 degrees of freedom
## Multiple R-squared:  0.2573, Adjusted R-squared:  0.2199 
## F-statistic:  6.89 on 9 and 179 DF,  p-value: 1.69e-08</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2360.77  -434.48    42.18   469.28  1710.36 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                             3.711      1.739   2.134 0.034154 *  
## age                            -4.760     10.054  -0.473 0.636500    
## factor(race)1                3037.381    339.863   8.937 4.55e-16 ***
## factor(race)2                2394.843    344.390   6.954 6.25e-11 ***
## factor(race)3                2480.085    293.002   8.464 8.57e-15 ***
## factor(race)1:factor(smoke)1 -570.605    143.546  -3.975 0.000102 ***
## factor(race)2:factor(smoke)1 -305.314    277.419  -1.101 0.272553    
## factor(race)3:factor(smoke)1  -75.981    216.468  -0.351 0.725994    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 678.9 on 181 degrees of freedom
## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 
## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># Preferred way of appearing, in the following regression we can se:</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co"># 1. more more power less MPG, Straight engine slightly higher MPG</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="co"># 2. V-shape engine car, going from auto to manual trans gain 4.1 MPG</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co"># 2. straight shape engine, going from auto to manual trans gain 6.67 MPG</span></a>
<a class="sourceLine" id="cb39-5" title="5"></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co"># Store Regression Results</span></a>
<a class="sourceLine" id="cb39-7" title="7">mt_model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ht) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ui) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ptl) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(smoke)<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race))</a>
<a class="sourceLine" id="cb39-8" title="8">rs_wgt_on_smke =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(bwt <span class="op">~</span><span class="st"> </span>mt_model <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb39-9" title="9"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(rs_wgt_on_smke))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ mt_model - 1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1863.18  -380.81    12.97   406.28  1623.16 
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(&gt;|t|)    
## mt_model(Intercept)                  3052.734    325.825   9.369  &lt; 2e-16 ***
## mt_modellwt                             3.926      1.700   2.309 0.022110 *  
## mt_modelage                            -3.750      9.580  -0.391 0.695949    
## mt_modelfactor(ht)1                  -530.489    198.071  -2.678 0.008101 ** 
## mt_modelfactor(ui)1                  -570.137    137.361  -4.151 5.16e-05 ***
## mt_modelfactor(ptl)1                 -281.977    145.534  -1.938 0.054281 .  
## mt_modelfactor(ptl)2                  -50.395    293.124  -0.172 0.863695    
## mt_modelfactor(ptl)3                 1347.020    654.426   2.058 0.041033 *  
## mt_modelfactor(race)2                -501.650    198.139  -2.532 0.012223 *  
## mt_modelfactor(race)3                -462.499    137.560  -3.362 0.000949 ***
## mt_modelfactor(race)1:factor(smoke)1 -471.806    138.040  -3.418 0.000784 ***
## mt_modelfactor(race)2:factor(smoke)1 -407.064    260.512  -1.563 0.119954    
## mt_modelfactor(race)3:factor(smoke)1   29.264    205.896   0.142 0.887139    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 634.2 on 176 degrees of freedom
## Multiple R-squared:  0.9593, Adjusted R-squared:  0.9563 
## F-statistic:   319 on 13 and 176 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">rs_wgt_on_smke_tidy =<span class="st"> </span><span class="kw">tidy</span>(rs_wgt_on_smke)</a>
<a class="sourceLine" id="cb41-2" title="2">rs_wgt_on_smke_tidy</a></code></pre></div>
<pre><code>## # A tibble: 13 x 5
##    term                                 estimate std.error statistic  p.value
##    &lt;chr&gt;                                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 mt_model(Intercept)                   3053.      326.       9.37  3.53e-17
##  2 mt_modellwt                              3.93      1.70     2.31  2.21e- 2
##  3 mt_modelage                             -3.75      9.58    -0.391 6.96e- 1
##  4 mt_modelfactor(ht)1                   -530.      198.      -2.68  8.10e- 3
##  5 mt_modelfactor(ui)1                   -570.      137.      -4.15  5.16e- 5
##  6 mt_modelfactor(ptl)1                  -282.      146.      -1.94  5.43e- 2
##  7 mt_modelfactor(ptl)2                   -50.4     293.      -0.172 8.64e- 1
##  8 mt_modelfactor(ptl)3                  1347.      654.       2.06  4.10e- 2
##  9 mt_modelfactor(race)2                 -502.      198.      -2.53  1.22e- 2
## 10 mt_modelfactor(race)3                 -462.      138.      -3.36  9.49e- 4
## 11 mt_modelfactor(race)1:factor(smoke)1  -472.      138.      -3.42  7.84e- 4
## 12 mt_modelfactor(race)2:factor(smoke)1  -407.      261.      -1.56  1.20e- 1
## 13 mt_modelfactor(race)3:factor(smoke)1    29.3     206.       0.142 8.87e- 1</code></pre>
</div>
<div id="construct-input-arrays-a_i-and-alpha_i" class="section level2">
<h2 class="hasAnchor">
<a href="#construct-input-arrays-a_i-and-alpha_i" class="anchor"></a>Construct Input Arrays <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span>
</h2>
<p>Multiply coefficient vector by covariate matrix to generate <em>A</em> vector that is child/individual specific.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># Estimates Table</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(rs_wgt_on_smke_tidy, <span class="dv">6</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   term                 estimate std.error statistic  p.value
##   &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 mt_model(Intercept)   3053.      326.       9.37  3.53e-17
## 2 mt_modellwt              3.93      1.70     2.31  2.21e- 2
## 3 mt_modelage             -3.75      9.58    -0.391 6.96e- 1
## 4 mt_modelfactor(ht)1   -530.      198.      -2.68  8.10e- 3
## 5 mt_modelfactor(ui)1   -570.      137.      -4.15  5.16e- 5
## 6 mt_modelfactor(ptl)1  -282.      146.      -1.94  5.43e- 2</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># Covariates</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(mt_model, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##   (Intercept) lwt age factor(ht)1 factor(ui)1 factor(ptl)1 factor(ptl)2
## 1           1 182  19           0           1            0            0
## 2           1 155  33           0           0            0            0
## 3           1 105  20           0           0            0            0
## 4           1 108  21           0           1            0            0
## 5           1 107  18           0           1            0            0
##   factor(ptl)3 factor(race)2 factor(race)3 factor(race)1:factor(smoke)1
## 1            0             1             0                            0
## 2            0             0             1                            0
## 3            0             0             0                            1
## 4            0             0             0                            1
## 5            0             0             0                            1
##   factor(race)2:factor(smoke)1 factor(race)3:factor(smoke)1
## 1                            0                            0
## 2                            0                            0
## 3                            0                            0
## 4                            0                            0
## 5                            0                            0</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co"># Covariates coefficients from regression (including constant)</span></a>
<a class="sourceLine" id="cb47-2" title="2">ar_fl_cova_esti &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(rs_wgt_on_smke_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="kw">str_detect</span>(term, <span class="st">'smoke'</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(estimate))</a>
<a class="sourceLine" id="cb47-3" title="3">ar_fl_main_esti &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(rs_wgt_on_smke_tidy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">str_detect</span>(term, <span class="st">'smoke'</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(estimate))</a>
<a class="sourceLine" id="cb47-4" title="4"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_fl_cova_esti, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##         estimate
## [1,] 3052.733875
## [2,]    3.925643
## [3,]   -3.749898
## [4,] -530.488594
## [5,] -570.136918</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_fl_main_esti, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##       estimate
## [1,] -471.8059
## [2,] -407.0641
## [3,]   29.2642</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co"># Select Matrix subcomponents</span></a>
<a class="sourceLine" id="cb51-2" title="2">mt_cova &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw">as_tibble</span>(mt_model) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">contains</span>(<span class="st">"smoke"</span>)))</a>
<a class="sourceLine" id="cb51-3" title="3">mt_intr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(race) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb51-4" title="4"></a>
<a class="sourceLine" id="cb51-5" title="5"><span class="co"># Generate A_i, use mt_cova_wth_const</span></a>
<a class="sourceLine" id="cb51-6" title="6">ar_A_m &lt;-<span class="st"> </span>mt_cova <span class="op">%*%</span><span class="st"> </span>ar_fl_cova_esti</a>
<a class="sourceLine" id="cb51-7" title="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_A_m, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##      estimate
## [1,] 2624.166
## [2,] 3074.963
## [3,] 3389.928
## [4,] 2827.819
## [5,] 2835.143</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># Generate alpha_i</span></a>
<a class="sourceLine" id="cb53-2" title="2">ar_alpha_m &lt;-<span class="st"> </span>mt_intr <span class="op">%*%</span><span class="st"> </span>ar_fl_main_esti</a>
<a class="sourceLine" id="cb53-3" title="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ar_alpha_m, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##    estimate
## 1 -407.0641
## 2   29.2642
## 3 -471.8059
## 4 -471.8059
## 5 -471.8059</code></pre>
</div>
<div id="individual-weight" class="section level2">
<h2 class="hasAnchor">
<a href="#individual-weight" class="anchor"></a>Individual Weight</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># Child Weight</span></a>
<a class="sourceLine" id="cb55-2" title="2">ar_beta_m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_A_m), <span class="dt">times=</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_A_m))</a></code></pre></div>
</div>
<div id="matrix-with-required-inputs-for-allocation" class="section level2">
<h2 class="hasAnchor">
<a href="#matrix-with-required-inputs-for-allocation" class="anchor"></a>Matrix with Required Inputs for Allocation</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># Initate Dataframe that will store all estimates and optimal allocation relevant information</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="co"># combine identifying key information along with estimation A, alpha results</span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="co"># note that we only need indi.id as key</span></a>
<a class="sourceLine" id="cb56-4" title="4">mt_opti &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(ar_alpha_m, ar_A_m, ar_beta_m)</a>
<a class="sourceLine" id="cb56-5" title="5">ar_st_varnames &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'alpha'</span>, <span class="st">'A'</span>, <span class="st">'beta'</span>)</a>
<a class="sourceLine" id="cb56-6" title="6">df_esti_alpha_A_beta &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mt_opti) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename_all</span>(<span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(ar_st_varnames))</a></code></pre></div>
<pre><code>## Warning: `as_tibble.matrix()` requires a matrix with column names or a `.name_repair` argument. Using compatibility `.name_repair`.
## This warning is displayed once per session.</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">tb_key_alpha_A_beta &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(df_opt_birthwt, df_esti_alpha_A_beta) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="st">              </span><span class="kw">select</span>(<span class="kw">one_of</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Index'</span>, <span class="st">'age'</span>, <span class="st">'lwt'</span>, <span class="st">'race'</span>, <span class="st">'smoke'</span>, <span class="st">'ptl'</span>, <span class="st">'ht'</span>, <span class="st">'ui'</span>, ar_st_varnames)))</a>
<a class="sourceLine" id="cb58-3" title="3"></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="co"># Need to only include the smokers here</span></a>
<a class="sourceLine" id="cb58-5" title="5">tb_key_alpha_A_beta &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(smoke <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb58-6" title="6"></a>
<a class="sourceLine" id="cb58-7" title="7"><span class="co"># Unique beta, A, and alpha check</span></a>
<a class="sourceLine" id="cb58-8" title="8">tb_opti_unique &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="op">!!!</span><span class="kw">syms</span>(ar_st_varnames)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-9" title="9"><span class="st">                    </span><span class="kw">arrange</span>(<span class="op">!!!</span><span class="kw">syms</span>(ar_st_varnames)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">n_obs_group=</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb58-11" title="11"></a>
<a class="sourceLine" id="cb58-12" title="12"><span class="co"># Show cars</span></a>
<a class="sourceLine" id="cb58-13" title="13"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tb_key_alpha_A_beta, <span class="dv">32</span>)</a></code></pre></div>
<pre><code>##    Index age lwt race smoke ptl ht ui     alpha        A        beta
## 1     87  20 105    1     1   0  0  0 -471.8059 3389.928 0.005291005
## 2     88  21 108    1     1   0  0  1 -471.8059 2827.819 0.005291005
## 3     89  18 107    1     1   0  0  1 -471.8059 2835.143 0.005291005
## 4     94  29 123    1     1   0  0  0 -471.8059 3426.841 0.005291005
## 5     95  26 113    1     1   0  0  0 -471.8059 3398.834 0.005291005
## 6    100  18 100    1     1   0  0  0 -471.8059 3377.800 0.005291005
## 7    101  18 100    1     1   0  0  0 -471.8059 3377.800 0.005291005
## 8    103  25 118    1     1   0  0  0 -471.8059 3422.212 0.005291005
## 9    105  28 120    1     1   0  0  0 -471.8059 3418.814 0.005291005
## 10   113  17 122    1     1   0  0  0 -471.8059 3467.914 0.005291005
## 11   115  26 168    2     1   0  0  0 -407.0641 3113.095 0.005291005
## 12   118  24  90    1     1   1  0  0 -471.8059 3034.067 0.005291005
## 13   119  35 121    2     1   1  0  0 -407.0641 2612.864 0.005291005
## 14   123  29 140    1     1   0  0  0 -471.8059 3493.577 0.005291005
## 15   124  19 138    1     1   0  0  0 -471.8059 3523.224 0.005291005
## 16   125  27 124    1     1   0  0  0 -471.8059 3438.266 0.005291005
## 17   126  31 215    1     1   0  0  0 -471.8059 3780.500 0.005291005
## 18   127  33 109    1     1   0  0  0 -471.8059 3356.882 0.005291005
## 19   128  21 185    2     1   0  0  0 -407.0641 3198.580 0.005291005
## 20   132  18  90    1     1   0  0  1 -471.8059 2768.407 0.005291005
## 21   133  18  90    1     1   0  0  1 -471.8059 2768.407 0.005291005
## 22   137  22  85    3     1   0  0  0   29.2642 2841.417 0.005291005
## 23   140  22 130    1     1   0  0  0 -471.8059 3480.570 0.005291005
## 24   141  30  95    1     1   0  0  0 -471.8059 3313.173 0.005291005
## 25   144  21 110    3     1   0  0  1   29.2642 2373.171 0.005291005
## 26   154  26 133    3     1   2  0  0   29.2642 2964.453 0.005291005
## 27   159  28 250    3     1   0  0  0   29.2642 3466.648 0.005291005
## 28   162  22 112    1     1   2  0  0 -471.8059 3359.513 0.005291005
## 29   163  31 150    3     1   0  0  0   29.2642 3062.834 0.005291005
## 30   164  23 115    3     1   0  0  0   29.2642 2955.436 0.005291005
## 31   167  16 135    1     1   0  0  0 -471.8059 3522.697 0.005291005
## 32   170  32 134    1     1   1  0  0 -471.8059 3176.796 0.005291005</code></pre>
</div>
</div>
<div id="optimal-linear-allocations" class="section level1">
<h1 class="hasAnchor">
<a href="#optimal-linear-allocations" class="anchor"></a>Optimal Linear Allocations</h1>
<div id="parameters-for-optimal-allocation" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-for-optimal-allocation" class="anchor"></a>Parameters for Optimal Allocation</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># Child Count</span></a>
<a class="sourceLine" id="cb60-2" title="2">it_obs =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(tb_opti_unique)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb60-3" title="3"></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="co"># Vector of Planner Preference</span></a>
<a class="sourceLine" id="cb60-5" title="5">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb60-6" title="6">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">-25</span>, <span class="dv">-10</span>)</a>
<a class="sourceLine" id="cb60-7" title="7">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-5</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb60-8" title="8">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">200</span>, <span class="dv">-100</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-25</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">-5</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">-1</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">-0.01</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.01</span>, <span class="fl">0.25</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.25</span>, <span class="fl">0.90</span>, <span class="dt">length.out=</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb60-9" title="9">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-5</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.99</span>)</a>
<a class="sourceLine" id="cb60-10" title="10">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-10</span>, <span class="dv">-1</span>, <span class="fl">0.05</span>, <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb60-11" title="11">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(ar_rho)</a></code></pre></div>
</div>
<div id="optimal-binary-allocation-crs" class="section level2">
<h2 class="hasAnchor">
<a href="#optimal-binary-allocation-crs" class="anchor"></a>Optimal binary Allocation (CRS)</h2>
<p>This also works with any CRS CES.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># Optimal Linear Equation</span></a>
<a class="sourceLine" id="cb61-2" title="2"></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="co"># Pull arrays out</span></a>
<a class="sourceLine" id="cb61-4" title="4">ar_A &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(A)</a>
<a class="sourceLine" id="cb61-5" title="5">ar_alpha &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(alpha)</a>
<a class="sourceLine" id="cb61-6" title="6">ar_beta &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(beta)</a>
<a class="sourceLine" id="cb61-7" title="7"></a>
<a class="sourceLine" id="cb61-8" title="8"><span class="co"># Define Function for each individual m, with hard coded arrays</span></a>
<a class="sourceLine" id="cb61-9" title="9">ffi_binary_dplyrdo_func &lt;-<span class="st"> </span><span class="cf">function</span>(ls_row, fl_rho, <span class="dt">bl_old=</span><span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb61-10" title="10">  <span class="co"># @param bl_old, weather to use old incorrect solution</span></a>
<a class="sourceLine" id="cb61-11" title="11">  <span class="co"># hard coded inputs are:</span></a>
<a class="sourceLine" id="cb61-12" title="12">  <span class="co"># 1, ar_A</span></a>
<a class="sourceLine" id="cb61-13" title="13">  <span class="co"># 2, ar_alpha</span></a>
<a class="sourceLine" id="cb61-14" title="14">  <span class="co"># 3, ar_beta</span></a>
<a class="sourceLine" id="cb61-15" title="15">  <span class="co"># note follow https://fanwangecon.github.io/R4Econ/support/function/fs_applysapplymutate.html</span></a>
<a class="sourceLine" id="cb61-16" title="16"></a>
<a class="sourceLine" id="cb61-17" title="17">  fl_alpha &lt;-<span class="st"> </span>ls_row<span class="op">$</span>alpha</a>
<a class="sourceLine" id="cb61-18" title="18">  fl_A &lt;-<span class="st"> </span>ls_row<span class="op">$</span>A</a>
<a class="sourceLine" id="cb61-19" title="19">  fl_beta &lt;-<span class="st"> </span>ls_row<span class="op">$</span>beta</a>
<a class="sourceLine" id="cb61-20" title="20"></a>
<a class="sourceLine" id="cb61-21" title="21">  <span class="cf">if</span> (bl_old) {</a>
<a class="sourceLine" id="cb61-22" title="22"></a>
<a class="sourceLine" id="cb61-23" title="23">    <span class="co"># the equation below is like doubly wrong I think, should be 1/(fl_rho-1)</span></a>
<a class="sourceLine" id="cb61-24" title="24">    bl_old_wrong =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb61-25" title="25">    <span class="cf">if</span> (bl_old_wrong) {</a>
<a class="sourceLine" id="cb61-26" title="26">      ar_left &lt;-<span class="st"> </span>((ar_A <span class="op">+</span><span class="st"> </span>ar_alpha)<span class="op">/</span>(fl_A <span class="op">+</span><span class="st"> </span>fl_alpha))</a>
<a class="sourceLine" id="cb61-27" title="27">      ar_right &lt;-<span class="st"> </span>((ar_alpha<span class="op">*</span>ar_beta)<span class="op">/</span>(fl_alpha<span class="op">*</span>fl_beta))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>fl_rho))</a>
<a class="sourceLine" id="cb61-28" title="28">      ar_full &lt;-<span class="st"> </span>ar_left<span class="op">*</span>ar_right</a>
<a class="sourceLine" id="cb61-29" title="29">      ar_indicator &lt;-<span class="st"> </span>(ar_full <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb61-30" title="30">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb61-31" title="31">      ar_left &lt;-<span class="st"> </span>((ar_A <span class="op">+</span><span class="st"> </span>ar_alpha)<span class="op">/</span>(fl_A <span class="op">+</span><span class="st"> </span>fl_alpha))</a>
<a class="sourceLine" id="cb61-32" title="32">      ar_right &lt;-<span class="st"> </span>((ar_alpha<span class="op">*</span>ar_beta)<span class="op">/</span>(fl_alpha<span class="op">*</span>fl_beta))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>(fl_rho<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb61-33" title="33">      ar_full &lt;-<span class="st"> </span>ar_left<span class="op">*</span>ar_right</a>
<a class="sourceLine" id="cb61-34" title="34">      ar_indicator &lt;-<span class="st"> </span>(ar_full <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb61-35" title="35">    }</a>
<a class="sourceLine" id="cb61-36" title="36"></a>
<a class="sourceLine" id="cb61-37" title="37">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb61-38" title="38">      ar_left &lt;-<span class="st"> </span>(</a>
<a class="sourceLine" id="cb61-39" title="39">                  ((ar_A <span class="op">+</span><span class="st"> </span>ar_alpha)<span class="op">^</span>fl_rho <span class="op">-</span><span class="st"> </span>(ar_A)<span class="op">^</span>fl_rho)</a>
<a class="sourceLine" id="cb61-40" title="40">                  <span class="op">/</span></a>
<a class="sourceLine" id="cb61-41" title="41"><span class="st">                  </span>((fl_A <span class="op">+</span><span class="st"> </span>fl_alpha)<span class="op">^</span>fl_rho <span class="op">-</span><span class="st"> </span>(fl_A)<span class="op">^</span>fl_rho)</a>
<a class="sourceLine" id="cb61-42" title="42">                 )</a>
<a class="sourceLine" id="cb61-43" title="43">      ar_right &lt;-<span class="st"> </span>((ar_beta)<span class="op">/</span>(fl_beta))</a>
<a class="sourceLine" id="cb61-44" title="44">      ar_full &lt;-<span class="st"> </span>ar_left<span class="op">*</span>ar_right</a>
<a class="sourceLine" id="cb61-45" title="45">      ar_indicator &lt;-<span class="st"> </span>(ar_full <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb61-46" title="46">  }</a>
<a class="sourceLine" id="cb61-47" title="47"></a>
<a class="sourceLine" id="cb61-48" title="48">  it_rank &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(ar_indicator)</a>
<a class="sourceLine" id="cb61-49" title="49">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(it_rank)</a>
<a class="sourceLine" id="cb61-50" title="50">}</a>
<a class="sourceLine" id="cb61-51" title="51"><span class="kw">ffi_binary_dplyrdo_func</span>(tb_key_alpha_A_beta[<span class="dv">1</span>,], <span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># accumulate allocation results</span></a>
<a class="sourceLine" id="cb63-2" title="2">tb_opti_alloc_all_rho &lt;-<span class="st"> </span>tb_key_alpha_A_beta</a>
<a class="sourceLine" id="cb63-3" title="3"></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="co"># A. First Loop over Planner Preference</span></a>
<a class="sourceLine" id="cb63-5" title="5"><span class="co"># Generate Rank Order</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="cf">for</span> (it_rho_ctr <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_rho))) {</a>
<a class="sourceLine" id="cb63-7" title="7">  rho =<span class="st"> </span>ar_rho[it_rho_ctr]</a>
<a class="sourceLine" id="cb63-8" title="8"></a>
<a class="sourceLine" id="cb63-9" title="9">  queue_rank &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-10" title="10"><span class="st">                              </span><span class="kw">do</span>(<span class="dt">rk =</span> <span class="kw">ffi_binary_dplyrdo_func</span>(., rho)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-11" title="11"><span class="st">                              </span><span class="kw">unnest</span>(rk) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(rk)</a>
<a class="sourceLine" id="cb63-12" title="12"></a>
<a class="sourceLine" id="cb63-13" title="13">  tb_with_rank &lt;-<span class="st"> </span>tb_key_alpha_A_beta <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_column</span>(queue_rank)</a>
<a class="sourceLine" id="cb63-14" title="14"></a>
<a class="sourceLine" id="cb63-15" title="15">  <span class="co"># m. Keep for df collection individual key + optimal allocation</span></a>
<a class="sourceLine" id="cb63-16" title="16">  <span class="co"># _on stands for optimal nutritional choices</span></a>
<a class="sourceLine" id="cb63-17" title="17">  <span class="co"># _eh stands for expected height</span></a>
<a class="sourceLine" id="cb63-18" title="18">  tb_opti_allocate_wth_key &lt;-<span class="st"> </span>tb_with_rank <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">one_of</span>(<span class="st">'Index'</span>,<span class="st">'queue_rank'</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-19" title="19"><span class="st">                                </span><span class="kw">rename</span>(<span class="op">!!</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'rho_c'</span>, it_rho_ctr, <span class="st">'_rk'</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="op">!!</span><span class="kw">sym</span>(<span class="st">'queue_rank'</span>))</a>
<a class="sourceLine" id="cb63-20" title="20"></a>
<a class="sourceLine" id="cb63-21" title="21">  <span class="co"># n. merge optimal allocaiton results from different planner preference</span></a>
<a class="sourceLine" id="cb63-22" title="22">  tb_opti_alloc_all_rho &lt;-<span class="st"> </span>tb_opti_alloc_all_rho <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(tb_opti_allocate_wth_key, <span class="dt">by=</span><span class="st">'Index'</span>)</a>
<a class="sourceLine" id="cb63-23" title="23">}</a>
<a class="sourceLine" id="cb63-24" title="24"></a>
<a class="sourceLine" id="cb63-25" title="25"><span class="co"># o. print results</span></a>
<a class="sourceLine" id="cb63-26" title="26"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_opti_alloc_all_rho))</a></code></pre></div>
<pre><code>##      Index             age             lwt             race           smoke  
##  Min.   :  4.00   Min.   :14.00   Min.   : 80.0   Min.   :1.000   Min.   :1  
##  1st Qu.: 59.25   1st Qu.:19.00   1st Qu.:107.2   1st Qu.:1.000   1st Qu.:1  
##  Median :102.00   Median :22.00   Median :120.0   Median :1.000   Median :1  
##  Mean   :105.92   Mean   :22.95   Mean   :128.1   Mean   :1.459   Mean   :1  
##  3rd Qu.:151.50   3rd Qu.:26.00   3rd Qu.:137.2   3rd Qu.:2.000   3rd Qu.:1  
##  Max.   :224.00   Max.   :35.00   Max.   :250.0   Max.   :3.000   Max.   :1  
##                                                                              
##       ptl               ht                ui             alpha        
##  Min.   :0.0000   Min.   :0.00000   Min.   :0.0000   Min.   :-471.81  
##  1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:-471.81  
##  Median :0.0000   Median :0.00000   Median :0.0000   Median :-471.81  
##  Mean   :0.3108   Mean   :0.06757   Mean   :0.1757   Mean   :-381.80  
##  3rd Qu.:0.0000   3rd Qu.:0.00000   3rd Qu.:0.0000   3rd Qu.:-407.06  
##  Max.   :3.0000   Max.   :1.00000   Max.   :1.0000   Max.   :  29.26  
##                                                                       
##        A             beta            rho_c1_rk     rho_c2_rk    
##  Min.   :2104   Min.   :0.005291   Min.   : NA   Min.   : 1.00  
##  1st Qu.:2892   1st Qu.:0.005291   1st Qu.: NA   1st Qu.:10.00  
##  Median :3207   Median :0.005291   Median : NA   Median :25.50  
##  Mean   :3154   Mean   :0.005291   Mean   :NaN   Mean   :27.51  
##  3rd Qu.:3449   3rd Qu.:0.005291   3rd Qu.: NA   3rd Qu.:43.75  
##  Max.   :4109   Max.   :0.005291   Max.   : NA   Max.   :62.00  
##                                    NA's   :74                   
##    rho_c3_rk       rho_c4_rk       rho_c5_rk    
##  Min.   : 1.00   Min.   : 1.00   Min.   : 1.00  
##  1st Qu.:10.00   1st Qu.:10.00   1st Qu.:10.00  
##  Median :25.50   Median :25.50   Median :26.00  
##  Mean   :27.51   Mean   :27.51   Mean   :27.51  
##  3rd Qu.:43.75   3rd Qu.:43.75   3rd Qu.:44.00  
##  Max.   :62.00   Max.   :62.00   Max.   :62.00  
## </code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(tb_opti_alloc_all_rho)</a></code></pre></div>
<pre><code>## 'data.frame':    74 obs. of  16 variables:
##  $ Index    : int  87 88 89 94 95 100 101 103 105 113 ...
##  $ age      : int  20 21 18 29 26 18 18 25 28 17 ...
##  $ lwt      : int  105 108 107 123 113 100 100 118 120 122 ...
##  $ race     : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ smoke    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ ptl      : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ht       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ui       : int  0 1 1 0 0 0 0 0 0 0 ...
##  $ alpha    : num  -472 -472 -472 -472 -472 ...
##  $ A        : num  3390 2828 2835 3427 3399 ...
##  $ beta     : num  0.00529 0.00529 0.00529 0.00529 0.00529 ...
##  $ rho_c1_rk: int  NA NA NA NA NA NA NA NA NA NA ...
##  $ rho_c2_rk: int  38 9 10 43 39 37 37 42 40 49 ...
##  $ rho_c3_rk: int  36 6 8 41 37 35 35 40 38 49 ...
##  $ rho_c4_rk: int  32 6 7 37 33 31 31 36 34 46 ...
##  $ rho_c5_rk: int  28 6 7 33 29 27 27 32 30 39 ...</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co"># Make Longer</span></a>
<a class="sourceLine" id="cb67-2" title="2">st_bisec_prefix &lt;-<span class="st"> 'rho_c'</span></a>
<a class="sourceLine" id="cb67-3" title="3">svr_abfafb_long_name &lt;-<span class="st"> 'rho'</span></a>
<a class="sourceLine" id="cb67-4" title="4">svr_bisect_iter &lt;-<span class="st"> 'nothing'</span></a>
<a class="sourceLine" id="cb67-5" title="5">svr_number_col &lt;-<span class="st"> 'rank'</span></a>
<a class="sourceLine" id="cb67-6" title="6">tb_opti_alloc_all_rho_long &lt;-<span class="st"> </span>tb_opti_alloc_all_rho <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-7" title="7"><span class="st">  </span><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb67-8" title="8">    <span class="dt">cols =</span> <span class="kw">starts_with</span>(st_bisec_prefix),</a>
<a class="sourceLine" id="cb67-9" title="9">    <span class="dt">names_to =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(svr_abfafb_long_name, svr_bisect_iter),</a>
<a class="sourceLine" id="cb67-10" title="10">    <span class="dt">names_pattern =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(st_bisec_prefix, <span class="st">"(.*)_(.*)"</span>),</a>
<a class="sourceLine" id="cb67-11" title="11">    <span class="dt">values_to =</span> svr_number_col</a>
<a class="sourceLine" id="cb67-12" title="12">  )</a></code></pre></div>
<div id="bump-plot-for-optimal-binary-allocations" class="section level3">
<h3 class="hasAnchor">
<a href="#bump-plot-for-optimal-binary-allocations" class="anchor"></a>Bump Plot for Optimal Binary Allocations</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">tb_opti_alloc_all_rho_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> rho, <span class="dt">y =</span> rank, <span class="dt">group =</span> Index)) <span class="op">+</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> race, <span class="dt">alpha =</span> <span class="dv">1</span>), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> race, <span class="dt">alpha =</span> <span class="dv">1</span>), <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb68-5" title="5"><span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.85</span>,<span class="dv">0</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="st">    </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(tb_opti_alloc_all_rho_long))<span class="op">+</span></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb68-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Equality vs Efficiency"</span>,</a>
<a class="sourceLine" id="cb68-9" title="9">         <span class="dt">y =</span> <span class="st">"Rank"</span>,</a>
<a class="sourceLine" id="cb68-10" title="10">         <span class="dt">title =</span> <span class="st">"Binary Deallocation Rank, Weight and Smokng"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb68-11" title="11"><span class="st">    </span><span class="kw"><a href="../reference/ffy_opt_ghthm_dk.html">ffy_opt_ghthm_dk</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb68-12" title="12"><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">data =</span>tb_opti_alloc_all_rho,<span class="kw">aes</span>(<span class="dt">y=</span>rho_c1_rk,<span class="dt">x=</span><span class="fl">0.6</span>,<span class="dt">label=</span>Index),<span class="dt">hjust=</span><span class="st">"right"</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 74 rows containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 74 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 74 rows containing missing values (geom_text).</code></pre>
<p><img src="ffv_opt_sobin_rkone_allrw_wgt_files/figure-html/binary%20allocation%20bump%20plot-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#objective">Objective</a></li>
      <li>
<a href="#load-packages-and-data">Load Packages and Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#load-dependencies">Load Dependencies</a></li>
      <li><a href="#load-data">Load Data</a></li>
      </ul>
</li>
      <li>
<a href="#regression-with-data-and-construct-input-arrays">Regression with Data and Construct Input Arrays</a><ul class="nav nav-pills nav-stacked">
<li><a href="#binary-problem-regress-birth-weight-on-mothers-smoking-status">Binary Problem Regress Birth Weight on Mother’s Smoking Status</a></li>
      <li><a href="#construct-input-arrays-a_i-and-alpha_i">Construct Input Arrays <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span></a></li>
      <li><a href="#individual-weight">Individual Weight</a></li>
      <li><a href="#matrix-with-required-inputs-for-allocation">Matrix with Required Inputs for Allocation</a></li>
      </ul>
</li>
      <li>
<a href="#optimal-linear-allocations">Optimal Linear Allocations</a><ul class="nav nav-pills nav-stacked">
<li><a href="#parameters-for-optimal-allocation">Parameters for Optimal Allocation</a></li>
      <li><a href="#optimal-binary-allocation-crs">Optimal binary Allocation (CRS)</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Fan Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
