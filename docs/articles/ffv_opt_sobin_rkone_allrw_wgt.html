<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Function Test Binary Allocation with Linear Regression • Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Function Test Binary Allocation with Linear Regression">
<meta property="og:description" content="Test binary optimal allocation solution function from package. 
Use the the birthwt testing dataset. Regression birth weight on smoking status.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Papers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3839890" class="external-link">Optimal Allocations to Heterogeneous Agents with An Application to Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3691091" class="external-link">Optimal Allocation of the COVID-19 Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3547706" class="external-link">The Optimal Allocation of Resources among Heterogeneous Individuals</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/" class="external-link">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/" class="external-link">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/" class="external-link">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/" class="external-link">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/" class="external-link">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/" class="external-link">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/" class="external-link">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/" class="external-link">Python Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Function Test Binary Allocation with Linear Regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/HEAD/vignettes/ffv_opt_sobin_rkone_allrw_wgt.Rmd" class="external-link"><code>vignettes/ffv_opt_sobin_rkone_allrw_wgt.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_sobin_rkone_allrw_wgt.Rmd</code></div>

    </div>

    
    
<p>The effects of mother’s smoking status on birth weight. If we aim to improve health outcomes, what is the priority sequence of mothers whom we would want to discourage from smoking.</p>
<div class="section level2">
<h2 id="load-packages-and-data">Load Packages and Data<a class="anchor" aria-label="anchor" href="#load-packages-and-data"></a>
</h2>
<div class="section level3">
<h3 id="load-dependencies">Load Dependencies<a class="anchor" aria-label="anchor" href="#load-dependencies"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>all.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.duplicate.label <span class="op">=</span> <span class="st">'allow'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org" class="external-link">forcats</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/REconTools/" class="external-link">REconTools</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/PrjOptiAlloc/">PrjOptiAlloc</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-data">Load Data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<p>Generate four categories by initial height and mother’s education levels combinations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load Data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span><span class="op">)</span>

<span class="co"># Summarize</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 'data.frame':    189 obs. of  11 variables:</span>
<span class="co">##  $ Index: int  85 86 87 88 89 91 92 93 94 95 ...</span>
<span class="co">##  $ low  : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">##  $ age  : int  19 33 20 21 18 21 22 17 29 26 ...</span>
<span class="co">##  $ lwt  : int  182 155 105 108 107 124 118 103 123 113 ...</span>
<span class="co">##  $ race : int  2 3 1 1 1 3 1 3 1 1 ...</span>
<span class="co">##  $ smoke: int  0 0 1 1 1 0 0 0 1 1 ...</span>
<span class="co">##  $ ptl  : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">##  $ ht   : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">##  $ ui   : int  1 0 0 1 1 0 0 0 0 0 ...</span>
<span class="co">##  $ ftv  : int  0 3 1 2 0 0 1 1 1 0 ...</span>
<span class="co">##  $ bwt  : int  2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      Index            low              age             lwt       </span>
<span class="co">##  Min.   :  4.0   Min.   :0.0000   Min.   :14.00   Min.   : 80.0  </span>
<span class="co">##  1st Qu.: 68.0   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0  </span>
<span class="co">##  Median :123.0   Median :0.0000   Median :23.00   Median :121.0  </span>
<span class="co">##  Mean   :121.1   Mean   :0.3122   Mean   :23.24   Mean   :129.8  </span>
<span class="co">##  3rd Qu.:176.0   3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0  </span>
<span class="co">##  Max.   :226.0   Max.   :1.0000   Max.   :45.00   Max.   :250.0  </span>
<span class="co">##       race           smoke             ptl               ht         </span>
<span class="co">##  Min.   :1.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  </span>
<span class="co">##  1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000  </span>
<span class="co">##  Median :1.000   Median :0.0000   Median :0.0000   Median :0.00000  </span>
<span class="co">##  Mean   :1.847   Mean   :0.3915   Mean   :0.1958   Mean   :0.06349  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.00000  </span>
<span class="co">##  Max.   :3.000   Max.   :1.0000   Max.   :3.0000   Max.   :1.00000  </span>
<span class="co">##        ui              ftv              bwt      </span>
<span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   : 709  </span>
<span class="co">##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2414  </span>
<span class="co">##  Median :0.0000   Median :0.0000   Median :2977  </span>
<span class="co">##  Mean   :0.1481   Mean   :0.7937   Mean   :2945  </span>
<span class="co">##  3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:3487  </span>
<span class="co">##  Max.   :1.0000   Max.   :6.0000   Max.   :4990</span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generate Discrete Version of continuous variables</span>
<span class="va">df_opt_birthwt</span> <span class="op">&lt;-</span> <span class="va">df_opt_birthwt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>momwgtLowHigh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">lwt</span>,
                               breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">129</span>, <span class="cn">Inf</span><span class="op">)</span>,
                               labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LW"</span>,<span class="st">"HW"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mombirthage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">age</span>,
                               breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">24</span>, <span class="cn">Inf</span><span class="op">)</span>,
                               labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"young"</span>,<span class="st">"older"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ftvm3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ftv</span>,
                               breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">Inf</span><span class="op">)</span>,
                               labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"novisit"</span>,<span class="st">"1visit"</span>,<span class="st">"morevisit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ftvm3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ftv</span>,
                               breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">Inf</span><span class="op">)</span>,
                               labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"novisit"</span>,<span class="st">"1visit"</span>,<span class="st">"morevisit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Generate Not Smoke Variable</span>
<span class="va">not_smoke_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"0"</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span>
<span class="va">df_opt_birthwt</span> <span class="op">&lt;-</span> <span class="va">df_opt_birthwt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>notsmoke <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">smoke</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">1</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      Index            low              age             lwt       </span>
<span class="co">##  Min.   :  4.0   Min.   :0.0000   Min.   :14.00   Min.   : 80.0  </span>
<span class="co">##  1st Qu.: 68.0   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0  </span>
<span class="co">##  Median :123.0   Median :0.0000   Median :23.00   Median :121.0  </span>
<span class="co">##  Mean   :121.1   Mean   :0.3122   Mean   :23.24   Mean   :129.8  </span>
<span class="co">##  3rd Qu.:176.0   3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0  </span>
<span class="co">##  Max.   :226.0   Max.   :1.0000   Max.   :45.00   Max.   :250.0  </span>
<span class="co">##       race           smoke             ptl               ht         </span>
<span class="co">##  Min.   :1.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  </span>
<span class="co">##  1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000  </span>
<span class="co">##  Median :1.000   Median :0.0000   Median :0.0000   Median :0.00000  </span>
<span class="co">##  Mean   :1.847   Mean   :0.3915   Mean   :0.1958   Mean   :0.06349  </span>
<span class="co">##  3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.00000  </span>
<span class="co">##  Max.   :3.000   Max.   :1.0000   Max.   :3.0000   Max.   :1.00000  </span>
<span class="co">##        ui              ftv              bwt       momwgtLowHigh mombirthage</span>
<span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   : 709   LW:110        young:120  </span>
<span class="co">##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2414   HW: 79        older: 69  </span>
<span class="co">##  Median :0.0000   Median :0.0000   Median :2977                            </span>
<span class="co">##  Mean   :0.1481   Mean   :0.7937   Mean   :2945                            </span>
<span class="co">##  3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:3487                            </span>
<span class="co">##  Max.   :1.0000   Max.   :6.0000   Max.   :4990                            </span>
<span class="co">##        ftvm3        notsmoke     </span>
<span class="co">##  novisit  :147   Min.   :0.0000  </span>
<span class="co">##  1visit   : 30   1st Qu.:0.0000  </span>
<span class="co">##  morevisit: 12   Median :1.0000  </span>
<span class="co">##                  Mean   :0.6085  </span>
<span class="co">##                  3rd Qu.:1.0000  </span>
<span class="co">##                  Max.   :1.0000</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="exploration">Exploration<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<div class="section level3">
<h3 id="tabulation">Tabulation<a class="anchor" aria-label="anchor" href="#tabulation"></a>
</h3>
<p>Tabulate:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># tabulate</span>
<span class="va">df_opt_birthwt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">race</span>, <span class="va">smoke</span>, <span class="va">ftv</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">race</span>, values_from <span class="op">=</span> <span class="va">freq</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'race', 'smoke'. You can override using the `.groups` argument.</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 11 x 5</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   smoke [2]</span></span>
<span class="co">##    smoke   ftv   `1`   `2`   `3`</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span>     0     0    13     8    34</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span>     0     1    20     4    11</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span>     0     2     9     3     7</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span>     0     3     1    <span style="color: #BB0000;">NA</span>     2</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span>     0     4     1     1     1</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span>     1     0    30     6     9</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span>     1     1     9     2     1</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span>     1     2     9     1     1</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span>     1     3     3     1    <span style="color: #BB0000;">NA</span></span>
<span class="co">## <span style="color: #BCBCBC;">10</span>     1     4     1    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">## <span style="color: #BCBCBC;">11</span>     1     6    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     1</span></code></pre>
<p>Summarize all, conditional on smoking or not:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summarize all</span>
<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span>, bl_statsasrows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: `funs()` was deprecated in dplyr 0.8.0.</span>
<span class="co">## Please use a list of either functions or lambdas: </span>
<span class="co">## </span>
<span class="co">##   # Simple named list: </span>
<span class="co">##   list(mean = mean, median = median)</span>
<span class="co">## </span>
<span class="co">##   # Auto named with `tibble::lst()`: </span>
<span class="co">##   tibble::lst(mean, median)</span>
<span class="co">## </span>
<span class="co">##   # Using lambdas</span>
<span class="co">##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## Warning: `as.tibble()` was deprecated in tibble 2.0.0.</span>
<span class="co">## Please use `as_tibble()` instead.</span>
<span class="co">## The signature and semantics have changed, see `?as_tibble`.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 x 19</span></span>
<span class="co">##    var          n unique NAobs ZEROobs    mean      sd    cv   min    p01    p05</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> age        189     24     0       0 2.32<span style="color: #949494;">e</span>+1   5.30  0.228    14   14     16  </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> bwt        189    131     0       0 2.94<span style="color: #949494;">e</span>+3 729.    0.248   709 <span style="text-decoration: underline;">1</span>121.  <span style="text-decoration: underline;">1</span>801. </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> ftv        189      6     0     100 7.94<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   1.06  1.33      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ht         189      2     0     177 6.35<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>   0.244 3.85      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Index      189    189     0       0 1.21<span style="color: #949494;">e</span>+2  63.3   0.523     4   10.9   20.8</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> low        189      2     0     130 3.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.465 1.49      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> lwt        189     75     0       0 1.30<span style="color: #949494;">e</span>+2  30.6   0.236    80   85     94.4</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> notsmoke   189      2     0      74 6.08<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.489 0.804     0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> ptl        189      4     0     159 1.96<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.493 2.52      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> race       189      3     0       0 1.85<span style="color: #949494;">e</span>+0   0.918 0.497     1    1      1  </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> smoke      189      2     0     115 3.92<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.489 1.25      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> ui         189      2     0     161 1.48<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.356 2.40      0    0      0  </span>
<span class="co">## <span style="color: #949494;"># ... with 8 more variables: p10 &lt;dbl&gt;, p25 &lt;dbl&gt;, p50 &lt;dbl&gt;, p75 &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   p90 &lt;dbl&gt;, p95 &lt;dbl&gt;, p99 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summarize smoking only</span>
<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">smoke</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, bl_statsasrows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 x 19</span></span>
<span class="co">##    var        n unique NAobs ZEROobs    mean      sd      cv   min    p01    p05</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> age      115     23     0       0 2.34<span style="color: #949494;">e</span>+1   5.47    0.233    14   14.1   16  </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> bwt      115     87     0       0 3.06<span style="color: #949494;">e</span>+3 753.      0.246  <span style="text-decoration: underline;">1</span>021 <span style="text-decoration: underline;">1</span>350.  <span style="text-decoration: underline;">1</span>721. </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> ftv      115      5     0      55 8.17<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.979   1.20      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ht       115      2     0     108 6.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>   0.240   3.95      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Index    115    115     0       0 1.31<span style="color: #949494;">e</span>+2  64.8     0.496    10   13.3   18.7</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> low      115      2     0      86 2.52<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.436   1.73      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> lwt      115     58     0       0 1.31<span style="color: #949494;">e</span>+2  28.4     0.217    85   89.8   96.7</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> notsm~   115      1     0       0 1   <span style="color: #949494;">e</span>+0   0       0         1    1      1  </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> ptl      115      3     0     103 1.22<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.378   3.11      0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> race     115      3     0       0 2.10<span style="color: #949494;">e</span>+0   0.927   0.442     1    1      1  </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> smoke    115      1     0     115 0   <span style="color: #949494;"> </span>     0     <span style="color: #BB0000;">NaN</span>         0    0      0  </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> ui       115      2     0     100 1.30<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.338   2.59      0    0      0  </span>
<span class="co">## <span style="color: #949494;"># ... with 8 more variables: p10 &lt;dbl&gt;, p25 &lt;dbl&gt;, p50 &lt;dbl&gt;, p75 &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   p90 &lt;dbl&gt;, p95 &lt;dbl&gt;, p99 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summarize non-smoking only, 74 smokers</span>
<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">smoke</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, bl_statsasrows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 x 19</span></span>
<span class="co">##    var        n unique NAobs ZEROobs    mean      sd      cv   min    p01    p05</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> age       74     21     0       0 2.29<span style="color: #949494;">e</span>+1   5.05    0.220    14 1.55<span style="color: #949494;">e</span>1   17  </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> bwt       74     61     0       0 2.77<span style="color: #949494;">e</span>+3 660.      0.238   709 1.02<span style="color: #949494;">e</span>3 <span style="text-decoration: underline;">1</span>862. </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> ftv       74      6     0      45 7.57<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   1.18    1.56      0 0   <span style="color: #949494;"> </span>     0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ht        74      2     0      69 6.76<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>   0.253   3.74      0 0   <span style="color: #949494;"> </span>     0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Index     74     74     0       0 1.06<span style="color: #949494;">e</span>+2  58.1     0.548     4 9.11<span style="color: #949494;">e</span>0   22.6</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> low       74      2     0      44 4.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.494   1.22      0 0   <span style="color: #949494;"> </span>     0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> lwt       74     45     0       0 1.28<span style="color: #949494;">e</span>+2  33.8     0.264    80 8.36<span style="color: #949494;">e</span>1   90  </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> notsm~    74      1     0      74 0   <span style="color: #949494;"> </span>     0     <span style="color: #BB0000;">NaN</span>         0 0   <span style="color: #949494;"> </span>     0  </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> ptl       74      4     0      56 3.11<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.618   1.99      0 0   <span style="color: #949494;"> </span>     0  </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> race      74      3     0       0 1.46<span style="color: #949494;">e</span>+0   0.762   0.522     1 1   <span style="color: #949494;">e</span>0    1  </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> smoke     74      1     0       0 1   <span style="color: #949494;">e</span>+0   0       0         1 1   <span style="color: #949494;">e</span>0    1  </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> ui        74      2     0      61 1.76<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>   0.383   2.18      0 0   <span style="color: #949494;"> </span>     0  </span>
<span class="co">## <span style="color: #949494;"># ... with 8 more variables: p10 &lt;dbl&gt;, p25 &lt;dbl&gt;, p50 &lt;dbl&gt;, p75 &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   p90 &lt;dbl&gt;, p95 &lt;dbl&gt;, p99 &lt;dbl&gt;, max &lt;dbl&gt;</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="explorational-regressions">Explorational Regressions<a class="anchor" aria-label="anchor" href="#explorational-regressions"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># birth weight on mother age, race, ht and ui</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bwt</span> <span class="op">~</span> <span class="va">lwt</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mombirthage</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ui</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = bwt ~ lwt + factor(mombirthage) + factor(race) + </span>
<span class="co">##     factor(ht) + factor(ui))</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##      Min       1Q   Median       3Q      Max </span>
<span class="co">## -1594.45  -453.35    40.06   468.89  1891.04 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                          Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">## (Intercept)              2572.173    237.094  10.849  &lt; 2e-16 ***</span>
<span class="co">## lwt                         5.216      1.735   3.006  0.00302 ** </span>
<span class="co">## factor(mombirthage)older -114.841    102.918  -1.116  0.26596    </span>
<span class="co">## factor(race)2            -453.756    150.971  -3.006  0.00302 ** </span>
<span class="co">## factor(race)3            -216.550    108.069  -2.004  0.04657 *  </span>
<span class="co">## factor(ht)1              -633.028    205.271  -3.084  0.00236 ** </span>
<span class="co">## factor(ui)1              -563.302    138.153  -4.077  6.8e-05 ***</span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 664.4 on 182 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.1964, Adjusted R-squared:  0.1699 </span>
<span class="co">## F-statistic: 7.412 on 6 and 182 DF,  p-value: 4.131e-07</span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># # summary(lm(bwt ~ factor(ftv) - 1))</span>
<span class="co"># summary(lm(bwt ~ factor(ftv) + factor(ht) + factor(ui) + factor(ptl) - 1))</span>

<span class="co"># Birth wegith on mother's weight last menstral cycle, and mother age, race and smoking interaction</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bwt</span> <span class="op">~</span> <span class="va">lwt</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">notsmoke</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(notsmoke) - </span>
<span class="co">##     1)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##      Min       1Q   Median       3Q      Max </span>
<span class="co">## -2360.77  -434.48    42.18   469.28  1710.36 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">## lwt                                3.711      1.739   2.134 0.034154 *  </span>
<span class="co">## age                               -4.760     10.054  -0.473 0.636500    </span>
<span class="co">## factor(race)1                   2466.776    304.057   8.113 7.29e-14 ***</span>
<span class="co">## factor(race)2                   2089.529    381.625   5.475 1.44e-07 ***</span>
<span class="co">## factor(race)3                   2404.104    345.416   6.960 6.04e-11 ***</span>
<span class="co">## factor(race)1:factor(notsmoke)1  570.605    143.546   3.975 0.000102 ***</span>
<span class="co">## factor(race)2:factor(notsmoke)1  305.314    277.419   1.101 0.272553    </span>
<span class="co">## factor(race)3:factor(notsmoke)1   75.981    216.468   0.351 0.725994    </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 678.9 on 181 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 </span>
<span class="co">## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summary(lm(bwt ~ lwt + factor(race) + (ftv) - 1))</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="regression-with-data-and-construct-input-arrays">Regression with Data and Construct Input Arrays<a class="anchor" aria-label="anchor" href="#regression-with-data-and-construct-input-arrays"></a>
</h2>
<div class="section level3">
<h3 id="binary-problem-regress-birth-weight-on-mothers-smoking-status">Binary Problem Regress Birth Weight on Mother’s Smoking Status<a class="anchor" aria-label="anchor" href="#binary-problem-regress-birth-weight-on-mothers-smoking-status"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A. Regress child birth weight on mother's age, race and mother's weight</span>
<span class="co"># print(summary(lm(bwt ~ lwt + factor(mombirthage) + factor(race))))</span>
<span class="co"># print(summary(lm(bwt ~ lwt + factor(mombirthage) + factor(race) + factor(ht) + factor(ui))))</span>
<span class="co"># print(summary(lm(bwt ~ lwt + age + factor(race) + factor(ht) + factor(ui) + factor(ptl))))</span>
<span class="co"># </span>
<span class="co"># print(summary(lm(bwt ~ lwt + age + factor(race) + factor(smoke))))</span>
<span class="co"># print(summary(lm(bwt ~ lwt + age + factor(race) + factor(ht) + factor(ui) +  factor(smoke))))</span>
<span class="co"># </span>
<span class="co"># print(summary(lm(bwt ~ lwt + age + factor(momwgtLowHigh):factor(smoke) - 1)))</span>
<span class="co"># print(summary(lm(bwt ~ lwt + age + factor(ht) + factor(ui) + factor(race) + factor(race):factor(smoke))))</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bwt</span> <span class="op">~</span> <span class="va">lwt</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">smoke</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(smoke) - </span>
<span class="co">##     1)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##      Min       1Q   Median       3Q      Max </span>
<span class="co">## -2360.77  -434.48    42.18   469.28  1710.36 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                              Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">## lwt                             3.711      1.739   2.134 0.034154 *  </span>
<span class="co">## age                            -4.760     10.054  -0.473 0.636500    </span>
<span class="co">## factor(race)1                3037.381    339.863   8.937 4.55e-16 ***</span>
<span class="co">## factor(race)2                2394.843    344.390   6.954 6.25e-11 ***</span>
<span class="co">## factor(race)3                2480.085    293.002   8.464 8.57e-15 ***</span>
<span class="co">## factor(race)1:factor(smoke)1 -570.605    143.546  -3.975 0.000102 ***</span>
<span class="co">## factor(race)2:factor(smoke)1 -305.314    277.419  -1.101 0.272553    </span>
<span class="co">## factor(race)3:factor(smoke)1  -75.981    216.468  -0.351 0.725994    </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 678.9 on 181 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 </span>
<span class="co">## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Preferred way of appearing, in the following regression we can se:</span>
<span class="co"># 1. more more power less MPG, Straight engine slightly higher MPG</span>
<span class="co"># 2. V-shape engine car, going from auto to manual trans gain 4.1 MPG</span>
<span class="co"># 2. straight shape engine, going from auto to manual trans gain 6.67 MPG</span>

<span class="co"># Store Regression Results</span>
<span class="va">mt_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">lwt</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">notsmoke</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span><span class="op">)</span>
<span class="va">rs_wgt_on_smke</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bwt</span> <span class="op">~</span> <span class="va">mt_model</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rs_wgt_on_smke</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = bwt ~ mt_model - 1)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##      Min       1Q   Median       3Q      Max </span>
<span class="co">## -2360.77  -434.48    42.18   469.28  1710.36 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                                         Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">## mt_model(Intercept)                     2466.776    304.057   8.113 7.29e-14</span>
<span class="co">## mt_modellwt                                3.711      1.739   2.134 0.034154</span>
<span class="co">## mt_modelage                               -4.760     10.054  -0.473 0.636500</span>
<span class="co">## mt_modelfactor(race)2                   -377.246    236.212  -1.597 0.111995</span>
<span class="co">## mt_modelfactor(race)3                    -62.672    217.474  -0.288 0.773538</span>
<span class="co">## mt_modelfactor(race)1:factor(notsmoke)1  570.605    143.546   3.975 0.000102</span>
<span class="co">## mt_modelfactor(race)2:factor(notsmoke)1  305.314    277.419   1.101 0.272553</span>
<span class="co">## mt_modelfactor(race)3:factor(notsmoke)1   75.981    216.468   0.351 0.725994</span>
<span class="co">##                                            </span>
<span class="co">## mt_model(Intercept)                     ***</span>
<span class="co">## mt_modellwt                             *  </span>
<span class="co">## mt_modelage                                </span>
<span class="co">## mt_modelfactor(race)2                      </span>
<span class="co">## mt_modelfactor(race)3                      </span>
<span class="co">## mt_modelfactor(race)1:factor(notsmoke)1 ***</span>
<span class="co">## mt_modelfactor(race)2:factor(notsmoke)1    </span>
<span class="co">## mt_modelfactor(race)3:factor(notsmoke)1    </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 678.9 on 181 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 </span>
<span class="co">## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rs_wgt_on_smke_tidy</span> <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">rs_wgt_on_smke</span><span class="op">)</span>
<span class="va">rs_wgt_on_smke_tidy</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 8 x 5</span></span>
<span class="co">##   term                                    estimate std.error statistic  p.value</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> mt_model(Intercept)                      <span style="text-decoration: underline;">2</span>467.      304.       8.11  7.29<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span></span>
<span class="co">## <span style="color: #BCBCBC;">2</span> mt_modellwt                                 3.71      1.74     2.13  3.42<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> mt_modelage                                -<span style="color: #BB0000;">4.76</span>     10.1     -<span style="color: #BB0000;">0.473</span> 6.36<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">## <span style="color: #BCBCBC;">4</span> mt_modelfactor(race)2                    -<span style="color: #BB0000;">377.</span>      236.      -<span style="color: #BB0000;">1.60</span>  1.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">## <span style="color: #BCBCBC;">5</span> mt_modelfactor(race)3                     -<span style="color: #BB0000;">62.7</span>     217.      -<span style="color: #BB0000;">0.288</span> 7.74<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">## <span style="color: #BCBCBC;">6</span> mt_modelfactor(race)1:factor(notsmoke)1   571.      144.       3.98  1.02<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span>
<span class="co">## <span style="color: #BCBCBC;">7</span> mt_modelfactor(race)2:factor(notsmoke)1   305.      277.       1.10  2.73<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">## <span style="color: #BCBCBC;">8</span> mt_modelfactor(race)3:factor(notsmoke)1    76.0     216.       0.351 7.26<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="construct-input-arrays-a_i-and-alpha_i">Construct Input Arrays <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span><a class="anchor" aria-label="anchor" href="#construct-input-arrays-a_i-and-alpha_i"></a>
</h3>
<p>Multiply coefficient vector by covariate matrix to generate <em>A</em> vector that is child/individual specific.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimates Table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rs_wgt_on_smke_tidy</span>, <span class="fl">6</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 x 5</span></span>
<span class="co">##   term                                    estimate std.error statistic  p.value</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> mt_model(Intercept)                      <span style="text-decoration: underline;">2</span>467.      304.       8.11  7.29<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span></span>
<span class="co">## <span style="color: #BCBCBC;">2</span> mt_modellwt                                 3.71      1.74     2.13  3.42<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> mt_modelage                                -<span style="color: #BB0000;">4.76</span>     10.1     -<span style="color: #BB0000;">0.473</span> 6.36<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">## <span style="color: #BCBCBC;">4</span> mt_modelfactor(race)2                    -<span style="color: #BB0000;">377.</span>      236.      -<span style="color: #BB0000;">1.60</span>  1.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">## <span style="color: #BCBCBC;">5</span> mt_modelfactor(race)3                     -<span style="color: #BB0000;">62.7</span>     217.      -<span style="color: #BB0000;">0.288</span> 7.74<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span>
<span class="co">## <span style="color: #BCBCBC;">6</span> mt_modelfactor(race)1:factor(notsmoke)1   571.      144.       3.98  1.02<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Covariates</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mt_model</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   (Intercept) lwt age factor(race)2 factor(race)3</span>
<span class="co">## 1           1 182  19             1             0</span>
<span class="co">## 2           1 155  33             0             1</span>
<span class="co">## 3           1 105  20             0             0</span>
<span class="co">## 4           1 108  21             0             0</span>
<span class="co">## 5           1 107  18             0             0</span>
<span class="co">##   factor(race)1:factor(notsmoke)1 factor(race)2:factor(notsmoke)1</span>
<span class="co">## 1                               0                               1</span>
<span class="co">## 2                               0                               0</span>
<span class="co">## 3                               0                               0</span>
<span class="co">## 4                               0                               0</span>
<span class="co">## 5                               0                               0</span>
<span class="co">##   factor(race)3:factor(notsmoke)1</span>
<span class="co">## 1                               0</span>
<span class="co">## 2                               1</span>
<span class="co">## 3                               0</span>
<span class="co">## 4                               0</span>
<span class="co">## 5                               0</span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Covariates coefficients from regression (including constant)</span>
<span class="va">ar_fl_cova_esti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">rs_wgt_on_smke_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">'notsmoke'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_fl_main_esti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">rs_wgt_on_smke_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">'notsmoke'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_fl_cova_esti</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         estimate</span>
<span class="co">## [1,] 2466.775608</span>
<span class="co">## [2,]    3.710935</span>
<span class="co">## [3,]   -4.759693</span>
<span class="co">## [4,] -377.246401</span>
<span class="co">## [5,]  -62.671843</span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_fl_main_esti</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       estimate</span>
<span class="co">## [1,] 570.60493</span>
<span class="co">## [2,] 305.31426</span>
<span class="co">## [3,]  75.98101</span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Select Matrix subcomponents</span>
<span class="va">mt_cova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">mt_model</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"notsmoke"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mt_intr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># Generate A_i, use mt_cova_wth_const</span>
<span class="va">ar_A_m</span> <span class="op">&lt;-</span> <span class="va">mt_cova</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">ar_fl_cova_esti</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_A_m</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      estimate</span>
<span class="co">## [1,] 2674.485</span>
<span class="co">## [2,] 2822.229</span>
<span class="co">## [3,] 2761.230</span>
<span class="co">## [4,] 2767.603</span>
<span class="co">## [5,] 2778.171</span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generate alpha_i</span>
<span class="va">ar_alpha_m</span> <span class="op">&lt;-</span> <span class="va">mt_intr</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">ar_fl_main_esti</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_alpha_m</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    estimate</span>
<span class="co">## 1 305.31426</span>
<span class="co">## 2  75.98101</span>
<span class="co">## 3 570.60493</span>
<span class="co">## 4 570.60493</span>
<span class="co">## 5 570.60493</span></code></pre>
</div>
<div class="section level3">
<h3 id="individual-weight">Individual Weight<a class="anchor" aria-label="anchor" href="#individual-weight"></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Child Weight</span>
<span class="va">ar_beta_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_A_m</span><span class="op">)</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_A_m</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="matrix-with-required-inputs-for-allocation">Matrix with Required Inputs for Allocation<a class="anchor" aria-label="anchor" href="#matrix-with-required-inputs-for-allocation"></a>
</h3>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Initate Dataframe that will store all estimates and optimal allocation relevant information</span>
<span class="co"># combine identifying key information along with estimation A, alpha results</span>
<span class="co"># note that we only need indi.id as key</span>
<span class="va">mt_opti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ar_alpha_m</span><span class="op">*</span><span class="fl">0.01</span>, <span class="va">ar_A_m</span><span class="op">*</span><span class="fl">0.01</span>, <span class="va">ar_beta_m</span><span class="op">)</span>
<span class="va">ar_st_varnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>, <span class="st">'A'</span>, <span class="st">'beta'</span><span class="op">)</span>
<span class="va">df_esti_alpha_A_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">mt_opti</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.</span>
<span class="co">## Using compatibility `.name_repair`.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tb_key_alpha_A_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">df_opt_birthwt</span>, <span class="va">df_esti_alpha_A_beta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html" class="external-link">one_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Index'</span>, <span class="st">'age'</span>, <span class="st">'lwt'</span>, <span class="st">'race'</span>, <span class="st">'notsmoke'</span>, <span class="st">'ptl'</span>, <span class="st">'ht'</span>, <span class="st">'ui'</span>, <span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Need to only include the smokers here</span>
<span class="va">tb_key_alpha_A_beta</span> <span class="op">&lt;-</span> <span class="va">tb_key_alpha_A_beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">smoke</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># Randomly select 15 smokers for easier visualization.</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span>
<span class="va">it_include</span> <span class="op">&lt;-</span> <span class="fl">15</span>
<span class="va">tb_key_alpha_A_beta</span> <span class="op">&lt;-</span> <span class="va">tb_key_alpha_A_beta</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tb_key_alpha_A_beta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">it_include</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span>

<span class="co"># Unique beta, A, and alpha check</span>
<span class="va">tb_opti_unique</span> <span class="op">&lt;-</span> <span class="va">tb_key_alpha_A_beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">syms</a></span><span class="op">(</span><span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">syms</a></span><span class="op">(</span><span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n_obs_group<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'alpha', 'A'. You can override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show cars</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tb_key_alpha_A_beta</span>, <span class="fl">32</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    Index age lwt race notsmoke ptl ht ui     alpha        A        beta</span>
<span class="co">## 27   159  28 250    3        0   0  0  0 0.7598101 31.98566 0.005291005</span>
<span class="co">## 68    68  17 120    1        0   0  0  0 5.7060493 28.31173 0.005291005</span>
<span class="co">## 61    51  20 121    1        0   1  0  1 5.7060493 28.20605 0.005291005</span>
<span class="co">## 71    78  14 101    3        0   1  0  0 0.7598101 27.12273 0.005291005</span>
<span class="co">## 14   123  29 140    1        0   0  0  0 5.7060493 28.48275 0.005291005</span>
<span class="co">## 65    61  24 105    2        0   0  0  0 3.0531426 23.64945 0.005291005</span>
<span class="co">## 58    44  20  80    3        0   0  0  1 0.7598101 26.05785 0.005291005</span>
<span class="co">## 10   113  17 122    1        0   0  0  0 5.7060493 28.38595 0.005291005</span>
<span class="co">## 22   137  22  85    3        0   0  0  0 0.7598101 26.14820 0.005291005</span>
<span class="co">## 35   187  19 235    1        0   0  1  0 5.7060493 32.48411 0.005291005</span>
<span class="co">## 23   140  22 130    1        0   0  0  0 5.7060493 28.44484 0.005291005</span>
<span class="co">## 56    40  20 120    2        0   0  0  0 3.0531426 24.39648 0.005291005</span>
<span class="co">## 15   124  19 138    1        0   0  0  0 5.7060493 28.88451 0.005291005</span>
<span class="co">## 5     95  26 113    1        0   0  0  0 5.7060493 27.62359 0.005291005</span>
<span class="co">## 7    101  18 100    1        0   0  0  0 5.7060493 27.52195 0.005291005</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="optimal-linear-allocations">Optimal Linear Allocations<a class="anchor" aria-label="anchor" href="#optimal-linear-allocations"></a>
</h2>
<div class="section level3">
<h3 id="parameters-for-optimal-allocation">Parameters for Optimal Allocation<a class="anchor" aria-label="anchor" href="#parameters-for-optimal-allocation"></a>
</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Child Count</span>
<span class="va">it_obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tb_opti_unique</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>

<span class="co"># Vector of Planner Preference</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1]   0.9900000   0.9862618   0.9811261   0.9740706   0.9643775   0.9510610</span>
<span class="co">##  [7]   0.9327664   0.9076329   0.8731039   0.8256671   0.7604973   0.6709655</span>
<span class="co">## [13]   0.5479646   0.3789831   0.1468321  -0.1721023  -0.6102620  -1.2122163</span>
<span class="co">## [19]  -2.0391954  -3.1753189  -4.7361525  -6.8804628  -9.8263673 -13.8735211</span>
<span class="co">## [25] -19.4335972 -27.0721620 -37.5662042 -51.9831691 -71.7895384 -99.0000000</span></code></pre>
</div>
<div class="section level3">
<h3 id="optimal-binary-allocation">Optimal binary Allocation<a class="anchor" aria-label="anchor" href="#optimal-binary-allocation"></a>
</h3>
<p>This also works with any CRS CES.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Optimal Linear Equation</span>
<span class="va">svr_inpalc</span> <span class="op">&lt;-</span> <span class="st">'rank'</span>

<span class="co"># Solve with Function</span>
<span class="va">ls_bin_solu_all_rhos</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/ffp_opt_anlyz_rhgin_bin.html">ffp_opt_anlyz_rhgin_bin</a></span><span class="op">(</span><span class="va">tb_key_alpha_A_beta</span>, svr_id_i <span class="op">=</span> <span class="st">'Index'</span>,
                          svr_A_i <span class="op">=</span> <span class="st">'A'</span>, svr_alpha_i <span class="op">=</span> <span class="st">'alpha'</span>, svr_beta_i <span class="op">=</span> <span class="st">'beta'</span>,
                          ar_rho <span class="op">=</span> <span class="va">ar_rho</span>,
                          svr_inpalc <span class="op">=</span> <span class="va">svr_inpalc</span>,
                          svr_expout <span class="op">=</span> <span class="st">'opti_exp_outcome'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = "Index"</span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tb_opti_alloc_all_rho</span> <span class="op">&lt;-</span> <span class="va">ls_bin_solu_all_rhos</span><span class="op">$</span><span class="va">df_all_rho</span>
<span class="va">tb_opti_alloc_all_rho_long</span> <span class="op">&lt;-</span> <span class="va">ls_bin_solu_all_rhos</span><span class="op">$</span><span class="va">df_all_rho_long</span>

<span class="co"># Converge rho to numeric so the graph below sorts along x-axis properly </span>
<span class="va">tb_opti_alloc_all_rho_long</span> <span class="op">&lt;-</span> <span class="va">tb_opti_alloc_all_rho_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rho_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Merge to get Race Data</span>
<span class="va">tb_opti_alloc_all_rho_long</span> <span class="op">&lt;-</span> <span class="va">tb_opti_alloc_all_rho_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tb_key_alpha_A_beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Index</span>, <span class="va">race</span><span class="op">)</span>, by<span class="op">=</span><span class="st">'Index'</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bump-plot-for-optimal-binary-allocations">Bump Plot for Optimal Binary Allocations<a class="anchor" aria-label="anchor" href="#bump-plot-for-optimal-binary-allocations"></a>
</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">st_title</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Binary Deallocation Rank, Birth Weight and Mother Smoking"</span><span class="op">)</span>
<span class="va">st_subtitle</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Which individual to encourage to stop smoking first\n"</span>,
                     <span class="st">"The expected outcome of interest is child birth weight\n"</span>,
                     <span class="st">"Deallocate smoking among 15 randomly selected smokers\n"</span>,
                     <span class="st">"Rank = 1, encourage this woman to stop smoking first"</span><span class="op">)</span>
<span class="va">st_caption</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Linear regression of birth weight on smoking. Data from Hosmer et. al. (1998)"</span><span class="op">)</span>
<span class="va">st_x_lab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Efficiency (Utilitarian) --&gt; Cobb-Douglas --&gt; Equity (Rawlsian)"</span><span class="op">)</span>
<span class="va">st_y_lab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Rank Along Binary Allocation Queue ( 1 = highest ranked)"</span><span class="op">)</span>

<span class="va">tb_opti_alloc_all_rho_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rho_num</span>, y <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">svr_inpalc</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">Index</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">race</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">race</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tb_opti_alloc_all_rho_long</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">st_x_lab</span>,
         y <span class="op">=</span> <span class="va">st_y_lab</span>, 
         title <span class="op">=</span> <span class="va">st_title</span>, 
         subtitle <span class="op">=</span> <span class="va">st_subtitle</span>,
         caption <span class="op">=</span> <span class="va">st_caption</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/ffy_opt_ghthm_dk.html">ffy_opt_ghthm_dk</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span><span class="va">tb_opti_alloc_all_rho</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">rho_c1_rk</span>,x<span class="op">=</span><span class="fl">0.6</span>,label<span class="op">=</span><span class="va">Index</span><span class="op">)</span>,hjust<span class="op">=</span><span class="st">"right"</span><span class="op">)</span></code></pre></div>
<p><img src="ffv_opt_sobin_rkone_allrw_wgt_files/figure-html/binary%20allocation%20bump%20plot-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://fanwangecon.github.io" class="external-link">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
