<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Function Test Binary Allocation with Linear Regression • Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Function Test Binary Allocation with Linear Regression">
<meta property="og:description" content="Test binary optimal allocation solution function from package. 
Use the the birthwt testing dataset. Regression birth weight on smoking status.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue.pdf">Paper</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue_Present.pdf">Slides</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/">Python Examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://fanwangecon.github.io/">Fan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ffv_opt_sobin_rkone_allrw_wgt_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Function Test Binary Allocation with Linear Regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/master/vignettes/ffv_opt_sobin_rkone_allrw_wgt.Rmd"><code>vignettes/ffv_opt_sobin_rkone_allrw_wgt.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_sobin_rkone_allrw_wgt.Rmd</code></div>

    </div>

    
    
<p>The effects of mother’s smoking status on birth weight. If we aim to improve health outcomes, what is the priority sequence of mothers whom we would want to discourage from smoking.</p>
<div id="load-packages-and-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-packages-and-data" class="anchor"></a>Load Packages and Data</h2>
<div id="load-dependencies" class="section level3">
<h3 class="hasAnchor">
<a href="#load-dependencies" class="anchor"></a>Load Dependencies</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="kw">all.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">knitr.duplicate.label</span> <span class="kw">=</span> <span class="st">'allow'</span>)</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stringr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">broom</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">REconTools</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">PrjOptiAlloc</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">knitr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">kableExtra</span>)</pre></body></html></div>
</div>
<div id="load-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load Data</h3>
<p>Generate four categories by initial height and mother’s education levels combinations.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Load Data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">df_opt_birthwt</span>)

<span class="co"># Summarize</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">df_opt_birthwt</span>)</pre></body></html></div>
<pre><code>## 'data.frame':    189 obs. of  11 variables:
##  $ Index: int  85 86 87 88 89 91 92 93 94 95 ...
##  $ low  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ age  : int  19 33 20 21 18 21 22 17 29 26 ...
##  $ lwt  : int  182 155 105 108 107 124 118 103 123 113 ...
##  $ race : int  2 3 1 1 1 3 1 3 1 1 ...
##  $ smoke: int  0 0 1 1 1 0 0 0 1 1 ...
##  $ ptl  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ht   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ui   : int  1 0 0 1 1 0 0 0 0 0 ...
##  $ ftv  : int  0 3 1 2 0 0 1 1 1 0 ...
##  $ bwt  : int  2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...</code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opt_birthwt</span>)</pre></body></html></div>
<pre><code>##      Index            low              age             lwt       
##  Min.   :  4.0   Min.   :0.0000   Min.   :14.00   Min.   : 80.0  
##  1st Qu.: 68.0   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0  
##  Median :123.0   Median :0.0000   Median :23.00   Median :121.0  
##  Mean   :121.1   Mean   :0.3122   Mean   :23.24   Mean   :129.8  
##  3rd Qu.:176.0   3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0  
##  Max.   :226.0   Max.   :1.0000   Max.   :45.00   Max.   :250.0  
##       race           smoke             ptl               ht         
##  Min.   :1.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  
##  1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000  
##  Median :1.000   Median :0.0000   Median :0.0000   Median :0.00000  
##  Mean   :1.847   Mean   :0.3915   Mean   :0.1958   Mean   :0.06349  
##  3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.00000  
##  Max.   :3.000   Max.   :1.0000   Max.   :3.0000   Max.   :1.00000  
##        ui              ftv              bwt      
##  Min.   :0.0000   Min.   :0.0000   Min.   : 709  
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2414  
##  Median :0.0000   Median :0.0000   Median :2977  
##  Mean   :0.1481   Mean   :0.7937   Mean   :2945  
##  3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:3487  
##  Max.   :1.0000   Max.   :6.0000   Max.   :4990</code></pre>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># Generate Discrete Version of continuous variables</span>
<span class="no">df_opt_birthwt</span> <span class="kw">&lt;-</span> <span class="no">df_opt_birthwt</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">momwgtLowHigh</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">lwt</span>,
                               <span class="kw">breaks</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">Inf</span>, <span class="fl">129</span>, <span class="fl">Inf</span>),
                               <span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"LW"</span>,<span class="st">"HW"</span>))) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">mombirthage</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">age</span>,
                               <span class="kw">breaks</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">Inf</span>, <span class="fl">24</span>, <span class="fl">Inf</span>),
                               <span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"young"</span>,<span class="st">"older"</span>))) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">ftvm3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">ftv</span>,
                               <span class="kw">breaks</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">Inf</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">Inf</span>),
                               <span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"novisit"</span>,<span class="st">"1visit"</span>,<span class="st">"morevisit"</span>)))

<span class="fu"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(<span class="no">df_opt_birthwt</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opt_birthwt</span>)</pre></body></html></div>
<pre><code>##      Index            low              age             lwt       
##  Min.   :  4.0   Min.   :0.0000   Min.   :14.00   Min.   : 80.0  
##  1st Qu.: 68.0   1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0  
##  Median :123.0   Median :0.0000   Median :23.00   Median :121.0  
##  Mean   :121.1   Mean   :0.3122   Mean   :23.24   Mean   :129.8  
##  3rd Qu.:176.0   3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0  
##  Max.   :226.0   Max.   :1.0000   Max.   :45.00   Max.   :250.0  
##       race           smoke             ptl               ht         
##  Min.   :1.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.00000  
##  1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000  
##  Median :1.000   Median :0.0000   Median :0.0000   Median :0.00000  
##  Mean   :1.847   Mean   :0.3915   Mean   :0.1958   Mean   :0.06349  
##  3rd Qu.:3.000   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.00000  
##  Max.   :3.000   Max.   :1.0000   Max.   :3.0000   Max.   :1.00000  
##        ui              ftv              bwt       momwgtLowHigh mombirthage
##  Min.   :0.0000   Min.   :0.0000   Min.   : 709   LW:110        young:120  
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2414   HW: 79        older: 69  
##  Median :0.0000   Median :0.0000   Median :2977                            
##  Mean   :0.1481   Mean   :0.7937   Mean   :2945                            
##  3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:3487                            
##  Max.   :1.0000   Max.   :6.0000   Max.   :4990                            
##        ftvm3    
##  novisit  :147  
##  1visit   : 30  
##  morevisit: 12  
##                 
##                 
## </code></pre>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># tabulate</span>
<span class="no">df_opt_birthwt</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">race</span>, <span class="no">smoke</span>, <span class="no">ftv</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="kw">freq</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>()) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span>(<span class="kw">names_from</span> <span class="kw">=</span> <span class="no">race</span>, <span class="kw">values_from</span> <span class="kw">=</span> <span class="no">freq</span>)</pre></body></html></div>
<pre><code>## # A tibble: 11 x 5
## # Groups:   smoke [2]
##    smoke   ftv   `1`   `2`   `3`
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1     0     0    13     8    34
##  2     0     1    20     4    11
##  3     0     2     9     3     7
##  4     0     3     1    NA     2
##  5     0     4     1     1     1
##  6     1     0    30     6     9
##  7     1     1     9     2     1
##  8     1     2     9     1     1
##  9     1     3     3     1    NA
## 10     1     4     1    NA    NA
## 11     1     6    NA    NA     1</code></pre>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">mombirthage</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ht</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ui</span>)))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(mombirthage) + factor(race) + 
##     factor(ht) + factor(ui))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1594.45  -453.35    40.06   468.89  1891.04 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              2572.173    237.094  10.849  &lt; 2e-16 ***
## lwt                         5.216      1.735   3.006  0.00302 ** 
## factor(mombirthage)older -114.841    102.918  -1.116  0.26596    
## factor(race)2            -453.756    150.971  -3.006  0.00302 ** 
## factor(race)3            -216.550    108.069  -2.004  0.04657 *  
## factor(ht)1              -633.028    205.271  -3.084  0.00236 ** 
## factor(ui)1              -563.302    138.153  -4.077  6.8e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 664.4 on 182 degrees of freedom
## Multiple R-squared:  0.1964, Adjusted R-squared:  0.1699 
## F-statistic: 7.412 on 6 and 182 DF,  p-value: 4.131e-07</code></pre>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>):<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>) - <span class="fl">1</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2360.77  -434.48    42.18   469.28  1710.36 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                             3.711      1.739   2.134 0.034154 *  
## age                            -4.760     10.054  -0.473 0.636500    
## factor(race)1                3037.381    339.863   8.937 4.55e-16 ***
## factor(race)2                2394.843    344.390   6.954 6.25e-11 ***
## factor(race)3                2480.085    293.002   8.464 8.57e-15 ***
## factor(race)1:factor(smoke)1 -570.605    143.546  -3.975 0.000102 ***
## factor(race)2:factor(smoke)1 -305.314    277.419  -1.101 0.272553    
## factor(race)3:factor(smoke)1  -75.981    216.468  -0.351 0.725994    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 678.9 on 181 degrees of freedom
## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 
## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>):<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>) - <span class="fl">1</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2360.77  -434.48    42.18   469.28  1710.36 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                             3.711      1.739   2.134 0.034154 *  
## age                            -4.760     10.054  -0.473 0.636500    
## factor(race)1                3037.381    339.863   8.937 4.55e-16 ***
## factor(race)2                2394.843    344.390   6.954 6.25e-11 ***
## factor(race)3                2480.085    293.002   8.464 8.57e-15 ***
## factor(race)1:factor(smoke)1 -570.605    143.546  -3.975 0.000102 ***
## factor(race)2:factor(smoke)1 -305.314    277.419  -1.101 0.272553    
## factor(race)3:factor(smoke)1  -75.981    216.468  -0.351 0.725994    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 678.9 on 181 degrees of freedom
## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 
## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ftv</span>) - <span class="fl">1</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ factor(ftv) - 1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2156.1  -484.1     0.0   578.9  1882.0 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## factor(ftv)0  2865.14      72.57  39.481  &lt; 2e-16 ***
## factor(ftv)1  3108.00     105.85  29.361  &lt; 2e-16 ***
## factor(ftv)2  3010.33     132.49  22.721  &lt; 2e-16 ***
## factor(ftv)3  2521.86     274.29   9.194  &lt; 2e-16 ***
## factor(ftv)4  3167.75     362.85   8.730 1.57e-15 ***
## factor(ftv)6  3303.00     725.70   4.551 9.69e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 725.7 on 183 degrees of freedom
## Multiple R-squared:  0.9446, Adjusted R-squared:  0.9428 
## F-statistic: 519.8 on 6 and 183 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ftv</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ht</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ui</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ptl</span>) - <span class="fl">1</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ factor(ftv) + factor(ht) + factor(ui) + factor(ptl) - 
##     1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1549.7  -443.4    30.2   490.4  1689.2 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## factor(ftv)0  3046.85      75.04  40.605  &lt; 2e-16 ***
## factor(ftv)1  3300.80     104.23  31.669  &lt; 2e-16 ***
## factor(ftv)2  3138.61     124.69  25.172  &lt; 2e-16 ***
## factor(ftv)3  2668.40     255.84  10.430  &lt; 2e-16 ***
## factor(ftv)4  3419.95     343.36   9.960  &lt; 2e-16 ***
## factor(ftv)6  3303.00     669.62   4.933 1.85e-06 ***
## factor(ht)1   -457.90     203.35  -2.252 0.025560 *  
## factor(ui)1   -567.88     143.45  -3.959 0.000109 ***
## factor(ptl)1  -504.40     152.28  -3.312 0.001121 ** 
## factor(ptl)2  -154.48     308.71  -0.500 0.617411    
## factor(ptl)3  1158.03     684.48   1.692 0.092428 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 669.6 on 178 degrees of freedom
## Multiple R-squared:  0.9541, Adjusted R-squared:  0.9513 
## F-statistic: 336.3 on 11 and 178 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + (<span class="no">ftv</span>) - <span class="fl">1</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(race) + (ftv) - 1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2088.45  -445.67    49.21   489.85  1927.65 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## lwt              4.609      1.769   2.605  0.00993 ** 
## factor(race)1 2483.595    243.002  10.220  &lt; 2e-16 ***
## factor(race)2 2033.475    292.413   6.954 5.99e-11 ***
## factor(race)3 2244.345    227.567   9.862  &lt; 2e-16 ***
## ftv             11.821     49.171   0.240  0.81028    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 704.9 on 184 degrees of freedom
## Multiple R-squared:  0.9474, Adjusted R-squared:  0.946 
## F-statistic: 663.1 on 5 and 184 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div id="regression-with-data-and-construct-input-arrays" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-with-data-and-construct-input-arrays" class="anchor"></a>Regression with Data and Construct Input Arrays</h2>
<div id="binary-problem-regress-birth-weight-on-mothers-smoking-status" class="section level3">
<h3 class="hasAnchor">
<a href="#binary-problem-regress-birth-weight-on-mothers-smoking-status" class="anchor"></a>Binary Problem Regress Birth Weight on Mother’s Smoking Status</h3>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># A. Regress child birth weight on mother's age, race and mother's weight</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">mombirthage</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>))))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(mombirthage) + factor(race))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2032.96  -430.84    31.49   454.21  1985.68 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              2494.551    242.319  10.294  &lt; 2e-16 ***
## lwt                         4.910      1.774   2.767  0.00623 ** 
## factor(mombirthage)older  -94.175    108.852  -0.865  0.38808    
## factor(race)2            -473.966    159.734  -2.967  0.00340 ** 
## factor(race)3            -247.629    114.199  -2.168  0.03141 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 703.5 on 184 degrees of freedom
## Multiple R-squared:  0.08898,    Adjusted R-squared:  0.06918 
## F-statistic: 4.493 on 4 and 184 DF,  p-value: 0.001736</code></pre>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">mombirthage</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ht</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ui</span>))))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + factor(mombirthage) + factor(race) + 
##     factor(ht) + factor(ui))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1594.45  -453.35    40.06   468.89  1891.04 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              2572.173    237.094  10.849  &lt; 2e-16 ***
## lwt                         5.216      1.735   3.006  0.00302 ** 
## factor(mombirthage)older -114.841    102.918  -1.116  0.26596    
## factor(race)2            -453.756    150.971  -3.006  0.00302 ** 
## factor(race)3            -216.550    108.069  -2.004  0.04657 *  
## factor(ht)1              -633.028    205.271  -3.084  0.00236 ** 
## factor(ui)1              -563.302    138.153  -4.077  6.8e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 664.4 on 182 degrees of freedom
## Multiple R-squared:  0.1964, Adjusted R-squared:  0.1699 
## F-statistic: 7.412 on 6 and 182 DF,  p-value: 4.131e-07</code></pre>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ht</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ui</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ptl</span>))))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(ht) + factor(ui) + 
##     factor(ptl))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1657.31  -411.29    36.18   456.73  1767.04 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2579.886    300.172   8.595 4.05e-15 ***
## lwt              4.764      1.734   2.748  0.00661 ** 
## age              1.269      9.530   0.133  0.89423    
## factor(race)2 -395.097    150.621  -2.623  0.00946 ** 
## factor(race)3 -180.030    107.653  -1.672  0.09621 .  
## factor(ht)1   -600.670    202.597  -2.965  0.00344 ** 
## factor(ui)1   -557.704    140.164  -3.979  0.00010 ***
## factor(ptl)1  -378.084    146.938  -2.573  0.01089 *  
## factor(ptl)2   -85.706    300.941  -0.285  0.77613    
## factor(ptl)3  1130.511    672.124   1.682  0.09431 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 654.1 on 179 degrees of freedom
## Multiple R-squared:  0.2339, Adjusted R-squared:  0.1954 
## F-statistic: 6.072 on 9 and 179 DF,  p-value: 1.975e-07</code></pre>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>))))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(smoke))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2281.9  -449.1    24.3   474.1  1746.2 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2839.433    321.435   8.834  8.2e-16 ***
## lwt               4.000      1.738   2.301  0.02249 *  
## age              -1.948      9.820  -0.198  0.84299    
## factor(race)2  -510.501    157.077  -3.250  0.00137 ** 
## factor(race)3  -398.644    119.579  -3.334  0.00104 ** 
## factor(smoke)1 -401.720    109.241  -3.677  0.00031 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 682.1 on 183 degrees of freedom
## Multiple R-squared:  0.1483, Adjusted R-squared:  0.125 
## F-statistic: 6.373 on 5 and 183 DF,  p-value: 1.758e-05</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ht</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ui</span>) +  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>))))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(ht) + factor(ui) + 
##     factor(smoke))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1819.85  -452.86    59.91   460.49  1726.15 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2933.466    310.773   9.439  &lt; 2e-16 ***
## lwt               4.396      1.707   2.575 0.010815 *  
## age              -4.673      9.337  -0.500 0.617383    
## factor(race)2  -490.638    149.188  -3.289 0.001209 ** 
## factor(race)3  -356.613    113.856  -3.132 0.002024 ** 
## factor(ht)1    -590.029    200.290  -2.946 0.003644 ** 
## factor(ui)1    -528.534    135.088  -3.913 0.000129 ***
## factor(smoke)1 -360.708    104.027  -3.467 0.000656 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 647.3 on 181 degrees of freedom
## Multiple R-squared:  0.2414, Adjusted R-squared:  0.2121 
## F-statistic:  8.23 on 7 and 181 DF,  p-value: 1.057e-08</code></pre>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">momwgtLowHigh</span>):<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>) - <span class="fl">1</span>)))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(momwgtLowHigh):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2075.34  -433.57    33.95   512.59  1781.49 
## 
## Coefficients:
##                                        Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                                       4.639      2.584   1.795   0.0743 .  
## age                                       7.426     10.009   0.742   0.4591    
## factor(momwgtLowHigh)LW:factor(smoke)0 2303.715    360.918   6.383 1.39e-09 ***
## factor(momwgtLowHigh)HW:factor(smoke)0 2236.467    462.299   4.838 2.78e-06 ***
## factor(momwgtLowHigh)LW:factor(smoke)1 2019.699    358.516   5.634 6.57e-08 ***
## factor(momwgtLowHigh)HW:factor(smoke)1 1987.478    473.861   4.194 4.26e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 712.3 on 183 degrees of freedom
## Multiple R-squared:  0.9466, Adjusted R-squared:  0.9448 
## F-statistic: 540.6 on 6 and 183 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ht</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ui</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>):<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>))))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(ht) + factor(ui) + factor(race) + 
##     factor(race):factor(smoke))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1866.50  -416.40    20.14   404.49  1678.65 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  3103.394    329.074   9.431  &lt; 2e-16 ***
## lwt                             3.950      1.714   2.305  0.02234 *  
## age                            -6.177      9.543  -0.647  0.51833    
## factor(ht)1                  -543.753    200.920  -2.706  0.00746 ** 
## factor(ui)1                  -550.326    136.026  -4.046 7.75e-05 ***
## factor(race)2                -544.929    199.565  -2.731  0.00695 ** 
## factor(race)3                -500.559    138.465  -3.615  0.00039 ***
## factor(race)1:factor(smoke)1 -497.444    137.338  -3.622  0.00038 ***
## factor(race)2:factor(smoke)1 -414.559    264.495  -1.567  0.11880    
## factor(race)3:factor(smoke)1  -13.101    207.582  -0.063  0.94975    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 644 on 179 degrees of freedom
## Multiple R-squared:  0.2573, Adjusted R-squared:  0.2199 
## F-statistic:  6.89 on 9 and 179 DF,  p-value: 1.69e-08</code></pre>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>):<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>) - <span class="fl">1</span>)))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ lwt + age + factor(race) + factor(race):factor(smoke) - 
##     1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2360.77  -434.48    42.18   469.28  1710.36 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## lwt                             3.711      1.739   2.134 0.034154 *  
## age                            -4.760     10.054  -0.473 0.636500    
## factor(race)1                3037.381    339.863   8.937 4.55e-16 ***
## factor(race)2                2394.843    344.390   6.954 6.25e-11 ***
## factor(race)3                2480.085    293.002   8.464 8.57e-15 ***
## factor(race)1:factor(smoke)1 -570.605    143.546  -3.975 0.000102 ***
## factor(race)2:factor(smoke)1 -305.314    277.419  -1.101 0.272553    
## factor(race)3:factor(smoke)1  -75.981    216.468  -0.351 0.725994    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 678.9 on 181 degrees of freedom
## Multiple R-squared:  0.952,  Adjusted R-squared:  0.9499 
## F-statistic: 448.9 on 8 and 181 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="co"># Preferred way of appearing, in the following regression we can se:</span>
<span class="co"># 1. more more power less MPG, Straight engine slightly higher MPG</span>
<span class="co"># 2. V-shape engine car, going from auto to manual trans gain 4.1 MPG</span>
<span class="co"># 2. straight shape engine, going from auto to manual trans gain 6.67 MPG</span>

<span class="co"># Store Regression Results</span>
<span class="no">mt_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="no">lwt</span> + <span class="no">age</span> + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ht</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ui</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">ptl</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) + <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">smoke</span>):<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>))
<span class="no">rs_wgt_on_smke</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">bwt</span> ~ <span class="no">mt_model</span> - <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">rs_wgt_on_smke</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = bwt ~ mt_model - 1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1863.18  -380.81    12.97   406.28  1623.16 
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(&gt;|t|)    
## mt_model(Intercept)                  3052.734    325.825   9.369  &lt; 2e-16 ***
## mt_modellwt                             3.926      1.700   2.309 0.022110 *  
## mt_modelage                            -3.750      9.580  -0.391 0.695949    
## mt_modelfactor(ht)1                  -530.489    198.071  -2.678 0.008101 ** 
## mt_modelfactor(ui)1                  -570.137    137.361  -4.151 5.16e-05 ***
## mt_modelfactor(ptl)1                 -281.977    145.534  -1.938 0.054281 .  
## mt_modelfactor(ptl)2                  -50.395    293.124  -0.172 0.863695    
## mt_modelfactor(ptl)3                 1347.020    654.426   2.058 0.041033 *  
## mt_modelfactor(race)2                -501.650    198.139  -2.532 0.012223 *  
## mt_modelfactor(race)3                -462.499    137.560  -3.362 0.000949 ***
## mt_modelfactor(race)1:factor(smoke)1 -471.806    138.040  -3.418 0.000784 ***
## mt_modelfactor(race)2:factor(smoke)1 -407.064    260.512  -1.563 0.119954    
## mt_modelfactor(race)3:factor(smoke)1   29.264    205.896   0.142 0.887139    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 634.2 on 176 degrees of freedom
## Multiple R-squared:  0.9593, Adjusted R-squared:  0.9563 
## F-statistic:   319 on 13 and 176 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="no">rs_wgt_on_smke_tidy</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/broom/man/reexports.html">tidy</a></span>(<span class="no">rs_wgt_on_smke</span>)
<span class="no">rs_wgt_on_smke_tidy</span></pre></body></html></div>
<pre><code>## # A tibble: 13 x 5
##    term                                 estimate std.error statistic  p.value
##    &lt;chr&gt;                                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 mt_model(Intercept)                   3053.      326.       9.37  3.53e-17
##  2 mt_modellwt                              3.93      1.70     2.31  2.21e- 2
##  3 mt_modelage                             -3.75      9.58    -0.391 6.96e- 1
##  4 mt_modelfactor(ht)1                   -530.      198.      -2.68  8.10e- 3
##  5 mt_modelfactor(ui)1                   -570.      137.      -4.15  5.16e- 5
##  6 mt_modelfactor(ptl)1                  -282.      146.      -1.94  5.43e- 2
##  7 mt_modelfactor(ptl)2                   -50.4     293.      -0.172 8.64e- 1
##  8 mt_modelfactor(ptl)3                  1347.      654.       2.06  4.10e- 2
##  9 mt_modelfactor(race)2                 -502.      198.      -2.53  1.22e- 2
## 10 mt_modelfactor(race)3                 -462.      138.      -3.36  9.49e- 4
## 11 mt_modelfactor(race)1:factor(smoke)1  -472.      138.      -3.42  7.84e- 4
## 12 mt_modelfactor(race)2:factor(smoke)1  -407.      261.      -1.56  1.20e- 1
## 13 mt_modelfactor(race)3:factor(smoke)1    29.3     206.       0.142 8.87e- 1</code></pre>
</div>
<div id="construct-input-arrays-a_i-and-alpha_i" class="section level3">
<h3 class="hasAnchor">
<a href="#construct-input-arrays-a_i-and-alpha_i" class="anchor"></a>Construct Input Arrays <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span>
</h3>
<p>Multiply coefficient vector by covariate matrix to generate <em>A</em> vector that is child/individual specific.</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="co"># Estimates Table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">rs_wgt_on_smke_tidy</span>, <span class="fl">6</span>)</pre></body></html></div>
<pre><code>## # A tibble: 6 x 5
##   term                 estimate std.error statistic  p.value
##   &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 mt_model(Intercept)   3053.      326.       9.37  3.53e-17
## 2 mt_modellwt              3.93      1.70     2.31  2.21e- 2
## 3 mt_modelage             -3.75      9.58    -0.391 6.96e- 1
## 4 mt_modelfactor(ht)1   -530.      198.      -2.68  8.10e- 3
## 5 mt_modelfactor(ui)1   -570.      137.      -4.15  5.16e- 5
## 6 mt_modelfactor(ptl)1  -282.      146.      -1.94  5.43e- 2</code></pre>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="co"># Covariates</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">mt_model</span>, <span class="fl">5</span>)</pre></body></html></div>
<pre><code>##   (Intercept) lwt age factor(ht)1 factor(ui)1 factor(ptl)1 factor(ptl)2
## 1           1 182  19           0           1            0            0
## 2           1 155  33           0           0            0            0
## 3           1 105  20           0           0            0            0
## 4           1 108  21           0           1            0            0
## 5           1 107  18           0           1            0            0
##   factor(ptl)3 factor(race)2 factor(race)3 factor(race)1:factor(smoke)1
## 1            0             1             0                            0
## 2            0             0             1                            0
## 3            0             0             0                            1
## 4            0             0             0                            1
## 5            0             0             0                            1
##   factor(race)2:factor(smoke)1 factor(race)3:factor(smoke)1
## 1                            0                            0
## 2                            0                            0
## 3                            0                            0
## 4                            0                            0
## 5                            0                            0</code></pre>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="co"># Covariates coefficients from regression (including constant)</span>
<span class="no">ar_fl_cova_esti</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">rs_wgt_on_smke_tidy</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">term</span>, <span class="st">'smoke'</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">estimate</span>))
<span class="no">ar_fl_main_esti</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">rs_wgt_on_smke_tidy</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">term</span>, <span class="st">'smoke'</span>)) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">estimate</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">ar_fl_cova_esti</span>, <span class="fl">5</span>)</pre></body></html></div>
<pre><code>##         estimate
## [1,] 3052.733875
## [2,]    3.925643
## [3,]   -3.749898
## [4,] -530.488594
## [5,] -570.136918</code></pre>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">ar_fl_main_esti</span>, <span class="fl">5</span>)</pre></body></html></div>
<pre><code>##       estimate
## [1,] -471.8059
## [2,] -407.0641
## [3,]   29.2642</code></pre>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="co"># Select Matrix subcomponents</span>
<span class="no">mt_cova</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">mt_model</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"smoke"</span>)))
<span class="no">mt_intr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">race</span>) - <span class="fl">1</span>)

<span class="co"># Generate A_i, use mt_cova_wth_const</span>
<span class="no">ar_A_m</span> <span class="kw">&lt;-</span> <span class="no">mt_cova</span> <span class="kw">%*%</span> <span class="no">ar_fl_cova_esti</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">ar_A_m</span>, <span class="fl">5</span>)</pre></body></html></div>
<pre><code>##      estimate
## [1,] 2624.166
## [2,] 3074.963
## [3,] 3389.928
## [4,] 2827.819
## [5,] 2835.143</code></pre>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="co"># Generate alpha_i</span>
<span class="no">ar_alpha_m</span> <span class="kw">&lt;-</span> <span class="no">mt_intr</span> <span class="kw">%*%</span> <span class="no">ar_fl_main_esti</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">ar_alpha_m</span>, <span class="fl">5</span>)</pre></body></html></div>
<pre><code>##    estimate
## 1 -407.0641
## 2   29.2642
## 3 -471.8059
## 4 -471.8059
## 5 -471.8059</code></pre>
</div>
<div id="individual-weight" class="section level3">
<h3 class="hasAnchor">
<a href="#individual-weight" class="anchor"></a>Individual Weight</h3>
<div class="sourceCode" id="cb55"><html><body><pre class="r"><span class="co"># Child Weight</span>
<span class="no">ar_beta_m</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>/<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_A_m</span>), <span class="kw">times</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_A_m</span>))</pre></body></html></div>
</div>
<div id="matrix-with-required-inputs-for-allocation" class="section level3">
<h3 class="hasAnchor">
<a href="#matrix-with-required-inputs-for-allocation" class="anchor"></a>Matrix with Required Inputs for Allocation</h3>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="co"># Initate Dataframe that will store all estimates and optimal allocation relevant information</span>
<span class="co"># combine identifying key information along with estimation A, alpha results</span>
<span class="co"># note that we only need indi.id as key</span>
<span class="no">mt_opti</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_alpha_m</span>, <span class="no">ar_A_m</span>, <span class="no">ar_beta_m</span>)
<span class="no">ar_st_varnames</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'alpha'</span>, <span class="st">'A'</span>, <span class="st">'beta'</span>)
<span class="no">df_esti_alpha_A_beta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">mt_opti</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html">rename_all</a></span>(~<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_st_varnames</span>))</pre></body></html></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="no">tb_key_alpha_A_beta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span>(<span class="no">df_opt_birthwt</span>, <span class="no">df_esti_alpha_A_beta</span>) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'Index'</span>, <span class="st">'age'</span>, <span class="st">'lwt'</span>, <span class="st">'race'</span>, <span class="st">'smoke'</span>, <span class="st">'ptl'</span>, <span class="st">'ht'</span>, <span class="st">'ui'</span>, <span class="no">ar_st_varnames</span>)))

<span class="co"># Need to only include the smokers here</span>
<span class="co"># tb_key_alpha_A_beta &lt;- tb_key_alpha_A_beta %&gt;% filter(smoke == 1)</span>
<span class="co"># Randomly select 30 people</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">it_include</span> <span class="kw">&lt;-</span> <span class="fl">30</span>
<span class="no">tb_key_alpha_A_beta</span> <span class="kw">&lt;-</span> <span class="no">tb_key_alpha_A_beta</span>[<span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">tb_key_alpha_A_beta</span>)[<span class="fl">1</span>], <span class="no">it_include</span>, <span class="kw">replace</span><span class="kw">=</span><span class="fl">FALSE</span>),]

<span class="co"># Unique beta, A, and alpha check</span>
<span class="no">tb_opti_unique</span> <span class="kw">&lt;-</span> <span class="no">tb_key_alpha_A_beta</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(!!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval.html">syms</a></span>(<span class="no">ar_st_varnames</span>)) <span class="kw">%&gt;%</span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(!!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval.html">syms</a></span>(<span class="no">ar_st_varnames</span>)) <span class="kw">%&gt;%</span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">n_obs_group</span><span class="kw">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>())

<span class="co"># Show cars</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb_key_alpha_A_beta</span>, <span class="fl">32</span>)</pre></body></html></div>
<pre><code>##     Index age lwt race smoke ptl ht ui     alpha        A        beta
## 159    43  27 130    2     0   0  0  1 -407.0641 2390.034 0.005291005
## 179    69  23 110    1     1   1  0  0 -471.8059 3116.330 0.005291005
## 14     99  30 107    3     0   1  0  1   29.2642 2045.668 0.005291005
## 170    57  15 110    1     0   0  0  0 -471.8059 3428.306 0.005291005
## 50    137  22  85    3     1   0  0  0   29.2642 2841.417 0.005291005
## 118   214  28 130    3     0   0  0  0   29.2642 2995.571 0.005291005
## 43    130  23 130    2     0   0  0  0 -407.0641 2975.170 0.005291005
## 187    82  23  94    3     1   0  0  0   29.2642 2872.998 0.005291005
## 184    78  14 101    3     1   1  0  0   29.2642 2652.249 0.005291005
## 153    34  19 112    1     1   0  0  1 -471.8059 2851.021 0.005291005
## 90    184  22 125    1     0   0  0  0 -471.8059 3460.941 0.005291005
## 91    185  24 133    1     0   0  0  0 -471.8059 3484.847 0.005291005
## 178    68  17 120    1     1   0  0  0 -471.8059 3460.063 0.005291005
## 92    186  21 134    3     0   0  0  0   29.2642 3037.523 0.005291005
## 137    17  23  97    3     0   0  0  1   29.2642 2314.638 0.005291005
## 99    193  19 147    1     1   0  0  0 -471.8059 3558.555 0.005291005
## 72    163  31 150    3     1   0  0  0   29.2642 3062.834 0.005291005
## 26    112  28 167    1     0   0  0  0 -471.8059 3603.319 0.005291005
## 7      92  22 118    1     0   0  0  0 -471.8059 3433.462 0.005291005
## 186    81  14 100    3     0   0  0  0   29.2642 2930.301 0.005291005
## 175    63  23 120    3     0   0  0  0   29.2642 2975.064 0.005291005
## 164    49  18 148    3     0   0  0  0   29.2642 3103.732 0.005291005
## 78    170  32 134    1     1   1  0  0 -471.8059 3176.796 0.005291005
## 81    174  22 131    1     0   0  0  0 -471.8059 3484.495 0.005291005
## 183    77  26 190    1     1   0  0  0 -471.8059 3701.109 0.005291005
## 103   199  24 110    3     0   1  0  0   29.2642 2650.081 0.005291005
## 117   213  14 135    1     0   0  0  0 -471.8059 3530.197 0.005291005
## 76    168  18 229    2     0   0  0  0 -407.0641 3382.558 0.005291005
## 143    24  25 115    3     0   0  0  0   29.2642 2947.936 0.005291005
## 32    118  24  90    1     1   1  0  0 -471.8059 3034.067 0.005291005</code></pre>
</div>
</div>
<div id="optimal-linear-allocations" class="section level2">
<h2 class="hasAnchor">
<a href="#optimal-linear-allocations" class="anchor"></a>Optimal Linear Allocations</h2>
<div id="parameters-for-optimal-allocation" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters-for-optimal-allocation" class="anchor"></a>Parameters for Optimal Allocation</h3>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="co"># Child Count</span>
<span class="no">it_obs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">tb_opti_unique</span>)[<span class="fl">1</span>]

<span class="co"># Vector of Planner Preference</span>
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">100</span>, <span class="fl">0.8</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">50</span>, -<span class="fl">25</span>, -<span class="fl">10</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">100</span>, -<span class="fl">5</span>, -<span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">200</span>, -<span class="fl">100</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">100</span>, -<span class="fl">25</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">25</span>, -<span class="fl">5</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">5</span>, -<span class="fl">1</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">1</span>, -<span class="fl">0.01</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.01</span>, <span class="fl">0.25</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">5</span>), <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.25</span>, <span class="fl">0.90</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">5</span>))
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">100</span>, -<span class="fl">5</span>, -<span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.99</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">100</span>, -<span class="fl">10</span>, -<span class="fl">1</span>, <span class="fl">0.05</span>, <span class="fl">0.9</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fl">1</span> - (<span class="fl">10</span>^(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">2</span>,<span class="fl">2</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">10</span>))))
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">100</span>, -<span class="fl">10</span>, -<span class="fl">1</span>, -<span class="fl">0.5</span>, -<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.20</span>,  <span class="fl">0.9</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">110</span>, -<span class="fl">90</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">10</span>), -<span class="fl">50</span>, <span class="fl">10</span>, -<span class="fl">1</span>, -<span class="fl">0.5</span>, -<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.20</span>,  <span class="fl">0.9</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">ar_rho</span>)</pre></body></html></div>
</div>
<div id="optimal-binary-allocation" class="section level3">
<h3 class="hasAnchor">
<a href="#optimal-binary-allocation" class="anchor"></a>Optimal binary Allocation</h3>
<p>This also works with any CRS CES.</p>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="co"># Optimal Linear Equation</span>
<span class="no">svr_inpalc</span> <span class="kw">&lt;-</span> <span class="st">'rank'</span>

<span class="co"># Solve with Function</span>
<span class="no">ls_bin_solu_all_rhos</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="../reference/ffp_opt_anlyz_rhgin_bin.html">ffp_opt_anlyz_rhgin_bin</a></span>(<span class="no">tb_key_alpha_A_beta</span>, <span class="kw">svr_id_i</span> <span class="kw">=</span> <span class="st">'Index'</span>,
                          <span class="kw">svr_A_i</span> <span class="kw">=</span> <span class="st">'A'</span>, <span class="kw">svr_alpha_i</span> <span class="kw">=</span> <span class="st">'alpha'</span>, <span class="kw">svr_beta_i</span> <span class="kw">=</span> <span class="st">'beta'</span>,
                          <span class="kw">ar_rho</span> <span class="kw">=</span> <span class="no">ar_rho</span>,
                          <span class="kw">svr_inpalc</span> <span class="kw">=</span> <span class="no">svr_inpalc</span>,
                          <span class="kw">svr_expout</span> <span class="kw">=</span> <span class="st">'opti_exp_outcome'</span>)</pre></body></html></div>
<pre><code>## Joining, by = "Index"</code></pre>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="no">tb_opti_alloc_all_rho</span> <span class="kw">&lt;-</span> <span class="no">ls_bin_solu_all_rhos</span>$<span class="no">df_all_rho</span>
<span class="no">tb_opti_alloc_all_rho_long</span> <span class="kw">&lt;-</span> <span class="no">ls_bin_solu_all_rhos</span>$<span class="no">df_all_rho_long</span>

<span class="co"># Converge rho to numeric so the graph below sorts along x-axis properly </span>
<span class="no">tb_opti_alloc_all_rho_long</span> <span class="kw">&lt;-</span> <span class="no">tb_opti_alloc_all_rho_long</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_num</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">rho</span>))

<span class="co"># Merge to get Race Data</span>
<span class="no">tb_opti_alloc_all_rho_long</span> <span class="kw">&lt;-</span> <span class="no">tb_opti_alloc_all_rho_long</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(<span class="no">tb_key_alpha_A_beta</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">Index</span>, <span class="no">race</span>), <span class="kw">by</span><span class="kw">=</span><span class="st">'Index'</span>)</pre></body></html></div>
</div>
<div id="bump-plot-for-optimal-binary-allocations" class="section level3">
<h3 class="hasAnchor">
<a href="#bump-plot-for-optimal-binary-allocations" class="anchor"></a>Bump Plot for Optimal Binary Allocations</h3>
<div class="sourceCode" id="cb64"><html><body><pre class="r"><span class="no">tb_opti_alloc_all_rho_long</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">rho_num</span>, <span class="kw">y</span> <span class="kw">=</span> !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval.html">sym</a></span>(<span class="no">svr_inpalc</span>), <span class="kw">group</span> <span class="kw">=</span> <span class="no">Index</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">color</span> <span class="kw">=</span> <span class="no">race</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">1</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">2</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">color</span> <span class="kw">=</span> <span class="no">race</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">1</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">4</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span>(<span class="kw">expand</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.85</span>,<span class="fl">0</span>))+
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_reverse</a></span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">tb_opti_alloc_all_rho_long</span>))+
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Equality vs Efficiency"</span>,
         <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Rank"</span>,
         <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Binary Deallocation Rank, Weight and Smokng"</span>) +
    <span class="fu"><a href="../reference/ffy_opt_ghthm_dk.html">ffy_opt_ghthm_dk</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="kw">data</span> <span class="kw">=</span><span class="no">tb_opti_alloc_all_rho</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span><span class="kw">=</span><span class="no">rho_c1_rk</span>,<span class="kw">x</span><span class="kw">=</span><span class="fl">0.6</span>,<span class="kw">label</span><span class="kw">=</span><span class="no">Index</span>),<span class="kw">hjust</span><span class="kw">=</span><span class="st">"right"</span>)</pre></body></html></div>
<p><img src="ffv_opt_sobin_rkone_allrw_wgt_files/figure-html/binary%20allocation%20bump%20plot-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://fanwangecon.github.io">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
