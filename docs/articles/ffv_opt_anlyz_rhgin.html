<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Allocation Test Bounded-Continuous Function with Height Nutrition Data â€¢ Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Allocation Test Bounded-Continuous Function with Height Nutrition Data">
<meta property="og:description" content="Given allocation space parameters (A, alpha), test the lower-bounded continuous optimal allocation function.
Compare inequality measures given optimal allocations across planner preferences.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Papers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3839890" class="external-link">Optimal Allocations to Heterogeneous Agents with An Application to Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3691091" class="external-link">Optimal Allocation of the COVID-19 Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3547706" class="external-link">The Optimal Allocation of Resources among Heterogeneous Individuals</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/" class="external-link">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/" class="external-link">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/" class="external-link">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/" class="external-link">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/" class="external-link">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/" class="external-link">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/" class="external-link">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/" class="external-link">Python Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Allocation Test Bounded-Continuous Function with Height Nutrition Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/HEAD/vignettes/ffv_opt_anlyz_rhgin.Rmd" class="external-link"><code>vignettes/ffv_opt_anlyz_rhgin.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_anlyz_rhgin.Rmd</code></div>

    </div>

    
    
<p>Given allocation space parameters (A, alpha), test lower-bounded continuous optimal allocation solution.Compare inequality measures given optimal allocations across planner preferences. This function tests out the procedure to solve for optimal allocations over various rhos, and computes gini each time.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>all.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.duplicate.label <span class="op">=</span> <span class="st">'allow'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/REconTools/" class="external-link">REconTools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/PrjOptiAlloc/">PrjOptiAlloc</a></span><span class="op">)</span>

<span class="va">bl_save_rda</span> <span class="op">=</span> <span class="cn">FALSE</span></code></pre></div>
<div class="section level2">
<h2 id="get-data">Get Data<a class="anchor" aria-label="anchor" href="#get-data"></a>
</h2>
<p>Load data that is generated by regression <a href="https://fanwangecon.github.io/PrjOptiAlloc/reference/ffy_opt_dtgch_cbem4.html">ffy_opt_dtgch_cbem4</a> (<a href="https://fanwangecon.github.io/PrjOptiAlloc/articles/ffv_opt_dtgch_cbem4.html">vignette</a>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load Library</span>
<span class="va">ls_opti_alpha_A</span> <span class="op">&lt;-</span> <span class="fu">PrjOptiAlloc</span><span class="fu">::</span><span class="fu"><a href="../reference/ffy_opt_dtgch_cbem4.html">ffy_opt_dtgch_cbem4</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.</span>
<span class="co">## Using compatibility `.name_repair`.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_raw</span> <span class="op">&lt;-</span> <span class="va">ls_opti_alpha_A</span><span class="op">$</span><span class="va">df_raw</span>
<span class="va">df_hw_cebu_m24</span> <span class="op">&lt;-</span> <span class="va">df_raw</span>
<span class="va">df_esti</span> <span class="op">&lt;-</span> <span class="va">ls_opti_alpha_A</span><span class="op">$</span><span class="va">df_esti</span>

<span class="co"># Review dataframes</span>
<span class="co"># raw file</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_raw</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 10 x 17</span></span>
<span class="co">##    S.country vil.id indi.id sex    svymthRound momEdu wealthIdx   hgt    wgt</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> Cebu           1       2 Female          24    7.1       7.3  79.2 <span style="text-decoration: underline;">10</span>776.</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> Cebu           1       3 Female          24    9.4      10.3  76.7 <span style="text-decoration: underline;">10</span>296.</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> Cebu           1       4 Female          24   13.9      13.3  78.1  <span style="text-decoration: underline;">7</span>604.</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> Cebu           1       5 Male            24   11.3       9.3  84.1 <span style="text-decoration: underline;">11</span>787.</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Cebu           1       6 Female          24    7.3       7.3  76.9  <span style="text-decoration: underline;">7</span>991.</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> Cebu           1       7 Male            24   10.4       8.3  79.6 <span style="text-decoration: underline;">12</span>583.</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> Cebu           1       8 Female          24   13.5       9.3  81.5  <span style="text-decoration: underline;">8</span>358.</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> Cebu           1       9 Female          24   10.4      17.3  74.7  <span style="text-decoration: underline;">8</span>195.</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> Cebu           1      10 Male            24   10.5       6.3  77.1  <span style="text-decoration: underline;">9</span>442.</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> Cebu           1      11 Male            24    1.9       6.3  72.1  <span style="text-decoration: underline;">6</span>627.</span>
<span class="co">## <span style="color: #949494;"># ... with 8 more variables: hgt0 &lt;dbl&gt;, wgt0 &lt;dbl&gt;, prot &lt;dbl&gt;, cal &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   p.A.prot &lt;dbl&gt;, p.A.nProt &lt;dbl&gt;, momEduRound &lt;fct&gt;, hgt0med &lt;fct&gt;</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_esti</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 10 x 9</span></span>
<span class="co">##    S.country vil.id indi.id svymthRound alpha_lin alpha_log A_lin A_log     beta</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> Cebu           1       2          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  78.4  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> Cebu           1       3          24    0.032<span style="text-decoration: underline;">3</span>   0.009<span style="text-decoration: underline;">25</span>  79.9  4.36 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> Cebu           1       4          24    0.032<span style="text-decoration: underline;">3</span>   0.009<span style="text-decoration: underline;">25</span>  78.9  4.35 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> Cebu           1       5          24    0.066<span style="text-decoration: underline;">2</span>   0.013<span style="text-decoration: underline;">9</span>   80.6  4.37 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Cebu           1       6          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  77.8  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> Cebu           1       7          24    0.066<span style="text-decoration: underline;">2</span>   0.013<span style="text-decoration: underline;">9</span>   79.6  4.36 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> Cebu           1       8          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  77.8  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> Cebu           1       9          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  78.0  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> Cebu           1      10          24    0.066<span style="text-decoration: underline;">2</span>   0.013<span style="text-decoration: underline;">9</span>   80.0  4.36 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;">10</span> Cebu           1      11          24    0.060<span style="text-decoration: underline;">2</span>   0.012<span style="text-decoration: underline;">1</span>   77.7  4.33 0.000<span style="text-decoration: underline;">959</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ar_prot_data</span> <span class="op">=</span> <span class="va">df_hw_cebu_m24</span><span class="op">$</span><span class="va">prot</span>
<span class="va">fl_N_agg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ar_prot_data</span><span class="op">)</span>

<span class="co"># Attach</span>
<span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">df_raw</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## The following objects are masked from df_hw:</span>
<span class="co">## </span>
<span class="co">##     cal, hgt, hgt0, hgt0med, indi.id, momEdu, momEduRound, p.A.nProt,</span>
<span class="co">##     p.A.prot, prot, S.country, sex, svymthRound, vil.id, wealthIdx,</span>
<span class="co">##     wgt, wgt0</span></code></pre>
</div>
<div class="section level2">
<h2 id="solve">Solve<a class="anchor" aria-label="anchor" href="#solve"></a>
</h2>
<p>I would like to be able to directly call the dataset generated here in various functions. Save the datafile we just created in the project folder.</p>
<div class="section level3">
<h3 id="prep-inputs">Prep Inputs<a class="anchor" aria-label="anchor" href="#prep-inputs"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_opt_dtgch_cbem4</span>
<span class="va">svr_id_i</span> <span class="op">&lt;-</span> <span class="st">'indi.id'</span>
<span class="va">svr_A_i</span> <span class="op">&lt;-</span> <span class="st">'A_lin'</span>
<span class="va">svr_alpha_i</span> <span class="op">&lt;-</span> <span class="st">'alpha_lin'</span>
<span class="va">svr_beta_i</span> <span class="op">&lt;-</span> <span class="st">'beta'</span>
<span class="va">fl_N_agg</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span>
<span class="va">svr_inpalc</span> <span class="op">&lt;-</span> <span class="st">'optiallocate'</span>
<span class="va">svr_expout</span> <span class="op">&lt;-</span> <span class="st">'optiexpoutcm'</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="solve-relative-allocation-problem-looping-over-planner-elasticities">Solve Relative Allocation Problem Looping over Planner Elasticities<a class="anchor" aria-label="anchor" href="#solve-relative-allocation-problem-looping-over-planner-elasticities"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_opti_alloc_all_rho</span> <span class="op">&lt;-</span> <span class="va">df</span>
<span class="va">it_indi_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>

<span class="co"># A. First Loop over Planner Preference ----</span>
<span class="co"># Generate Rank Order</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">it_rho_ctr</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">fl_rho</span> <span class="op">=</span> <span class="va">ar_rho</span><span class="op">[</span><span class="va">it_rho_ctr</span><span class="op">]</span>

  <span class="co"># B. Invoke optimal linear (crs) solution problem ----</span>
  <span class="co"># ar_opti is the array of optimal choices, it is in df_opti as well.</span>
  <span class="co"># use df_opti for merging, because that contains the individual keys.</span>
  <span class="co"># actually file here should contain unique keys, unique key ID as required input. should return?</span>
  <span class="co"># actually it is fine, the function here needs the key, not solin_flinr</span>
  <span class="va">ls_lin_solu</span> <span class="op">&lt;-</span> <span class="fu">PrjOptiAlloc</span><span class="fu">::</span><span class="fu"><a href="../reference/ffp_opt_solin_relow.html">ffp_opt_solin_relow</a></span><span class="op">(</span>
    <span class="va">df</span>, <span class="va">svr_A_i</span>, <span class="va">svr_alpha_i</span>, <span class="va">svr_beta_i</span>, <span class="va">fl_N_agg</span>, <span class="va">fl_rho</span>,
    <span class="va">svr_inpalc</span>, <span class="va">svr_expout</span><span class="op">)</span>

  <span class="co"># C. Keep for df collection individual key + optimal allocation ----</span>
  <span class="co"># _on stands for optimal nutritional choices</span>
  <span class="co"># _eh stands for expected height</span>
  <span class="va">tb_opti_allocate_wth_key</span> <span class="op">&lt;-</span> <span class="va">ls_lin_solu</span><span class="op">$</span><span class="va">df_opti</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html" class="external-link">one_of</a></span><span class="op">(</span><span class="va">svr_id_i</span>, <span class="va">svr_inpalc</span>, <span class="va">svr_expout</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                                <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'rho_c'</span>, <span class="va">it_rho_ctr</span>, <span class="st">'_'</span>, <span class="va">svr_inpalc</span><span class="op">)</span> <span class="op">:=</span> <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">svr_inpalc</span><span class="op">)</span>,
                                        <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'rho_c'</span>, <span class="va">it_rho_ctr</span>, <span class="st">'_'</span>, <span class="va">svr_expout</span><span class="op">)</span> <span class="op">:=</span> <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">svr_expout</span><span class="op">)</span><span class="op">)</span>

  <span class="co"># D. merge optimal allocaiton results from different planner preference ----</span>
  <span class="va">df_opti_alloc_all_rho</span> <span class="op">&lt;-</span> <span class="va">df_opti_alloc_all_rho</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tb_opti_allocate_wth_key</span>, by<span class="op">=</span><span class="va">svr_id_i</span><span class="op">)</span>

<span class="op">}</span>

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_opti_alloc_all_rho</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 10 x 21</span></span>
<span class="co">##    S.country vil.id indi.id svymthRound alpha_lin alpha_log A_lin A_log     beta</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> Cebu           1       2          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  78.4  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> Cebu           1       3          24    0.032<span style="text-decoration: underline;">3</span>   0.009<span style="text-decoration: underline;">25</span>  79.9  4.36 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> Cebu           1       4          24    0.032<span style="text-decoration: underline;">3</span>   0.009<span style="text-decoration: underline;">25</span>  78.9  4.35 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> Cebu           1       5          24    0.066<span style="text-decoration: underline;">2</span>   0.013<span style="text-decoration: underline;">9</span>   80.6  4.37 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> Cebu           1       6          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  77.8  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> Cebu           1       7          24    0.066<span style="text-decoration: underline;">2</span>   0.013<span style="text-decoration: underline;">9</span>   79.6  4.36 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> Cebu           1       8          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  77.8  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> Cebu           1       9          24    0.010<span style="text-decoration: underline;">1</span>   0.006<span style="text-decoration: underline;">69</span>  78.0  4.34 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> Cebu           1      10          24    0.066<span style="text-decoration: underline;">2</span>   0.013<span style="text-decoration: underline;">9</span>   80.0  4.36 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #BCBCBC;">10</span> Cebu           1      11          24    0.060<span style="text-decoration: underline;">2</span>   0.012<span style="text-decoration: underline;">1</span>   77.7  4.33 0.000<span style="text-decoration: underline;">959</span></span>
<span class="co">## <span style="color: #949494;"># ... with 12 more variables: rho_c1_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c1_optiexpoutcm &lt;dbl&gt;, rho_c2_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c2_optiexpoutcm &lt;dbl&gt;, rho_c3_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c3_optiexpoutcm &lt;dbl&gt;, rho_c4_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c4_optiexpoutcm &lt;dbl&gt;, rho_c5_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c5_optiexpoutcm &lt;dbl&gt;, rho_c6_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c6_optiexpoutcm &lt;dbl&gt;</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_opti_alloc_all_rho</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">'rho'</span><span class="op">)</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 20 x 12</span></span>
<span class="co">##    rho_c1_optiallocate rho_c1_optiexpoutcm rho_c2_optiallocate rho_c2_optiexpou~</span>
<span class="co">##                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span>                0                   78.4                0                 78.4</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span>                0                   79.9                0                 79.9</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span>                0                   78.9                0                 78.9</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span>                0                   80.6                0                 80.6</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span>                0                   77.8                0                 77.8</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span>                0                   79.6                7.17              80.0</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span>                0                   77.8                0                 77.8</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span>                0                   78.0                0                 78.0</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span>                0                   80.0                1.17              80.0</span>
<span class="co">## <span style="color: #BCBCBC;">10</span>               25.8                 79.3               27.0               79.4</span>
<span class="co">## <span style="color: #BCBCBC;">11</span>               26.6                 79.3               27.7               79.4</span>
<span class="co">## <span style="color: #BCBCBC;">12</span>                0                   78.9                0                 78.9</span>
<span class="co">## <span style="color: #BCBCBC;">13</span>                8.82                79.3               10.0               79.4</span>
<span class="co">## <span style="color: #BCBCBC;">14</span>                0                   81.1                0                 81.1</span>
<span class="co">## <span style="color: #BCBCBC;">15</span>                0                   78.8                0                 78.8</span>
<span class="co">## <span style="color: #BCBCBC;">16</span>                0                   77.1                0                 77.1</span>
<span class="co">## <span style="color: #BCBCBC;">17</span>                0                   78.3                0                 78.3</span>
<span class="co">## <span style="color: #BCBCBC;">18</span>                0                   79.1                0                 79.1</span>
<span class="co">## <span style="color: #BCBCBC;">19</span>                0                   78.7                0                 78.7</span>
<span class="co">## <span style="color: #BCBCBC;">20</span>                0                   79.1                0                 79.1</span>
<span class="co">## <span style="color: #949494;"># ... with 8 more variables: rho_c3_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c3_optiexpoutcm &lt;dbl&gt;, rho_c4_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c4_optiexpoutcm &lt;dbl&gt;, rho_c5_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c5_optiexpoutcm &lt;dbl&gt;, rho_c6_optiallocate &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   rho_c6_optiexpoutcm &lt;dbl&gt;</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="extract-optimal-allocations-and-expected-outcomes">Extract Optimal Allocations and Expected Outcomes<a class="anchor" aria-label="anchor" href="#extract-optimal-allocations-and-expected-outcomes"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># E. Extract from All results Optimal Allocation and Expected Outcomes ----</span>
<span class="va">mt_opti_alloc_all_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">df_opti_alloc_all_rho</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="va">svr_inpalc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mt_expc_outcm_all_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">df_opti_alloc_all_rho</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="va">svr_expout</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mt_opti_alloc_all_rho</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  rho_c1_optiallocate rho_c2_optiallocate rho_c3_optiallocate</span>
<span class="co">##  Min.   :  0.000     Min.   : 0.000      Min.   : 0.000     </span>
<span class="co">##  1st Qu.:  0.000     1st Qu.: 0.000      1st Qu.: 0.000     </span>
<span class="co">##  Median :  0.000     Median : 0.000      Median : 0.000     </span>
<span class="co">##  Mean   :  9.588     Mean   : 9.588      Mean   : 9.588     </span>
<span class="co">##  3rd Qu.: 15.122     3rd Qu.:17.191      3rd Qu.: 0.000     </span>
<span class="co">##  Max.   :216.490     Max.   :94.000      Max.   :63.897     </span>
<span class="co">##  rho_c4_optiallocate rho_c5_optiallocate rho_c6_optiallocate</span>
<span class="co">##  Min.   : 0.000      Min.   : 0.000      Min.   : 0.000     </span>
<span class="co">##  1st Qu.: 0.000      1st Qu.: 0.000      1st Qu.: 0.000     </span>
<span class="co">##  Median : 0.000      Median : 0.000      Median : 0.000     </span>
<span class="co">##  Mean   : 9.588      Mean   : 9.588      Mean   : 9.588     </span>
<span class="co">##  3rd Qu.: 0.000      3rd Qu.: 0.000      3rd Qu.: 0.000     </span>
<span class="co">##  Max.   :64.217      Max.   :64.252      Max.   :64.252</span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mt_expc_outcm_all_rho</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  rho_c1_optiexpoutcm rho_c2_optiexpoutcm rho_c3_optiexpoutcm</span>
<span class="co">##  Min.   :76.56       Min.   :74.37       Min.   :74.37      </span>
<span class="co">##  1st Qu.:78.35       1st Qu.:78.35       1st Qu.:77.73      </span>
<span class="co">##  Median :79.28       Median :79.35       Median :78.46      </span>
<span class="co">##  Mean   :78.96       Mean   :79.05       Mean   :79.10      </span>
<span class="co">##  3rd Qu.:79.43       3rd Qu.:79.87       3rd Qu.:79.87      </span>
<span class="co">##  Max.   :84.61       Max.   :84.61       Max.   :84.61      </span>
<span class="co">##  rho_c4_optiexpoutcm rho_c5_optiexpoutcm rho_c6_optiexpoutcm</span>
<span class="co">##  Min.   :74.19       Min.   :73.70       Min.   :73.70      </span>
<span class="co">##  1st Qu.:77.73       1st Qu.:77.73       1st Qu.:77.73      </span>
<span class="co">##  Median :78.46       Median :78.46       Median :78.46      </span>
<span class="co">##  Mean   :79.10       Mean   :79.10       Mean   :79.10      </span>
<span class="co">##  3rd Qu.:79.87       3rd Qu.:79.87       3rd Qu.:79.87      </span>
<span class="co">##  Max.   :84.61       Max.   :84.61       Max.   :84.61</span></code></pre>
</div>
<div class="section level3">
<h3 id="calculate-gini-for-each-vector">Calculate GINI for each vector<a class="anchor" aria-label="anchor" href="#calculate-gini-for-each-vector"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># F. Compute gini for each rho ----</span>
<span class="co"># ff_dist_gini_vector_pos() is from REconTools</span>
<span class="va">ar_opti_alloc_gini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mt_opti_alloc_all_rho</span><span class="op">)</span>, <span class="fl">1</span>,
                                             <span class="fu">REconTools</span><span class="fu">::</span><span class="va"><a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html" class="external-link">ff_dist_gini_vector_pos</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_expc_outcm_gini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mt_expc_outcm_all_rho</span><span class="op">)</span>, <span class="fl">1</span>,
                                             <span class="fu">REconTools</span><span class="fu">::</span><span class="va"><a href="https://fanwangecon.github.io/REconTools/reference/ff_dist_gini_vector_pos.html" class="external-link">ff_dist_gini_vector_pos</a></span><span class="op">)</span><span class="op">)</span>

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ar_opti_alloc_gini</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## rho_c1_optiallocate rho_c2_optiallocate rho_c3_optiallocate rho_c4_optiallocate </span>
<span class="co">##           0.7496377           0.6902218           0.8089562           0.8105391 </span>
<span class="co">## rho_c5_optiallocate rho_c6_optiallocate </span>
<span class="co">##           0.8107186           0.8107186</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ar_expc_outcm_gini</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## rho_c1_optiexpoutcm rho_c2_optiexpoutcm rho_c3_optiexpoutcm rho_c4_optiexpoutcm </span>
<span class="co">##         0.006735065         0.007619387         0.013797035         0.013896702 </span>
<span class="co">## rho_c5_optiexpoutcm rho_c6_optiexpoutcm </span>
<span class="co">##         0.013907624         0.013907624</span></code></pre>
</div>
<div class="section level3">
<h3 id="gini-results-reshaping-for-easier-outputs">Gini Results Reshaping for Easier outputs<a class="anchor" aria-label="anchor" href="#gini-results-reshaping-for-easier-outputs"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># G. Wide to Long to Wide Gini ----</span>
<span class="co"># column names look like: rho_c1_on rho_c2_on rho_c3_on rho_c1_eh rho_c2_eh rho_c3_eh</span>
<span class="va">tb_gini_onerow_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ar_opti_alloc_gini</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ar_expc_outcm_gini</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">tb_gini_long</span> <span class="op">&lt;-</span> <span class="va">tb_gini_onerow_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"rho"</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"it_rho_ctr"</span>, <span class="st">"oneh"</span><span class="op">)</span>,
    names_pattern <span class="op">=</span> <span class="st">"rho_c(.*)_(.*)"</span>,
    values_to <span class="op">=</span> <span class="st">"gini"</span>
  <span class="op">)</span>
<span class="va">tb_gini_wide2</span> <span class="op">&lt;-</span> <span class="va">tb_gini_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>
    id_cols <span class="op">=</span> <span class="va">it_rho_ctr</span>,
    names_from <span class="op">=</span> <span class="va">oneh</span>,
    values_from <span class="op">=</span> <span class="va">gini</span>
  <span class="op">)</span>
<span class="va">planner_elas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ar_rho</span><span class="op">)</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span>
<span class="va">mt_gini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">tb_gini_wide2</span>, <span class="va">planner_elas</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tb_gini_onerow_wide</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   rho_c1_optiallocate rho_c2_optiallocate rho_c3_optiallocate</span>
<span class="co">## 1           0.7496377           0.6902218           0.8089562</span>
<span class="co">##   rho_c4_optiallocate rho_c5_optiallocate rho_c6_optiallocate</span>
<span class="co">## 1           0.8105391           0.8107186           0.8107186</span>
<span class="co">##   rho_c1_optiexpoutcm rho_c2_optiexpoutcm rho_c3_optiexpoutcm</span>
<span class="co">## 1         0.006735065         0.007619387          0.01379703</span>
<span class="co">##   rho_c4_optiexpoutcm rho_c5_optiexpoutcm rho_c6_optiexpoutcm</span>
<span class="co">## 1           0.0138967          0.01390762          0.01390762</span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tb_gini_long</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 12 x 3</span></span>
<span class="co">##    it_rho_ctr oneh            gini</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> 1          optiallocate 0.750  </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> 2          optiallocate 0.690  </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> 3          optiallocate 0.809  </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> 4          optiallocate 0.811  </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> 5          optiallocate 0.811  </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> 6          optiallocate 0.811  </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> 1          optiexpoutcm 0.006<span style="text-decoration: underline;">74</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> 2          optiexpoutcm 0.007<span style="text-decoration: underline;">62</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> 3          optiexpoutcm 0.013<span style="text-decoration: underline;">8</span> </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> 4          optiexpoutcm 0.013<span style="text-decoration: underline;">9</span> </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> 5          optiexpoutcm 0.013<span style="text-decoration: underline;">9</span> </span>
<span class="co">## <span style="color: #BCBCBC;">12</span> 6          optiexpoutcm 0.013<span style="text-decoration: underline;">9</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tb_gini_wide2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 x 3</span></span>
<span class="co">##   it_rho_ctr optiallocate optiexpoutcm</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> 1                 0.750      0.006<span style="text-decoration: underline;">74</span></span>
<span class="co">## <span style="color: #BCBCBC;">2</span> 2                 0.690      0.007<span style="text-decoration: underline;">62</span></span>
<span class="co">## <span style="color: #BCBCBC;">3</span> 3                 0.809      0.013<span style="text-decoration: underline;">8</span> </span>
<span class="co">## <span style="color: #BCBCBC;">4</span> 4                 0.811      0.013<span style="text-decoration: underline;">9</span> </span>
<span class="co">## <span style="color: #BCBCBC;">5</span> 5                 0.811      0.013<span style="text-decoration: underline;">9</span> </span>
<span class="co">## <span style="color: #BCBCBC;">6</span> 6                 0.811      0.013<span style="text-decoration: underline;">9</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mt_gini</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      it_rho_ctr optiallocate optiexpoutcm planner_elas</span>
<span class="co">## [1,]          1    0.7496377  0.006735065    0.7029034</span>
<span class="co">## [2,]          2    0.6902218  0.007619387    0.7375989</span>
<span class="co">## [3,]          3    0.8089562  0.013797035    1.0678406</span>
<span class="co">## [4,]          4    0.8105391  0.013896702    1.1349799</span>
<span class="co">## [5,]          5    0.8107186  0.013907624    1.3862944</span>
<span class="co">## [6,]          6    0.8107186  0.013907624    1.6739764</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="save-outputs">Save Outputs<a class="anchor" aria-label="anchor" href="#save-outputs"></a>
</h2>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># df_opt_dtgch_ropti: dataframe, opt project, data guat cebu height, cebu edu mother, results relative linear optimal</span>
<span class="va">df_opt_dtgch_cbem4_rrlop_allrh</span> <span class="op">&lt;-</span> <span class="va">df_opti_alloc_all_rho</span>
<span class="va">df_opt_dtgch_cbem4_rrlop_argin</span> <span class="op">&lt;-</span> <span class="va">mt_gini</span>
<span class="kw">if</span> <span class="op">(</span><span class="va">bl_save_rda</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data</a></span><span class="op">(</span><span class="va">df_opt_dtgch_cbem4_rrlop_allrh</span>, <span class="va">df_opt_dtgch_cbem4_rrlop_allrh</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data</a></span><span class="op">(</span><span class="va">df_opt_dtgch_cbem4_rrlop_argin</span>, <span class="va">df_opt_dtgch_cbem4_rrlop_argin</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://fanwangecon.github.io" class="external-link">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
