<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DISCRETE--Discrete Optimal Allocation California Teacher Student Ratio (Function) • PrjOptiAlloc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="DISCRETE--Discrete Optimal Allocation California Teacher Student Ratio (Function)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PrjOptiAlloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ffv_opt_anlyz_rhgin.html">ANALYSIS--Optimal Allocations Planner Elasticity Vector and Ginis</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_dtgch_cbem4.html">DATA--Generate Data Cebu Four Category Test Regression Results</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rev.html">BINARY--REV Test One Resource Equivalent Variation Computation (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rev_two.html">BINARY--REV Test Two Resource Equivalent Variation Computation (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allfc_training_logit.html">BINARY--NSW Training EMPLOYMENT as Outcome Optimal Allocation Solution</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_car.html">BINARY--MPG and Shift Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_training.html">BINARY--NSW Training WAGE and EMPLOYMENT Optimal Allocation Analysis</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_training_wage.html">BINARY--NSW Training WAGE Optimal Allocation Solution</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sobin_rkone_allrw_wgt.html">BINARY--Birth Weight and Doctors Visit Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sodis_rkone_casch_allfn.html">DISCRETE--Discrete Optimal Allocation California Teacher Student Ratio (Function)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_sodis_rkone_casch_allrw.html">DISCRETE--Discrete Optimal Allocation California Teacher Student Ratio (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow.html">LINEAR--Optimal Linear Allocation based On Relative Allocation to Lowest</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allfn.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Function)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_relow_allrw.html">LINEAR--CRS (Linear) Optimal Allocation Solution (Line by Line)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solog_asame_allrw.html">LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Analytical Common Alpha</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solog_bisec_allrw.html">LOG-LINEAR--DRS (Log-Linear) Optimal Allocation Implicit Bisection Solution (Line by Line)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>DISCRETE–Discrete Optimal Allocation California Teacher Student Ratio (Function)</h1>
            
      
      
      <div class="hidden name"><code>ffv_opt_sodis_rkone_casch_allfn.Rmd</code></div>

    </div>

    
    
<div id="discrete-optimal-allocation-allocate-teacher-function" class="section level1">
<h1 class="hasAnchor">
<a href="#discrete-optimal-allocation-allocate-teacher-function" class="anchor"></a>Discrete Optimal Allocation Allocate Teacher (Function)</h1>
<p>This function produces the same results as <a href="https://fanwangecon.github.io/PrjOptiAlloc/articles/ffv_opt_sodis_rkone_casch_allrw.html">DISCRETE–Discrete Optimal Allocation California Teacher Student Ratio (Line by Line)</a>. The differences are:</p>
<ol style="list-style-type: decimal">
<li>the program here uses the dataframes created by the line by line file as Inputs</li>
<li>the program here uses functions that are identical to the line by line function, but are saved in the R folder.</li>
</ol>
<p>This file, by invoking functions, is much shorter than the line by line program.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="dt">all.names =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">knitr.duplicate.label =</span> <span class="st">'allow'</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tibble)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stringr)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(broom)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(REconTools)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PrjOptiAlloc)</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra)</a></code></pre></div>
<div id="hand-input-data-example" class="section level2">
<h2 class="hasAnchor">
<a href="#hand-input-data-example" class="anchor"></a>Hand Input Data Example</h2>
<p>Set Preference Array:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">ar_rho &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>, <span class="dt">length.out=</span><span class="dv">4</span>))))</a>
<a class="sourceLine" id="cb3-2" title="2">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(ar_rho)</a>
<a class="sourceLine" id="cb3-3" title="3">it_w_agg &lt;-<span class="st"> </span><span class="dv">5</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">id_i    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">id_il   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">D_max_i &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">D_il    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6">A_il_i1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-7" title="7">A_il_i2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2.7</span>,<span class="fl">2.2</span>,<span class="fl">1.5</span>,<span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb4-8" title="8">A_il_i3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.9</span>,<span class="fl">1.8</span>,<span class="fl">1.1</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb4-9" title="9">A_il &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(A_il_i1[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], A_il_i2[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], A_il_i3[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb4-10" title="10">alpha_il &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="op">-</span>A_il_i1), <span class="kw"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="op">-</span>A_il_i2), <span class="kw"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="op">-</span>A_il_i3))</a>
<a class="sourceLine" id="cb4-11" title="11">beta_i &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13">df_handinput_input_il &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(id_i, id_il, D_max_i, D_il, A_il, alpha_il, beta_i))</a>
<a class="sourceLine" id="cb4-14" title="14"></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_handinput_input_il)</a></code></pre></div>
<pre><code>## # A tibble: 9 x 7
##    id_i id_il D_max_i  D_il  A_il alpha_il beta_i
##   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1     1     1       3     1   3     1       0.333
## 2     1     2       3     2   2     1       0.333
## 3     1     3       3     3   1     1       0.333
## 4     2     4       3     1   2.2   0.5     0.333
## 5     2     5       3     2   1.5   0.7     0.333
## 6     2     6       3     3   1.1   0.400   0.333
## 7     3     7       3     1   1.8   0.1000  0.333
## 8     3     8       3     2   1.1   0.7     0.333
## 9     3     9       3     3   0.1   1       0.333</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">ls_df_queue_hand &lt;-<span class="st"> </span>PrjOptiAlloc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/PrjOptiAlloc/man/ffp_opt_anlyz_rhgin_dis.html">ffp_opt_anlyz_rhgin_dis</a></span>(ar_rho, it_w_agg,</a>
<a class="sourceLine" id="cb6-2" title="2">                                            <span class="dt">bl_df_alloc_il =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-3" title="3">                                            <span class="dt">bl_return_V =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">                                            <span class="dt">bl_return_allQ_V =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-5" title="5">                                            <span class="dt">bl_return_inner_V =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                                            <span class="dt">df_input_il =</span> df_handinput_input_il)</a></code></pre></div>
<pre><code>## Joining, by = "id_il"Adding missing grouping variables: `id_i`see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=3,
## max-inequality/min-gini=0.5</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=3,
## max-inequality/min-gini=0.5</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=3,
## max-inequality/min-gini=0.5</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=3,
## max-inequality/min-gini=0.5</code></pre>
<pre><code>## Adding missing grouping variables: `id_i`see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=3, max-inequality/min-gini=0.5</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=3, max-inequality/min-gini=0.5</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=3, max-inequality/min-gini=0.5</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=3, max-inequality/min-gini=0.5</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(rev)`</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(alloc_i_upto_Q)`</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">df_queue_il_long &lt;-<span class="st"> </span>ls_df_queue_hand<span class="op">$</span>df_queue_il_long</a>
<a class="sourceLine" id="cb25-2" title="2">df_queue_il_wide &lt;-<span class="st"> </span>ls_df_queue_hand<span class="op">$</span>df_queue_il_wide</a>
<a class="sourceLine" id="cb25-3" title="3">df_alloc_i_long  &lt;-<span class="st"> </span>ls_df_queue_hand<span class="op">$</span>df_alloc_i_long</a>
<a class="sourceLine" id="cb25-4" title="4">df_rho_gini  &lt;-<span class="st"> </span>ls_df_queue_hand<span class="op">$</span>df_rho_gini</a>
<a class="sourceLine" id="cb25-5" title="5">df_alloc_il_long &lt;-<span class="st"> </span>ls_df_queue_hand<span class="op">$</span>df_alloc_il_long</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_queue_il_long)</a></code></pre></div>
<pre><code>## # A tibble: 36 x 11
##      rho rho_val  id_i id_il D_max_i  D_il  Q_il D_Wbin_il  V_sum_l V_inner_Q_il
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
##  1     1   0.99      1     1       3     1     4         1 1.31e+ 0     2.41e+ 0
##  2     2   0.785     1     1       3     1     4         1 9.89e- 1     1.97e+ 0
##  3     3  -3.64      1     1       3     1     9         0 2.14e- 3     4.33e- 2
##  4     4 -99         1     1       3     1     9         0 8.30e-61     8.44e-29
##  5     1   0.99      1     2       3     2     3         1 9.89e- 1     2.08e+ 0
##  6     2   0.785     1     2       3     2     3         1 7.89e- 1     1.77e+ 0
##  7     3  -3.64      1     2       3     2     6         0 6.10e- 3     6.42e- 2
##  8     4 -99         1     2       3     2     7         0 1.94e-48     8.44e-29
##  9     1   0.99      1     3       3     3     2         1 6.62e- 1     1.76e+ 0
## 10     2   0.785     1     3       3     3     2         1 5.74e- 1     1.55e+ 0
## # ... with 26 more rows, and 1 more variable: V_star_Q_il &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_queue_il_wide)</a></code></pre></div>
<pre><code>## # A tibble: 9 x 14
##   id_il  A_il alpha_il beta_i rank_min rank_max avg_rank  id_i D_max_i  D_il
##   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;int&gt;    &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1     1   3     1       0.333        9        4     6.5      1       3     1
## 2     2   2     1       0.333        7        3     4.75     1       3     2
## 3     3   1     1       0.333        2        2     2        1       3     3
## 4     4   2.2   0.5     0.333        8        7     7.25     2       3     1
## 5     5   1.5   0.7     0.333        6        5     5.5      2       3     2
## 6     6   1.1   0.400   0.333        8        4     6        2       3     3
## 7     7   1.8   0.1000  0.333        9        6     8        3       3     1
## 8     8   1.1   0.7     0.333        5        3     4        3       3     2
## 9     9   0.1   1       0.333        1        1     1        3       3     3
## # ... with 4 more variables: rho_c1_rk &lt;int&gt;, rho_c2_rk &lt;int&gt;, rho_c3_rk &lt;int&gt;,
## #   rho_c4_rk &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_alloc_i_long)</a></code></pre></div>
<pre><code>## # A tibble: 12 x 7
## # Groups:   id_i [3]
##      rho rho_val  id_i D_max_i D_star_i F_star_i EH_star_i
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1     1   0.99      1       3        3    1           2  
##  2     2   0.785     1       3        3    1           2  
##  3     3  -3.64      1       3        1    0.333       4  
##  4     4 -99         1       3        1    0.333       4  
##  5     1   0.99      2       3        0    0           2.2
##  6     2   0.785     2       3        0    0           2.2
##  7     3  -3.64      2       3        2    0.667       2.2
##  8     4 -99         2       3        2    0.667       2.2
##  9     1   0.99      3       3        2    0.667       1.8
## 10     2   0.785     3       3        2    0.667       1.8
## 11     3  -3.64      3       3        2    0.667       1.8
## 12     4 -99         3       3        2    0.667       1.8</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_rho_gini)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##     rho rho_val gini_D_star gini_EH_star
##   &lt;int&gt;   &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
## 1     1   0.99        0.300       0.0333
## 2     2   0.785       0.300       0.0333
## 3     3  -3.64        0.100       0.137 
## 4     4 -99           0.100       0.137</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_alloc_il_long)</a></code></pre></div>
<pre><code>## # A tibble: 36 x 5
##      rho  Q_il sid_1 sid_2 sid_3
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1     0     0     1
##  2     1     2     1     0     1
##  3     1     3     2     0     1
##  4     1     4     3     0     1
##  5     1     5     3     0     2
##  6     1     6     3     1     2
##  7     1     7     3     2     2
##  8     1     8     3     3     2
##  9     1     9     3     3     3
## 10     2     1     0     0     1
## # ... with 26 more rows</code></pre>
</div>
<div id="load-pre-generated-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-pre-generated-data" class="anchor"></a>Load Pre-Generated Data</h2>
<p>These are data thata were generated in the <a href="https://fanwangecon.github.io/PrjOptiAlloc/articles/ffv_opt_sodis_rkone_casch_allrw.html">DISCRETE–Discrete Optimal Allocation California Teacher Student Ratio (Line by Line)</a> function.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># Load Data</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(df_opt_caschool_prep_i)</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(df_opt_caschool_input_il)</a>
<a class="sourceLine" id="cb36-4" title="4"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(df_opt_caschool_input_ib)</a>
<a class="sourceLine" id="cb36-5" title="5"></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co"># Show Variables</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(df_opt_caschool_prep_i)</a></code></pre></div>
<pre><code>## 'data.frame':    420 obs. of  15 variables:
##  $ id_i    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ D_max_i : num  1 1 8 1 7 0 1 4 1 10 ...
##  $ D_o_i   : num  0 0 2 0 1 0 0 1 0 2 ...
##  $ Omega_i : num  706 673 657 656 656 ...
##  $ theta_i : num  -0.87 -0.87 -0.87 -0.87 -0.87 ...
##  $ beta_i  : num  0.00238 0.00238 0.00238 0.00238 0.00238 ...
##  $ enrltot : num  195 240 1550 243 1335 ...
##  $ teachers: num  11 11 83 14 72 6 10 42 19 108 ...
##  $ stravg  : num  17.7 21.8 18.7 17.4 18.5 ...
##  $ distcod : int  75119 61499 61549 61457 61523 62042 68536 63834 62331 67306 ...
##  $ county  : Factor w/ 45 levels "Alameda","Butte",..: 1 2 2 2 2 6 29 11 6 25 ...
##  $ district: Factor w/ 409 levels "Ackerman Elementary",..: 362 214 367 134 270 53 152 383 263 93 ...
##  $ grspan  : Factor w/ 2 levels "KK-06","KK-08": 2 2 2 2 2 2 2 2 2 1 ...
##  $ avginc  : num  22.69 9.82 8.98 8.98 9.08 ...
##  $ testscr : num  691 661 644 648 641 ...</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(df_opt_caschool_input_il)</a></code></pre></div>
<pre><code>## Classes 'tbl_df', 'tbl' and 'data.frame':    5224 obs. of  7 variables:
##  $ id_i    : int  1 2 3 3 3 3 3 3 3 3 ...
##  $ id_il   : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ D_max_i : num  1 1 8 8 8 8 8 8 8 8 ...
##  $ D_il    : int  1 1 1 2 3 4 5 6 7 8 ...
##  $ A_il    : num  691 654 641 641 641 ...
##  $ alpha_il: num  1.285 1.582 0.193 0.189 0.184 ...
##  $ beta_i  : num  0.00238 0.00238 0.00238 0.00238 0.00238 ...</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(df_opt_caschool_input_ib)</a></code></pre></div>
<pre><code>## 'data.frame':    420 obs. of  4 variables:
##  $ id_i     : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ A_i_l0   : num  691 654 641 641 639 ...
##  $ alpha_o_i: num  0 0 0.382 0 0.221 ...
##  $ beta_i   : num  0.00238 0.00238 0.00238 0.00238 0.00238 ...</code></pre>
</div>
<div id="solve-all-districts-discrete-optimal-allocation-across-planner-preferences" class="section level2">
<h2 class="hasAnchor">
<a href="#solve-all-districts-discrete-optimal-allocation-across-planner-preferences" class="anchor"></a>Solve All Districts Discrete Optimal Allocation Across Planner Preferences</h2>
<div id="specify-policy-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#specify-policy-parameters" class="anchor"></a>Specify Policy Parameters</h3>
<p>Note that <em>input_il</em> function already is based on <em>fl_fi_max</em>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="co"># 100 percent teacher at most per school, discretize floor as needed</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="co"># This is not a parameter that matters here, already a part of the input_il function</span></a>
<a class="sourceLine" id="cb42-3" title="3">fl_fi_max =<span class="st"> </span><span class="fl">1.00</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co"># 20 percent total additional of all teachers</span></a>
<a class="sourceLine" id="cb42-5" title="5">fl_fa_max =<span class="st"> </span><span class="fl">0.20</span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="co"># What is the number of teachers we can increase by</span></a>
<a class="sourceLine" id="cb42-7" title="7">fl_teacher_increase_number &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(df_opt_caschool_prep_i<span class="op">$</span>teachers)<span class="op">*</span>fl_fa_max</a>
<a class="sourceLine" id="cb42-8" title="8">fl_teacher_increase_number &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(fl_teacher_increase_number)</a>
<a class="sourceLine" id="cb42-9" title="9"></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="co"># Rho values to consider</span></a>
<a class="sourceLine" id="cb42-11" title="11">ar_rho &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>, <span class="dt">length.out=</span><span class="dv">4</span>))))</a>
<a class="sourceLine" id="cb42-12" title="12">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(ar_rho)</a></code></pre></div>
</div>
</div>
<div id="optimal-queue-and-allocations" class="section level2">
<h2 class="hasAnchor">
<a href="#optimal-queue-and-allocations" class="anchor"></a>Optimal Queue and Allocations</h2>
<p>Use the discrete allocation function across preference <a href="https://fanwangecon.github.io/PrjOptiAlloc/reference/ffp_opt_anlyz_rhgin_dis.html">ffp_opt_anlyz_rhgin_dis.html</a> function. This computes optimal allocation for multiple planner inequality aversion <span class="math inline">\(\lambda\)</span> parameters at the same time. Note that in the function <span class="math inline">\(\lambda=\rho\)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">ls_df_queue &lt;-<span class="st"> </span>PrjOptiAlloc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/PrjOptiAlloc/man/ffp_opt_anlyz_rhgin_dis.html">ffp_opt_anlyz_rhgin_dis</a></span>(ar_rho,</a>
<a class="sourceLine" id="cb43-2" title="2">                                       fl_teacher_increase_number,</a>
<a class="sourceLine" id="cb43-3" title="3">                                       <span class="dt">bl_df_alloc_il =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb43-4" title="4">                                       <span class="dt">df_input_il =</span> df_opt_caschool_input_il,</a>
<a class="sourceLine" id="cb43-5" title="5">                                       <span class="dt">svr_rho =</span> <span class="st">'rho'</span>,</a>
<a class="sourceLine" id="cb43-6" title="6">                                       <span class="dt">svr_id_i =</span> <span class="st">'id_i'</span>, <span class="dt">svr_id_il =</span> <span class="st">'id_il'</span>,</a>
<a class="sourceLine" id="cb43-7" title="7">                                       <span class="dt">svr_D_max_i =</span> <span class="st">'D_max_i'</span>, <span class="dt">svr_D_il =</span> <span class="st">'D_il'</span>,</a>
<a class="sourceLine" id="cb43-8" title="8">                                       <span class="dt">svr_D_star_i =</span> <span class="st">'D_star_i'</span>, <span class="dt">svr_F_star_i =</span> <span class="st">'F_star_i'</span>,</a>
<a class="sourceLine" id="cb43-9" title="9">                                       <span class="dt">svr_inpalc =</span> <span class="st">'Q_il'</span>, <span class="dt">svr_D_Wbin_il =</span> <span class="st">'D_Wbin_il'</span>,</a>
<a class="sourceLine" id="cb43-10" title="10">                                       <span class="dt">svr_A_il =</span> <span class="st">'A_il'</span>, <span class="dt">svr_alpha_il =</span> <span class="st">'alpha_il'</span>, <span class="dt">svr_beta_i =</span> <span class="st">'beta_i'</span>,</a>
<a class="sourceLine" id="cb43-11" title="11">                                       <span class="dt">svr_expout =</span> <span class="st">'opti_exp_outcome'</span>,</a>
<a class="sourceLine" id="cb43-12" title="12">                                       <span class="dt">st_idcol_prefix =</span> <span class="st">'sid_'</span>)</a></code></pre></div>
<pre><code>## Joining, by = "id_il"Adding missing grouping variables: `id_i`see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)
## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)
## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)
## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)
## Adding missing grouping variables: `id_i`see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)
## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)
## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)
## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(rev)`</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(alloc_i_upto_Q)`</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">df_queue_il_long &lt;-<span class="st"> </span>ls_df_queue<span class="op">$</span>df_queue_il_long</a>
<a class="sourceLine" id="cb47-2" title="2">df_queue_il_wide &lt;-<span class="st"> </span>ls_df_queue<span class="op">$</span>df_queue_il_wide</a>
<a class="sourceLine" id="cb47-3" title="3">df_alloc_i_long &lt;-<span class="st"> </span>ls_df_queue<span class="op">$</span>df_alloc_i_long</a>
<a class="sourceLine" id="cb47-4" title="4">df_rho_gini  &lt;-<span class="st"> </span>ls_df_queue<span class="op">$</span>df_rho_gini</a>
<a class="sourceLine" id="cb47-5" title="5">df_alloc_il_long &lt;-<span class="st"> </span>ls_df_queue<span class="op">$</span>df_alloc_il_long</a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Display Results</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(df_queue_il_long, <span class="dv">10</span>))</a></code></pre></div>
<pre><code>## # A tibble: 10 x 9
##      rho rho_val  id_i id_il D_max_i  D_il  Q_il D_Wbin_il V_star_Q_il
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
##  1     1   0.99      1     1       1     1    17         1        583.
##  2     2   0.785     1     1       1     1    18         1        566.
##  3     3  -3.64      1     1       1     1    43         1        673.
##  4     4 -99         1     1       1     1  4615         1        638.
##  5     1   0.99      2     2       1     1     5         1        583.
##  6     2   0.785     2     2       1     1     5         1        566.
##  7     3  -3.64      2     2       1     1     7         1        673.
##  8     4 -99         2     2       1     1   749         1        637.
##  9     1   0.99      3     3       8     1   558         1        583.
## 10     2   0.785     3     3       8     1   555         1        566.</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># print(str(df_queue_il_long))</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(df_queue_il_wide, <span class="dv">10</span>))</a></code></pre></div>
<pre><code>## # A tibble: 10 x 14
##    id_il  A_il alpha_il  beta_i rank_min rank_max avg_rank  id_i D_max_i  D_il
##    &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;int&gt;    &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;
##  1     1  691.    1.29  0.00238     4615       17    1173.     1       1     1
##  2     2  654.    1.58  0.00238      749        5     192.     2       1     1
##  3     3  641.    0.193 0.00238      700      507     580      3       8     1
##  4     4  641.    0.189 0.00238      736      527     602.     3       8     2
##  5     5  641.    0.184 0.00238      769      546     624      3       8     3
##  6     6  641.    0.180 0.00238      804      566     648.     3       8     4
##  7     7  642.    0.176 0.00238      834      586     669.     3       8     5
##  8     8  642.    0.172 0.00238      865      607     694.     3       8     6
##  9     9  642.    0.168 0.00238      893      631     718.     3       8     7
## 10    10  642.    0.165 0.00238      921      654     742.     3       8     8
## # ... with 4 more variables: rho_c1_rk &lt;int&gt;, rho_c2_rk &lt;int&gt;, rho_c3_rk &lt;int&gt;,
## #   rho_c4_rk &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># print(str(df_queue_il_wide))</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(df_alloc_i_long, <span class="dv">10</span>))</a></code></pre></div>
<pre><code>## # A tibble: 10 x 7
## # Groups:   id_i [3]
##      rho rho_val  id_i D_max_i D_star_i F_star_i EH_star_i
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1     1   0.99      1       1        1        1      692.
##  2     2   0.785     1       1        1        1      692.
##  3     3  -3.64      1       1        1        1      692.
##  4     4 -99         1       1        1        1      692.
##  5     1   0.99      2       1        1        1      656.
##  6     2   0.785     2       1        1        1      656.
##  7     3  -3.64      2       1        1        1      656.
##  8     4 -99         2       1        1        1      656.
##  9     1   0.99      3       8        8        1      642.
## 10     2   0.785     3       8        8        1      642.</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># print(str(df_queue_il_wide))</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_rho_gini)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##     rho rho_val gini_D_star gini_EH_star
##   &lt;int&gt;   &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
## 1     1   0.99        0.610       0.0151
## 2     2   0.785       0.610       0.0151
## 3     3  -3.64        0.610       0.0151
## 4     4 -99           0.610       0.0151</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># print(str(df_alloc_i_long))</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(df_alloc_il_long, <span class="dv">10</span>))</a></code></pre></div>
<pre><code>## # A tibble: 10 x 377
##      rho  Q_il sid_1 sid_2 sid_3 sid_4 sid_5 sid_7 sid_8 sid_9 sid_10 sid_11
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1     1     1     0     0     0     0     0     0     0     0      0      0
##  2     1     2     0     0     0     0     0     0     0     0      0      0
##  3     1     3     0     0     0     0     0     0     0     0      0      0
##  4     1     4     0     0     0     0     0     0     0     0      0      0
##  5     1     5     0     1     0     0     0     0     0     0      0      0
##  6     1     6     0     1     0     0     0     0     0     0      0      0
##  7     1     7     0     1     0     0     0     0     0     0      0      0
##  8     1     8     0     1     0     0     0     1     0     0      0      0
##  9     1     9     0     1     0     0     0     1     0     0      0      0
## 10     1    10     0     1     0     0     0     1     0     0      0      0
## # ... with 365 more variables: sid_12 &lt;dbl&gt;, sid_14 &lt;dbl&gt;, sid_15 &lt;dbl&gt;,
## #   sid_16 &lt;dbl&gt;, sid_17 &lt;dbl&gt;, sid_18 &lt;dbl&gt;, sid_19 &lt;dbl&gt;, sid_20 &lt;dbl&gt;,
## #   sid_21 &lt;dbl&gt;, sid_22 &lt;dbl&gt;, sid_23 &lt;dbl&gt;, sid_24 &lt;dbl&gt;, sid_25 &lt;dbl&gt;,
## #   sid_26 &lt;dbl&gt;, sid_27 &lt;dbl&gt;, sid_28 &lt;dbl&gt;, sid_29 &lt;dbl&gt;, sid_30 &lt;dbl&gt;,
## #   sid_31 &lt;dbl&gt;, sid_32 &lt;dbl&gt;, sid_33 &lt;dbl&gt;, sid_34 &lt;dbl&gt;, sid_35 &lt;dbl&gt;,
## #   sid_36 &lt;dbl&gt;, sid_37 &lt;dbl&gt;, sid_38 &lt;dbl&gt;, sid_39 &lt;dbl&gt;, sid_40 &lt;dbl&gt;,
## #   sid_41 &lt;dbl&gt;, sid_43 &lt;dbl&gt;, sid_44 &lt;dbl&gt;, sid_45 &lt;dbl&gt;, sid_46 &lt;dbl&gt;,
## #   sid_47 &lt;dbl&gt;, sid_48 &lt;dbl&gt;, sid_49 &lt;dbl&gt;, sid_50 &lt;dbl&gt;, sid_51 &lt;dbl&gt;,
## #   sid_52 &lt;dbl&gt;, sid_53 &lt;dbl&gt;, sid_54 &lt;dbl&gt;, sid_55 &lt;dbl&gt;, sid_56 &lt;dbl&gt;,
## #   sid_57 &lt;dbl&gt;, sid_58 &lt;dbl&gt;, sid_59 &lt;dbl&gt;, sid_60 &lt;dbl&gt;, sid_61 &lt;dbl&gt;,
## #   sid_62 &lt;dbl&gt;, sid_63 &lt;dbl&gt;, sid_64 &lt;dbl&gt;, sid_65 &lt;dbl&gt;, sid_66 &lt;dbl&gt;,
## #   sid_67 &lt;dbl&gt;, sid_68 &lt;dbl&gt;, sid_69 &lt;dbl&gt;, sid_70 &lt;dbl&gt;, sid_71 &lt;dbl&gt;,
## #   sid_72 &lt;dbl&gt;, sid_73 &lt;dbl&gt;, sid_74 &lt;dbl&gt;, sid_75 &lt;dbl&gt;, sid_76 &lt;dbl&gt;,
## #   sid_77 &lt;dbl&gt;, sid_78 &lt;dbl&gt;, sid_79 &lt;dbl&gt;, sid_80 &lt;dbl&gt;, sid_81 &lt;dbl&gt;,
## #   sid_82 &lt;dbl&gt;, sid_83 &lt;dbl&gt;, sid_84 &lt;dbl&gt;, sid_85 &lt;dbl&gt;, sid_86 &lt;dbl&gt;,
## #   sid_87 &lt;dbl&gt;, sid_88 &lt;dbl&gt;, sid_89 &lt;dbl&gt;, sid_90 &lt;dbl&gt;, sid_91 &lt;dbl&gt;,
## #   sid_92 &lt;dbl&gt;, sid_93 &lt;dbl&gt;, sid_95 &lt;dbl&gt;, sid_96 &lt;dbl&gt;, sid_97 &lt;dbl&gt;,
## #   sid_98 &lt;dbl&gt;, sid_99 &lt;dbl&gt;, sid_100 &lt;dbl&gt;, sid_102 &lt;dbl&gt;, sid_103 &lt;dbl&gt;,
## #   sid_104 &lt;dbl&gt;, sid_105 &lt;dbl&gt;, sid_106 &lt;dbl&gt;, sid_107 &lt;dbl&gt;, sid_108 &lt;dbl&gt;,
## #   sid_109 &lt;dbl&gt;, sid_110 &lt;dbl&gt;, sid_111 &lt;dbl&gt;, sid_112 &lt;dbl&gt;, sid_113 &lt;dbl&gt;,
## #   sid_114 &lt;dbl&gt;, sid_115 &lt;dbl&gt;, ...</code></pre>
</div>
<div id="rev-compute" class="section level2">
<h2 class="hasAnchor">
<a href="#rev-compute" class="anchor"></a>REV Compute</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">tb_rho_rev &lt;-</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="st">  </span>PrjOptiAlloc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/PrjOptiAlloc/man/ffp_opt_anlyz_sodis_rev.html">ffp_opt_anlyz_sodis_rev</a></span>(ar_rho,</a>
<a class="sourceLine" id="cb58-3" title="3">                          fl_teacher_increase_number,</a>
<a class="sourceLine" id="cb58-4" title="4">                          <span class="dt">df_input_ib =</span> df_opt_caschool_input_ib,</a>
<a class="sourceLine" id="cb58-5" title="5">                          <span class="dt">df_queue_il_long_with_V =</span> df_queue_il_long)</a></code></pre></div>
<pre><code>## Warning in min(df_queue_il_with_V %&gt;% filter(!!sym(svr_V_star_Q_il) &gt;=
## fl_util_alter_alloc) %&gt;% : no non-missing arguments to min; returning Inf

## Warning in min(df_queue_il_with_V %&gt;% filter(!!sym(svr_V_star_Q_il) &gt;=
## fl_util_alter_alloc) %&gt;% : no non-missing arguments to min; returning Inf</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(rev)`</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># Display Results</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(tb_rho_rev)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##     rho rho_val      REV
##   &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1     1   0.99  -Inf    
## 2     2   0.785 -Inf    
## 3     3  -3.64     1.000
## 4     4 -99        1.000</code></pre>
</div>
<div id="optimal-allocation-among-subset-of-districts" class="section level2">
<h2 class="hasAnchor">
<a href="#optimal-allocation-among-subset-of-districts" class="anchor"></a>Optimal Allocation Among Subset of Districts</h2>
<div id="select-a-small-subset-of-districts" class="section level3">
<h3 class="hasAnchor">
<a href="#select-a-small-subset-of-districts" class="anchor"></a>Select a Small Subset of Districts</h3>
<p>To generate some graphs and more easily readable results, rather than using all school districts, select some random subset of school districts from the existing data frames.</p>
<ol style="list-style-type: decimal">
<li>Select a random subset of district IDs</li>
<li>New input df that only includes these IDs.</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># select four school districts</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="co"># cas = california schools</span></a>
<a class="sourceLine" id="cb63-3" title="3">it_O &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb63-5" title="5">df_cas_prep_sub_i &lt;-<span class="st"> </span>df_opt_caschool_prep_i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(teachers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span> <span class="op">&amp;</span><span class="st"> </span>teachers <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb63-6" title="6">df_cas_prep_sub_i &lt;-<span class="st"> </span>df_cas_prep_sub_i[<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(df_cas_prep_sub_i)[<span class="dv">1</span>], it_O, <span class="dt">replace=</span><span class="ot">FALSE</span>),]</a>
<a class="sourceLine" id="cb63-7" title="7">ar_cas_id_selected &lt;-<span class="st"> </span>df_cas_prep_sub_i <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(id_i)</a>
<a class="sourceLine" id="cb63-8" title="8"></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="co"># Select from il and ib only ids that are randomly selected</span></a>
<a class="sourceLine" id="cb63-10" title="10">df_cas_input_sub_il &lt;-<span class="st"> </span>df_opt_caschool_input_il <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(id_i <span class="op">%in%</span><span class="st"> </span>ar_cas_id_selected)</a>
<a class="sourceLine" id="cb63-11" title="11">df_cas_input_sub_ib &lt;-<span class="st"> </span>df_opt_caschool_input_ib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(id_i <span class="op">%in%</span><span class="st"> </span>ar_cas_id_selected)</a>
<a class="sourceLine" id="cb63-12" title="12"></a>
<a class="sourceLine" id="cb63-13" title="13"><span class="co"># Print</span></a>
<a class="sourceLine" id="cb63-14" title="14"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_cas_prep_sub_i)</a></code></pre></div>
<pre><code>##    id_i D_max_i D_o_i  Omega_i    theta_i      beta_i enrltot teachers   stravg
## 4    32      10     2 636.0332 -0.8699505 0.002380952    2102      100 21.02000
## 39  327       5     1 686.9896 -0.8699505 0.002380952     900       51 17.64706
## 1     3       8     2 657.0958 -0.8699505 0.002380952    1550       83 18.67470
## 34  286       6     1 671.6432 -0.8699505 0.002380952    1252       65 19.26154
##    distcod    county                    district grspan   avginc testscr
## 4    75440  Monterey             Soledad Unified  KK-08 12.40900  624.95
## 39   68007 San Diego          Cardiff Elementary  KK-06 21.96700  668.65
## 1    61549     Butte Thermalito Union Elementary  KK-08  8.97800  643.60
## 34   71035    Sonoma           Wright Elementary  KK-06 12.58425  663.85</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_cas_input_sub_ib)</a></code></pre></div>
<pre><code>##   id_i   A_i_l0 alpha_o_i      beta_i
## 1    3 640.8497 0.3822603 0.002380952
## 2   32 617.7468 0.3585561 0.002380952
## 3  286 654.8866 0.2538877 0.002380952
## 4  327 671.6376 0.2952321 0.002380952</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_cas_input_sub_il)</a></code></pre></div>
<pre><code>## # A tibble: 29 x 7
##     id_i id_il D_max_i  D_il  A_il alpha_il  beta_i
##    &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
##  1     3     3       8     1  641.    0.193 0.00238
##  2     3     4       8     2  641.    0.189 0.00238
##  3     3     5       8     3  641.    0.184 0.00238
##  4     3     6       8     4  641.    0.180 0.00238
##  5     3     7       8     5  642.    0.176 0.00238
##  6     3     8       8     6  642.    0.172 0.00238
##  7     3     9       8     7  642.    0.168 0.00238
##  8     3    10       8     8  642.    0.165 0.00238
##  9    32   205      10     1  618.    0.181 0.00238
## 10    32   206      10     2  618.    0.178 0.00238
## # ... with 19 more rows</code></pre>
<p>Now we also have a new total number of teacher increase, no longer based on all districts. The policy here is to potentially increase each school district by <em>fl_fi_max</em>, already coded into the <em>input_il</em> file, so that can not change. The total number of available new teachers is <em>fl_fa_max</em> times the existing number of teachers in the selected districts overall</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">fl_fa_max =<span class="st"> </span><span class="fl">0.20</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="co"># What is the number of teachers we can increase by</span></a>
<a class="sourceLine" id="cb69-3" title="3">fl_teacher_increase_sub_number &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(df_cas_prep_sub_i<span class="op">$</span>teachers)<span class="op">*</span>fl_fa_max</a>
<a class="sourceLine" id="cb69-4" title="4">fl_teacher_increase_sub_number &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(fl_teacher_increase_sub_number)</a></code></pre></div>
</div>
<div id="optimal-queue-allocations-and-rev" class="section level3">
<h3 class="hasAnchor">
<a href="#optimal-queue-allocations-and-rev" class="anchor"></a>Optimal Queue, Allocations and REV</h3>
<p>Use the discrete allocation function across preference <a href="https://fanwangecon.github.io/PrjOptiAlloc/reference/ffp_opt_anlyz_rhgin_dis.html">ffp_opt_anlyz_rhgin_dis.html</a> function. This computes optimal allocation for multiple planner inequality aversion <span class="math inline">\(\lambda\)</span> parameters at the same time. Note that in the function <span class="math inline">\(\lambda=\rho\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># Rho values to consider</span></a>
<a class="sourceLine" id="cb70-2" title="2">ar_rho &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>, <span class="dt">length.out=</span><span class="dv">4</span>))))</a>
<a class="sourceLine" id="cb70-3" title="3">ar_rho &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(ar_rho)</a>
<a class="sourceLine" id="cb70-4" title="4"></a>
<a class="sourceLine" id="cb70-5" title="5"><span class="co"># Optimal Allocation</span></a>
<a class="sourceLine" id="cb70-6" title="6">ls_df_sub_queue &lt;-<span class="st"> </span>PrjOptiAlloc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/PrjOptiAlloc/man/ffp_opt_anlyz_rhgin_dis.html">ffp_opt_anlyz_rhgin_dis</a></span>(ar_rho, fl_teacher_increase_sub_number,</a>
<a class="sourceLine" id="cb70-7" title="7">                                           <span class="dt">df_input_il =</span> df_cas_input_sub_il,</a>
<a class="sourceLine" id="cb70-8" title="8">                                           <span class="dt">bl_df_alloc_il =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Joining, by = "id_il"Adding missing grouping variables: `id_i`see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=4,
## max-inequality/min-gini=0.6</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=4,
## max-inequality/min-gini=0.6</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=4,
## max-inequality/min-gini=0.6</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_D_star_i]]): Data vector has only n=4,
## max-inequality/min-gini=0.6</code></pre>
<pre><code>## Adding missing grouping variables: `id_i`see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=4, max-inequality/min-gini=0.6</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=4, max-inequality/min-gini=0.6</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=4, max-inequality/min-gini=0.6</code></pre>
<pre><code>## see REconTools for formula: DIST GINI--Compute Gini Inequality Coefficient Given Data Vector (One Variable)</code></pre>
<pre><code>## Warning in ff_dist_gini_vector_pos(.[[svr_EH_star_i]]): Data vector has only
## n=4, max-inequality/min-gini=0.6</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(rev)`</code></pre>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(alloc_i_upto_Q)`</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">df_queue_il_sub_long &lt;-<span class="st"> </span>ls_df_sub_queue<span class="op">$</span>df_queue_il_long</a>
<a class="sourceLine" id="cb89-2" title="2">df_queue_il_sub_wide &lt;-<span class="st"> </span>ls_df_sub_queue<span class="op">$</span>df_queue_il_wide</a>
<a class="sourceLine" id="cb89-3" title="3">df_alloc_i_long &lt;-<span class="st"> </span>ls_df_sub_queue<span class="op">$</span>df_alloc_i_long</a>
<a class="sourceLine" id="cb89-4" title="4">df_rho_gini &lt;-<span class="st"> </span>ls_df_sub_queue<span class="op">$</span>df_rho_gini</a>
<a class="sourceLine" id="cb89-5" title="5">df_alloc_il_long &lt;-<span class="st"> </span>ls_df_sub_queue<span class="op">$</span>df_alloc_il_long</a>
<a class="sourceLine" id="cb89-6" title="6"></a>
<a class="sourceLine" id="cb89-7" title="7"><span class="co"># REV</span></a>
<a class="sourceLine" id="cb89-8" title="8">ar_util_rev_loop_func &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ffp_opt_anlyz_sodis_rev.html">ffp_opt_anlyz_sodis_rev</a></span>(ar_rho,fl_teacher_increase_sub_number,</a>
<a class="sourceLine" id="cb89-9" title="9">                                                 <span class="dt">df_input_ib =</span> df_cas_input_sub_ib,</a>
<a class="sourceLine" id="cb89-10" title="10">                                                 <span class="dt">df_queue_il_long_with_V =</span> df_queue_il_sub_long)</a></code></pre></div>
<pre><code>## Warning: `cols` is now required.
## Please use `cols = c(rev)`</code></pre>
<p>Show Results</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co"># Display Results</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_queue_il_sub_long)</a></code></pre></div>
<pre><code>## # A tibble: 116 x 9
##      rho rho_val  id_i id_il D_max_i  D_il  Q_il D_Wbin_il V_star_Q_il
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
##  1     1   0.99      3     3       8     1    12         1        5.88
##  2     2   0.785     3     3       8     1    12         1        1.72
##  3     3  -3.64      3     3       8     1    18         1     2318.  
##  4     4 -99         3     3       8     1    11         1      658.  
##  5     1   0.99      3     4       8     2    13         1        5.88
##  6     2   0.785     3     4       8     2    13         1        1.72
##  7     3  -3.64      3     4       8     2    20         1     2319.  
##  8     4 -99         3     4       8     2    12         1      658.  
##  9     1   0.99      3     5       8     3    14         1        5.88
## 10     2   0.785     3     5       8     3    14         1        1.72
## # ... with 106 more rows</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_alloc_i_long)</a></code></pre></div>
<pre><code>## # A tibble: 16 x 7
## # Groups:   id_i [4]
##      rho rho_val  id_i D_max_i D_star_i F_star_i EH_star_i
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1     1   0.99      3       8        8        1      642.
##  2     2   0.785     3       8        8        1      642.
##  3     3  -3.64      3       8        8        1      642.
##  4     4 -99         3       8        8        1      642.
##  5     1   0.99     32      10       10        1      619.
##  6     2   0.785    32      10       10        1      619.
##  7     3  -3.64     32      10       10        1      619.
##  8     4 -99        32      10       10        1      619.
##  9     1   0.99    286       6        6        1      656.
## 10     2   0.785   286       6        6        1      656.
## 11     3  -3.64    286       6        6        1      656.
## 12     4 -99       286       6        6        1      656.
## 13     1   0.99    327       5        5        1      673.
## 14     2   0.785   327       5        5        1      673.
## 15     3  -3.64    327       5        5        1      673.
## 16     4 -99       327       5        5        1      673.</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_rho_gini)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##     rho rho_val gini_D_star gini_EH_star
##   &lt;int&gt;   &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
## 1     1   0.99        0.117       0.0135
## 2     2   0.785       0.117       0.0135
## 3     3  -3.64        0.117       0.0135
## 4     4 -99           0.117       0.0135</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(df_alloc_il_long)</a></code></pre></div>
<pre><code>## # A tibble: 116 x 6
##      rho  Q_il sid_3 sid_32 sid_286 sid_327
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1     0      0       0       1
##  2     1     2     0      0       0       2
##  3     1     3     0      0       0       3
##  4     1     4     0      0       0       4
##  5     1     5     0      0       0       5
##  6     1     6     0      0       1       5
##  7     1     7     0      0       2       5
##  8     1     8     0      0       3       5
##  9     1     9     0      0       4       5
## 10     1    10     0      0       5       5
## # ... with 106 more rows</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(ar_util_rev_loop_func)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##     rho rho_val   REV
##   &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1     1   0.99  0.915
## 2     2   0.785 0.915
## 3     3  -3.64  0.898
## 4     4 -99     0.949</code></pre>
<!-- ### Additional Statistics

1. Predicted Expected Outcomes for each i given allocations
2. Utility at each Queue rank point
3. Gini Statistics based on allocations

### Results Analysis

Core graphical/tabular illustration of results across Many Individuals

1. Mean and standard deviation of outcome, across $\lambda$, along with actual mean and standard deviation
2. Gini of Allocations and Outcomes, across $\lambda$, along with observed of intended Gini of Allocation or Outcomes
3. REV in percentages as well as in units of resources lost, across $\lambda$
4. Tabular results already exists for this. Rank Data/chart:
    - columns are $\lambda$ points
    - colors identify individuals, each color appears multiple times due to multiple allocations for each individual
    - show ranking changes as preference changes
    - highligh only subset (1) of individuals
    - Climbing chart? x axis is rank, y axis allocation for individual, but not sure why this would be useful. Perhaps useful for tabular outputs. Maybe only very small chart

How should illustrative graph be shown with only 2 individuals? -->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#discrete-optimal-allocation-allocate-teacher-function">Discrete Optimal Allocation Allocate Teacher (Function)</a><ul class="nav nav-pills nav-stacked">
<li><a href="#hand-input-data-example">Hand Input Data Example</a></li>
      <li><a href="#load-pre-generated-data">Load Pre-Generated Data</a></li>
      <li><a href="#solve-all-districts-discrete-optimal-allocation-across-planner-preferences">Solve All Districts Discrete Optimal Allocation Across Planner Preferences</a></li>
      <li><a href="#optimal-queue-and-allocations">Optimal Queue and Allocations</a></li>
      <li><a href="#rev-compute">REV Compute</a></li>
      <li><a href="#optimal-allocation-among-subset-of-districts">Optimal Allocation Among Subset of Districts</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Fan Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
