<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Linear Wage Binary Allocation Lalonde Training Example • Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Linear Wage Binary Allocation Lalonde Training Example">
<meta property="og:description" content="Linear wage regression estimation of A and alpha from the Lalonde Training Dataset (722 Observations). 
Solve for optimal binary allocation queues.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Papers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3839890" class="external-link">Optimal Allocations to Heterogeneous Agents with An Application to Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3691091" class="external-link">Optimal Allocation of the COVID-19 Stimulus Checks</a>
    </li>
    <li>
      <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3547706" class="external-link">The Optimal Allocation of Resources among Heterogeneous Individuals</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/" class="external-link">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/" class="external-link">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/" class="external-link">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/" class="external-link">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/" class="external-link">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/" class="external-link">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/" class="external-link">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/" class="external-link">Python Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Linear Wage Binary Allocation Lalonde Training Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/HEAD/vignettes/ffv_opt_sobin_rkone_allrw_training_wage.Rmd" class="external-link"><code>vignettes/ffv_opt_sobin_rkone_allrw_training_wage.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_sobin_rkone_allrw_training_wage.Rmd</code></div>

    </div>

    
    
<p>Linear wage regression estimation of A and alpha from the Lalonde Training Dataset (722 Observations). Solve for optimal binary allocation queues. Test binary allocation queue with Lalonde training dataset. There are 722 observations, 297 in the treatment group, 425 in the control group. Following Lalonde, regressions are in terms of wage levels (not log wage)</p>
<div class="section level2">
<h2 id="load-dependencies">Load Dependencies<a class="anchor" aria-label="anchor" href="#load-dependencies"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>all.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.duplicate.label <span class="op">=</span> <span class="st">'allow'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org" class="external-link">forcats</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/REconTools/" class="external-link">REconTools</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fanwangecon.github.io/PrjOptiAlloc/">PrjOptiAlloc</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span>

<span class="va">bl_save_rda</span> <span class="op">=</span> <span class="cn">FALSE</span>
<span class="va">bl_save_img</span> <span class="op">=</span> <span class="cn">FALSE</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-data-and-generate-new-variables">Load Data and Generate New Variables<a class="anchor" aria-label="anchor" href="#load-data-and-generate-new-variables"></a>
</h2>
<p>Generate four categories by initial height and mother’s education levels combinations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training</span><span class="op">)</span>

<span class="co"># Add a binary variable for if there are wage in year 1975</span>
<span class="va">dft</span> <span class="op">&lt;-</span> <span class="va">df_opt_lalonde_training</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>re75_zero <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">re75</span> <span class="op">&lt;=</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>, 
                               <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">re75_zero</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># summary</span>
<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">dft</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: `funs()` was deprecated in dplyr 0.8.0.</span>
<span class="co">## Please use a list of either functions or lambdas: </span>
<span class="co">## </span>
<span class="co">##   # Simple named list: </span>
<span class="co">##   list(mean = mean, median = median)</span>
<span class="co">## </span>
<span class="co">##   # Auto named with `tibble::lst()`: </span>
<span class="co">##   tibble::lst(mean, median)</span>
<span class="co">## </span>
<span class="co">##   # Using lambdas</span>
<span class="co">##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## Warning: `as.tibble()` was deprecated in tibble 2.0.0.</span>
<span class="co">## Please use `as_tibble()` instead.</span>
<span class="co">## The signature and semantics have changed, see `?as_tibble`.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.</span>
<span class="co">## Using compatibility `.name_repair`.</span>
<span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span>
<span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 18 x 13</span></span>
<span class="co">##    stats   age   black educ  hisp  marr  nodeg re74  re75  re75.zero re78  trt  </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> n       <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>722<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> unique  <span style="color: #949494;">"</span> 35<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 14<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>116<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>424<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>524<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> NAobs   <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>277<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ZEROobs <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>144<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>646<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>605<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>159<span style="color: #949494;">"</span>  <span style="color: #BB0000;">NA</span>   <span style="color: #949494;">"</span>289<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>433<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>196<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> mean    <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>210~ <span style="color: #949494;">"</span>304~ <span style="color: #949494;">"</span>   0.40~ <span style="color: #949494;">"</span>545~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> sd      <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>536~ <span style="color: #949494;">"</span>506~ <span style="color: #949494;">"</span>   0.49~ <span style="color: #949494;">"</span>625~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> cv      <span style="color: #949494;">"</span>0.2~ <span style="color: #949494;">"</span>0.4~ <span style="color: #949494;">"</span>0.1~ <span style="color: #949494;">"</span>2.9~ <span style="color: #949494;">"</span>2.2~ <span style="color: #949494;">"</span>0.5~ <span style="color: #949494;">"</span>2.5~ <span style="color: #949494;">"</span>1.6~ <span style="color: #949494;">"</span>1.22488~ <span style="color: #949494;">"</span>1.1~ <span style="color: #949494;">"</span>1.1~</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> min     <span style="color: #949494;">"</span>17<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 3<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>      <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span> </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> p01     <span style="color: #949494;">"</span>17.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 5.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.00<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> p05     <span style="color: #949494;">"</span>17.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 8.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.00<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~</span>
<span class="co">## <span style="color: #BCBCBC;">11</span> p10     <span style="color: #949494;">"</span>18.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 8.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.0<span style="color: #949494;">"</span>    <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~</span>
<span class="co">## <span style="color: #BCBCBC;">12</span> p25     <span style="color: #949494;">"</span> 19~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>  9~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0.00<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0~</span>
<span class="co">## <span style="color: #BCBCBC;">13</span> p50     <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span> 93~ <span style="color: #949494;">"</span>   0.00~ <span style="color: #949494;">"</span>395~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">14</span> p75     <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span> 82~ <span style="color: #949494;">"</span>399~ <span style="color: #949494;">"</span>   1.00~ <span style="color: #949494;">"</span>877~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">15</span> p90     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span> 78~ <span style="color: #949494;">"</span> 89~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>128~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">16</span> p95     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>122~ <span style="color: #949494;">"</span>122~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>166~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">17</span> p99     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>270~ <span style="color: #949494;">"</span>242~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>260~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">18</span> max     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>395~ <span style="color: #949494;">"</span>374~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>603~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #949494;"># ... with 1 more variable: X &lt;chr&gt;</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summary treated only</span>
<span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trt</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 18 x 13</span></span>
<span class="co">##    stats   age   black educ  hisp  marr  nodeg re74  re75  re75.zero re78  trt  </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> n       <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> unique  <span style="color: #949494;">"</span> 30<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 13<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 54<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>184<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>230<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> NAobs   <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>112<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ZEROobs <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 59<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>269<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>247<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 80<span style="color: #949494;">"</span>  <span style="color: #BB0000;">NA</span>   <span style="color: #949494;">"</span>111<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>186<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span> 67<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> mean    <span style="color: #949494;">"</span>2.4~ <span style="color: #949494;">"</span>8.0~ <span style="color: #949494;">"</span>1.0~ <span style="color: #949494;">"</span>9.4~ <span style="color: #949494;">"</span>1.6~ <span style="color: #949494;">"</span>7.3~ <span style="color: #949494;">"</span>2.0~ <span style="color: #949494;">"</span>3.0~ <span style="color: #949494;">"</span>3.73737~ <span style="color: #949494;">"</span>5.9~ <span style="color: #949494;">"</span>1.0~</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> sd      <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>488~ <span style="color: #949494;">"</span>487~ <span style="color: #949494;">"</span>   0.48~ <span style="color: #949494;">"</span>692~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> cv      <span style="color: #949494;">"</span>0.2~ <span style="color: #949494;">"</span>0.4~ <span style="color: #949494;">"</span>0.1~ <span style="color: #949494;">"</span>3.1~ <span style="color: #949494;">"</span>2.2~ <span style="color: #949494;">"</span>0.6~ <span style="color: #949494;">"</span>2.3~ <span style="color: #949494;">"</span>1.5~ <span style="color: #949494;">"</span>1.29666~ <span style="color: #949494;">"</span>1.1~ <span style="color: #949494;">"</span>0.0~</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> min     <span style="color: #949494;">"</span> 17<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  4<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> p01     <span style="color: #949494;">"</span> 17~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  4~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  0.0<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span>  0~ <span style="color: #949494;">"</span>  1~</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> p05     <span style="color: #949494;">"</span> 17<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  8<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;">11</span> p10     <span style="color: #949494;">"</span> 18<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  8<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;">12</span> p25     <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   0.00~ <span style="color: #949494;">"</span> 54~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">13</span> p50     <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>111~ <span style="color: #949494;">"</span>   0.00~ <span style="color: #949494;">"</span>423~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">14</span> p75     <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>129~ <span style="color: #949494;">"</span>431~ <span style="color: #949494;">"</span>   1.00~ <span style="color: #949494;">"</span>938~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">15</span> p90     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span> 84~ <span style="color: #949494;">"</span> 84~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>134~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">16</span> p95     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>123~ <span style="color: #949494;">"</span>122~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>173~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">17</span> p99     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>211~ <span style="color: #949494;">"</span>231~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>271~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">18</span> max     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>350~ <span style="color: #949494;">"</span>374~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>603~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #949494;"># ... with 1 more variable: X &lt;chr&gt;</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">REconTools</span><span class="fu">::</span><span class="fu"><a href="https://fanwangecon.github.io/REconTools/reference/ff_summ_percentiles.html" class="external-link">ff_summ_percentiles</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trt</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: attributes are not identical across measure variables;</span>
<span class="co">## they will be dropped</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 18 x 13</span></span>
<span class="co">##    stats   age   black educ  hisp  marr  nodeg re74  re75  re75.zero re78  trt  </span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> n       <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> unique  <span style="color: #949494;">"</span> 31<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 12<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 67<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>245<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  2<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>297<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> NAobs   <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>165<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> ZEROobs <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 85<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>377<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>358<span style="color: #949494;">"</span> <span style="color: #949494;">"</span> 79<span style="color: #949494;">"</span>  <span style="color: #BB0000;">NA</span>   <span style="color: #949494;">"</span>178<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>247<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>129<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>425<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> mean    <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>210~ <span style="color: #949494;">"</span>302~ <span style="color: #949494;">"</span>   0.41~ <span style="color: #949494;">"</span>509~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> sd      <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>568~ <span style="color: #949494;">"</span>520~ <span style="color: #949494;">"</span>   0.49~ <span style="color: #949494;">"</span>571~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> cv      <span style="color: #949494;">"</span>0.2~ <span style="color: #949494;">"</span>0.5~ <span style="color: #949494;">"</span>0.1~ <span style="color: #949494;">"</span>2.8~ <span style="color: #949494;">"</span>2.3~ <span style="color: #949494;">"</span>0.4~ <span style="color: #949494;">"</span>2.6~ <span style="color: #949494;">"</span>1.7~ <span style="color: #949494;">"</span>1.17936~ <span style="color: #949494;">"</span>1.1~  <span style="color: #BB0000;">NA</span>  </span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> min     <span style="color: #949494;">"</span>17<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 3<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>      <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span>  <span style="color: #949494;">"</span> 0<span style="color: #949494;">"</span> </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> p01     <span style="color: #949494;">"</span>17.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 5.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.00<span style="color: #949494;">"</span>   <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~</span>
<span class="co">## <span style="color: #BCBCBC;">10</span> p05     <span style="color: #949494;">"</span>17.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 8.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.0<span style="color: #949494;">"</span>    <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~</span>
<span class="co">## <span style="color: #BCBCBC;">11</span> p10     <span style="color: #949494;">"</span>18.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 8.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.0<span style="color: #949494;">"</span>    <span style="color: #949494;">"</span> 0.~ <span style="color: #949494;">"</span> 0.~</span>
<span class="co">## <span style="color: #BCBCBC;">12</span> p25     <span style="color: #949494;">"</span> 19<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  9<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  1<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span>     <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span> <span style="color: #949494;">"</span>  0<span style="color: #949494;">"</span></span>
<span class="co">## <span style="color: #BCBCBC;">13</span> p50     <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span> 82~ <span style="color: #949494;">"</span>   0.00~ <span style="color: #949494;">"</span>374~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">14</span> p75     <span style="color: #949494;">"</span>  2~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>  1~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span> 13~ <span style="color: #949494;">"</span>364~ <span style="color: #949494;">"</span>   1.00~ <span style="color: #949494;">"</span>832~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">15</span> p90     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span> 76~ <span style="color: #949494;">"</span> 91~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>124~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">16</span> p95     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>106~ <span style="color: #949494;">"</span>121~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>162~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">17</span> p99     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>295~ <span style="color: #949494;">"</span>242~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>209~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #BCBCBC;">18</span> max     <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>   ~ <span style="color: #949494;">"</span>395~ <span style="color: #949494;">"</span>369~ <span style="color: #949494;">"</span>    1.0~ <span style="color: #949494;">"</span>394~ <span style="color: #949494;">"</span>   ~</span>
<span class="co">## <span style="color: #949494;"># ... with 1 more variable: X &lt;chr&gt;</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># within 297 treated, 111 (37%) had zero wage in 1975</span>
<span class="co"># within 425 untreated, 178 (42%) had zero wage in 1975</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load Data</span>
<span class="va">dft</span> <span class="op">&lt;-</span> <span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Summarize</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dft</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 'data.frame':    722 obs. of  12 variables:</span>
<span class="co">##  $ id       : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">##  $ trt      : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">##  $ re75_zero: num  1 1 1 0 1 1 1 0 1 1 ...</span>
<span class="co">##  $ age      : int  23 26 22 34 18 45 18 27 24 34 ...</span>
<span class="co">##  $ educ     : int  10 12 9 9 9 11 9 12 8 11 ...</span>
<span class="co">##  $ black    : int  1 0 1 1 1 1 1 1 0 1 ...</span>
<span class="co">##  $ hisp     : int  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">##  $ marr     : int  0 0 0 0 0 0 0 0 0 1 ...</span>
<span class="co">##  $ nodeg    : int  1 0 1 1 1 1 1 0 1 1 ...</span>
<span class="co">##  $ re74     : num  0 0 0 NA 0 0 0 NA 0 0 ...</span>
<span class="co">##  $ re75     : num  0 0 0 4368 0 ...</span>
<span class="co">##  $ re78     : num  0 12384 0 14051 10740 ...</span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dft</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##        id              trt           re75_zero           age       </span>
<span class="co">##  Min.   :   1.0   Min.   :0.0000   Min.   :0.0000   Min.   :17.00  </span>
<span class="co">##  1st Qu.: 181.2   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:19.00  </span>
<span class="co">##  Median : 361.5   Median :0.0000   Median :0.0000   Median :23.00  </span>
<span class="co">##  Mean   : 854.4   Mean   :0.4114   Mean   :0.4003   Mean   :24.52  </span>
<span class="co">##  3rd Qu.:1458.5   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:27.00  </span>
<span class="co">##  Max.   :4110.0   Max.   :1.0000   Max.   :1.0000   Max.   :55.00  </span>
<span class="co">##                                                                    </span>
<span class="co">##       educ           black             hisp             marr      </span>
<span class="co">##  Min.   : 3.00   Min.   :0.0000   Min.   :0.0000   Min.   :0.000  </span>
<span class="co">##  1st Qu.: 9.00   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.000  </span>
<span class="co">##  Median :10.00   Median :1.0000   Median :0.0000   Median :0.000  </span>
<span class="co">##  Mean   :10.27   Mean   :0.8006   Mean   :0.1053   Mean   :0.162  </span>
<span class="co">##  3rd Qu.:11.00   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.000  </span>
<span class="co">##  Max.   :16.00   Max.   :1.0000   Max.   :1.0000   Max.   :1.000  </span>
<span class="co">##                                                                   </span>
<span class="co">##      nodeg             re74              re75              re78      </span>
<span class="co">##  Min.   :0.0000   Min.   :    0.0   Min.   :    0.0   Min.   :    0  </span>
<span class="co">##  1st Qu.:1.0000   1st Qu.:    0.0   1st Qu.:    0.0   1st Qu.:    0  </span>
<span class="co">##  Median :1.0000   Median :    0.0   Median :  936.3   Median : 3952  </span>
<span class="co">##  Mean   :0.7798   Mean   : 2102.3   Mean   : 3042.9   Mean   : 5455  </span>
<span class="co">##  3rd Qu.:1.0000   3rd Qu.:  824.4   3rd Qu.: 3993.2   3rd Qu.: 8772  </span>
<span class="co">##  Max.   :1.0000   Max.   :39570.7   Max.   :37431.7   Max.   :60308  </span>
<span class="co">##                   NA's   :277</span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generate Employment 0 or 1 status Variable, and non-zero wages variable</span>
<span class="va">dft</span> <span class="op">&lt;-</span> <span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>emp78 <span class="op">=</span>
                      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
                                <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>emp75 <span class="op">=</span>
                      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">re75</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
                                <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>emp74 <span class="op">=</span>
                      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">re74</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
                                <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Generate combine black + hispanic status</span>
<span class="co"># 0 = white, 1 = black, 2 = hispanics</span>
<span class="va">dft</span> <span class="op">&lt;-</span> <span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>race <span class="op">=</span>
             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">black</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">1</span>,
                       <span class="va">hisp</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="fl">2</span>,
                       <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="va">dft</span> <span class="op">&lt;-</span> <span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age_m2 <span class="op">=</span>
             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">23</span> <span class="op">~</span> <span class="fl">1</span>,
                       <span class="va">age</span> <span class="op">&gt;</span>  <span class="fl">23</span><span class="op">~</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age_m3 <span class="op">=</span>
             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">20</span> <span class="op">~</span> <span class="fl">1</span>,
                       <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">26</span> <span class="op">~</span> <span class="fl">2</span>,
                       <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">26</span> <span class="op">~</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>



<span class="co"># filter(re78 != 0) %&gt;%</span>
<span class="co"># mutate(re78_log = log(re78))</span>

<span class="co"># Exclude zeros</span>
<span class="co"># when this is on, both linear and log linear results exclude wage = 0</span>
<span class="co"># dft &lt;- dft %&gt;%</span>
<span class="co">#     filter(re78 &gt; 0)</span>

<span class="co"># Generate Discrete Version of continuous variables</span>
<span class="co"># dft &lt;- dft %&gt;%</span>
<span class="co">#     mutate(momwgtLowHigh = cut(lwt,</span>
<span class="co">#                                breaks=c(-Inf, 129, Inf),</span>
<span class="co">#                                labels=c("LW","HW"))) %&gt;%</span>
<span class="co">#     mutate(mombirthage = cut(age,</span>
<span class="co">#                                breaks=c(-Inf, 24, Inf),</span>
<span class="co">#                                labels=c("young","older")))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="regression-with-data-and-construct-input-arrays">Regression with Data and Construct Input Arrays<a class="anchor" aria-label="anchor" href="#regression-with-data-and-construct-input-arrays"></a>
</h2>
<div class="section level3">
<h3 id="tabulate-and-summarize-averages">Tabulate and Summarize Averages<a class="anchor" aria-label="anchor" href="#tabulate-and-summarize-averages"></a>
</h3>
<p>What is the average difference in wage between treatment and control, do they match what is reported in Lalonde (1986)?</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Summarize average for all variables grouping by treatment status</span>
<span class="co"># re78 is significantly different</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    [,1]     [,2]</span>
<span class="co">## trt               0.000    1.000</span>
<span class="co">## id_mean         213.000 1772.316</span>
<span class="co">## re75_zero_mean    0.419    0.374</span>
<span class="co">## age_mean         24.447   24.626</span>
<span class="co">## educ_mean        10.188   10.380</span>
<span class="co">## black_mean        0.800    0.801</span>
<span class="co">## hisp_mean         0.113    0.094</span>
<span class="co">## marr_mean         0.158    0.168</span>
<span class="co">## nodeg_mean        0.814    0.731</span>
<span class="co">## re74_mean      2107.027 2095.574</span>
<span class="co">## re75_mean      3026.683 3066.098</span>
<span class="co">## re78_mean      5090.048 5976.352</span>
<span class="co">## emp78_mean        0.696    0.774</span>
<span class="co">## emp75_mean        0.581    0.626</span>
<span class="co">## emp74_mean        0.541    0.559</span>
<span class="co">## race_mean         1.026    0.990</span>
<span class="co">## age_m2_mean       1.489    1.481</span>
<span class="co">## age_m3_mean       1.948    1.990</span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">marr</span>, <span class="va">age_m2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    [,1]     [,2]     [,3]     [,4]</span>
<span class="co">## marr              0.000    0.000    1.000    1.000</span>
<span class="co">## age_m2            1.000    2.000    1.000    2.000</span>
<span class="co">## id_mean         840.140  823.626 1083.179  928.270</span>
<span class="co">## trt_mean          0.411    0.405    0.464    0.416</span>
<span class="co">## re75_zero_mean    0.350    0.489    0.214    0.393</span>
<span class="co">## age_mean         19.569   29.485   20.929   30.124</span>
<span class="co">## educ_mean        10.105   10.412   10.143   10.506</span>
<span class="co">## black_mean        0.778    0.824    0.607    0.876</span>
<span class="co">## hisp_mean         0.134    0.069    0.250    0.056</span>
<span class="co">## nodeg_mean        0.845    0.698    0.821    0.753</span>
<span class="co">## re74_mean      1991.445 1509.914 2758.832 3996.214</span>
<span class="co">## re75_mean      2304.886 2950.030 5827.808 5284.371</span>
<span class="co">## re78_mean      5219.173 5516.690 7153.395 5644.975</span>
<span class="co">## emp78_mean        0.752    0.683    0.893    0.719</span>
<span class="co">## emp75_mean        0.650    0.511    0.786    0.607</span>
<span class="co">## emp74_mean        0.615    0.447    0.714    0.539</span>
<span class="co">## race_mean         1.047    0.962    1.107    0.989</span>
<span class="co">## age_m3_mean       1.309    2.630    1.607    2.652</span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Summarize by finer sub groups: RACE</span>
<span class="co"># big increase for black, but not for other group</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">race</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span>
<span class="co">## trt               0.000    0.000    0.000    1.000    1.000    1.000</span>
<span class="co">## race              0.000    1.000    2.000    0.000    1.000    2.000</span>
<span class="co">## id_mean         233.027  209.679  221.083 1700.129 1782.723 1763.786</span>
<span class="co">## re75_zero_mean    0.243    0.435    0.438    0.323    0.403    0.179</span>
<span class="co">## age_mean         23.351   24.812   22.708   25.677   24.853   21.536</span>
<span class="co">## educ_mean        10.486   10.285    9.271   10.839   10.382    9.857</span>
<span class="co">## black_mean        0.000    1.000    0.000    0.000    1.000    0.000</span>
<span class="co">## hisp_mean         0.000    0.000    1.000    0.000    0.000    1.000</span>
<span class="co">## marr_mean         0.135    0.162    0.146    0.161    0.168    0.179</span>
<span class="co">## nodeg_mean        0.649    0.821    0.896    0.548    0.739    0.857</span>
<span class="co">## re74_mean      3791.631 2086.477 1242.022 1305.037 2155.013 2546.219</span>
<span class="co">## re75_mean      5373.717 2862.948 2377.296 4038.830 2785.916 4370.691</span>
<span class="co">## re78_mean      7114.471 4654.996 6611.178 7034.041 5814.419 6181.772</span>
<span class="co">## emp78_mean        0.838    0.659    0.854    0.935    0.739    0.893</span>
<span class="co">## emp75_mean        0.757    0.565    0.562    0.677    0.597    0.821</span>
<span class="co">## emp74_mean        0.676    0.521    0.583    0.548    0.534    0.786</span>
<span class="co">## age_m2_mean       1.514    1.506    1.354    1.484    1.513    1.214</span>
<span class="co">## age_m3_mean       1.946    1.988    1.667    2.065    2.021    1.643</span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Summarize by finer sub groups: MARRIAGE</span>
<span class="co"># big increase for black, but not for other group</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">marr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    [,1]     [,2]     [,3]     [,4]</span>
<span class="co">## trt               0.000    0.000    1.000    1.000</span>
<span class="co">## marr              0.000    1.000    0.000    1.000</span>
<span class="co">## id_mean         210.176  228.090 1735.688 1953.260</span>
<span class="co">## re75_zero_mean    0.427    0.373    0.385    0.320</span>
<span class="co">## age_mean         23.933   27.194   23.761   28.900</span>
<span class="co">## educ_mean        10.131   10.493   10.393   10.320</span>
<span class="co">## black_mean        0.796    0.821    0.802    0.800</span>
<span class="co">## hisp_mean         0.115    0.104    0.093    0.100</span>
<span class="co">## nodeg_mean        0.818    0.791    0.729    0.740</span>
<span class="co">## re74_mean      1834.893 3603.759 1646.427 4020.488</span>
<span class="co">## re75_mean      2465.121 6027.269 2756.966 4593.212</span>
<span class="co">## re78_mean      5105.237 5008.892 5699.897 7342.041</span>
<span class="co">## emp78_mean        0.701    0.672    0.753    0.880</span>
<span class="co">## emp75_mean        0.573    0.627    0.615    0.680</span>
<span class="co">## emp74_mean        0.534    0.582    0.555    0.580</span>
<span class="co">## race_mean         1.025    1.030    0.988    1.000</span>
<span class="co">## age_m2_mean       1.436    1.776    1.429    1.740</span>
<span class="co">## age_m3_mean       1.866    2.388    1.903    2.420</span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Summarize by finer sub groups: AGE GROUPS</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">age_m2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    [,1]     [,2]     [,3]     [,4]</span>
<span class="co">## trt               0.000    0.000    1.000    1.000</span>
<span class="co">## age_m2            1.000    2.000    1.000    2.000</span>
<span class="co">## id_mean         241.908  182.841 1727.292 1820.804</span>
<span class="co">## re75_zero_mean    0.382    0.457    0.279    0.476</span>
<span class="co">## age_mean         19.539   29.567   19.857   29.762</span>
<span class="co">## educ_mean         9.977   10.409   10.292   10.476</span>
<span class="co">## black_mean        0.774    0.827    0.753    0.853</span>
<span class="co">## hisp_mean         0.143    0.082    0.143    0.042</span>
<span class="co">## marr_mean         0.069    0.250    0.084    0.259</span>
<span class="co">## nodeg_mean        0.899    0.726    0.766    0.692</span>
<span class="co">## re74_mean      2333.261 1900.754 1571.490 2486.164</span>
<span class="co">## re75_mean      2313.545 3770.677 2933.215 3209.204</span>
<span class="co">## re78_mean      5095.991 5083.849 5744.425 6226.119</span>
<span class="co">## emp78_mean        0.728    0.663    0.812    0.734</span>
<span class="co">## emp75_mean        0.618    0.543    0.721    0.524</span>
<span class="co">## emp74_mean        0.590    0.490    0.669    0.441</span>
<span class="co">## race_mean         1.060    0.990    1.039    0.937</span>
<span class="co">## age_m3_mean       1.290    2.635    1.390    2.636</span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">age_m3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    [,1]     [,2]     [,3]     [,4]     [,5]     [,6]</span>
<span class="co">## trt               0.000    0.000    0.000    1.000    1.000    1.000</span>
<span class="co">## age_m3            1.000    2.000    3.000    1.000    2.000    3.000</span>
<span class="co">## id_mean         261.675  180.475  190.462 1646.723 1918.705 1721.879</span>
<span class="co">## re75_zero_mean    0.383    0.453    0.424    0.266    0.366    0.495</span>
<span class="co">## age_mean         18.532   23.626   32.212   18.479   23.402   32.484</span>
<span class="co">## educ_mean         9.877   10.209   10.530    9.851   10.902   10.286</span>
<span class="co">## black_mean        0.740    0.835    0.833    0.777    0.777    0.857</span>
<span class="co">## hisp_mean         0.175    0.072    0.083    0.160    0.071    0.055</span>
<span class="co">## marr_mean         0.039    0.209    0.242    0.053    0.170    0.286</span>
<span class="co">## nodeg_mean        0.922    0.806    0.697    0.883    0.607    0.725</span>
<span class="co">## re74_mean       827.694 3297.704 2095.804 1466.314 2840.083 1794.839</span>
<span class="co">## re75_mean      1564.343 3604.432 4124.358 2302.777 4136.499 2537.167</span>
<span class="co">## re78_mean      4987.829 5320.403 4966.734 5498.803 5744.032 6755.577</span>
<span class="co">## emp78_mean        0.760    0.676    0.644    0.777    0.795    0.747</span>
<span class="co">## emp75_mean        0.617    0.547    0.576    0.734    0.634    0.505</span>
<span class="co">## emp74_mean        0.584    0.532    0.500    0.670    0.598    0.396</span>
<span class="co">## race_mean         1.091    0.978    1.000    1.096    0.920    0.967</span>
<span class="co">## age_m2_mean       1.000    1.547    2.000    1.000    1.464    2.000</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">marr</span>, <span class="va">age_m2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]</span>
<span class="co">## trt               0.000    0.000    0.000    0.000    1.000    1.000    1.000</span>
<span class="co">## marr              0.000    0.000    1.000    1.000    0.000    0.000    1.000</span>
<span class="co">## age_m2            1.000    2.000    1.000    2.000    1.000    2.000    1.000</span>
<span class="co">## id_mean         243.302  167.282  223.133  229.519 1695.184 1789.566 2075.538</span>
<span class="co">## re75_zero_mean    0.391    0.474    0.267    0.404    0.291    0.509    0.154</span>
<span class="co">## age_mean         19.450   29.737   20.733   29.058   19.738   29.113   21.154</span>
<span class="co">## educ_mean         9.965   10.346   10.133   10.596   10.305   10.509   10.154</span>
<span class="co">## black_mean        0.782    0.814    0.667    0.865    0.773    0.840    0.538</span>
<span class="co">## hisp_mean         0.139    0.083    0.200    0.077    0.128    0.047    0.308</span>
<span class="co">## nodeg_mean        0.896    0.718    0.933    0.750    0.773    0.670    0.692</span>
<span class="co">## re74_mean      2215.155 1386.863 5144.184 3383.698 1621.704 1669.249 1055.009</span>
<span class="co">## re75_mean      2033.499 3024.016 6084.840 6010.662 2693.681 2841.146 5531.232</span>
<span class="co">## re78_mean      5009.475 5229.235 6261.061 4647.690 5519.591 5939.737 8183.010</span>
<span class="co">## emp78_mean        0.723    0.673    0.800    0.635    0.794    0.698    1.000</span>
<span class="co">## emp75_mean        0.609    0.526    0.733    0.596    0.709    0.491    0.846</span>
<span class="co">## emp74_mean        0.579    0.474    0.733    0.538    0.667    0.406    0.692</span>
<span class="co">## race_mean         1.059    0.981    1.067    1.019    1.028    0.934    1.154</span>
<span class="co">## age_m3_mean       1.267    2.641    1.600    2.615    1.369    2.613    1.615</span>
<span class="co">##                    [,8]</span>
<span class="co">## trt               1.000</span>
<span class="co">## marr              1.000</span>
<span class="co">## age_m2            2.000</span>
<span class="co">## id_mean        1910.297</span>
<span class="co">## re75_zero_mean    0.378</span>
<span class="co">## age_mean         31.622</span>
<span class="co">## educ_mean        10.378</span>
<span class="co">## black_mean        0.892</span>
<span class="co">## hisp_mean         0.027</span>
<span class="co">## nodeg_mean        0.757</span>
<span class="co">## re74_mean      4761.858</span>
<span class="co">## re75_mean      4263.638</span>
<span class="co">## re78_mean      7046.565</span>
<span class="co">## emp78_mean        0.838</span>
<span class="co">## emp75_mean        0.622</span>
<span class="co">## emp74_mean        0.541</span>
<span class="co">## race_mean         0.946</span>
<span class="co">## age_m3_mean       2.703</span></code></pre>
</div>
<div class="section level3">
<h3 id="tabulate">Tabulate<a class="anchor" aria-label="anchor" href="#tabulate"></a>
</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tabulate groups, how many in each group, enough for group heterogeneity in effects?</span>
<span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">marr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">trt</span>, values_from <span class="op">=</span> <span class="va">freq</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'trt'. You can override using the `.groups` argument.</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 2 x 3</span></span>
<span class="co">##    marr   `0`   `1`</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span>     0   358   247</span>
<span class="co">## <span style="color: #BCBCBC;">2</span>     1    67    50</span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tabulate groups, how many in each group, enough for group heterogeneity in effects?</span>
<span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span>, <span class="va">age_m2</span>, <span class="va">marr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">trt</span>, values_from <span class="op">=</span> <span class="va">freq</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'trt', 'age_m2'. You can override using the `.groups` argument.</span></code></pre>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 4 x 4</span></span>
<span class="co">## <span style="color: #949494;"># Groups:   age_m2 [2]</span></span>
<span class="co">##   age_m2  marr   `0`   `1`</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span>      1     0   202   141</span>
<span class="co">## <span style="color: #BCBCBC;">2</span>      1     1    15    13</span>
<span class="co">## <span style="color: #BCBCBC;">3</span>      2     0   156   106</span>
<span class="co">## <span style="color: #BCBCBC;">4</span>      2     1    52    37</span></code></pre>
</div>
<div class="section level3">
<h3 id="regression-testing">Regression Testing<a class="anchor" aria-label="anchor" href="#regression-testing"></a>
</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># As noted in Lalonde (1986), functional form assumptions do not matter much</span>
<span class="co"># Dummies, treatment effect average about 801 dollars</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">educ</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">nodeg</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
                  data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = re78 ~ factor(age) + factor(educ) + factor(race) + </span>
<span class="co">##     factor(marr) + factor(nodeg) + factor(trt) - 1, data = dft)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##    Min     1Q Median     3Q    Max </span>
<span class="co">## -14412  -4409  -1265   3139  54012 </span>
<span class="co">## </span>
<span class="co">## Coefficients: (2 not defined because of singularities)</span>
<span class="co">##                Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">## factor(age)17    2290.8     6400.4   0.358   0.7205  </span>
<span class="co">## factor(age)18    2445.2     6380.0   0.383   0.7016  </span>
<span class="co">## factor(age)19    3540.8     6384.6   0.555   0.5794  </span>
<span class="co">## factor(age)20    3558.8     6389.4   0.557   0.5777  </span>
<span class="co">## factor(age)21    4670.1     6412.9   0.728   0.4667  </span>
<span class="co">## factor(age)22    2975.7     6262.4   0.475   0.6348  </span>
<span class="co">## factor(age)23    2278.3     6416.7   0.355   0.7227  </span>
<span class="co">## factor(age)24    2362.0     6417.2   0.368   0.7129  </span>
<span class="co">## factor(age)25    2430.8     6395.4   0.380   0.7040  </span>
<span class="co">## factor(age)26    4223.8     6419.2   0.658   0.5108  </span>
<span class="co">## factor(age)27    2720.7     6413.6   0.424   0.6716  </span>
<span class="co">## factor(age)28    4311.2     6428.8   0.671   0.5027  </span>
<span class="co">## factor(age)29    2895.7     6475.4   0.447   0.6549  </span>
<span class="co">## factor(age)30    2044.7     6593.6   0.310   0.7566  </span>
<span class="co">## factor(age)31    3847.6     6471.3   0.595   0.5523  </span>
<span class="co">## factor(age)32    4379.5     6762.9   0.648   0.5175  </span>
<span class="co">## factor(age)33    3880.4     6645.4   0.584   0.5595  </span>
<span class="co">## factor(age)34    2741.6     6613.4   0.415   0.6786  </span>
<span class="co">## factor(age)35    2397.2     6770.4   0.354   0.7234  </span>
<span class="co">## factor(age)36    4081.3     6758.7   0.604   0.5461  </span>
<span class="co">## factor(age)37    1315.2     7296.6   0.180   0.8570  </span>
<span class="co">## factor(age)38    1610.3     6740.8   0.239   0.8113  </span>
<span class="co">## factor(age)39    -545.5     6937.2  -0.079   0.9374  </span>
<span class="co">## factor(age)40   14642.9     7741.1   1.892   0.0590 .</span>
<span class="co">## factor(age)41   -1436.5     6972.1  -0.206   0.8368  </span>
<span class="co">## factor(age)42    3079.3     6992.4   0.440   0.6598  </span>
<span class="co">## factor(age)43    1562.5     7719.2   0.202   0.8397  </span>
<span class="co">## factor(age)44    3459.6     7062.6   0.490   0.6244  </span>
<span class="co">## factor(age)45    6597.1     7347.2   0.898   0.3696  </span>
<span class="co">## factor(age)46   -1436.8     7354.4  -0.195   0.8452  </span>
<span class="co">## factor(age)48    5423.7     9353.1   0.580   0.5622  </span>
<span class="co">## factor(age)49   12421.9     8898.2   1.396   0.1632  </span>
<span class="co">## factor(age)50    2091.2     7718.9   0.271   0.7865  </span>
<span class="co">## factor(age)54    6628.8     8864.7   0.748   0.4549  </span>
<span class="co">## factor(age)55    7456.5     6243.0   1.194   0.2328  </span>
<span class="co">## factor(educ)4    1939.6     6912.8   0.281   0.7791  </span>
<span class="co">## factor(educ)5    2173.8     6919.6   0.314   0.7535  </span>
<span class="co">## factor(educ)6     496.9     6723.6   0.074   0.9411  </span>
<span class="co">## factor(educ)7    3107.2     6476.6   0.480   0.6316  </span>
<span class="co">## factor(educ)8    2867.3     6322.4   0.454   0.6503  </span>
<span class="co">## factor(educ)9    3836.5     6298.3   0.609   0.5426  </span>
<span class="co">## factor(educ)10   3028.1     6288.2   0.482   0.6303  </span>
<span class="co">## factor(educ)11   2796.4     6283.5   0.445   0.6564  </span>
<span class="co">## factor(educ)12   3351.0     6291.2   0.533   0.5945  </span>
<span class="co">## factor(educ)13   4125.2     6420.0   0.643   0.5207  </span>
<span class="co">## factor(educ)14  11173.8     6586.6   1.696   0.0903 .</span>
<span class="co">## factor(educ)15   9616.1     7679.7   1.252   0.2110  </span>
<span class="co">## factor(educ)16       NA         NA      NA       NA  </span>
<span class="co">## factor(race)1   -1612.7      822.1  -1.962   0.0502 .</span>
<span class="co">## factor(race)2     -95.0     1082.8  -0.088   0.9301  </span>
<span class="co">## factor(marr)1     626.9      670.8   0.935   0.3504  </span>
<span class="co">## factor(nodeg)1       NA         NA      NA       NA  </span>
<span class="co">## factor(trt)1      801.0      488.2   1.641   0.1013  </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 6189 on 671 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.4826, Adjusted R-squared:  0.4433 </span>
<span class="co">## F-statistic: 12.27 on 51 and 671 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># cts Controls and treatment effects about 761 dollars</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">~</span>  <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
                   <span class="va">educ</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">educ</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">nodeg</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
                  data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = re78 ~ age + I(age^2) + educ + I(educ^2) + +factor(race) + </span>
<span class="co">##     factor(marr) + factor(nodeg) + factor(trt) - 1, data = dft)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##    Min     1Q Median     3Q    Max </span>
<span class="co">##  -9154  -4677  -1556   3246  54687 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                  Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">## age              -29.1127   213.9845  -0.136   0.8918  </span>
<span class="co">## I(age^2)           0.6658     3.5882   0.186   0.8529  </span>
<span class="co">## educ           -1150.6075  1021.2110  -1.127   0.2602  </span>
<span class="co">## I(educ^2)         76.1351    56.0966   1.357   0.1751  </span>
<span class="co">## factor(race)0  10204.2957  5360.7995   1.904   0.0574 .</span>
<span class="co">## factor(race)1   8421.7101  5328.1587   1.581   0.1144  </span>
<span class="co">## factor(race)2  10059.7028  5298.4854   1.899   0.0580 .</span>
<span class="co">## factor(marr)1    579.8210   650.3352   0.892   0.3729  </span>
<span class="co">## factor(nodeg)1   175.0729   913.5232   0.192   0.8481  </span>
<span class="co">## factor(trt)1     761.4122   472.5196   1.611   0.1075  </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 6206 on 712 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.448,  Adjusted R-squared:  0.4402 </span>
<span class="co">## F-statistic: 57.78 on 10 and 712 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Treatment interactions by marriage status, 476 unmarried, vs 2216 for married</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">~</span>  <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
                   <span class="va">educ</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">educ</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">nodeg</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
                  data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = re78 ~ age + I(age^2) + educ + I(educ^2) + +factor(race) + </span>
<span class="co">##     factor(marr) + factor(nodeg) + factor(marr):factor(trt) - </span>
<span class="co">##     1, data = dft)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##    Min     1Q Median     3Q    Max </span>
<span class="co">##  -9999  -4554  -1552   3132  54838 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                              Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">## age                          -14.6509   214.1161  -0.068   0.9455  </span>
<span class="co">## I(age^2)                       0.3773     3.5922   0.105   0.9164  </span>
<span class="co">## educ                       -1124.9544  1020.7625  -1.102   0.2708  </span>
<span class="co">## I(educ^2)                     75.1305    56.0673   1.340   0.1807  </span>
<span class="co">## factor(race)0               9986.4688  5359.9102   1.863   0.0628 .</span>
<span class="co">## factor(race)1               8214.9578  5327.0673   1.542   0.1235  </span>
<span class="co">## factor(race)2               9845.8189  5297.5758   1.859   0.0635 .</span>
<span class="co">## factor(marr)1               -156.2047   844.1521  -0.185   0.8532  </span>
<span class="co">## factor(nodeg)1               176.8634   912.9685   0.194   0.8464  </span>
<span class="co">## factor(marr)0:factor(trt)1   476.6372   516.1797   0.923   0.3561  </span>
<span class="co">## factor(marr)1:factor(trt)1  2216.3634  1164.8513   1.903   0.0575 .</span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 6202 on 711 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.4494, Adjusted R-squared:  0.4409 </span>
<span class="co">## F-statistic: 52.76 on 11 and 711 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Treatment interactions by marriage status, 453 vs 1070 each age group</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">~</span>  <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age_m2</span><span class="op">)</span> <span class="op">+</span>
                   <span class="va">educ</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">educ</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">nodeg</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age_m2</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
                  data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = re78 ~ age + I(age^2) + factor(age_m2) + educ + </span>
<span class="co">##     I(educ^2) + +factor(race) + factor(marr) + factor(nodeg) + </span>
<span class="co">##     factor(age_m2):factor(trt) - 1, data = dft)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##    Min     1Q Median     3Q    Max </span>
<span class="co">##  -9281  -4664  -1521   3260  54557 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                                Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">## age                             73.5664   317.3603   0.232    0.817  </span>
<span class="co">## I(age^2)                        -0.7038     4.7486  -0.148    0.882  </span>
<span class="co">## factor(age_m2)1               8890.8921  6129.7194   1.450    0.147  </span>
<span class="co">## factor(age_m2)2               8237.1456  6661.6040   1.237    0.217  </span>
<span class="co">## educ                         -1137.5178  1025.7038  -1.109    0.268  </span>
<span class="co">## I(educ^2)                       75.1320    56.3181   1.334    0.183  </span>
<span class="co">## factor(race)1                -1782.6432   804.4433  -2.216    0.027 *</span>
<span class="co">## factor(race)2                 -130.3132  1055.7904  -0.123    0.902  </span>
<span class="co">## factor(marr)1                  590.5769   651.5151   0.906    0.365  </span>
<span class="co">## factor(nodeg)1                 139.6452   916.7444   0.152    0.879  </span>
<span class="co">## factor(age_m2)1:factor(trt)1   453.7963   659.7260   0.688    0.492  </span>
<span class="co">## factor(age_m2)2:factor(trt)1  1070.8127   677.9949   1.579    0.115  </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 6212 on 710 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.4484, Adjusted R-squared:  0.4391 </span>
<span class="co">## F-statistic:  48.1 on 12 and 710 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Treatment interactions by marriage status, greater effect for older married + younger married</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">~</span>  <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age_m2</span><span class="op">)</span> <span class="op">+</span>
                   <span class="va">educ</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">educ</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">nodeg</span><span class="op">)</span>
                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age_m2</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
                  data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = re78 ~ age + I(age^2) + factor(age_m2) + educ + </span>
<span class="co">##     I(educ^2) + +factor(race) + factor(marr) + factor(nodeg) + </span>
<span class="co">##     factor(marr):factor(age_m2):factor(trt) - 1, data = dft)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##    Min     1Q Median     3Q    Max </span>
<span class="co">##  -9725  -4576  -1573   3089  54691 </span>
<span class="co">## </span>
<span class="co">## Coefficients: (3 not defined because of singularities)</span>
<span class="co">##                                              Estimate Std. Error t value</span>
<span class="co">## age                                           37.3770   319.8439   0.117</span>
<span class="co">## I(age^2)                                      -0.2698     4.7852  -0.056</span>
<span class="co">## factor(age_m2)1                            10519.8273  6563.8924   1.603</span>
<span class="co">## factor(age_m2)2                             9557.6915  6655.2092   1.436</span>
<span class="co">## educ                                       -1107.2556  1026.5070  -1.079</span>
<span class="co">## I(educ^2)                                     74.1506    56.3551   1.316</span>
<span class="co">## factor(race)1                              -1732.3553   806.1276  -2.149</span>
<span class="co">## factor(race)2                               -143.3612  1056.8346  -0.136</span>
<span class="co">## factor(marr)1                               1217.5255  1196.2563   1.018</span>
<span class="co">## factor(nodeg)1                               164.2353   918.1533   0.179</span>
<span class="co">## factor(age_m2)1:factor(marr)0:factor(trt)0 -1378.9391  2164.2994  -0.637</span>
<span class="co">## factor(age_m2)2:factor(marr)0:factor(trt)0  -640.4138   785.5838  -0.815</span>
<span class="co">## factor(age_m2)1:factor(marr)1:factor(trt)0 -1595.6462  2363.5262  -0.675</span>
<span class="co">## factor(age_m2)2:factor(marr)1:factor(trt)0 -2339.1547  1346.3197  -1.737</span>
<span class="co">## factor(age_m2)1:factor(marr)0:factor(trt)1 -1029.3096  2177.4284  -0.473</span>
<span class="co">## factor(age_m2)2:factor(marr)0:factor(trt)1         NA         NA      NA</span>
<span class="co">## factor(age_m2)1:factor(marr)1:factor(trt)1         NA         NA      NA</span>
<span class="co">## factor(age_m2)2:factor(marr)1:factor(trt)1         NA         NA      NA</span>
<span class="co">##                                            Pr(&gt;|t|)  </span>
<span class="co">## age                                          0.9070  </span>
<span class="co">## I(age^2)                                     0.9551  </span>
<span class="co">## factor(age_m2)1                              0.1095  </span>
<span class="co">## factor(age_m2)2                              0.1514  </span>
<span class="co">## educ                                         0.2811  </span>
<span class="co">## I(educ^2)                                    0.1887  </span>
<span class="co">## factor(race)1                                0.0320 *</span>
<span class="co">## factor(race)2                                0.8921  </span>
<span class="co">## factor(marr)1                                0.3091  </span>
<span class="co">## factor(nodeg)1                               0.8581  </span>
<span class="co">## factor(age_m2)1:factor(marr)0:factor(trt)0   0.5242  </span>
<span class="co">## factor(age_m2)2:factor(marr)0:factor(trt)0   0.4152  </span>
<span class="co">## factor(age_m2)1:factor(marr)1:factor(trt)0   0.4998  </span>
<span class="co">## factor(age_m2)2:factor(marr)1:factor(trt)0   0.0827 .</span>
<span class="co">## factor(age_m2)1:factor(marr)0:factor(trt)1   0.6366  </span>
<span class="co">## factor(age_m2)2:factor(marr)0:factor(trt)1       NA  </span>
<span class="co">## factor(age_m2)1:factor(marr)1:factor(trt)1       NA  </span>
<span class="co">## factor(age_m2)2:factor(marr)1:factor(trt)1       NA  </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 6215 on 707 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.4502, Adjusted R-squared:  0.4386 </span>
<span class="co">## F-statistic:  38.6 on 15 and 707 DF,  p-value: &lt; 2.2e-16</span></code></pre>
</div>
<div class="section level3">
<h3 id="regress-wage-on-training-status">Regress Wage on Training Status<a class="anchor" aria-label="anchor" href="#regress-wage-on-training-status"></a>
</h3>
<div class="section level4">
<h4 id="linear-binary-problem">Linear Binary Problem<a class="anchor" aria-label="anchor" href="#linear-binary-problem"></a>
</h4>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Store Regression Results</span>
<span class="va">mt_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age_m2</span><span class="op">)</span> <span class="op">+</span>
                            <span class="va">educ</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">educ</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
                          <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span>
                          <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span>
                          <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">nodeg</span><span class="op">)</span>
                          <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">re75_zero</span><span class="op">)</span>
                          <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">age_m2</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span>,
                          data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span>
<span class="va">rs_wage_on_trt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">~</span> <span class="va">mt_model</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rs_wage_on_trt</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## lm(formula = re78 ~ mt_model - 1, data = dft)</span>
<span class="co">## </span>
<span class="co">## Residuals:</span>
<span class="co">##    Min     1Q Median     3Q    Max </span>
<span class="co">##  -9457  -4550  -1555   3407  54173 </span>
<span class="co">## </span>
<span class="co">## Coefficients:</span>
<span class="co">##                                        Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">## mt_model(Intercept)                  10052.3179  6160.1001   1.632   0.1032  </span>
<span class="co">## mt_modelage                             52.9924   317.1787   0.167   0.8674  </span>
<span class="co">## mt_modelI(age^2)                        -0.2876     4.7488  -0.061   0.9517  </span>
<span class="co">## mt_modelfactor(age_m2)2               -588.1949  1031.9301  -0.570   0.5689  </span>
<span class="co">## mt_modeleduc                         -1263.1725  1027.0533  -1.230   0.2191  </span>
<span class="co">## mt_modelI(educ^2)                       80.5134    56.3343   1.429   0.1534  </span>
<span class="co">## mt_modelfactor(race)1                -1676.5079   805.8386  -2.080   0.0378 *</span>
<span class="co">## mt_modelfactor(race)2                  -86.6527  1054.7258  -0.082   0.9345  </span>
<span class="co">## mt_modelfactor(marr)1                  506.4687   652.5609   0.776   0.4379  </span>
<span class="co">## mt_modelfactor(nodeg)1                 162.4342   915.6448   0.177   0.8592  </span>
<span class="co">## mt_modelfactor(re75_zero)1            -823.5052   486.9104  -1.691   0.0912 .</span>
<span class="co">## mt_modelfactor(age_m2)1:factor(trt)1   379.3939   660.3304   0.575   0.5658  </span>
<span class="co">## mt_modelfactor(age_m2)2:factor(trt)1  1079.5020   677.1278   1.594   0.1113  </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">## </span>
<span class="co">## Residual standard error: 6204 on 709 degrees of freedom</span>
<span class="co">## Multiple R-squared:  0.4506, Adjusted R-squared:  0.4406 </span>
<span class="co">## F-statistic: 44.74 on 13 and 709 DF,  p-value: &lt; 2.2e-16</span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rs_wage_on_trt_tidy</span> <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">rs_wage_on_trt</span><span class="op">)</span>
<span class="va">rs_wage_on_trt_tidy</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 13 x 5</span></span>
<span class="co">##    term                                  estimate std.error statistic p.value</span>
<span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span> mt_model(Intercept)                  <span style="text-decoration: underline;">10</span>052.      <span style="text-decoration: underline;">6</span>160.      1.63    0.103 </span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span> mt_modelage                             53.0      317.      0.167   0.867 </span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span> mt_modelI(age^2)                        -<span style="color: #BB0000;">0.288</span>      4.75   -<span style="color: #BB0000;">0.060</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.952 </span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span> mt_modelfactor(age_m2)2               -<span style="color: #BB0000;">588.</span>      <span style="text-decoration: underline;">1</span>032.     -<span style="color: #BB0000;">0.570</span>   0.569 </span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span> mt_modeleduc                         -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">263.</span>      <span style="text-decoration: underline;">1</span>027.     -<span style="color: #BB0000;">1.23</span>    0.219 </span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span> mt_modelI(educ^2)                       80.5       56.3     1.43    0.153 </span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span> mt_modelfactor(race)1                -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">677.</span>       806.     -<span style="color: #BB0000;">2.08</span>    0.037<span style="text-decoration: underline;">8</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span> mt_modelfactor(race)2                  -<span style="color: #BB0000;">86.7</span>     <span style="text-decoration: underline;">1</span>055.     -<span style="color: #BB0000;">0.082</span><span style="color: #BB0000; text-decoration: underline;">2</span>  0.935 </span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span> mt_modelfactor(marr)1                  506.       653.      0.776   0.438 </span>
<span class="co">## <span style="color: #BCBCBC;">10</span> mt_modelfactor(nodeg)1                 162.       916.      0.177   0.859 </span>
<span class="co">## <span style="color: #BCBCBC;">11</span> mt_modelfactor(re75_zero)1            -<span style="color: #BB0000;">824.</span>       487.     -<span style="color: #BB0000;">1.69</span>    0.091<span style="text-decoration: underline;">2</span></span>
<span class="co">## <span style="color: #BCBCBC;">12</span> mt_modelfactor(age_m2)1:factor(trt)1   379.       660.      0.575   0.566 </span>
<span class="co">## <span style="color: #BCBCBC;">13</span> mt_modelfactor(age_m2)2:factor(trt)1  <span style="text-decoration: underline;">1</span>080.       677.      1.59    0.111</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="construct-input-arrays-a_i-and-alpha_i">Construct Input Arrays <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_i\)</span><a class="anchor" aria-label="anchor" href="#construct-input-arrays-a_i-and-alpha_i"></a>
</h3>
<div class="section level4">
<h4 id="linear-binary-regression">Linear Binary Regression<a class="anchor" aria-label="anchor" href="#linear-binary-regression"></a>
</h4>
<p>Multiply coefficient vector by covariate matrix to generate <em>A</em> vector that is child/individual specific.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Estimates Table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rs_wage_on_trt_tidy</span>, <span class="fl">6</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 x 5</span></span>
<span class="co">##   term                     estimate std.error statistic p.value</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;">1</span> mt_model(Intercept)     <span style="text-decoration: underline;">10</span>052.      <span style="text-decoration: underline;">6</span>160.      1.63     0.103</span>
<span class="co">## <span style="color: #BCBCBC;">2</span> mt_modelage                53.0      317.      0.167    0.867</span>
<span class="co">## <span style="color: #BCBCBC;">3</span> mt_modelI(age^2)           -<span style="color: #BB0000;">0.288</span>      4.75   -<span style="color: #BB0000;">0.060</span><span style="color: #BB0000; text-decoration: underline;">6</span>   0.952</span>
<span class="co">## <span style="color: #BCBCBC;">4</span> mt_modelfactor(age_m2)2  -<span style="color: #BB0000;">588.</span>      <span style="text-decoration: underline;">1</span>032.     -<span style="color: #BB0000;">0.570</span>    0.569</span>
<span class="co">## <span style="color: #BCBCBC;">5</span> mt_modeleduc            -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">263.</span>      <span style="text-decoration: underline;">1</span>027.     -<span style="color: #BB0000;">1.23</span>     0.219</span>
<span class="co">## <span style="color: #BCBCBC;">6</span> mt_modelI(educ^2)          80.5       56.3     1.43     0.153</span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Covariates</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mt_model</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   (Intercept) age I(age^2) factor(age_m2)2 educ I(educ^2) factor(race)1</span>
<span class="co">## 1           1  23      529               0   10       100             1</span>
<span class="co">## 2           1  26      676               1   12       144             0</span>
<span class="co">## 3           1  22      484               0    9        81             1</span>
<span class="co">## 4           1  34     1156               1    9        81             1</span>
<span class="co">## 5           1  18      324               0    9        81             1</span>
<span class="co">##   factor(race)2 factor(marr)1 factor(nodeg)1 factor(re75_zero)1</span>
<span class="co">## 1             0             0              1                  1</span>
<span class="co">## 2             0             0              0                  1</span>
<span class="co">## 3             0             0              1                  1</span>
<span class="co">## 4             0             0              1                  0</span>
<span class="co">## 5             0             0              1                  1</span>
<span class="co">##   factor(age_m2)1:factor(trt)1 factor(age_m2)2:factor(trt)1</span>
<span class="co">## 1                            0                            0</span>
<span class="co">## 2                            0                            0</span>
<span class="co">## 3                            0                            0</span>
<span class="co">## 4                            0                            0</span>
<span class="co">## 5                            0                            0</span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Covariates coefficients from regression (including constant)</span>
<span class="va">ar_fl_cova_esti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">rs_wage_on_trt_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">'trt'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_fl_main_esti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">rs_wage_on_trt_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">'trt'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_fl_cova_esti</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##           estimate</span>
<span class="co">## [1,] 10052.3178902</span>
<span class="co">## [2,]    52.9923510</span>
<span class="co">## [3,]    -0.2876203</span>
<span class="co">## [4,]  -588.1948533</span>
<span class="co">## [5,] -1263.1724715</span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_fl_main_esti</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##       estimate</span>
<span class="co">## [1,]  379.3939</span>
<span class="co">## [2,] 1079.5020</span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Select Matrix subcomponents</span>
<span class="va">mt_cova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">mt_model</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"trt"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mt_intr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">marr</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dft</span><span class="op">)</span>

<span class="co"># Generate A_i, use mt_cova_wth_const</span>
<span class="va">ar_A_m</span> <span class="op">&lt;-</span> <span class="va">mt_cova</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">ar_fl_cova_esti</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_A_m</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      estimate</span>
<span class="co">## [1,] 4201.030</span>
<span class="co">## [2,] 6259.851</span>
<span class="co">## [3,] 3894.398</span>
<span class="co">## [4,] 4572.335</span>
<span class="co">## [5,] 3728.447</span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generate alpha_i</span>
<span class="va">ar_alpha_m</span> <span class="op">&lt;-</span> <span class="va">mt_intr</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">ar_fl_main_esti</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ar_alpha_m</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   estimate</span>
<span class="co">## 1 379.3939</span>
<span class="co">## 2 379.3939</span>
<span class="co">## 3 379.3939</span>
<span class="co">## 4 379.3939</span>
<span class="co">## 5 379.3939</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="individual-weight">Individual Weight<a class="anchor" aria-label="anchor" href="#individual-weight"></a>
</h3>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Child Weight</span>
<span class="va">ar_beta_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_A_m</span><span class="op">)</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_A_m</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="matrix-with-required-inputs-for-allocation">Matrix with Required Inputs for Allocation<a class="anchor" aria-label="anchor" href="#matrix-with-required-inputs-for-allocation"></a>
</h3>
<div class="section level4">
<h4 id="linear-binary-matrix">Linear Binary Matrix<a class="anchor" aria-label="anchor" href="#linear-binary-matrix"></a>
</h4>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Initate Dataframe that will store all estimates and optimal allocation relevant information</span>
<span class="co"># combine identifying key information along with estimation A, alpha results</span>
<span class="co"># note that we only need indi.id as key</span>
<span class="va">mt_opti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">ar_alpha_m</span>, <span class="va">ar_A_m</span>, <span class="va">ar_beta_m</span><span class="op">)</span>
<span class="va">ar_st_varnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>, <span class="st">'A'</span>, <span class="st">'beta'</span><span class="op">)</span>
<span class="va">df_esti_alpha_A_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">mt_opti</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span>
<span class="va">tb_key_alpha_A_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">dft</span>, <span class="va">df_esti_alpha_A_beta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html" class="external-link">one_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'id'</span>, <span class="st">'trt'</span>, <span class="st">'age'</span>, <span class="st">'educ'</span>, <span class="st">'race'</span>, <span class="st">'marr'</span>, <span class="st">'nodeg'</span>, <span class="st">'re78'</span>,
                              <span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Rescale A and alpha to deal more easily with large powers</span>
<span class="va">tb_key_alpha_A_beta</span> <span class="op">&lt;-</span> <span class="va">tb_key_alpha_A_beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">1000</span>, A <span class="op">=</span> <span class="va">A</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>

<span class="co"># Need to only include the smokers here</span>
<span class="co"># tb_key_alpha_A_beta &lt;- tb_key_alpha_A_beta %&gt;% filter(trt == 0)</span>

<span class="co"># Unique beta, A, and alpha check</span>
<span class="va">tb_opti_unique</span> <span class="op">&lt;-</span> <span class="va">tb_key_alpha_A_beta</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">syms</a></span><span class="op">(</span><span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">syms</a></span><span class="op">(</span><span class="va">ar_st_varnames</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n_obs_group<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'alpha', 'A'. You can override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show cars</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tb_key_alpha_A_beta</span>, <span class="fl">32</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    id trt age educ race marr nodeg      re78     alpha        A        beta</span>
<span class="co">## 1   1   0  23   10    1    0     1     0.000 0.3793939 4.201030 0.001385042</span>
<span class="co">## 2   2   0  26   12    0    0     0 12383.680 0.3793939 6.259851 0.001385042</span>
<span class="co">## 3   3   0  22    9    1    0     1     0.000 0.3793939 3.894398 0.001385042</span>
<span class="co">## 4   4   0  34    9    1    0     1 14051.160 0.3793939 4.572335 0.001385042</span>
<span class="co">## 5   5   0  18    9    1    0     1 10740.080 0.3793939 3.728447 0.001385042</span>
<span class="co">## 6   6   0  45   11    1    0     1 11796.470 0.3793939 4.775996 0.001385042</span>
<span class="co">## 7   7   0  18    9    1    0     1  9227.052 0.3793939 3.728447 0.001385042</span>
<span class="co">## 8   8   0  27   12    1    0     0  3552.268 0.3793939 5.444597 0.001385042</span>
<span class="co">## 9   9   0  24    8    0    0     1 10569.270 0.3793939 4.956678 0.001385042</span>
<span class="co">## 10 10   0  34   11    1    1     1  6040.335 1.0795020 4.949491 0.001385042</span>
<span class="co">## 11 11   0  20   13    1    0     0  9199.563 0.3793939 6.506135 0.001385042</span>
<span class="co">## 12 12   0  24    4    2    0     1  3880.833 0.3793939 6.058071 0.001385042</span>
<span class="co">## 13 13   0  36   10    1    0     1     0.000 0.3793939 4.081130 0.001385042</span>
<span class="co">## 14 14   0  21   10    1    0     1     0.000 0.3793939 4.943861 0.001385042</span>
<span class="co">## 15 15   0  28   12    1    1     0 10067.430 1.0795020 5.988239 0.001385042</span>
<span class="co">## 16 16   0  21   14    1    0     0  5775.062 0.3793939 6.634520 0.001385042</span>
<span class="co">## 17 17   0  28    9    1    0     1     0.000 0.3793939 3.537871 0.001385042</span>
<span class="co">## 18 18   0  21   11    1    1     1  8976.826 1.0795020 5.877939 0.001385042</span>
<span class="co">## 19 19   0  27    7    1    1     1     0.000 1.0795020 3.957082 0.001385042</span>
<span class="co">## 20 20   0  18   12    0    0     0  2502.526 0.3793939 7.348854 0.001385042</span>
<span class="co">## 21 21   0  19   11    0    0     1     0.000 0.3793939 6.141498 0.001385042</span>
<span class="co">## 22 22   0  30   13    1    0     0     0.000 0.3793939 6.304054 0.001385042</span>
<span class="co">## 23 23   0  26   11    2    0     1     0.000 0.3793939 6.570501 0.001385042</span>
<span class="co">## 24 24   0  20    8    1    0     1     0.000 0.3793939 3.707017 0.001385042</span>
<span class="co">## 25 25   0  31    4    0    0     1     0.000 0.3793939 7.228442 0.001385042</span>
<span class="co">## 26 26   0  18   12    1    0     0 14444.710 0.3793939 5.672347 0.001385042</span>
<span class="co">## 27 27   0  34   12    1    0     0  2113.722 0.3793939 4.869224 0.001385042</span>
<span class="co">## 28 28   0  24   10    1    0     1  7618.639 0.3793939 3.652309 0.001385042</span>
<span class="co">## 29 29   0  22    8    2    0     1  9920.945 0.3793939 5.378697 0.001385042</span>
<span class="co">## 30 30   0  28    8    1    0     1  4623.188 0.3793939 4.255820 0.001385042</span>
<span class="co">## 31 31   0  25   11    1    0     1  4196.375 0.3793939 4.118817 0.001385042</span>
<span class="co">## 32 32   0  39    9    1    0     1     0.000 0.3793939 3.908810 0.001385042</span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="optimal-linear-allocations">Optimal Linear Allocations<a class="anchor" aria-label="anchor" href="#optimal-linear-allocations"></a>
</h2>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">svr_inpalc</span> <span class="op">&lt;-</span> <span class="st">'opti_alloc_queue'</span>

<span class="co"># Child Count</span>
<span class="va">it_obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tb_opti_unique</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>

<span class="co"># Vector of Planner Preference</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">0.8</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="op">-</span><span class="fl">25</span>, <span class="op">-</span><span class="fl">10</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span>
<span class="co"># ar_rho &lt;- c(seq(-200, -100, length.out=5), seq(-100, -25, length.out=5), seq(-25, -5, length.out=5), seq(-5, -1, length.out=5), seq(-1, -0.01, length.out=5), seq(0.01, 0.25, length.out=5), seq(0.25, 0.90, length.out=5))</span>
<span class="co"># ar_rho &lt;- c(-100, -5, -1, 0.1, 0.6, 0.99)</span>
<span class="co"># ar_rho &lt;- c(-20, -1, 0.05, 0.9)</span>
<span class="co"># ar_rho &lt;- c(-50, -40, -30, -20, -15, -10, -7.5, -5,-3,-2,-1)</span>
<span class="co"># ar_rho = c(-100, -0.001,  0.95)</span>
<span class="va">ar_rho</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">0.001</span>,  <span class="fl">0.95</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="op">-</span><span class="fl">100</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">25</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>, <span class="op">-</span><span class="fl">5</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">1</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.01</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.25</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.90</span>, length.out<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>, length.out<span class="op">=</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ar_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ar_rho</span><span class="op">)</span>

<span class="va">svr_rho_val</span> <span class="op">&lt;-</span> <span class="st">'rho_val'</span>
<span class="va">ls_bin_solu_all_rhos</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/ffp_opt_anlyz_rhgin_bin.html">ffp_opt_anlyz_rhgin_bin</a></span><span class="op">(</span><span class="va">tb_key_alpha_A_beta</span>,
                          svr_id_i <span class="op">=</span> <span class="st">'id'</span>,
                          svr_A_i <span class="op">=</span> <span class="st">'A'</span>, svr_alpha_i <span class="op">=</span> <span class="st">'alpha'</span>, svr_beta_i <span class="op">=</span> <span class="st">'beta'</span>,
                          ar_rho <span class="op">=</span> <span class="va">ar_rho</span>, 
                          svr_rho <span class="op">=</span> <span class="st">'rho'</span>, svr_rho_val <span class="op">=</span> <span class="va">svr_rho_val</span>,
                          svr_inpalc <span class="op">=</span> <span class="va">svr_inpalc</span>,
                          svr_expout <span class="op">=</span> <span class="st">'opti_exp_outcome'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = "id"</span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_all_rho</span> <span class="op">&lt;-</span> <span class="va">ls_bin_solu_all_rhos</span><span class="op">$</span><span class="va">df_all_rho</span>
<span class="va">df_all_rho_long</span> <span class="op">&lt;-</span> <span class="va">ls_bin_solu_all_rhos</span><span class="op">$</span><span class="va">df_all_rho_long</span>

<span class="co"># How many people have different ranks across rhos</span>
<span class="va">it_how_many_vary_rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df_all_rho</span><span class="op">$</span><span class="va">rank_max</span> <span class="op">-</span> <span class="va">df_all_rho</span><span class="op">$</span><span class="va">rank_min</span><span class="op">)</span>
<span class="va">it_how_many_vary_rank</span></code></pre></div>
<pre><code><span class="co">## [1] -94434</span></code></pre>
<div class="section level3">
<h3 id="save-results">Save Results<a class="anchor" aria-label="anchor" href="#save-results"></a>
</h3>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Change Variable names so that this can becombined with logit file later</span>
<span class="va">df_all_rho</span> <span class="op">&lt;-</span> <span class="va">df_all_rho</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"rho_"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html" class="external-link">funs</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"rk"</span>, <span class="st">"rk_wage"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">df_all_rho</span> <span class="op">&lt;-</span> <span class="va">df_all_rho</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>A_i_wage <span class="op">=</span> <span class="va">A</span>, alpha_i_wage <span class="op">=</span> <span class="va">alpha</span>, beta_i_wage <span class="op">=</span> <span class="va">beta</span>,
                                    rank_min_wage <span class="op">=</span> <span class="va">rank_min</span>, rank_max_wage <span class="op">=</span> <span class="va">rank_max</span>, avg_rank_wage <span class="op">=</span> <span class="va">avg_rank</span><span class="op">)</span>

<span class="co"># Save File</span>
<span class="kw">if</span> <span class="op">(</span><span class="va">bl_save_rda</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">df_opt_lalonde_training_wage</span> <span class="op">&lt;-</span> <span class="va">df_all_rho</span>
  <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data</a></span><span class="op">(</span><span class="va">df_opt_lalonde_training_wage</span>, <span class="va">df_opt_lalonde_training_wage</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="change-in-rank-along-rho">Change in Rank along rho<a class="anchor" aria-label="anchor" href="#change-in-rank-along-rho"></a>
</h3>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get rank when wage rho = 1</span>
<span class="va">df_all_rho_rho_c1</span> <span class="op">&lt;-</span> <span class="va">df_all_rho</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">rho_c1_rk_wage</span><span class="op">)</span>

<span class="co"># Merge</span>
<span class="va">df_all_rho_long_more</span> <span class="op">&lt;-</span> <span class="va">df_all_rho_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">df_all_rho_rho_c1</span>, by<span class="op">=</span><span class="st">'id'</span><span class="op">)</span>

<span class="co"># Select subset to graph</span>
<span class="va">df_rank_graph</span> <span class="op">&lt;-</span> <span class="va">df_all_rho_long_more</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">167</span><span class="op">)</span> <span class="op">|</span>  <span class="co"># utilitarian rank = 1</span>
                           <span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">175</span><span class="op">)</span> <span class="op">|</span>  <span class="co"># utilitarian rank = 101</span>
                           <span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">3710</span><span class="op">)</span>  <span class="op">|</span>  <span class="co"># utilitarian rank = 202</span>
                           <span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">2151</span><span class="op">)</span> <span class="op">|</span>  <span class="co"># utilitarian rank = 306</span>
                           <span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">27</span><span class="op">)</span><span class="op">|</span>  <span class="co"># utilitarian rank = 405</span>
                           <span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">58</span><span class="op">)</span> <span class="op">|</span>  <span class="co"># utilitarian rank = 503</span>
                           <span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">184</span><span class="op">)</span> <span class="op">|</span>  <span class="co"># utilitarian rank = 603</span>
                           <span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">1481</span><span class="op">)</span>   <span class="co"># utilitarian rank = 701</span>
                             <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>one_minus_rho <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">svr_rho_val</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rho_c1_rk_wage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">rho_c1_rk_wage</span><span class="op">)</span><span class="op">)</span>

<span class="va">df_rank_graph</span><span class="op">$</span><span class="va">rho_c1_rk_wage</span></code></pre></div>
<pre><code><span class="co">##   [1] 405 405 405 405 405 405 405 405 405 405 405 405 405 405 405 405 405 405</span>
<span class="co">##  [19] 405 405 405 405 405 405 405 405 405 405 405 405 503 503 503 503 503 503</span>
<span class="co">##  [37] 503 503 503 503 503 503 503 503 503 503 503 503 503 503 503 503 503 503</span>
<span class="co">##  [55] 503 503 503 503 503 503 1   1   1   1   1   1   1   1   1   1   1   1  </span>
<span class="co">##  [73] 1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1  </span>
<span class="co">##  [91] 101 101 101 101 101 101 101 101 101 101 101 101 101 101 101 101 101 101</span>
<span class="co">## [109] 101 101 101 101 101 101 101 101 101 101 101 101 603 603 603 603 603 603</span>
<span class="co">## [127] 603 603 603 603 603 603 603 603 603 603 603 603 603 603 603 603 603 603</span>
<span class="co">## [145] 603 603 603 603 603 603 202 202 202 202 202 202 202 202 202 202 202 202</span>
<span class="co">## [163] 202 202 202 202 202 202 202 202 202 202 202 202 202 202 202 202 202 202</span>
<span class="co">## [181] 701 701 701 701 701 701 701 701 701 701 701 701 701 701 701 701 701 701</span>
<span class="co">## [199] 701 701 701 701 701 701 701 701 701 701 701 701 306 306 306 306 306 306</span>
<span class="co">## [217] 306 306 306 306 306 306 306 306 306 306 306 306 306 306 306 306 306 306</span>
<span class="co">## [235] 306 306 306 306 306 306</span>
<span class="co">## Levels: 1 101 202 306 405 503 603 701</span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_rank_graph</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df_rank_graph</span><span class="op">$</span><span class="va">rho_c1_rk_wage</span>,
                           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Rank= 1 when λ=0.99'</span>, <span class="co">#200</span>
                                      <span class="st">'Rank= 101 when λ=0.99'</span>, <span class="co">#110</span>
                                      <span class="st">'Rank= 201 when λ=0.99'</span>, <span class="co">#95</span>
                                      <span class="st">'Rank= 301 when λ=0.99'</span>, <span class="co">#217</span>
                                      <span class="st">'Rank= 401 when λ=0.99'</span>, <span class="co">#274</span>
                                      <span class="st">'Rank= 501 when λ=0.99'</span>, <span class="co">#101</span>
                                      <span class="st">'Rank= 601 when λ=0.99'</span>, <span class="co">#131</span>
                                      <span class="st">'Rank= 701 when λ=0.99'</span> <span class="co">#3610</span>
                                       <span class="op">)</span><span class="op">)</span>

<span class="co"># x-labels</span>
<span class="va">x.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'λ=0.99'</span>, <span class="st">'λ=0.90'</span>, <span class="st">'λ=0'</span>, <span class="st">'λ=-10'</span>, <span class="st">'λ=-100'</span><span class="op">)</span>
<span class="va">x.breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.10</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>

<span class="co"># title line 2</span>
<span class="va">title_line1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"LINEAR WAGE: Optimal Tageting Queue, NSW Lalonde (AER, 1986)"</span><span class="op">)</span>
<span class="va">title_line2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"How Do Allocation Rankings (Targeting Queue) Shift with λ?"</span><span class="op">)</span>

<span class="co"># Graph Results--Draw</span>
<span class="va">line.plot</span> <span class="op">&lt;-</span> <span class="va">df_rank_graph</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">one_minus_rho</span>, y<span class="op">=</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">svr_inpalc</span><span class="op">)</span>,
             group<span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,
             colour<span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,
             size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># geom_line(aes(linetype =fct_rev(id)), size=0.75) +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, linetype<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">title_line1</span>, <span class="st">'\n'</span>, <span class="va">title_line2</span><span class="op">)</span>,
       x <span class="op">=</span> <span class="st">'log10 Rescale of λ, Log10(λ)\nλ=1 Utilitarian, λ=-infty Rawlsian'</span>,
       y <span class="op">=</span> <span class="st">'Optimal Targeting Queue Rank (1=highest)'</span>,
       caption <span class="op">=</span> <span class="st">'Training RCT with 297 treated, 425 untreated. Optimal Binary Targeting Queue.'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>trans<span class="op">=</span><span class="st">'log10'</span>, labels <span class="op">=</span> <span class="va">x.labels</span>, breaks <span class="op">=</span> <span class="va">x.breaks</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">line.plot</span><span class="op">)</span></code></pre></div>
<p><img src="ffv_opt_sobin_rkone_allrw_training_wage_files/figure-html/graph%20of%20rank%20change-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="bump-plot-for-optimal-binary-allocations">Bump Plot for Optimal Binary Allocations<a class="anchor" aria-label="anchor" href="#bump-plot-for-optimal-binary-allocations"></a>
</h3>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># tb_opti_alloc_all_rho_long %&gt;%</span>
<span class="co">#   ggplot(aes(x = rho, y = rank, group = id)) +</span>
<span class="co">#     geom_line(aes(color = race, alpha = 1), size = 2) +</span>
<span class="co">#     geom_point(aes(color = race, alpha = 1), size = 4) +</span>
<span class="co">#     scale_x_discrete(expand = c(0.85,0))+</span>
<span class="co">#     scale_y_reverse(breaks = 1:nrow(tb_opti_alloc_all_rho_long))+</span>
<span class="co">#     theme(legend.position = "none") +</span>
<span class="co">#     labs(x = "Equality vs Efficiency",</span>
<span class="co">#          y = "Rank",</span>
<span class="co">#          title = "Binary Allocation Rank, which untrained to receive training first") +</span>
<span class="co">#     ffy_opt_ghthm_dk() +</span>
<span class="co">#     geom_text(data =tb_opti_alloc_all_rho,aes(y=rho_c1_rk,x=0.6,label=id),hjust="right")</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://fanwangecon.github.io" class="external-link">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
