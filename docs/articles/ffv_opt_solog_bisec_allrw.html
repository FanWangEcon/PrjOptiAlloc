<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Line by Line Test Log Linear Allocation Test â€¢ Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Line by Line Test Log Linear Allocation Test">
<meta property="og:description" content="Given allocation space parameters (A, alpha) for log linear regression, test log-linear optima allocation line by line.
The result is not included in the final version of the paper, because the results are not closed-form, but are based on a root search.
The root search is very fast when initial condition is zero.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/PrjOptiAlloc.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue.pdf">Paper</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue_Present.pdf">Slides</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/">Python Examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://fanwangecon.github.io/">Fan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ffv_opt_solog_bisec_allrw_files/header-attrs-2.2/header-attrs.js"></script><script src="ffv_opt_solog_bisec_allrw_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Line by Line Test Log Linear Allocation Test</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/master/vignettes/ffv_opt_solog_bisec_allrw.Rmd"><code>vignettes/ffv_opt_solog_bisec_allrw.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_solog_bisec_allrw.Rmd</code></div>

    </div>

    
    
<p>Given allocation space parameters (A, alpha) for log linear regression, test log-linear optima allocation line by line. The result is not included in the final version of the paper, because the results are not closed-form, but are based on a root search. The root search is very fast when initial condition is zero.</p>
<p>The objective of this file is to solve the log linear <span class="math inline">\(N_i\)</span> and <span class="math inline">\(H_i\)</span> problem without invoking any functions using bisection with the implicit solution derived in the paper.</p>
<p>File name <em>ffv_opt_solog_bisec_allrw</em>:</p>
<ul>
<li>
<em>opt</em>: optimal allocation project</li>
<li>
<em>solog</em>: log linear production function</li>
<li>
<em>bisec</em>: implicit formula solved via bisection</li>
<li>
<em>allrw</em>: all code line by line raw original file</li>
</ul>
<div id="input-and-output" class="section level2">
<h2 class="hasAnchor">
<a href="#input-and-output" class="anchor"></a>Input and Output</h2>
<p>There is a dataset with child attributes, nutritional inputs and outputs. Run regression to estimate some input output relationship first. Then generate required inputs for code.</p>
<ol style="list-style-type: decimal">
<li>Required Input</li>
</ol>
<ul>
<li>
<span class="citation">@param</span> df tibble data table including variables using svr names below each row is potentially an individual who will receive alternative allocations</li>
<li>
<span class="citation">@param</span> svr_A_i string name of the A_i variable, dot product of covariates and coefficients, TFP from log linear</li>
<li>
<span class="citation">@param</span> svr_alpha_i string name of the alpha_i variable, individual specific elasticity information, elasticity from log linear</li>
<li>
<span class="citation">@param</span> svr_beta_i string name of the beta_i variable, relative preference weight for each child</li>
<li>
<span class="citation">@param</span> svr_N_i string name of the vector of existing inputs, based on which to compute aggregate resource</li>
<li>
<span class="citation">@param</span> fl_N_hat float total resource avaible for allocation, if not specific, sum by svr_N_i</li>
<li>
<span class="citation">@param</span> fl_rho float preference for equality for the planner</li>
<li>
<span class="citation">@return</span> a dataframe that expands the df inputs with additional results, including bisection solution.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>The structure assumes some regression has already taken place to generate the i specific variables listed.</li>
</ol>
</div>
<div id="load-packages-and-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-packages-and-data" class="anchor"></a>Load Packages and Data</h2>
<div id="load-dependencies" class="section level3">
<h3 class="hasAnchor">
<a href="#load-dependencies" class="anchor"></a>Load Dependencies</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="kw">all.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">knitr.duplicate.label</span> <span class="kw">=</span> <span class="st">'allow'</span>)</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stringr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">broom</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">PrjOptiAlloc</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">knitr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">kableExtra</span>)</pre></body></html></div>
</div>
<div id="common-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#common-parameters" class="anchor"></a>common parameters</h3>
<p>some important shared, common fixed parameters specify them here:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># which params to test</span>
<span class="no">it_test</span> <span class="kw">=</span> <span class="fl">6</span>

<span class="co"># parameters</span>
<span class="no">fl_rho</span> <span class="kw">=</span> <span class="fl">0.20</span>
<span class="no">svr_id_var</span> <span class="kw">=</span> <span class="st">'indi_id'</span>

<span class="co"># it_child_count = n, the number of children</span>
<span class="no">it_n_child_cnt</span> <span class="kw">=</span> <span class="fl">2</span>
<span class="co"># it_heter_param = q, number of parameters that are heterogeneous across children</span>
<span class="no">it_q_hetpa_cnt</span> <span class="kw">=</span> <span class="fl">2</span>

<span class="co"># choice grid for nutritional feasible choices for each</span>
<span class="no">fl_n_agg</span> <span class="kw">=</span> <span class="fl">100</span>
<span class="no">fl_n_min</span> <span class="kw">=</span> <span class="fl">0</span>
<span class="no">it_n_choice_cnt_ttest</span> <span class="kw">=</span> <span class="fl">3</span>
<span class="no">it_n_choice_cnt_dense</span> <span class="kw">=</span> <span class="fl">100</span></pre></body></html></div>
</div>
<div id="a-and-alpha-input-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#a-and-alpha-input-matrix" class="anchor"></a>a and alpha input matrix</h3>
<p>different types of <em>alpha</em> and <em>a</em> combinations. the algorithm, solutions should work for any alpha and a.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="kw">if</span> (<span class="no">it_test</span> <span class="kw">==</span> <span class="fl">1</span>) {
  <span class="co"># A. test params 1</span>
  <span class="co"># these are initially what i tested with, positively correlated a and alpha, some have both higher tfp as well as elasticity.</span>
  <span class="no">ar_nn_a</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">2</span>, <span class="fl">2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="no">it_n_child_cnt</span>)
  <span class="no">ar_nn_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="no">it_n_child_cnt</span>)
  <span class="no">mt_nn_by_nq_a_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>)
} <span class="kw">else</span> <span class="kw">if</span> (<span class="no">it_test</span> <span class="kw">==</span> <span class="fl">2</span>) {
  <span class="co"># B. test params 2</span>
  <span class="no">ar_nn_a</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>)
  <span class="no">ar_nn_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>)
  <span class="no">mt_nn_by_nq_a_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>)
} <span class="kw">else</span> <span class="kw">if</span> (<span class="no">it_test</span> <span class="kw">==</span> <span class="fl">3</span>) {
  <span class="co"># C. test params 3</span>
  <span class="no">ar_nn_a</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>)
  <span class="no">ar_nn_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>)
  <span class="no">mt_nn_by_nq_a_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>)
} <span class="kw">else</span> <span class="kw">if</span> (<span class="no">it_test</span> <span class="kw">==</span> <span class="fl">4</span>) {
  <span class="co"># D. test params 4</span>
  <span class="no">ar_nn_a</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>)
  <span class="no">ar_nn_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.006686704</span>,<span class="fl">0.009251407</span>)
  <span class="no">mt_nn_by_nq_a_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>)
} <span class="kw">else</span> <span class="kw">if</span> (<span class="no">it_test</span> <span class="kw">==</span> <span class="fl">5</span>) {
  <span class="co"># E. test params 5</span>
  <span class="no">ar_nn_a</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.342501</span>, <span class="fl">4.359987</span>)
  <span class="no">ar_nn_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.006686704</span>,<span class="fl">0.009251407</span>)
  <span class="no">mt_nn_by_nq_a_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>)
} <span class="kw">else</span> <span class="kw">if</span> (<span class="no">it_test</span> <span class="kw">==</span> <span class="fl">6</span>) {
  <span class="co"># graph b</span>
  <span class="co"># input group two, from the project</span>
  <span class="no">ls_opti_alpha_a</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ffy_opt_dtgch_cbem4.html">ffy_opt_dtgch_cbem4</a></span>()
  <span class="no">df_esti</span> <span class="kw">&lt;-</span> <span class="no">ls_opti_alpha_a</span>$<span class="no">df_esti</span>
  <span class="no">df_dtgch_cbem4_bisec</span> <span class="kw">&lt;-</span> <span class="no">df_esti</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'A_log'</span>, <span class="st">'alpha_log'</span>)]
  <span class="no">ar_nn_a</span> <span class="kw">&lt;-</span> <span class="no">df_dtgch_cbem4_bisec</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">A_log</span>)
  <span class="no">ar_nn_alpha</span> <span class="kw">&lt;-</span> <span class="no">df_dtgch_cbem4_bisec</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">alpha_log</span>)
  <span class="no">mt_nn_by_nq_a_alpha</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>)
}</pre></body></html></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
</div>
<div id="expand-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#expand-matrix" class="anchor"></a>expand matrix</h3>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># choice grid for nutritional feasible choices for each</span>
<span class="no">it_n_choice_cnt_ttest</span> <span class="kw">=</span> <span class="fl">3</span>
<span class="no">it_n_choice_cnt_dense</span> <span class="kw">=</span> <span class="fl">100</span>
<span class="no">ar_n_choices_ttest</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">fl_n_min</span>, <span class="no">fl_n_agg</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="no">it_n_choice_cnt_ttest</span>)
<span class="no">ar_n_choices_dense</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">fl_n_min</span>, <span class="no">fl_n_agg</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="no">it_n_choice_cnt_dense</span>)

<span class="co"># mesh expand</span>
<span class="no">tb_states_choices</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="no">mt_nn_by_nq_a_alpha</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rowid_to_column</a></span>(<span class="kw">var</span><span class="kw">=</span><span class="no">svr_id_var</span>)
<span class="no">tb_states_choices_ttest</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span>(<span class="fl">9</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span>(<span class="kw">choices</span> <span class="kw">=</span> <span class="no">ar_n_choices_ttest</span>)
<span class="no">tb_states_choices_dense</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span>(<span class="fl">9</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span>(<span class="kw">choices</span> <span class="kw">=</span> <span class="no">ar_n_choices_dense</span>)

<span class="co"># display</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tb_states_choices_dense</span>)</pre></body></html></div>
<pre><code>##     indi_id          ar_nn_a       ar_nn_alpha          choices   
##  Min.   : 265.0   Min.   :4.326   Min.   :0.006687   Min.   :  0  
##  1st Qu.: 415.0   1st Qu.:4.333   1st Qu.:0.006687   1st Qu.: 25  
##  Median : 619.0   Median :4.339   Median :0.006687   Median : 50  
##  Mean   : 642.3   Mean   :4.341   Mean   :0.009184   Mean   : 50  
##  3rd Qu.: 910.0   3rd Qu.:4.350   3rd Qu.:0.012090   3rd Qu.: 75  
##  Max.   :1034.0   Max.   :4.356   Max.   :0.013940   Max.   :100</code></pre>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">tb_states_choices_ttest</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span>(<span class="kw">bootstrap_options</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</pre></body></html></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:right;">
indi_id
</th>
<th style="text-align:right;">
ar_nn_a
</th>
<th style="text-align:right;">
ar_nn_alpha
</th>
<th style="text-align:right;">
choices
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
4.349022
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
4.349022
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
4.349022
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
875
</td>
<td style="text-align:right;">
4.327174
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
875
</td>
<td style="text-align:right;">
4.327174
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
875
</td>
<td style="text-align:right;">
4.327174
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
4.340905
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
4.340905
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
4.340905
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
4.325589
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
4.325589
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
4.325589
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
4.335723
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
4.335723
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
4.335723
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
4.363504
</td>
<td style="text-align:right;">
0.0139396
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
4.363504
</td>
<td style="text-align:right;">
0.0139396
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
4.363504
</td>
<td style="text-align:right;">
0.0139396
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
564
</td>
<td style="text-align:right;">
4.347655
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
564
</td>
<td style="text-align:right;">
4.347655
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
564
</td>
<td style="text-align:right;">
4.347655
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
4.347518
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
4.347518
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
4.347518
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="apply-same-function-all-rows-some-inputs-row-specific-other-shared" class="section level2">
<h2 class="hasAnchor">
<a href="#apply-same-function-all-rows-some-inputs-row-specific-other-shared" class="anchor"></a>Apply Same Function All Rows, some inputs row-specific, other shared</h2>
<div id="points-and-denser-dataframs-and-define-function" class="section level3">
<h3 class="hasAnchor">
<a href="#points-and-denser-dataframs-and-define-function" class="anchor"></a>3 points and denser dataframs and define function</h3>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># convert matrix to tibble</span>
<span class="no">ar_st_col_names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">svr_id_var</span>,<span class="st">'fl_a'</span>, <span class="st">'fl_alpha'</span>)
<span class="no">tb_states_choices</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html">rename_all</a></span>(~<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_st_col_names</span>))
<span class="no">ar_st_col_names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">svr_id_var</span>,<span class="st">'fl_a'</span>, <span class="st">'fl_alpha'</span>, <span class="st">'fl_n'</span>)
<span class="no">tb_states_choices_ttest</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_ttest</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html">rename_all</a></span>(~<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_st_col_names</span>))
<span class="no">tb_states_choices_dense</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_dense</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html">rename_all</a></span>(~<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_st_col_names</span>))

<span class="co"># define implicit function</span>
<span class="no">ffi_nonlin_dplyrdo</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">fl_a</span>, <span class="no">fl_alpha</span>, <span class="no">fl_n</span>, <span class="no">ar_a</span>, <span class="no">ar_alpha</span>, <span class="no">fl_n_agg</span>, <span class="no">fl_rho</span>){
  <span class="co"># scalar value that are row-specific, in dataframe already: *fl_a*, *fl_alpha*, *fl_n*</span>
  <span class="co"># array and scalars not in dataframe, common all rows: *ar_a*, *ar_alpha*, *fl_n_agg*, *fl_rho*</span>

  <span class="co"># test parameters</span>
  <span class="co"># ar_a = ar_nn_a</span>
  <span class="co"># ar_alpha = ar_nn_alpha</span>
  <span class="co"># fl_n = 100</span>
  <span class="co"># fl_rho = -1</span>
  <span class="co"># fl_n_q = 10</span>

  <span class="co"># apply function</span>
  <span class="no">ar_p1_s1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>((<span class="no">fl_a</span> - <span class="no">ar_a</span>)*<span class="no">fl_rho</span>)
  <span class="no">ar_p1_s2</span> <span class="kw">=</span> (<span class="no">fl_alpha</span>/<span class="no">ar_alpha</span>)
  <span class="no">ar_p1_s3</span> <span class="kw">=</span> (<span class="fl">1</span>/(<span class="no">ar_alpha</span>*<span class="no">fl_rho</span> - <span class="fl">1</span>))
  <span class="no">ar_p1</span> <span class="kw">=</span> (<span class="no">ar_p1_s1</span>*<span class="no">ar_p1_s2</span>)^<span class="no">ar_p1_s3</span>
  <span class="no">ar_p2</span> <span class="kw">=</span> <span class="no">fl_n</span>^((<span class="no">fl_alpha</span>*<span class="no">fl_rho</span>-<span class="fl">1</span>)/(<span class="no">ar_alpha</span>*<span class="no">fl_rho</span>-<span class="fl">1</span>))
  <span class="no">ar_overall</span> <span class="kw">=</span> <span class="no">ar_p1</span>*<span class="no">ar_p2</span>
  <span class="no">fl_overall</span> <span class="kw">=</span> <span class="no">fl_n_agg</span> - <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">ar_overall</span>)

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">fl_overall</span>)
}</pre></body></html></div>
</div>
<div id="evaluate-at-three-choice-points-and-show-table" class="section level3">
<h3 class="hasAnchor">
<a href="#evaluate-at-three-choice-points-and-show-table" class="anchor"></a>evaluate at three choice points and show table</h3>
<p>in the example below, just show results evaluating over three choice points and show table.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># fl_a, fl_alpha are from columns of tb_nn_by_nq_a_alpha</span>
<span class="no">tb_states_choices_ttest_eval</span> <span class="kw">=</span> <span class="no">tb_states_choices_ttest</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span>() <span class="kw">%&gt;%</span>
                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">dplyr_eval</span> <span class="kw">=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(<span class="no">fl_a</span>, <span class="no">fl_alpha</span>, <span class="no">fl_n</span>,
                                                               <span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>,
                                                               <span class="no">fl_n_agg</span>, <span class="no">fl_rho</span>))
<span class="co"># show</span>
<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">tb_states_choices_ttest_eval</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span>(<span class="kw">bootstrap_options</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>))</pre></body></html></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:right;">
indi_id
</th>
<th style="text-align:right;">
fl_a
</th>
<th style="text-align:right;">
fl_alpha
</th>
<th style="text-align:right;">
fl_n
</th>
<th style="text-align:right;">
dplyr_eval
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
4.349022
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
4.349022
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-58144.64
</td>
</tr>
<tr>
<td style="text-align:right;">
171
</td>
<td style="text-align:right;">
4.349022
</td>
<td style="text-align:right;">
0.0092514
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-116420.04
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-80752.67
</td>
</tr>
<tr>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
4.346102
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-161705.70
</td>
</tr>
<tr>
<td style="text-align:right;">
875
</td>
<td style="text-align:right;">
4.327174
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
875
</td>
<td style="text-align:right;">
4.327174
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-81060.01
</td>
</tr>
<tr>
<td style="text-align:right;">
875
</td>
<td style="text-align:right;">
4.327174
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-162320.75
</td>
</tr>
<tr>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
4.340905
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
4.340905
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-44415.50
</td>
</tr>
<tr>
<td style="text-align:right;">
298
</td>
<td style="text-align:right;">
4.340905
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-88919.39
</td>
</tr>
<tr>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
4.325589
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
4.325589
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-81085.80
</td>
</tr>
<tr>
<td style="text-align:right;">
850
</td>
<td style="text-align:right;">
4.325589
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-162372.37
</td>
</tr>
<tr>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
4.335723
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
4.335723
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-80921.05
</td>
</tr>
<tr>
<td style="text-align:right;">
496
</td>
<td style="text-align:right;">
4.335723
</td>
<td style="text-align:right;">
0.0066867
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-162042.68
</td>
</tr>
<tr>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
4.363504
</td>
<td style="text-align:right;">
0.0139396
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
4.363504
</td>
<td style="text-align:right;">
0.0139396
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-38267.14
</td>
</tr>
<tr>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
4.363504
</td>
<td style="text-align:right;">
0.0139396
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-76604.56
</td>
</tr>
<tr>
<td style="text-align:right;">
564
</td>
<td style="text-align:right;">
4.347655
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
564
</td>
<td style="text-align:right;">
4.347655
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-44355.31
</td>
</tr>
<tr>
<td style="text-align:right;">
564
</td>
<td style="text-align:right;">
4.347655
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-88799.03
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
4.347518
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
4.347518
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-44356.54
</td>
</tr>
<tr>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
4.347518
</td>
<td style="text-align:right;">
0.0120902
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
-88801.48
</td>
</tr>
</tbody>
</table>
</div>
<div id="evaluate-at-many-choice-points-and-show-graphically" class="section level3">
<h3 class="hasAnchor">
<a href="#evaluate-at-many-choice-points-and-show-graphically" class="anchor"></a>evaluate at many choice points and show graphically</h3>
<p>same as above, but now we evaluate the function over the individuals at many choice points so that we can graph things out.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># fl_a, fl_alpha are from columns of tb_nn_by_nq_a_alpha</span>
<span class="no">tb_states_choices_dense_eval</span> <span class="kw">=</span> <span class="no">tb_states_choices_dense</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span>() <span class="kw">%&gt;%</span>
                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">dplyr_eval</span> <span class="kw">=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(<span class="no">fl_a</span>, <span class="no">fl_alpha</span>, <span class="no">fl_n</span>,
                                                               <span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>,
                                                               <span class="no">fl_n_agg</span>, <span class="no">fl_rho</span>))</pre></body></html></div>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># show</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">tb_states_choices_dense_eval</span>)</pre></body></html></div>
<pre><code>## [1] 900   5</code></pre>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tb_states_choices_dense_eval</span>)</pre></body></html></div>
<pre><code>##     indi_id            fl_a          fl_alpha             fl_n    
##  Min.   : 265.0   Min.   :4.326   Min.   :0.006687   Min.   :  0  
##  1st Qu.: 415.0   1st Qu.:4.333   1st Qu.:0.006687   1st Qu.: 25  
##  Median : 619.0   Median :4.339   Median :0.006687   Median : 50  
##  Mean   : 642.3   Mean   :4.341   Mean   :0.009184   Mean   : 50  
##  3rd Qu.: 910.0   3rd Qu.:4.350   3rd Qu.:0.012090   3rd Qu.: 75  
##  Max.   :1034.0   Max.   :4.356   Max.   :0.013940   Max.   :100  
##    dplyr_eval     
##  Min.   :-162366  
##  1st Qu.: -94933  
##  Median : -58742  
##  Mean   : -64873  
##  3rd Qu.: -29280  
##  Max.   :    100</code></pre>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">lineplot</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_dense_eval</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">fl_n</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">dplyr_eval</span>)) +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>( <span class="no">.</span> ~ <span class="no">indi_id</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>) +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="kw">yintercept</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">linetype</span><span class="kw">=</span><span class="st">"dashed"</span>,
                <span class="kw">color</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>)
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">'evaluate non-linear functions to search for roots'</span>,
             <span class="kw">x</span> <span class="kw">=</span> <span class="st">'x values'</span>,
             <span class="kw">y</span> <span class="kw">=</span> <span class="st">'f(x)'</span>,
             <span class="kw">caption</span> <span class="kw">=</span> <span class="st">'evaluating the function'</span>)</pre></body></html></div>
<pre><code>## $x
## [1] "x values"
## 
## $y
## [1] "f(x)"
## 
## $title
## [1] "evaluate non-linear functions to search for roots"
## 
## $caption
## [1] "evaluating the function"
## 
## attr(,"class")
## [1] "labels"</code></pre>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">lineplot</span>)</pre></body></html></div>
<p><img src="ffv_opt_solog_bisec_allrw_files/figure-html/graph%20many%20evaluations-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="dplyr-implementation-of-bisection" class="section level2">
<h2 class="hasAnchor">
<a href="#dplyr-implementation-of-bisection" class="anchor"></a>dplyr implementation of bisection</h2>
<div id="initialize-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#initialize-matrix" class="anchor"></a>initialize matrix</h3>
<p>first, initialize the matrix with <span class="math inline">\(a_0\)</span> and <span class="math inline">\(b_0\)</span>, the initial min and max points:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># common prefix to make reshaping easier</span>
<span class="no">st_bisec_prefix</span> <span class="kw">&lt;-</span> <span class="st">'bisec_'</span>
<span class="no">svr_a_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'a_0'</span>)
<span class="no">svr_b_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'b_0'</span>)
<span class="no">svr_fa_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'fa_0'</span>)
<span class="no">svr_fb_lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'fb_0'</span>)

<span class="co"># add initial a and b</span>
<span class="no">tb_states_choices_bisec</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices</span> <span class="kw">%&gt;%</span>
                            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_a_lst</span>) <span class="kw">:=</span> <span class="no">fl_n_min</span>, !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_b_lst</span>) <span class="kw">:=</span> <span class="no">fl_n_agg</span>)

<span class="co"># evaluate function f(a_0) and f(b_0)</span>
<span class="no">tb_states_choices_bisec</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_bisec</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span>() <span class="kw">%&gt;%</span>
                            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_fa_lst</span>) <span class="kw">:=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(<span class="no">fl_a</span>, <span class="no">fl_alpha</span>, !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_a_lst</span>),
                                                                          <span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>,
                                                                          <span class="no">fl_n_agg</span>, <span class="no">fl_rho</span>),
                                   !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_fb_lst</span>) <span class="kw">:=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(<span class="no">fl_a</span>, <span class="no">fl_alpha</span>, !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_b_lst</span>),
                                                                          <span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>,
                                                                          <span class="no">fl_n_agg</span>, <span class="no">fl_rho</span>))
<span class="co"># summarize</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">tb_states_choices_bisec</span>)</pre></body></html></div>
<pre><code>## [1] 1043    7</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tb_states_choices_bisec</span>)</pre></body></html></div>
<pre><code>##     indi_id            fl_a          fl_alpha          bisec_a_0   bisec_b_0  
##  Min.   :   1.0   Min.   :4.287   Min.   :0.006687   Min.   :0   Min.   :100  
##  1st Qu.: 261.5   1st Qu.:4.334   1st Qu.:0.006687   1st Qu.:0   1st Qu.:100  
##  Median : 522.0   Median :4.343   Median :0.012090   Median :0   Median :100  
##  Mean   : 522.0   Mean   :4.343   Mean   :0.010321   Mean   :0   Mean   :100  
##  3rd Qu.: 782.5   3rd Qu.:4.351   3rd Qu.:0.012090   3rd Qu.:0   3rd Qu.:100  
##  Max.   :1043.0   Max.   :4.417   Max.   :0.013940   Max.   :0   Max.   :100  
##    bisec_fa_0    bisec_fb_0     
##  Min.   :100   Min.   :-163379  
##  1st Qu.:100   1st Qu.:-161838  
##  Median :100   Median : -89227  
##  Mean   :100   Mean   :-114259  
##  3rd Qu.:100   3rd Qu.: -88801  
##  Max.   :100   Max.   : -76145</code></pre>
</div>
<div id="iterate-and-solve-for-fp-update-fa-and-fb" class="section level3">
<h3 class="hasAnchor">
<a href="#iterate-and-solve-for-fp-update-fa-and-fb" class="anchor"></a>iterate and solve for f(p), update f(a) and f(b)</h3>
<p>implement the dplyr based concurrent bisection algorithm.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># fl_tol = float tolerance criteria</span>
<span class="co"># it_tol = number of interations to allow at most</span>
<span class="no">fl_tol</span> <span class="kw">&lt;-</span> <span class="fl">10</span>^-<span class="fl">6</span>
<span class="no">it_tol</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="co"># fl_p_dist2zr = distance to zero to initalize</span>
<span class="no">fl_p_dist2zr</span> <span class="kw">&lt;-</span> <span class="fl">1000</span>
<span class="no">it_cur</span> <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="kw">while</span> (<span class="no">it_cur</span> <span class="kw">&lt;=</span> <span class="no">it_tol</span> <span class="kw">&amp;&amp;</span> <span class="no">fl_p_dist2zr</span> <span class="kw">&gt;=</span> <span class="no">fl_tol</span> ) {

  <span class="no">it_cur</span> <span class="kw">&lt;-</span> <span class="no">it_cur</span> + <span class="fl">1</span>

  <span class="co"># new variables</span>
  <span class="no">svr_a_cur</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'a_'</span>, <span class="no">it_cur</span>)
  <span class="no">svr_b_cur</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'b_'</span>, <span class="no">it_cur</span>)
  <span class="no">svr_fa_cur</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'fa_'</span>, <span class="no">it_cur</span>)
  <span class="no">svr_fb_cur</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">'fb_'</span>, <span class="no">it_cur</span>)

  <span class="co"># evaluate function f(a_0) and f(b_0)</span>
  <span class="co"># 1. generate p</span>
  <span class="co"># 2. generate f_p</span>
  <span class="co"># 3. generate f_p*f_a</span>
  <span class="no">tb_states_choices_bisec</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_bisec</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html">rowwise</a></span>() <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">p</span> <span class="kw">=</span> ((!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_a_lst</span>) + !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_b_lst</span>))/<span class="fl">2</span>)) <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">f_p</span> <span class="kw">=</span> <span class="fu">ffi_nonlin_dplyrdo</span>(<span class="no">fl_a</span>, <span class="no">fl_alpha</span>, <span class="no">p</span>,
                                                              <span class="no">ar_nn_a</span>, <span class="no">ar_nn_alpha</span>,
                                                              <span class="no">fl_n_agg</span>, <span class="no">fl_rho</span>)) <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">f_p_t_f_a</span> <span class="kw">=</span> <span class="no">f_p</span>*!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_fa_lst</span>))
  <span class="co"># fl_p_dist2zr = sum(abs(p))</span>
  <span class="no">fl_p_dist2zr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">tb_states_choices_bisec</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">f_p</span>)))

  <span class="co"># update a and b</span>
  <span class="no">tb_states_choices_bisec</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_bisec</span> <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_a_cur</span>) <span class="kw">:=</span>
                                       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">f_p_t_f_a</span> <span class="kw">&lt;</span> <span class="fl">0</span> ~ !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_a_lst</span>),
                                                 <span class="fl">TRUE</span> ~ <span class="no">p</span>)) <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_b_cur</span>) <span class="kw">:=</span>
                                       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">f_p_t_f_a</span> <span class="kw">&lt;</span> <span class="fl">0</span> ~ <span class="no">p</span>,
                                                 <span class="fl">TRUE</span> ~ !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_b_lst</span>)))
  <span class="co"># update f(a) and f(b)</span>
  <span class="no">tb_states_choices_bisec</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_bisec</span> <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_fa_cur</span>) <span class="kw">:=</span>
                                       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">f_p_t_f_a</span> <span class="kw">&lt;</span> <span class="fl">0</span> ~ !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_fa_lst</span>),
                                                 <span class="fl">TRUE</span> ~ <span class="no">f_p</span>)) <span class="kw">%&gt;%</span>
                              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_fb_cur</span>) <span class="kw">:=</span>
                                       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">f_p_t_f_a</span> <span class="kw">&lt;</span> <span class="fl">0</span> ~ <span class="no">f_p</span>,
                                                 <span class="fl">TRUE</span> ~ !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_fb_lst</span>)))
  <span class="co"># save from last</span>
  <span class="no">svr_a_lst</span> <span class="kw">&lt;-</span> <span class="no">svr_a_cur</span>
  <span class="no">svr_b_lst</span> <span class="kw">&lt;-</span> <span class="no">svr_b_cur</span>
  <span class="no">svr_fa_lst</span> <span class="kw">&lt;-</span> <span class="no">svr_fa_cur</span>
  <span class="no">svr_fb_lst</span> <span class="kw">&lt;-</span> <span class="no">svr_fb_cur</span>

  <span class="co"># summar current round</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'it_cur:'</span>, <span class="no">it_cur</span>, <span class="st">', fl_p_dist2zr:'</span>, <span class="no">fl_p_dist2zr</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tb_states_choices_bisec</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="no">svr_a_cur</span>, <span class="no">svr_b_cur</span>, <span class="no">svr_fa_cur</span>, <span class="no">svr_fb_cur</span>)))
}</pre></body></html></div>
<pre><code>## [1] "it_cur:1, fl_p_dist2zr:57065.8515924507"
## [1] "it_cur:2, fl_p_dist2zr:28476.0859665553"
## [1] "it_cur:3, fl_p_dist2zr:14184.6282193769"
## [1] "it_cur:4, fl_p_dist2zr:7040.60930196585"
## [1] "it_cur:5, fl_p_dist2zr:3469.45353361675"
## [1] "it_cur:6, fl_p_dist2zr:1684.30185106396"
## [1] "it_cur:7, fl_p_dist2zr:791.938788974897"
## [1] "it_cur:8, fl_p_dist2zr:345.863486789484"
## [1] "it_cur:9, fl_p_dist2zr:122.878869797614"
## [1] "it_cur:10, fl_p_dist2zr:30.3977559686063"
## [1] "it_cur:11, fl_p_dist2zr:25.3181374761203"
## [1] "it_cur:12, fl_p_dist2zr:12.0886419051021"
## [1] "it_cur:13, fl_p_dist2zr:2.06815551406747"
## [1] "it_cur:14, fl_p_dist2zr:4.89604753960856"
## [1] "it_cur:15, fl_p_dist2zr:1.93331480031098"
## [1] "it_cur:16, fl_p_dist2zr:0.614579561133518"
## [1] "it_cur:17, fl_p_dist2zr:0.314081026590978"
## [1] "it_cur:18, fl_p_dist2zr:0.207595932727363"
## [1] "it_cur:19, fl_p_dist2zr:0.112869498156886"
## [1] "it_cur:20, fl_p_dist2zr:0.0559799114586833"
## [1] "it_cur:21, fl_p_dist2zr:0.027032944900061"
## [1] "it_cur:22, fl_p_dist2zr:0.0132672918026609"
## [1] "it_cur:23, fl_p_dist2zr:0.00680454432702988"
## [1] "it_cur:24, fl_p_dist2zr:0.00333360097714742"
## [1] "it_cur:25, fl_p_dist2zr:0.00168437455159884"
## [1] "it_cur:26, fl_p_dist2zr:0.000848467303071653"
## [1] "it_cur:27, fl_p_dist2zr:0.000427696340068737"
## [1] "it_cur:28, fl_p_dist2zr:0.000218673312373287"
## [1] "it_cur:29, fl_p_dist2zr:0.000108180725121156"
## [1] "it_cur:30, fl_p_dist2zr:5.24326238874592e-05"
## [1] "it_cur:31, fl_p_dist2zr:2.67010139017832e-05"
## [1] "it_cur:32, fl_p_dist2zr:1.33128324107031e-05"
## [1] "it_cur:33, fl_p_dist2zr:6.65284808581866e-06"
## [1] "it_cur:34, fl_p_dist2zr:3.34008954068542e-06"
## [1] "it_cur:35, fl_p_dist2zr:1.65812727955474e-06"
## [1] "it_cur:36, fl_p_dist2zr:8.52063209322296e-07"</code></pre>
</div>
<div id="reshape-wide-to-long-to-wide" class="section level3">
<h3 class="hasAnchor">
<a href="#reshape-wide-to-long-to-wide" class="anchor"></a>Reshape wide to long to wide</h3>
<div id="table-onevery-wide" class="section level4">
<h4 class="hasAnchor">
<a href="#table-onevery-wide" class="anchor"></a>Table Oneâ€“very wide</h4>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb_states_choices_bisec</span>, <span class="fl">10</span>)</pre></body></html></div>
<pre><code>## # A tibble: 10 x 154
## # Rowwise: 
##    indi_id  fl_a fl_alpha bisec_a_0 bisec_b_0 bisec_fa_0 bisec_fb_0      p
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1       1  4.34  0.00669         0       100        100   -161823. 0.0622
##  2       2  4.36  0.00925         0       100        100   -116164. 0.0862
##  3       3  4.35  0.00925         0       100        100   -116436. 0.0860
##  4       4  4.37  0.0139          0       100        100    -76535. 0.130 
##  5       5  4.34  0.00669         0       100        100   -162038. 0.0621
##  6       6  4.36  0.0139          0       100        100    -76706. 0.130 
##  7       7  4.34  0.00669         0       100        100   -162025. 0.0621
##  8       8  4.34  0.00669         0       100        100   -161980. 0.0621
##  9       9  4.36  0.0139          0       100        100    -76632. 0.130 
## 10      10  4.33  0.0121          0       100        100    -89034. 0.112 
## # ... with 146 more variables: f_p &lt;dbl&gt;, f_p_t_f_a &lt;dbl&gt;, bisec_a_1 &lt;dbl&gt;,
## #   bisec_b_1 &lt;dbl&gt;, bisec_fa_1 &lt;dbl&gt;, bisec_fb_1 &lt;dbl&gt;, bisec_a_2 &lt;dbl&gt;,
## #   bisec_b_2 &lt;dbl&gt;, bisec_fa_2 &lt;dbl&gt;, bisec_fb_2 &lt;dbl&gt;, bisec_a_3 &lt;dbl&gt;,
## #   bisec_b_3 &lt;dbl&gt;, bisec_fa_3 &lt;dbl&gt;, bisec_fb_3 &lt;dbl&gt;, bisec_a_4 &lt;dbl&gt;,
## #   bisec_b_4 &lt;dbl&gt;, bisec_fa_4 &lt;dbl&gt;, bisec_fb_4 &lt;dbl&gt;, bisec_a_5 &lt;dbl&gt;,
## #   bisec_b_5 &lt;dbl&gt;, bisec_fa_5 &lt;dbl&gt;, bisec_fb_5 &lt;dbl&gt;, bisec_a_6 &lt;dbl&gt;,
## #   bisec_b_6 &lt;dbl&gt;, bisec_fa_6 &lt;dbl&gt;, bisec_fb_6 &lt;dbl&gt;, bisec_a_7 &lt;dbl&gt;,
## #   bisec_b_7 &lt;dbl&gt;, bisec_fa_7 &lt;dbl&gt;, bisec_fb_7 &lt;dbl&gt;, bisec_a_8 &lt;dbl&gt;,
## #   bisec_b_8 &lt;dbl&gt;, bisec_fa_8 &lt;dbl&gt;, bisec_fb_8 &lt;dbl&gt;, bisec_a_9 &lt;dbl&gt;,
## #   bisec_b_9 &lt;dbl&gt;, bisec_fa_9 &lt;dbl&gt;, bisec_fb_9 &lt;dbl&gt;, bisec_a_10 &lt;dbl&gt;,
## #   bisec_b_10 &lt;dbl&gt;, bisec_fa_10 &lt;dbl&gt;, bisec_fb_10 &lt;dbl&gt;, bisec_a_11 &lt;dbl&gt;,
## #   bisec_b_11 &lt;dbl&gt;, bisec_fa_11 &lt;dbl&gt;, bisec_fb_11 &lt;dbl&gt;, bisec_a_12 &lt;dbl&gt;,
## #   bisec_b_12 &lt;dbl&gt;, bisec_fa_12 &lt;dbl&gt;, bisec_fb_12 &lt;dbl&gt;, bisec_a_13 &lt;dbl&gt;,
## #   bisec_b_13 &lt;dbl&gt;, bisec_fa_13 &lt;dbl&gt;, bisec_fb_13 &lt;dbl&gt;, bisec_a_14 &lt;dbl&gt;,
## #   bisec_b_14 &lt;dbl&gt;, bisec_fa_14 &lt;dbl&gt;, bisec_fb_14 &lt;dbl&gt;, bisec_a_15 &lt;dbl&gt;,
## #   bisec_b_15 &lt;dbl&gt;, bisec_fa_15 &lt;dbl&gt;, bisec_fb_15 &lt;dbl&gt;, bisec_a_16 &lt;dbl&gt;,
## #   bisec_b_16 &lt;dbl&gt;, bisec_fa_16 &lt;dbl&gt;, bisec_fb_16 &lt;dbl&gt;, bisec_a_17 &lt;dbl&gt;,
## #   bisec_b_17 &lt;dbl&gt;, bisec_fa_17 &lt;dbl&gt;, bisec_fb_17 &lt;dbl&gt;, bisec_a_18 &lt;dbl&gt;,
## #   bisec_b_18 &lt;dbl&gt;, bisec_fa_18 &lt;dbl&gt;, bisec_fb_18 &lt;dbl&gt;, bisec_a_19 &lt;dbl&gt;,
## #   bisec_b_19 &lt;dbl&gt;, bisec_fa_19 &lt;dbl&gt;, bisec_fb_19 &lt;dbl&gt;, bisec_a_20 &lt;dbl&gt;,
## #   bisec_b_20 &lt;dbl&gt;, bisec_fa_20 &lt;dbl&gt;, bisec_fb_20 &lt;dbl&gt;, bisec_a_21 &lt;dbl&gt;,
## #   bisec_b_21 &lt;dbl&gt;, bisec_fa_21 &lt;dbl&gt;, bisec_fb_21 &lt;dbl&gt;, bisec_a_22 &lt;dbl&gt;,
## #   bisec_b_22 &lt;dbl&gt;, bisec_fa_22 &lt;dbl&gt;, bisec_fb_22 &lt;dbl&gt;, bisec_a_23 &lt;dbl&gt;,
## #   bisec_b_23 &lt;dbl&gt;, bisec_fa_23 &lt;dbl&gt;, bisec_fb_23 &lt;dbl&gt;, bisec_a_24 &lt;dbl&gt;,
## #   bisec_b_24 &lt;dbl&gt;, bisec_fa_24 &lt;dbl&gt;, bisec_fb_24 &lt;dbl&gt;, bisec_a_25 &lt;dbl&gt;,
## #   bisec_b_25 &lt;dbl&gt;, ...</code></pre>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'input allocated total sum: '</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">tb_states_choices_bisec</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">p</span>))))</pre></body></html></div>
<pre><code>## [1] "input allocated total sum: 100.000000033469"</code></pre>
</div>
<div id="table-twovery-wide-to-very-long" class="section level4">
<h4 class="hasAnchor">
<a href="#table-twovery-wide-to-very-long" class="anchor"></a>Table Twoâ€“very wide to very long</h4>
<p>we want to treat the iteration count information that is the suffix of variable names as a variable by itself. additionally, we want to treat the a,b,fa,fb as a variable. structuring the data very long like this allows for easy graphing and other types of analysis. rather than dealing with many many variables, we have only 3 core variables that store bisection iteration information.</p>
<p>here we use the very nice <em>pivot_longer</em> function. note that to achieve this, we put a common prefix in front of the variables we wanted to convert to long. this is helpful, because we can easily identify which variables need to be reshaped.</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="co"># new variables</span>
<span class="no">svr_bisect_iter</span> <span class="kw">&lt;-</span> <span class="st">'biseciter'</span>
<span class="no">svr_abfafb_long_name</span> <span class="kw">&lt;-</span> <span class="st">'varname'</span>
<span class="no">svr_number_col</span> <span class="kw">&lt;-</span> <span class="st">'value'</span>
<span class="no">svr_id_bisect_iter</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">svr_id_var</span>, <span class="st">'_bisect_ier'</span>)

<span class="co"># pivot wide to very long</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="no">tb_states_choices_bisec_long</span> <span class="kw">&lt;-</span>
  <span class="no">tb_states_choices_bisec</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">tb_states_choices_bisec</span>)[<span class="fl">1</span>], <span class="fl">9</span>, <span class="kw">replace</span><span class="kw">=</span><span class="fl">FALSE</span>),] <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(
    <span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">starts_with</a></span>(<span class="no">st_bisec_prefix</span>),
    <span class="kw">names_to</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">svr_abfafb_long_name</span>, <span class="no">svr_bisect_iter</span>),
    <span class="kw">names_pattern</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">st_bisec_prefix</span>, <span class="st">"(.*)_(.*)"</span>),
    <span class="kw">values_to</span> <span class="kw">=</span> <span class="no">svr_number_col</span>
  )

<span class="co"># print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tb_states_choices_bisec_long</span>)</pre></body></html></div>
<pre><code>##     indi_id           fl_a          fl_alpha              p          
##  Min.   :179.0   Min.   :4.330   Min.   :0.006687   Min.   :0.06205  
##  1st Qu.:415.0   1st Qu.:4.333   1st Qu.:0.009251   1st Qu.:0.08607  
##  Median :526.0   Median :4.350   Median :0.012090   Median :0.11231  
##  Mean   :521.3   Mean   :4.346   Mean   :0.011396   Mean   :0.10591  
##  3rd Qu.:665.0   3rd Qu.:4.356   3rd Qu.:0.013940   3rd Qu.:0.12969  
##  Max.   :938.0   Max.   :4.361   Max.   :0.013940   Max.   :0.12983  
##       f_p               f_p_t_f_a            varname         
##  Min.   :-1.383e-06   Min.   :-1.334e-12   Length:1332       
##  1st Qu.:-8.178e-07   1st Qu.:-4.099e-13   Class :character  
##  Median :-1.467e-07   Median :-1.525e-13   Mode  :character  
##  Mean   :-3.205e-07   Mean   : 1.368e-13                     
##  3rd Qu.: 1.672e-07   3rd Qu.: 2.153e-13                     
##  Max.   : 1.022e-06   Max.   : 3.444e-12                     
##   biseciter             value           
##  Length:1332        Min.   :-162130.75  
##  Class :character   1st Qu.:      0.00  
##  Mode  :character   Median :      0.06  
##                     Mean   :  -1374.64  
##                     3rd Qu.:      0.13  
##                     Max.   :    100.00</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb_states_choices_bisec_long</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="fl">30</span>)</pre></body></html></div>
<pre><code>## # A tibble: 30 x 6
##    indi_id  fl_a fl_alpha varname biseciter    value
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;
##  1     415  4.33  0.00669 a       0               0 
##  2     415  4.33  0.00669 b       0             100 
##  3     415  4.33  0.00669 fa      0             100 
##  4     415  4.33  0.00669 fb      0         -162131.
##  5     415  4.33  0.00669 a       1               0 
##  6     415  4.33  0.00669 b       1              50 
##  7     415  4.33  0.00669 fa      1             100 
##  8     415  4.33  0.00669 fb      1          -80965.
##  9     415  4.33  0.00669 a       2               0 
## 10     415  4.33  0.00669 b       2              25 
## # ... with 20 more rows</code></pre>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">tb_states_choices_bisec_long</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="fl">30</span>)</pre></body></html></div>
<pre><code>## # A tibble: 30 x 6
##    indi_id  fl_a fl_alpha varname biseciter      value
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
##  1     709  4.33   0.0121 fa      29         0.0000610
##  2     709  4.33   0.0121 fb      29        -0.000105 
##  3     709  4.33   0.0121 a       30         0.112    
##  4     709  4.33   0.0121 b       30         0.112    
##  5     709  4.33   0.0121 fa      30         0.0000610
##  6     709  4.33   0.0121 fb      30        -0.0000222
##  7     709  4.33   0.0121 a       31         0.112    
##  8     709  4.33   0.0121 b       31         0.112    
##  9     709  4.33   0.0121 fa      31         0.0000194
## 10     709  4.33   0.0121 fb      31        -0.0000222
## # ... with 20 more rows</code></pre>
</div>
<div id="table-twovery-very-long-to-wider-again" class="section level4">
<h4 class="hasAnchor">
<a href="#table-twovery-very-long-to-wider-again" class="anchor"></a>Table Twoâ€“very very long to wider again</h4>
<p>but the previous results are too long, with the a, b, fa, and fb all in one column as different categories, they are really not different categories, they are in fact different types of variables. so we want to spread those four categories of this variable into four columns, each one representing the a, b, fa, and fb values. the rows would then be uniquly identified by the iteration counter and individual id.</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="co"># pivot wide to very long to a little wide</span>
<span class="no">tb_states_choices_bisec_wider</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_bisec_long</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span>(
    <span class="kw">names_from</span> <span class="kw">=</span> !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_abfafb_long_name</span>),
    <span class="kw">values_from</span> <span class="kw">=</span> <span class="no">svr_number_col</span>
  )</pre></body></html></div>
<pre><code>## Note: Using an external vector in selections is ambiguous.
## i Use `all_of(svr_number_col)` instead of `svr_number_col` to silence this message.
## i See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.
## This message is displayed once per session.</code></pre>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="co"># print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tb_states_choices_bisec_wider</span>)</pre></body></html></div>
<pre><code>##     indi_id           fl_a          fl_alpha              p          
##  Min.   :179.0   Min.   :4.330   Min.   :0.006687   Min.   :0.06205  
##  1st Qu.:415.0   1st Qu.:4.333   1st Qu.:0.009251   1st Qu.:0.08607  
##  Median :526.0   Median :4.350   Median :0.012090   Median :0.11231  
##  Mean   :521.3   Mean   :4.346   Mean   :0.011396   Mean   :0.10591  
##  3rd Qu.:665.0   3rd Qu.:4.356   3rd Qu.:0.013940   3rd Qu.:0.12969  
##  Max.   :938.0   Max.   :4.361   Max.   :0.013940   Max.   :0.12983  
##       f_p               f_p_t_f_a           biseciter               a          
##  Min.   :-1.383e-06   Min.   :-1.334e-12   Length:333         Min.   :0.00000  
##  1st Qu.:-8.178e-07   1st Qu.:-4.099e-13   Class :character   1st Qu.:0.00000  
##  Median :-1.467e-07   Median :-1.525e-13   Mode  :character   Median :0.08607  
##  Mean   :-3.205e-07   Mean   : 1.368e-13                      Mean   :0.07498  
##  3rd Qu.: 1.672e-07   3rd Qu.: 2.153e-13                      3rd Qu.:0.12817  
##  Max.   : 1.022e-06   Max.   : 3.444e-12                      Max.   :0.12983  
##        b                   fa                  fb            
##  Min.   :  0.06205   Min.   :  0.00000   Min.   :-162130.75  
##  1st Qu.:  0.11195   1st Qu.:  0.00033   1st Qu.:   -126.98  
##  Median :  0.12969   Median :  0.15876   Median :     -0.09  
##  Mean   :  5.48039   Mean   : 29.47787   Mean   :  -5533.61  
##  3rd Qu.:  0.19531   3rd Qu.:100.00000   3rd Qu.:      0.00  
##  Max.   :100.00000   Max.   :100.00000   Max.   :      0.00</code></pre>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb_states_choices_bisec_wider</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="fl">30</span>)</pre></body></html></div>
<pre><code>## # A tibble: 30 x 8
##    indi_id  fl_a fl_alpha biseciter     a       b    fa       fb
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1     415  4.33  0.00669 0             0 100       100 -162131.
##  2     415  4.33  0.00669 1             0  50       100  -80965.
##  3     415  4.33  0.00669 2             0  25       100  -40407.
##  4     415  4.33  0.00669 3             0  12.5     100  -20141.
##  5     415  4.33  0.00669 4             0   6.25    100  -10014.
##  6     415  4.33  0.00669 5             0   3.12    100   -4954.
##  7     415  4.33  0.00669 6             0   1.56    100   -2425.
##  8     415  4.33  0.00669 7             0   0.781   100   -1162.
##  9     415  4.33  0.00669 8             0   0.391   100    -531.
## 10     415  4.33  0.00669 9             0   0.195   100    -215.
## # ... with 20 more rows</code></pre>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">tb_states_choices_bisec_wider</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="st">'p'</span>,<span class="st">'f_p'</span>,<span class="st">'f_p_t_f_a'</span>)), <span class="fl">30</span>)</pre></body></html></div>
<pre><code>## # A tibble: 30 x 8
##    indi_id  fl_a fl_alpha biseciter      a     b      fa       fb
##      &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1     709  4.33   0.0121 7         0      0.781 100     -598.   
##  2     709  4.33   0.0121 8         0      0.391 100     -249.   
##  3     709  4.33   0.0121 9         0      0.195 100      -74.4  
##  4     709  4.33   0.0121 10        0.0977 0.195  12.8    -74.4  
##  5     709  4.33   0.0121 11        0.0977 0.146  12.8    -30.8  
##  6     709  4.33   0.0121 12        0.0977 0.122  12.8     -9.04 
##  7     709  4.33   0.0121 13        0.110  0.122   1.86    -9.04 
##  8     709  4.33   0.0121 14        0.110  0.116   1.86    -3.59 
##  9     709  4.33   0.0121 15        0.110  0.113   1.86    -0.863
## 10     709  4.33   0.0121 16        0.111  0.113   0.499   -0.863
## # ... with 20 more rows</code></pre>
</div>
</div>
<div id="graph-bisection-iteration-results" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-bisection-iteration-results" class="anchor"></a>Graph Bisection Iteration results</h3>
<p>actually we want to graph based on the long results, not the wider. wider easier to view in table.</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="co"># graph results</span>
<span class="no">lineplot</span> <span class="kw">&lt;-</span> <span class="no">tb_states_choices_bisec_long</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_bisect_iter</span>) <span class="kw">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_bisect_iter</span>))) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_abfafb_long_name</span>) <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'a'</span>, <span class="st">'b'</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span>!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_bisect_iter</span>), <span class="kw">y</span><span class="kw">=</span>!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_number_col</span>),
               <span class="kw">colour</span><span class="kw">=</span>!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_abfafb_long_name</span>),
               <span class="kw">linetype</span><span class="kw">=</span>!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_abfafb_long_name</span>),
               <span class="kw">shape</span><span class="kw">=</span>!!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_abfafb_long_name</span>))) +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>( ~ <span class="no">indi_id</span>) +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">'bisection iteration over individuals until convergence'</span>,
             <span class="kw">x</span> <span class="kw">=</span> <span class="st">'bisection iteration'</span>,
             <span class="kw">y</span> <span class="kw">=</span> <span class="st">'a (left side point) and b (right side point) values'</span>,
             <span class="kw">caption</span> <span class="kw">=</span> <span class="st">'dplyr concurrent bisection nonlinear multple individuals'</span>) +
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> <span class="fl">90</span>, <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">lineplot</span>)</pre></body></html></div>
<p><img src="ffv_opt_solog_bisec_allrw_files/figure-html/reshape%20solution%20for%20graphing-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://fanwangecon.github.io">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
