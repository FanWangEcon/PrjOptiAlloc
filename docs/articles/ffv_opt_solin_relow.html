<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Line by Line Test Bounded-Continuous Function with Height Nutrition Data â€¢ Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Line by Line Test Bounded-Continuous Function with Height Nutrition Data">
<meta property="og:description" content="Given allocation space parameters (A, alpha), test the lower-bounded continuous optimal allocation line by line without function.
This demonstrates relative optimality conditions, inverse optimal allocation, and optimal allocation.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/PrjOptiAlloc.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue.pdf">Paper</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue_Present.pdf">Slides</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/">Python Examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://fanwangecon.github.io/">Fan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ffv_opt_solin_relow_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Line by Line Test Bounded-Continuous Function with Height Nutrition Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/master/vignettes/ffv_opt_solin_relow.Rmd"><code>vignettes/ffv_opt_solin_relow.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_solin_relow.Rmd</code></div>

    </div>

    
    
<p>Given allocation space parameters (A, alpha), test the lower-bounded continuous optimal allocation line by line without function. This demonstrates relative optimality conditions, inverse optimal allocation, and optimal allocation.</p>
<p>Solves the linear optimal allocation problem. Each individual receives input <span class="math inline">\(N_i\)</span>, and we are interested in individual expected outcomes <span class="math inline">\(H_i\)</span>. Production functions or reduced causal form relationships are linear with individual specific slopes and intercepts. Solve for different planners.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="kw">all.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">knitr.duplicate.label</span> <span class="kw">=</span> <span class="st">'allow'</span>)</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">REconTools</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">PrjOptiAlloc</span>)

<span class="no">bl_save_rda</span> <span class="kw">=</span> <span class="fl">FALSE</span></pre></body></html></div>
<div id="load-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load Data</h2>
<p>Load data that is generated by regression <a href="https://fanwangecon.github.io/PrjOptiAlloc/reference/ffy_opt_dtgch_cbem4.html">ffy_opt_dtgch_cbem4</a> (<a href="https://fanwangecon.github.io/PrjOptiAlloc/articles/ffv_opt_dtgch_cbem4.html">vignette</a>).</p>
<p>Alternatively, provide hand input data.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">bl_save_rda</span> <span class="kw">=</span> <span class="fl">FALSE</span>

<span class="no">it_data_which</span> <span class="kw">=</span> <span class="fl">2</span>

<span class="kw">if</span> (<span class="no">it_data_which</span> <span class="kw">==</span> <span class="fl">1</span>) {
  <span class="co"># the data here has very little heterogeneity in alpha</span>
  <span class="co"># Load Library</span>
  <span class="no">ls_opti_alpha_A</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ffy_opt_dtgch_cbem4.html">ffy_opt_dtgch_cbem4</a></span>()
  <span class="no">df_raw</span> <span class="kw">&lt;-</span> <span class="no">ls_opti_alpha_A</span>$<span class="no">df_raw</span>
  <span class="no">df_hw_cebu_m24</span> <span class="kw">&lt;-</span> <span class="no">df_raw</span>
  <span class="no">df_esti</span> <span class="kw">&lt;-</span> <span class="no">ls_opti_alpha_A</span>$<span class="no">df_esti</span>

  <span class="co"># Review dataframes</span>
  <span class="co"># raw file</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df_raw</span>, <span class="fl">10</span>)
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df_esti</span>, <span class="fl">10</span>)
  <span class="no">ar_prot_data</span> <span class="kw">=</span> <span class="no">df_hw_cebu_m24</span>$<span class="no">prot</span>
  <span class="no">fl_N_agg</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">ar_prot_data</span>)

  <span class="co"># Attach</span>
  <span class="fu"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(<span class="no">df_raw</span>)
}

<span class="kw">if</span> (<span class="no">it_data_which</span> <span class="kw">==</span> <span class="fl">2</span>) {
  <span class="co"># generate 50 individuals with arbitrary A, alpha and beta</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
  <span class="no">it_N</span> <span class="kw">&lt;-</span> <span class="fl">50</span>
  <span class="no">ar_alpha</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">it_N</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">1</span>)
  <span class="no">ar_A</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">it_N</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">2</span>)
  <span class="no">ar_beta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">it_N</span>, <span class="kw">min</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">1</span>)
  <span class="no">ar_beta</span> <span class="kw">&lt;-</span> <span class="no">ar_beta</span>/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">ar_beta</span>)

  <span class="no">mt_cts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="no">it_N</span>), <span class="no">ar_A</span>, <span class="no">ar_alpha</span>, <span class="no">ar_beta</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_cts</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'indi.id'</span>, <span class="st">'A_lin'</span>, <span class="st">'alpha_lin'</span>, <span class="st">'beta'</span>)
  <span class="no">df_esti</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">mt_cts</span>)
  <span class="no">fl_N_agg</span> <span class="kw">&lt;-</span> <span class="fl">10</span>*<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">ar_alpha</span>)
}</pre></body></html></div>
</div>
<div id="solve" class="section level2">
<h2 class="hasAnchor">
<a href="#solve" class="anchor"></a>Solve</h2>
<p>I would like to be able to directly call the dataset generated here in various functions. Save the datafile we just created in the project folder.</p>
<div id="prep-inputs" class="section level3">
<h3 class="hasAnchor">
<a href="#prep-inputs" class="anchor"></a>Prep Inputs</h3>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">df_esti</span>
<span class="no">svr_A_i</span> <span class="kw">&lt;-</span> <span class="st">'A_lin'</span>
<span class="no">svr_alpha_i</span> <span class="kw">&lt;-</span> <span class="st">'alpha_lin'</span>
<span class="no">svr_beta_i</span> <span class="kw">&lt;-</span> <span class="st">'beta'</span>
<span class="no">fl_N_agg</span> <span class="kw">&lt;-</span> <span class="no">fl_N_agg</span>
<span class="no">fl_rho</span> <span class="kw">&lt;-</span> -<span class="fl">10</span></pre></body></html></div>
</div>
<div id="relative-allocations" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-allocations" class="anchor"></a>Relative Allocations</h3>
<div id="rank" class="section level4">
<h4 class="hasAnchor">
<a href="#rank" class="anchor"></a>Rank</h4>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># a. select only relevant data</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span>(<span class="kw">A</span> <span class="kw">=</span> !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_A_i</span>), <span class="kw">alpha</span> <span class="kw">=</span> !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_alpha_i</span>), <span class="kw">beta</span> <span class="kw">=</span> !!<span class="fu"><a href="https://dplyr.tidyverse.org/reference/tidyeval-compat.html">sym</a></span>(<span class="no">svr_beta_i</span>))

<span class="co"># b. Generate V4, Rank Index Value, rho specific</span>
<span class="co"># df_opti &lt;- df_opti %&gt;% mutate(!!paste0('rv_', it_rho_ctr) := A/((alpha*beta))^(1/(1-fl_rho)))</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rank_val</span> <span class="kw">=</span> <span class="no">A</span>/((<span class="no">alpha</span>*<span class="no">beta</span>))^(<span class="fl">1</span>/(<span class="fl">1</span>-<span class="no">fl_rho</span>)))

<span class="co"># c. Generate Rank Index based on y-intercept</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">rank_val</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rank_y_inter_idx</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>())

<span class="co"># d. Populate lowest index alpha, beta, and A to all rows</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">lowest_rank_A</span> <span class="kw">=</span> <span class="no">A</span>[<span class="no">rank_y_inter_idx</span><span class="kw">==</span><span class="fl">1</span>]) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">lowest_rank_alpha</span> <span class="kw">=</span> <span class="no">alpha</span>[<span class="no">rank_y_inter_idx</span><span class="kw">==</span><span class="fl">1</span>]) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">lowest_rank_beta</span> <span class="kw">=</span> <span class="no">beta</span>[<span class="no">rank_y_inter_idx</span><span class="kw">==</span><span class="fl">1</span>])

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df_opti</span>, <span class="fl">10</span>)</pre></body></html></div>
<pre><code>## # A tibble: 10 x 9
##    indi.id     A alpha    beta rank_val rank_y_inter_idx lowest_rank_A
##      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;            &lt;int&gt;         &lt;dbl&gt;
##  1       4  1.12 0.895 0.0370      1.53                1          1.12
##  2      24  1.00 0.995 0.00853     1.54                2          1.12
##  3       7  1.13 0.575 0.0355      1.61                3          1.12
##  4       1  1.05 0.359 0.0233      1.62                4          1.12
##  5      26  1.22 0.738 0.0382      1.69                5          1.12
##  6      12  1.09 0.508 0.0117      1.74                6          1.12
##  7      31  1.24 0.967 0.0240      1.75                7          1.12
##  8      30  1.11 0.232 0.0268      1.76                8          1.12
##  9      14  1.27 0.615 0.0368      1.80                9          1.12
## 10      40  1.18 0.308 0.0171      1.89               10          1.12
## # ... with 2 more variables: lowest_rank_alpha &lt;dbl&gt;, lowest_rank_beta &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span>)</pre></body></html></div>
<pre><code>##     indi.id            A             alpha             beta          
##  Min.   : 1.00   Min.   :1.001   Min.   :0.1222   Min.   :0.0004062  
##  1st Qu.:13.25   1st Qu.:1.226   1st Qu.:0.3442   1st Qu.:0.0100739  
##  Median :25.50   Median :1.445   Median :0.5527   Median :0.0195919  
##  Mean   :25.50   Mean   :1.477   Mean   :0.5681   Mean   :0.0200000  
##  3rd Qu.:37.75   3rd Qu.:1.743   3rd Qu.:0.8028   3rd Qu.:0.0285548  
##  Max.   :50.00   Max.   :1.985   Max.   :0.9948   Max.   :0.0381932  
##     rank_val     rank_y_inter_idx lowest_rank_A   lowest_rank_alpha
##  Min.   :1.529   Min.   : 1.00    Min.   :1.122   Min.   :0.8947   
##  1st Qu.:1.961   1st Qu.:13.25    1st Qu.:1.122   1st Qu.:0.8947   
##  Median :2.295   Median :25.50    Median :1.122   Median :0.8947   
##  Mean   :2.302   Mean   :25.50    Mean   :1.122   Mean   :0.8947   
##  3rd Qu.:2.728   3rd Qu.:37.75    3rd Qu.:1.122   3rd Qu.:0.8947   
##  Max.   :3.034   Max.   :50.00    Max.   :1.122   Max.   :0.8947   
##  lowest_rank_beta 
##  Min.   :0.03704  
##  1st Qu.:0.03704  
##  Median :0.03704  
##  Mean   :0.03704  
##  3rd Qu.:0.03704  
##  Max.   :0.03704</code></pre>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">lowest_rank_A</span>, <span class="no">lowest_rank_alpha</span>, <span class="no">lowest_rank_beta</span>))</pre></body></html></div>
<pre><code>##  lowest_rank_A   lowest_rank_alpha lowest_rank_beta 
##  Min.   :1.122   Min.   :0.8947    Min.   :0.03704  
##  1st Qu.:1.122   1st Qu.:0.8947    1st Qu.:0.03704  
##  Median :1.122   Median :0.8947    Median :0.03704  
##  Mean   :1.122   Mean   :0.8947    Mean   :0.03704  
##  3rd Qu.:1.122   3rd Qu.:0.8947    3rd Qu.:0.03704  
##  Max.   :1.122   Max.   :0.8947    Max.   :0.03704</code></pre>
</div>
<div id="relative-slopes-intercepts" class="section level4">
<h4 class="hasAnchor">
<a href="#relative-slopes-intercepts" class="anchor"></a>Relative Slopes, Intercepts</h4>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># e. relative slope and relative intercept with respect to lowest index</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rela_slope_to_lowest</span> <span class="kw">=</span>
           ((
             (<span class="no">lowest_rank_alpha</span>*<span class="no">lowest_rank_beta</span>)/(<span class="no">alpha</span>*<span class="no">beta</span>)
           )^(<span class="fl">1</span>/(<span class="no">fl_rho</span>-<span class="fl">1</span>))
           *(<span class="no">lowest_rank_alpha</span>/<span class="no">alpha</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rela_intercept_to_lowest</span> <span class="kw">=</span>
           (((
             (<span class="no">lowest_rank_alpha</span>*<span class="no">lowest_rank_beta</span>)/(<span class="no">alpha</span>*<span class="no">beta</span>)
           )^(<span class="fl">1</span>/(<span class="no">fl_rho</span>-<span class="fl">1</span>))
           *(<span class="no">lowest_rank_A</span>/<span class="no">alpha</span>)) - (<span class="no">A</span>/<span class="no">alpha</span>))
  )

<span class="co"># h. Relative x-intercept points and ranking based on x-intercepts</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rela_x_intercept</span> <span class="kw">=</span>
           (-<span class="fl">1</span>)*(<span class="no">rela_intercept_to_lowest</span>/<span class="no">rela_slope_to_lowest</span>)
  ) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">rela_x_intercept</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rank_x_inter_idx</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>())

<span class="co"># In this example, is x-intercept rank and y-intercept rank the same?</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">df_opti</span>$<span class="no">rank_y_inter_idx</span>-<span class="no">df_opti</span>$<span class="no">rank_x_inter_idx</span>)</pre></body></html></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">rela_slope_to_lowest</span>, <span class="no">rela_intercept_to_lowest</span>))</pre></body></html></div>
<pre><code>##  rela_slope_to_lowest rela_intercept_to_lowest
##  Min.   :0.7946       Min.   :-6.2816         
##  1st Qu.:1.0155       1st Qu.:-1.4794         
##  Median :1.3717       Median :-0.8238         
##  Mean   :1.8444       Mean   :-1.1871         
##  3rd Qu.:2.1876       3rd Qu.:-0.5305         
##  Max.   :5.7846       Max.   : 0.0000</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">df_opti</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">A</span>, <span class="no">alpha</span>, <span class="no">beta</span>,
         <span class="no">rank_val</span>, <span class="no">rela_intercept_to_lowest</span>, <span class="no">rela_x_intercept</span>,
         <span class="no">rank_y_inter_idx</span>, <span class="no">rank_x_inter_idx</span>)</pre></body></html></div>
<pre><code>## # A tibble: 50 x 8
##        A alpha    beta rank_val rela_intercept_~ rela_x_intercept
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1  1.12 0.895 0.0370      1.53          0                 0     
##  2  1.00 0.995 0.00853     1.54         -0.00948           0.0119
##  3  1.13 0.575 0.0355      1.61         -0.0938            0.0630
##  4  1.05 0.359 0.0233      1.62         -0.156             0.0710
##  5  1.22 0.738 0.0382      1.69         -0.155             0.130 
##  6  1.09 0.508 0.0117      1.74         -0.266             0.177 
##  7  1.24 0.967 0.0240      1.75         -0.163             0.182 
##  8  1.11 0.232 0.0268      1.76         -0.635             0.192 
##  9  1.27 0.615 0.0368      1.80         -0.310             0.221 
## 10  1.18 0.308 0.0171      1.89         -0.733             0.299 
## # ... with 40 more rows, and 2 more variables: rank_y_inter_idx &lt;int&gt;,
## #   rank_x_inter_idx &lt;int&gt;</code></pre>
</div>
</div>
<div id="spline-and-inversion" class="section level3">
<h3 class="hasAnchor">
<a href="#spline-and-inversion" class="anchor"></a>Spline and Inversion</h3>
<div id="summing-up-for-splines" class="section level4">
<h4 class="hasAnchor">
<a href="#summing-up-for-splines" class="anchor"></a>Summing up for Splines</h4>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># f. cumulative sums</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rela_slope_to_lowest_cumsum</span> <span class="kw">=</span>
                        <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="no">rela_slope_to_lowest</span>)
                    ) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rela_intercept_to_lowest_cumsum</span> <span class="kw">=</span>
                        <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="no">rela_intercept_to_lowest</span>)
                    )
<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">rela_slope_to_lowest_cumsum</span>, <span class="no">rela_intercept_to_lowest_cumsum</span>))</pre></body></html></div>
<pre><code>##  rela_slope_to_lowest_cumsum rela_intercept_to_lowest_cumsum
##  Min.   : 1.00               Min.   :-59.356                
##  1st Qu.:30.81               1st Qu.:-28.787                
##  Median :48.36               Median :-15.944                
##  Mean   :46.42               Mean   :-19.426                
##  3rd Qu.:64.62               3rd Qu.: -7.318                
##  Max.   :92.22               Max.   :  0.000</code></pre>
</div>
<div id="inverting-splines-cumulative" class="section level4">
<h4 class="hasAnchor">
<a href="#inverting-splines-cumulative" class="anchor"></a>Inverting Splines (Cumulative)</h4>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># g. inverting cumulative slopes and intercepts</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rela_slope_to_lowest_cumsum_invert</span> <span class="kw">=</span>
                        (<span class="fl">1</span>/<span class="no">rela_slope_to_lowest_cumsum</span>)
                    ) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rela_intercept_to_lowest_cumsum_invert</span> <span class="kw">=</span>
                        ((-<span class="fl">1</span>)*(<span class="no">rela_intercept_to_lowest_cumsum</span>)/(<span class="no">rela_slope_to_lowest_cumsum</span>))
                    )
<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">rela_slope_to_lowest_cumsum_invert</span>, <span class="no">rela_intercept_to_lowest_cumsum_invert</span>))</pre></body></html></div>
<pre><code>##  rela_slope_to_lowest_cumsum_invert rela_intercept_to_lowest_cumsum_invert
##  Min.   :0.01084                    Min.   :0.0000                        
##  1st Qu.:0.01548                    1st Qu.:0.2375                        
##  Median :0.02068                    Median :0.3296                        
##  Mean   :0.06883                    Mean   :0.3284                        
##  3rd Qu.:0.03247                    3rd Qu.:0.4453                        
##  Max.   :1.00000                    Max.   :0.6436</code></pre>
</div>
<div id="x-intercepts-as-spline-knots-and-inverted-spline-knots" class="section level4">
<h4 class="hasAnchor">
<a href="#x-intercepts-as-spline-knots-and-inverted-spline-knots" class="anchor"></a>X intercepts as Spline Knots and inverted Spline Knots</h4>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># # h. Relative x-intercept points</span>
<span class="co"># df_opti &lt;- df_opti %&gt;%</span>
<span class="co">#               mutate(rela_x_intercept =</span>
<span class="co">#                         (-1)*(rela_intercept_to_lowest/rela_slope_to_lowest)</span>
<span class="co">#                     )</span>

<span class="co"># i. Inverted relative x-intercepts</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">opti_lowest_spline_knots</span> <span class="kw">=</span>
                        (<span class="no">rela_intercept_to_lowest_cumsum</span> + <span class="no">rela_slope_to_lowest_cumsum</span>*<span class="no">rela_x_intercept</span>)
                    )
<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">rela_x_intercept</span>, <span class="no">opti_lowest_spline_knots</span>))</pre></body></html></div>
<pre><code>##  rela_x_intercept opti_lowest_spline_knots
##  Min.   :0.0000   Min.   : 0.000          
##  1st Qu.:0.3538   1st Qu.: 3.586          
##  Median :0.6277   Median :14.415          
##  Mean   :0.6334   Mean   :18.657          
##  3rd Qu.:0.9831   3rd Qu.:34.778          
##  Max.   :1.2340   Max.   :54.438</code></pre>
</div>
</div>
<div id="optimal-allocations" class="section level3">
<h3 class="hasAnchor">
<a href="#optimal-allocations" class="anchor"></a>Optimal Allocations</h3>
<div id="compute-optimal-allocation-for-the-lowest" class="section level4">
<h4 class="hasAnchor">
<a href="#compute-optimal-allocation-for-the-lowest" class="anchor"></a>Compute Optimal Allocation for the Lowest</h4>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># j. Sort by order of receiving transfers/subsidies</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">rela_x_intercept</span>)

<span class="co"># k. Find position of subsidy</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">opti_lowest_spline_knots</span>) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">tot_devi</span> <span class="kw">=</span> <span class="no">opti_lowest_spline_knots</span> - <span class="no">fl_N_agg</span>) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>((-<span class="fl">1</span>)*<span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">tot_devi</span> <span class="kw">&lt;</span> <span class="fl">0</span> ~ <span class="no">tot_devi</span>)) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">allocate_lowest</span> <span class="kw">=</span>
                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>() <span class="kw">==</span> <span class="fl">1</span> ~
                                    <span class="no">rela_intercept_to_lowest_cumsum_invert</span> +
                                    <span class="no">rela_slope_to_lowest_cumsum_invert</span>*<span class="no">fl_N_agg</span>)) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">allocate_lowest</span> <span class="kw">=</span> <span class="no">allocate_lowest</span>[<span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>() <span class="kw">==</span> <span class="fl">1</span>])
<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">tot_devi</span>, <span class="no">allocate_lowest</span>))</pre></body></html></div>
<pre><code>##     tot_devi      allocate_lowest 
##  Min.   :-5.681   Min.   :0.4198  
##  1st Qu.:-2.095   1st Qu.:0.4198  
##  Median : 8.735   Median :0.4198  
##  Mean   :12.976   Mean   :0.4198  
##  3rd Qu.:29.097   3rd Qu.:0.4198  
##  Max.   :48.758   Max.   :0.4198</code></pre>
</div>
<div id="compute-optimal-allocation-for-all-others-given-lowest" class="section level4">
<h4 class="hasAnchor">
<a href="#compute-optimal-allocation-for-all-others-given-lowest" class="anchor"></a>Compute Optimal Allocation for All Others given Lowest</h4>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># l. Find position of subsidy</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">opti_allocate</span> <span class="kw">=</span>
                        <span class="no">rela_intercept_to_lowest</span> +
                        <span class="no">rela_slope_to_lowest</span>*<span class="no">allocate_lowest</span>) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">opti_allocate</span> <span class="kw">=</span>
                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">opti_allocate</span> <span class="kw">&gt;=</span> <span class="fl">0</span> ~ <span class="no">opti_allocate</span>, <span class="fl">TRUE</span> ~ <span class="fl">0</span>)) <span class="kw">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">allocate_total</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">opti_allocate</span>, <span class="kw">na.rm</span><span class="kw">=</span><span class="fl">TRUE</span>))

<span class="co"># if want 0 to be 0</span>
<span class="co"># case_when(opti_allocate &gt;= 0 ~ opti_allocate, TRUE ~ 0)) %&gt;%</span>
<span class="co"># if want 0 to be NA, makes it easier to see average change for non zeros</span>
<span class="co"># case_when(opti_allocate &gt;= 0 ~ opti_allocate)) %&gt;%</span>

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">opti_allocate</span>, <span class="no">allocate_total</span>))</pre></body></html></div>
<pre><code>##  opti_allocate    allocate_total 
##  Min.   :0.0000   Min.   :5.681  
##  1st Qu.:0.0000   1st Qu.:5.681  
##  Median :0.0000   Median :5.681  
##  Mean   :0.1136   Mean   :5.681  
##  3rd Qu.:0.1792   3rd Qu.:5.681  
##  Max.   :0.7674   Max.   :5.681</code></pre>
</div>
</div>
<div id="expected-outcomes-given-optimal-allocations" class="section level3">
<h3 class="hasAnchor">
<a href="#expected-outcomes-given-optimal-allocations" class="anchor"></a>Expected Outcomes Given Optimal Allocations</h3>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># l. Predictes Expected choice: A + alpha*opti_allocate</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">opti_exp_outcome</span> <span class="kw">=</span> <span class="no">A</span> + <span class="no">alpha</span>*<span class="no">opti_allocate</span>)

<span class="co"># m. Drop some variables that I do not want to keep even in full df to export</span>
<span class="co"># inpalc = input allocation optimal</span>
<span class="co"># expout = expected outcome given input allocation</span>
<span class="no">df_opti</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(-<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">one_of</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'lowest_rank_alpha'</span>, <span class="st">'lowest_rank_beta'</span>)))
<span class="no">ar_opti_inpalc</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">opti_allocate</span>)
<span class="no">ar_opti_expout</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(<span class="no">opti_exp_outcome</span>)

<span class="co"># Print</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df_opti</span>, <span class="fl">10</span>)</pre></body></html></div>
<pre><code>## # A tibble: 10 x 21
##    indi.id     A alpha    beta rank_val rank_y_inter_idx lowest_rank_A
##      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;            &lt;int&gt;         &lt;dbl&gt;
##  1      33  1.42 0.722 0.0261      2.03               15          1.12
##  2      48  1.09 0.519 0.00298     1.97               14          1.12
##  3       6  1.21 0.141 0.0346      1.96               13          1.12
##  4      41  1.13 0.229 0.0121      1.93               12          1.12
##  5      35  1.10 0.122 0.0202      1.90               11          1.12
##  6      40  1.18 0.308 0.0171      1.89               10          1.12
##  7      14  1.27 0.615 0.0368      1.80                9          1.12
##  8      30  1.11 0.232 0.0268      1.76                8          1.12
##  9      31  1.24 0.967 0.0240      1.75                7          1.12
## 10      12  1.09 0.508 0.0117      1.74                6          1.12
## # ... with 14 more variables: rela_slope_to_lowest &lt;dbl&gt;,
## #   rela_intercept_to_lowest &lt;dbl&gt;, rela_x_intercept &lt;dbl&gt;,
## #   rank_x_inter_idx &lt;int&gt;, rela_slope_to_lowest_cumsum &lt;dbl&gt;,
## #   rela_intercept_to_lowest_cumsum &lt;dbl&gt;,
## #   rela_slope_to_lowest_cumsum_invert &lt;dbl&gt;,
## #   rela_intercept_to_lowest_cumsum_invert &lt;dbl&gt;,
## #   opti_lowest_spline_knots &lt;dbl&gt;, tot_devi &lt;dbl&gt;, allocate_lowest &lt;dbl&gt;,
## #   opti_allocate &lt;dbl&gt;, allocate_total &lt;dbl&gt;, opti_exp_outcome &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">df_opti</span>)</pre></body></html></div>
<pre><code>##     indi.id            A             alpha             beta          
##  Min.   : 1.00   Min.   :1.001   Min.   :0.1222   Min.   :0.0004062  
##  1st Qu.:13.25   1st Qu.:1.226   1st Qu.:0.3442   1st Qu.:0.0100739  
##  Median :25.50   Median :1.445   Median :0.5527   Median :0.0195919  
##  Mean   :25.50   Mean   :1.477   Mean   :0.5681   Mean   :0.0200000  
##  3rd Qu.:37.75   3rd Qu.:1.743   3rd Qu.:0.8028   3rd Qu.:0.0285548  
##  Max.   :50.00   Max.   :1.985   Max.   :0.9948   Max.   :0.0381932  
##     rank_val     rank_y_inter_idx lowest_rank_A   rela_slope_to_lowest
##  Min.   :1.529   Min.   : 1.00    Min.   :1.122   Min.   :0.7946      
##  1st Qu.:1.961   1st Qu.:13.25    1st Qu.:1.122   1st Qu.:1.0155      
##  Median :2.295   Median :25.50    Median :1.122   Median :1.3717      
##  Mean   :2.302   Mean   :25.50    Mean   :1.122   Mean   :1.8444      
##  3rd Qu.:2.728   3rd Qu.:37.75    3rd Qu.:1.122   3rd Qu.:2.1876      
##  Max.   :3.034   Max.   :50.00    Max.   :1.122   Max.   :5.7846      
##  rela_intercept_to_lowest rela_x_intercept rank_x_inter_idx
##  Min.   :-6.2816          Min.   :0.0000   Min.   : 1.00   
##  1st Qu.:-1.4794          1st Qu.:0.3538   1st Qu.:13.25   
##  Median :-0.8238          Median :0.6277   Median :25.50   
##  Mean   :-1.1871          Mean   :0.6334   Mean   :25.50   
##  3rd Qu.:-0.5305          3rd Qu.:0.9831   3rd Qu.:37.75   
##  Max.   : 0.0000          Max.   :1.2340   Max.   :50.00   
##  rela_slope_to_lowest_cumsum rela_intercept_to_lowest_cumsum
##  Min.   : 1.00               Min.   :-59.356                
##  1st Qu.:30.81               1st Qu.:-28.787                
##  Median :48.36               Median :-15.944                
##  Mean   :46.42               Mean   :-19.426                
##  3rd Qu.:64.62               3rd Qu.: -7.318                
##  Max.   :92.22               Max.   :  0.000                
##  rela_slope_to_lowest_cumsum_invert rela_intercept_to_lowest_cumsum_invert
##  Min.   :0.01084                    Min.   :0.0000                        
##  1st Qu.:0.01548                    1st Qu.:0.2375                        
##  Median :0.02068                    Median :0.3296                        
##  Mean   :0.06883                    Mean   :0.3284                        
##  3rd Qu.:0.03247                    3rd Qu.:0.4453                        
##  Max.   :1.00000                    Max.   :0.6436                        
##  opti_lowest_spline_knots    tot_devi      allocate_lowest  opti_allocate   
##  Min.   : 0.000           Min.   :-5.681   Min.   :0.4198   Min.   :0.0000  
##  1st Qu.: 3.586           1st Qu.:-2.095   1st Qu.:0.4198   1st Qu.:0.0000  
##  Median :14.415           Median : 8.735   Median :0.4198   Median :0.0000  
##  Mean   :18.657           Mean   :12.976   Mean   :0.4198   Mean   :0.1136  
##  3rd Qu.:34.778           3rd Qu.:29.097   3rd Qu.:0.4198   3rd Qu.:0.1792  
##  Max.   :54.438           Max.   :48.758   Max.   :0.4198   Max.   :0.7674  
##  allocate_total  opti_exp_outcome
##  Min.   :5.681   Min.   :1.133   
##  1st Qu.:5.681   1st Qu.:1.357   
##  Median :5.681   Median :1.471   
##  Mean   :5.681   Mean   :1.529   
##  3rd Qu.:5.681   3rd Qu.:1.743   
##  Max.   :5.681   Max.   :1.985</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_opti_expout</span>,<span class="no">ar_opti_inpalc</span>))</pre></body></html></div>
<pre><code>##       ar_opti_expout ar_opti_inpalc
##  [1,]       1.422612    0.006880531
##  [2,]       1.133311    0.076469304
##  [3,]       1.257978    0.364864308
##  [4,]       1.194809    0.280558877
##  [5,]       1.182663    0.653270709
##  [6,]       1.266780    0.297369431
##  [7,]       1.446481    0.279664218
##  [8,]       1.286286    0.753652841
##  [9,]       1.449922    0.213404330
## [10,]       1.280823    0.366106406
## [11,]       1.475576    0.346299292
## [12,]       1.321196    0.767417565
## [13,]       1.432987    0.530954043
## [14,]       1.323050    0.324096274
## [15,]       1.497510    0.419810625
## [16,]       1.320373    0.000000000
## [17,]       1.187691    0.000000000
## [18,]       1.439832    0.000000000
## [19,]       1.511505    0.000000000
## [20,]       1.434893    0.000000000
## [21,]       1.442200    0.000000000
## [22,]       1.475317    0.000000000
## [23,]       1.560948    0.000000000
## [24,]       1.665115    0.000000000
## [25,]       1.668056    0.000000000
## [26,]       1.379817    0.000000000
## [27,]       1.374463    0.000000000
## [28,]       1.448516    0.000000000
## [29,]       1.351798    0.000000000
## [30,]       1.466779    0.000000000
## [31,]       1.383970    0.000000000
## [32,]       1.754475    0.000000000
## [33,]       1.753308    0.000000000
## [34,]       1.629221    0.000000000
## [35,]       1.788196    0.000000000
## [36,]       1.653102    0.000000000
## [37,]       1.710182    0.000000000
## [38,]       1.794342    0.000000000
## [39,]       1.798925    0.000000000
## [40,]       1.886469    0.000000000
## [41,]       1.984957    0.000000000
## [42,]       1.656758    0.000000000
## [43,]       1.612771    0.000000000
## [44,]       1.810064    0.000000000
## [45,]       1.895045    0.000000000
## [46,]       1.893051    0.000000000
## [47,]       1.814640    0.000000000
## [48,]       1.343516    0.000000000
## [49,]       1.812390    0.000000000
## [50,]       1.782294    0.000000000</code></pre>
</div>
</div>
<div id="save-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#save-outputs" class="anchor"></a>Save Outputs</h2>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="kw">if</span> (<span class="no">bl_save_rda</span>) {
  <span class="co"># df_opt_dtgch_ropti: dataframe, opt project, data guat cebu height, cebu edu mother, results relative linear optimal</span>
  <span class="no">df_opt_dtgch_cbem4_rrlop</span> <span class="kw">&lt;-</span> <span class="no">df_opti</span>
  <span class="kw pkg">usethis</span><span class="kw ns">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html">use_data</a></span>(<span class="no">df_opt_dtgch_cbem4_rrlop</span>, <span class="no">df_opt_dtgch_cbem4_rrlop</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
}</pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://fanwangecon.github.io">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
