<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Linear (CRS) Optimal Allocation Solution (Function) • PrjOptiAlloc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Linear (CRS) Optimal Allocation Solution (Function)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PrjOptiAlloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ffv_opt_solin_flinf.html">Linear (CRS) Optimal Allocation Solution (Function)</a>
    </li>
    <li>
      <a href="../articles/ffv_opt_solin_flinr.html">Linear (CRS) Optimal Allocation Solution (No Function)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Linear (CRS) Optimal Allocation Solution (Function)</h1>
            
      
      
      <div class="hidden name"><code>ffv_opt_solin_flinf.Rmd</code></div>

    </div>

    
    
<p>Back to <strong><a href="https://fanwangecon.github.io/">Fan</a></strong>’s Optimal Allocation Homepage <strong><a href="https://fanwangecon.github.io/PrjOptiAlloc/">Table of Content</a></strong></p>
<p>There are two related filed:</p>
<ol style="list-style-type: decimal">
<li>*vignettes_opt_solin_flinf.Rmd*</li>
</ol>
<div id="outline" class="section level1">
<h1 class="hasAnchor">
<a href="#outline" class="anchor"></a>Outline</h1>
<p>This is the function based file for</p>
<div id="set-up" class="section level2">
<h2 class="hasAnchor">
<a href="#set-up" class="anchor"></a>Set Up</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>(<span class="dt">all.names =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">knitr.duplicate.label =</span> <span class="st">'allow'</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stringr)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(broom)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(R4Econ)</a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PrjOptiAlloc)</a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra)</a></code></pre></div>
</div>
<div id="get-data-and-regression-results" class="section level2">
<h2 class="hasAnchor">
<a href="#get-data-and-regression-results" class="anchor"></a>Get Data and Regression Results</h2>
<p>Generate four categories by initial height and mother’s education levels combinations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Load Data and Estimation Results: A and alpha, lin and loglin</span></a>
<a class="sourceLine" id="cb3-2" title="2">ls_opti_alpha_A &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ffy_opt_dtgch_cbem4.html">ffy_opt_dtgch_cbem4</a></span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = hgt ~ prot:mt_linht + mt_lincv - 1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.212  -2.339   0.088   2.437   9.805 
## 
## Coefficients:
##                                       Estimate Std. Error t value Pr(&gt;|t|)    
## mt_lincv(Intercept)                  5.638e+01  3.683e+00  15.307  &lt; 2e-16 ***
## mt_lincvhgt0                         3.774e-01  8.723e-02   4.326 1.66e-05 ***
## mt_lincvwgt0                         1.154e-03  3.705e-04   3.115  0.00189 ** 
## prot:mt_linhtsexFemale:hgt0medh0low  1.014e-02  1.058e-02   0.959  0.33783    
## prot:mt_linhtsexMale:hgt0medh0low    6.018e-02  9.625e-03   6.252 5.91e-10 ***
## prot:mt_linhtsexFemale:hgt0medh0high 3.228e-02  1.332e-02   2.423  0.01558 *  
## prot:mt_linhtsexMale:hgt0medh0high   6.619e-02  1.001e-02   6.612 6.05e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.473 on 1036 degrees of freedom
## Multiple R-squared:  0.9981, Adjusted R-squared:  0.9981 
## F-statistic: 7.79e+04 on 7 and 1036 DF,  p-value: &lt; 2.2e-16
## 
## 
## Call:
## lm(formula = log(hgt) ~ log(prot):mt_loght + mt_logcv - 1)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.223890 -0.030027  0.002461  0.031047  0.118097 
## 
## Coefficients:
##                                            Estimate Std. Error t value Pr(&gt;|t|)
## mt_logcv(Intercept)                       4.087e+00  5.342e-02  76.512  &lt; 2e-16
## mt_logcvhgt0                              4.305e-03  1.224e-03   3.516 0.000457
## mt_logcvwgt0                              1.465e-05  4.733e-06   3.096 0.002012
## log(prot):mt_loghtsexFemale:hgt0medh0low  6.687e-03  2.218e-03   3.014 0.002640
## log(prot):mt_loghtsexMale:hgt0medh0low    1.209e-02  2.176e-03   5.557 3.49e-08
## log(prot):mt_loghtsexFemale:hgt0medh0high 9.251e-03  2.441e-03   3.790 0.000159
## log(prot):mt_loghtsexMale:hgt0medh0high   1.394e-02  2.288e-03   6.094 1.55e-09
##                                              
## mt_logcv(Intercept)                       ***
## mt_logcvhgt0                              ***
## mt_logcvwgt0                              ** 
## log(prot):mt_loghtsexFemale:hgt0medh0low  ** 
## log(prot):mt_loghtsexMale:hgt0medh0low    ***
## log(prot):mt_loghtsexFemale:hgt0medh0high ***
## log(prot):mt_loghtsexMale:hgt0medh0high   ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.04436 on 1036 degrees of freedom
## Multiple R-squared:  0.9999, Adjusted R-squared:  0.9999 
## F-statistic: 1.448e+06 on 7 and 1036 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">df_raw &lt;-<span class="st"> </span>ls_opti_alpha_A<span class="op">$</span>df_raw</a>
<a class="sourceLine" id="cb5-2" title="2">df_hw_cebu_m24 &lt;-<span class="st"> </span>df_raw</a>
<a class="sourceLine" id="cb5-3" title="3">df_esti &lt;-<span class="st"> </span>ls_opti_alpha_A<span class="op">$</span>df_esti</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co"># Review dataframes</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co"># raw file</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(df_raw, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 17
##    S.country vil.id indi.id sex   svymthRound momEdu wealthIdx   hgt    wgt
##    &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 Cebu           1       2 Fema…          24    7.1       7.3  79.2 10776.
##  2 Cebu           1       3 Fema…          24    9.4      10.3  76.7 10296.
##  3 Cebu           1       4 Fema…          24   13.9      13.3  78.1  7604.
##  4 Cebu           1       5 Male           24   11.3       9.3  84.1 11787.
##  5 Cebu           1       6 Fema…          24    7.3       7.3  76.9  7991.
##  6 Cebu           1       7 Male           24   10.4       8.3  79.6 12583.
##  7 Cebu           1       8 Fema…          24   13.5       9.3  81.5  8358.
##  8 Cebu           1       9 Fema…          24   10.4      17.3  74.7  8195.
##  9 Cebu           1      10 Male           24   10.5       6.3  77.1  9442.
## 10 Cebu           1      11 Male           24    1.9       6.3  72.1  6627.
## # … with 8 more variables: hgt0 &lt;dbl&gt;, wgt0 &lt;dbl&gt;, prot &lt;dbl&gt;, cal &lt;dbl&gt;,
## #   p.A.prot &lt;dbl&gt;, p.A.nProt &lt;dbl&gt;, momEduRound &lt;fct&gt;, hgt0med &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(df_esti, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##    alpha_lin alpha_log A_lin A_log     beta
##        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1    0.0101   0.00669  78.4  4.34 0.000959
##  2    0.0323   0.00925  79.9  4.36 0.000959
##  3    0.0323   0.00925  78.9  4.35 0.000959
##  4    0.0662   0.0139   80.6  4.37 0.000959
##  5    0.0101   0.00669  77.8  4.34 0.000959
##  6    0.0662   0.0139   79.6  4.36 0.000959
##  7    0.0101   0.00669  77.8  4.34 0.000959
##  8    0.0101   0.00669  78.0  4.34 0.000959
##  9    0.0662   0.0139   80.0  4.36 0.000959
## 10    0.0602   0.0121   77.7  4.33 0.000959</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># Attach</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(df_raw)</a></code></pre></div>
<pre><code>## The following objects are masked from df_hw:
## 
##     cal, hgt, hgt0, hgt0med, indi.id, momEdu, momEduRound, p.A.nProt,
##     p.A.prot, prot, S.country, sex, svymthRound, vil.id, wealthIdx,
##     wgt, wgt0</code></pre>
</div>
<div id="rename-results-use-linear" class="section level2">
<h2 class="hasAnchor">
<a href="#rename-results-use-linear" class="anchor"></a>Rename Results Use Linear</h2>
<p>To replicate previous results, rename linear A and alpha for optimal allocation.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># Initate Dataframe that will store all estimates and optimal allocation relevant information</span></a>
<a class="sourceLine" id="cb11-2" title="2">tb_opti &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(df_esti) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">            </span><span class="kw">select</span>(alpha_lin, A_lin, beta) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">            </span><span class="kw">rename</span>(<span class="dt">alpha =</span> alpha_lin, <span class="dt">A =</span> A_lin, <span class="dt">beta =</span> beta)</a>
<a class="sourceLine" id="cb11-5" title="5"></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co"># Print</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tb_opti, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##     alpha     A     beta
##     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 0.0101  78.4 0.000959
##  2 0.0323  79.9 0.000959
##  3 0.0323  78.9 0.000959
##  4 0.0662  80.6 0.000959
##  5 0.0101  77.8 0.000959
##  6 0.0662  79.6 0.000959
##  7 0.0101  77.8 0.000959
##  8 0.0101  78.0 0.000959
##  9 0.0662  80.0 0.000959
## 10 0.0602  77.7 0.000959</code></pre>
</div>
</div>
<div id="optimal-allocations" class="section level1">
<h1 class="hasAnchor">
<a href="#optimal-allocations" class="anchor"></a>Optimal Allocations</h1>
<div id="common-parameters-for-optimal-allocation" class="section level2">
<h2 class="hasAnchor">
<a href="#common-parameters-for-optimal-allocation" class="anchor"></a>Common Parameters for Optimal Allocation</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># Child Count</span></a>
<a class="sourceLine" id="cb13-2" title="2">df_hw_cebu_m24_full &lt;-<span class="st"> </span>df_hw_cebu_m24</a>
<a class="sourceLine" id="cb13-3" title="3">it_obs =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(df_hw_cebu_m24)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb13-4" title="4"></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co"># Total Resource Count</span></a>
<a class="sourceLine" id="cb13-6" title="6">ar_prot_data =<span class="st"> </span>df_hw_cebu_m24<span class="op">$</span>prot</a>
<a class="sourceLine" id="cb13-7" title="7">fl_N_agg =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(ar_prot_data)</a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co"># Vector of Planner Preference</span></a>
<a class="sourceLine" id="cb13-10" title="10">ar_rho =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">200</span>, <span class="dv">-100</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">-25</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">-5</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">-1</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">-0.01</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.01</span>, <span class="fl">0.25</span>, <span class="dt">length.out=</span><span class="dv">5</span>), <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.25</span>, <span class="fl">0.99</span>, <span class="dt">length.out=</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb13-11" title="11">ar_rho =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">-25</span>, <span class="dv">-10</span>)</a>
<a class="sourceLine" id="cb13-12" title="12">ar_rho =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(ar_rho)</a></code></pre></div>
</div>
<div id="optimal-linear-allocation-crs" class="section level2">
<h2 class="hasAnchor">
<a href="#optimal-linear-allocation-crs" class="anchor"></a>Optimal Linear Allocation (CRS)</h2>
<p>This also works with any CRS CES.</p>
<div id="optimal-linear-allocation-hard-coded" class="section level3">
<h3 class="hasAnchor">
<a href="#optimal-linear-allocation-hard-coded" class="anchor"></a>Optimal Linear Allocation Hard-Coded</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># Optimal Linear Equation</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co"># Planner Inputs</span></a>
<a class="sourceLine" id="cb14-3" title="3">mt_hev_lin =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(, <span class="dt">nrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_rho), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-4" title="4">mt_opti_N =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(, <span class="dt">nrow =</span> it_obs, <span class="dt">ncol =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_rho))</a>
<a class="sourceLine" id="cb14-5" title="5"></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co"># A. First Loop over Planner Preference</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co"># Generate Rank Order</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="cf">for</span> (it_rho_ctr <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(ar_rho))) {</a>
<a class="sourceLine" id="cb14-9" title="9">  rho =<span class="st"> </span>ar_rho[it_rho_ctr]</a>
<a class="sourceLine" id="cb14-10" title="10"></a>
<a class="sourceLine" id="cb14-11" title="11">  <span class="co"># B. Generate V4, Rank Index Value, rho specific</span></a>
<a class="sourceLine" id="cb14-12" title="12">  <span class="co"># tb_opti &lt;- tb_opti %&gt;% mutate(!!paste0('rv_', it_rho_ctr) := A/((alpha*beta))^(1/(1-rho)))</span></a>
<a class="sourceLine" id="cb14-13" title="13">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">rank_val =</span> A<span class="op">/</span>((alpha<span class="op">*</span>beta))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>rho)))</a>
<a class="sourceLine" id="cb14-14" title="14"></a>
<a class="sourceLine" id="cb14-15" title="15">  <span class="co"># c. Generate Rank Index</span></a>
<a class="sourceLine" id="cb14-16" title="16">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(rank_val) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">rank_idx =</span> <span class="kw">row_number</span>())</a>
<a class="sourceLine" id="cb14-17" title="17"></a>
<a class="sourceLine" id="cb14-18" title="18">  <span class="co"># d. Populate lowest index alpha, beta, and A to all rows</span></a>
<a class="sourceLine" id="cb14-19" title="19">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">lowest_rank_A =</span> A[rank_idx<span class="op">==</span><span class="dv">1</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">lowest_rank_alpha =</span> alpha[rank_idx<span class="op">==</span><span class="dv">1</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-21" title="21"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">lowest_rank_beta =</span> beta[rank_idx<span class="op">==</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb14-22" title="22"></a>
<a class="sourceLine" id="cb14-23" title="23">  <span class="co"># e. relative slope and relative intercept with respect to lowest index</span></a>
<a class="sourceLine" id="cb14-24" title="24">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">rela_slope_to_lowest =</span></a>
<a class="sourceLine" id="cb14-26" title="26">                         (((lowest_rank_alpha<span class="op">*</span>lowest_rank_beta)<span class="op">/</span>(alpha<span class="op">*</span>beta))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>(rho<span class="dv">-1</span>))<span class="op">*</span>(lowest_rank_alpha<span class="op">/</span>alpha))</a>
<a class="sourceLine" id="cb14-27" title="27">                      ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-28" title="28"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">rela_intercept_to_lowest =</span></a>
<a class="sourceLine" id="cb14-29" title="29">                         ((((lowest_rank_alpha<span class="op">*</span>lowest_rank_beta)<span class="op">/</span>(alpha<span class="op">*</span>beta))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>(rho<span class="dv">-1</span>))<span class="op">*</span>(lowest_rank_A<span class="op">/</span>alpha)) <span class="op">-</span><span class="st"> </span>(A<span class="op">/</span>alpha))</a>
<a class="sourceLine" id="cb14-30" title="30">                      )</a>
<a class="sourceLine" id="cb14-31" title="31"></a>
<a class="sourceLine" id="cb14-32" title="32">  <span class="co"># f. cumulative sums</span></a>
<a class="sourceLine" id="cb14-33" title="33">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-34" title="34"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">rela_slope_to_lowest_cumsum =</span></a>
<a class="sourceLine" id="cb14-35" title="35">                         <span class="kw"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(rela_slope_to_lowest)</a>
<a class="sourceLine" id="cb14-36" title="36">                      ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-37" title="37"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">rela_intercept_to_lowest_cumsum =</span></a>
<a class="sourceLine" id="cb14-38" title="38">                         <span class="kw"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(rela_intercept_to_lowest)</a>
<a class="sourceLine" id="cb14-39" title="39">                      )</a>
<a class="sourceLine" id="cb14-40" title="40"></a>
<a class="sourceLine" id="cb14-41" title="41">  <span class="co"># g. inverting cumulative slopes and intercepts</span></a>
<a class="sourceLine" id="cb14-42" title="42">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-43" title="43"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">rela_slope_to_lowest_cumsum_invert =</span></a>
<a class="sourceLine" id="cb14-44" title="44">                         (<span class="dv">1</span><span class="op">/</span>rela_slope_to_lowest_cumsum)</a>
<a class="sourceLine" id="cb14-45" title="45">                      ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-46" title="46"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">rela_intercept_to_lowest_cumsum_invert =</span></a>
<a class="sourceLine" id="cb14-47" title="47">                         ((<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(rela_intercept_to_lowest_cumsum)<span class="op">/</span>(rela_slope_to_lowest_cumsum))</a>
<a class="sourceLine" id="cb14-48" title="48">                      )</a>
<a class="sourceLine" id="cb14-49" title="49"></a>
<a class="sourceLine" id="cb14-50" title="50">  <span class="co"># h. Relative x-intercept points</span></a>
<a class="sourceLine" id="cb14-51" title="51">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-52" title="52"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">rela_x_intercept =</span></a>
<a class="sourceLine" id="cb14-53" title="53">                         (<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(rela_intercept_to_lowest<span class="op">/</span>rela_slope_to_lowest)</a>
<a class="sourceLine" id="cb14-54" title="54">                      )</a>
<a class="sourceLine" id="cb14-55" title="55"></a>
<a class="sourceLine" id="cb14-56" title="56">  <span class="co"># i. Inverted relative x-intercepts</span></a>
<a class="sourceLine" id="cb14-57" title="57">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-58" title="58"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">opti_lowest_spline_knots =</span></a>
<a class="sourceLine" id="cb14-59" title="59">                         (rela_intercept_to_lowest_cumsum <span class="op">+</span><span class="st"> </span>rela_slope_to_lowest_cumsum<span class="op">*</span>rela_x_intercept)</a>
<a class="sourceLine" id="cb14-60" title="60">                      )</a>
<a class="sourceLine" id="cb14-61" title="61"></a>
<a class="sourceLine" id="cb14-62" title="62">  <span class="co"># j. Sort by order of receiving transfers/subsidies</span></a>
<a class="sourceLine" id="cb14-63" title="63">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(rela_x_intercept)</a>
<a class="sourceLine" id="cb14-64" title="64"></a>
<a class="sourceLine" id="cb14-65" title="65">  <span class="co"># k. Find position of subsidy</span></a>
<a class="sourceLine" id="cb14-66" title="66">  tb_opti &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(opti_lowest_spline_knots) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-67" title="67"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">tot_devi =</span> opti_lowest_spline_knots <span class="op">-</span><span class="st"> </span>fl_N_agg) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-68" title="68"><span class="st">                </span><span class="kw">arrange</span>((<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">case_when</span>(tot_devi <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span>tot_devi)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-69" title="69"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">allocate_lowest =</span></a>
<a class="sourceLine" id="cb14-70" title="70">                         <span class="kw">case_when</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span></a>
<a class="sourceLine" id="cb14-71" title="71"><span class="st">                                     </span>rela_intercept_to_lowest_cumsum_invert <span class="op">+</span></a>
<a class="sourceLine" id="cb14-72" title="72"><span class="st">                                     </span>rela_slope_to_lowest_cumsum_invert<span class="op">*</span>fl_N_agg)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-73" title="73"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">allocate_lowest =</span> allocate_lowest[<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-74" title="74"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">opti_allocate =</span></a>
<a class="sourceLine" id="cb14-75" title="75">                         rela_intercept_to_lowest <span class="op">+</span></a>
<a class="sourceLine" id="cb14-76" title="76"><span class="st">                         </span>rela_slope_to_lowest<span class="op">*</span>allocate_lowest) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-77" title="77"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">opti_allocate =</span></a>
<a class="sourceLine" id="cb14-78" title="78">                         <span class="kw">case_when</span>(opti_allocate <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span>opti_allocate)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-79" title="79"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">opti_allocate_total =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(opti_allocate, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb14-80" title="80"></a>
<a class="sourceLine" id="cb14-81" title="81">  <span class="co"># l. Summarize outputs</span></a>
<a class="sourceLine" id="cb14-82" title="82">  tb_opti_main_results &lt;-<span class="st"> </span>tb_opti <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-83" title="83"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">one_of</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'lowest_rank_alpha'</span>, <span class="st">'lowest_rank_beta'</span>)))</a>
<a class="sourceLine" id="cb14-84" title="84">  </a>
<a class="sourceLine" id="cb14-85" title="85">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">''</span>)</a>
<a class="sourceLine" id="cb14-86" title="86">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>)</a>
<a class="sourceLine" id="cb14-87" title="87">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'xxx rho:'</span>, rho))</a>
<a class="sourceLine" id="cb14-88" title="88">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>)</a>
<a class="sourceLine" id="cb14-89" title="89">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>)</a>
<a class="sourceLine" id="cb14-90" title="90"></a>
<a class="sourceLine" id="cb14-91" title="91">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(tb_opti_main_results))</a>
<a class="sourceLine" id="cb14-92" title="92">  </a>
<a class="sourceLine" id="cb14-93" title="93">}</a></code></pre></div>
<pre><code>## [1] ""
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
## [1] "xxx rho:-50"
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
##      alpha               A              beta              rank_val     
##  Min.   :0.01014   Min.   :73.70   Min.   :0.0009588   Min.   : 89.24  
##  1st Qu.:0.01014   1st Qu.:77.73   1st Qu.:0.0009588   1st Qu.: 95.00  
##  Median :0.06018   Median :78.45   Median :0.0009588   Median : 96.39  
##  Mean   :0.04108   Mean   :78.46   Mean   :0.0009588   Mean   : 96.25  
##  3rd Qu.:0.06018   3rd Qu.:79.15   3rd Qu.:0.0009588   3rd Qu.: 97.58  
##  Max.   :0.06619   Max.   :84.61   Max.   :0.0009588   Max.   :103.71  
##                                                                        
##     rank_idx      lowest_rank_A  rela_slope_to_lowest rela_intercept_to_lowest
##  Min.   :   1.0   Min.   :73.7   Min.   :0.9108       Min.   :-823.49         
##  1st Qu.: 261.5   1st Qu.:73.7   1st Qu.:1.0000       1st Qu.:-601.87         
##  Median : 522.0   Median :73.7   Median :1.0000       Median :-101.68         
##  Mean   : 522.0   Mean   :73.7   Mean   :2.6677       Mean   :-286.05         
##  3rd Qu.: 782.5   3rd Qu.:73.7   3rd Qu.:5.7284       3rd Qu.: -76.81         
##  Max.   :1043.0   Max.   :73.7   Max.   :5.7284       Max.   :   0.00         
##                                                                               
##  rela_slope_to_lowest_cumsum rela_intercept_to_lowest_cumsum
##  Min.   :   1.0              Min.   :-298346                
##  1st Qu.: 297.9              1st Qu.:-151286                
##  Median : 735.0              Median : -58624                
##  Mean   : 990.1              Mean   : -91892                
##  3rd Qu.:1599.0              3rd Qu.: -19563                
##  Max.   :2782.4              Max.   :      0                
##                                                             
##  rela_slope_to_lowest_cumsum_invert rela_intercept_to_lowest_cumsum_invert
##  Min.   :0.0003594                  Min.   :  0.00                        
##  1st Qu.:0.0006254                  1st Qu.: 65.67                        
##  Median :0.0013606                  Median : 79.76                        
##  Mean   :0.0066321                  Mean   : 78.57                        
##  3rd Qu.:0.0033568                  3rd Qu.: 94.61                        
##  Max.   :1.0000000                  Max.   :107.22                        
##                                                                           
##  rela_x_intercept opti_lowest_spline_knots    tot_devi      allocate_lowest
##  Min.   :  0.00   Min.   :     0           Min.   :-22823   Min.   :107.9  
##  1st Qu.: 79.01   1st Qu.:  3973           1st Qu.:-18849   1st Qu.:107.9  
##  Median : 98.16   Median : 13521           Median : -9301   Median :107.9  
##  Mean   : 96.11   Mean   : 21151           Mean   : -1672   Mean   :107.9  
##  3rd Qu.:114.36   3rd Qu.: 31587           3rd Qu.:  8764   3rd Qu.:107.9  
##  Max.   :198.59   Max.   :254218           Max.   :231396   Max.   :107.9  
##                                                                            
##  opti_allocate      opti_allocate_total
##  Min.   :  0.0297   Min.   :22823      
##  1st Qu.: 15.9180   1st Qu.:22823      
##  Median : 27.6730   Median :22823      
##  Mean   : 33.9116   Mean   :22823      
##  3rd Qu.: 42.1508   3rd Qu.:22823      
##  Max.   :302.9810   Max.   :22823      
##  NA's   :370                           
## [1] ""
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
## [1] "xxx rho:-25"
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
##      alpha               A              beta              rank_val    
##  Min.   :0.01014   Min.   :73.70   Min.   :0.0009588   Min.   :107.3  
##  1st Qu.:0.01014   1st Qu.:77.73   1st Qu.:0.0009588   1st Qu.:114.2  
##  Median :0.06018   Median :78.45   Median :0.0009588   Median :116.7  
##  Mean   :0.04108   Mean   :78.46   Mean   :0.0009588   Mean   :117.2  
##  3rd Qu.:0.06018   3rd Qu.:79.15   3rd Qu.:0.0009588   3rd Qu.:120.5  
##  Max.   :0.06619   Max.   :84.61   Max.   :0.0009588   Max.   :126.1  
##                                                                       
##     rank_idx      lowest_rank_A  rela_slope_to_lowest rela_intercept_to_lowest
##  Min.   :   1.0   Min.   :73.7   Min.   :0.9125       Min.   :-1055.06        
##  1st Qu.: 261.5   1st Qu.:73.7   1st Qu.:1.0000       1st Qu.: -833.45        
##  Median : 522.0   Median :73.7   Median :1.0000       Median :  -99.67        
##  Mean   : 522.0   Mean   :73.7   Mean   :2.6023       Mean   : -366.22        
##  3rd Qu.: 782.5   3rd Qu.:73.7   3rd Qu.:5.5393       3rd Qu.:  -75.96        
##  Max.   :1043.0   Max.   :73.7   Max.   :5.5393       Max.   :    0.00        
##                                                                               
##  rela_slope_to_lowest_cumsum rela_intercept_to_lowest_cumsum
##  Min.   :   1.0              Min.   :-381972                
##  1st Qu.: 259.5              1st Qu.:-146435                
##  Median : 513.6              Median : -39659                
##  Mean   : 834.7              Mean   : -93578                
##  3rd Qu.:1300.9              3rd Qu.: -16917                
##  Max.   :2714.1              Max.   :      0                
##                                                             
##  rela_slope_to_lowest_cumsum_invert rela_intercept_to_lowest_cumsum_invert
##  Min.   :0.0003684                  Min.   :  0.00                        
##  1st Qu.:0.0007687                  1st Qu.: 65.19                        
##  Median :0.0019471                  Median : 77.22                        
##  Mean   :0.0070255                  Mean   : 86.34                        
##  3rd Qu.:0.0038538                  3rd Qu.:112.56                        
##  Max.   :1.0000000                  Max.   :140.73                        
##                                                                           
##  rela_x_intercept opti_lowest_spline_knots    tot_devi      allocate_lowest
##  Min.   :  0.00   Min.   :     0           Min.   :-22823   Min.   :120.6  
##  1st Qu.: 79.02   1st Qu.:  3588           1st Qu.:-19234   1st Qu.:120.6  
##  Median :108.08   Median : 15848           Median : -6975   Median :120.6  
##  Mean   :112.93   Mean   : 29311           Mean   :  6489   Mean   :120.6  
##  3rd Qu.:151.52   3rd Qu.: 50677           3rd Qu.: 27855   3rd Qu.:120.6  
##  Max.   :215.41   Max.   :202670           Max.   :179848   Max.   :120.6  
##                                                                            
##  opti_allocate      opti_allocate_total
##  Min.   :  0.0912   Min.   :22823      
##  1st Qu.: 26.1823   1st Qu.:22823      
##  Median : 38.5475   Median :22823      
##  Mean   : 38.6822   Mean   :22823      
##  3rd Qu.: 50.8072   3rd Qu.:22823      
##  Max.   :121.4469   Max.   :22823      
##  NA's   :453                           
## [1] ""
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
## [1] "xxx rho:-10"
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
## [1] "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
##      alpha               A              beta              rank_val    
##  Min.   :0.01014   Min.   :73.70   Min.   :0.0009588   Min.   :179.0  
##  1st Qu.:0.01014   1st Qu.:77.73   1st Qu.:0.0009588   1st Qu.:190.1  
##  Median :0.06018   Median :78.45   Median :0.0009588   Median :194.0  
##  Mean   :0.04108   Mean   :78.46   Mean   :0.0009588   Mean   :202.8  
##  3rd Qu.:0.06018   3rd Qu.:79.15   3rd Qu.:0.0009588   3rd Qu.:220.6  
##  Max.   :0.06619   Max.   :84.61   Max.   :0.0009588   Max.   :227.1  
##                                                                       
##     rank_idx      lowest_rank_A  rela_slope_to_lowest rela_intercept_to_lowest
##  Min.   :   1.0   Min.   :73.7   Min.   :0.917        Min.   :-1659.82        
##  1st Qu.: 261.5   1st Qu.:73.7   1st Qu.:1.000        1st Qu.:-1438.21        
##  Median : 522.0   Median :73.7   Median :1.000        Median :  -94.39        
##  Mean   : 522.0   Mean   :73.7   Mean   :2.431        Mean   : -575.93        
##  3rd Qu.: 782.5   3rd Qu.:73.7   3rd Qu.:5.046        3rd Qu.:  -73.43        
##  Max.   :1043.0   Max.   :73.7   Max.   :5.046        Max.   :    0.00        
##                                                                               
##  rela_slope_to_lowest_cumsum rela_intercept_to_lowest_cumsum
##  Min.   :   1.0              Min.   :-600691                
##  1st Qu.: 257.5              1st Qu.:-203379                
##  Median : 505.2              Median : -37596                
##  Mean   : 787.4              Mean   :-129856                
##  3rd Qu.:1221.2              3rd Qu.: -16569                
##  Max.   :2535.6              Max.   :      0                
##                                                             
##  rela_slope_to_lowest_cumsum_invert rela_intercept_to_lowest_cumsum_invert
##  Min.   :0.0003944                  Min.   :  0.00                        
##  1st Qu.:0.0008189                  1st Qu.: 64.34                        
##  Median :0.0019792                  Median : 74.41                        
##  Mean   :0.0070661                  Mean   :109.21                        
##  3rd Qu.:0.0038832                  3rd Qu.:166.54                        
##  Max.   :1.0000000                  Max.   :236.91                        
##                                                                           
##  rela_x_intercept opti_lowest_spline_knots    tot_devi      allocate_lowest
##  Min.   :  0.00   Min.   :     0           Min.   :-22823   Min.   :119.1  
##  1st Qu.: 76.34   1st Qu.:  3091           1st Qu.:-19732   1st Qu.:119.1  
##  Median :102.59   Median : 14234           Median : -8588   Median :119.1  
##  Mean   :162.65   Mean   : 63977           Mean   : 41154   Mean   :119.1  
##  3rd Qu.:285.05   3rd Qu.:144722           3rd Qu.:121899   3rd Qu.:119.1  
##  Max.   :328.97   Max.   :233432           Max.   :210609   Max.   :119.1  
##                                                                            
##  opti_allocate      opti_allocate_total
##  Min.   :  0.0067   Min.   :22823      
##  1st Qu.: 32.2789   1st Qu.:22823      
##  Median : 40.5017   Median :22823      
##  Mean   : 41.7230   Mean   :22823      
##  3rd Qu.: 50.0891   3rd Qu.:22823      
##  Max.   :119.1325   Max.   :22823      
##  NA's   :496</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># lineplot &lt;- tb_opti %&gt;%</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#     gather(variable, value, -month) %&gt;%</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#     ggplot(aes(x=month, y=value, colour=variable, linetype=variable)) +</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#         geom_line() +</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">#         geom_point() +</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#         labs(title = 'Mean and SD of Temperature Acorss US Cities',</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">#              x = 'Months',</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">#              y = 'Temperature in Fahrenheit',</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#              caption = 'Temperature data 2017') +</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#         scale_x_continuous(labels = as.character(df_temp_mth_summ$month),</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">#                            breaks = df_temp_mth_summ$month)</span></a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#outline">Outline</a><ul class="nav nav-pills nav-stacked">
<li><a href="#set-up">Set Up</a></li>
      <li><a href="#get-data-and-regression-results">Get Data and Regression Results</a></li>
      <li><a href="#rename-results-use-linear">Rename Results Use Linear</a></li>
      </ul>
</li>
      <li>
<a href="#optimal-allocations">Optimal Allocations</a><ul class="nav nav-pills nav-stacked">
<li><a href="#common-parameters-for-optimal-allocation">Common Parameters for Optimal Allocation</a></li>
      <li><a href="#optimal-linear-allocation-crs">Optimal Linear Allocation (CRS)</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Fan Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
