<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example Discrete and Bounded-Continuous Optimal Allocation for N=2 • Optimal Allocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example Discrete and Bounded-Continuous Optimal Allocation for N=2">
<meta property="og:description" content="Test Theorem 1 and Theorem 2 optimal allocation functions when N=2.
Use randomly generated A and alpha parameters for two individuals' discrete and bounded-continuous
allocation problems.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92953468-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Optimal Allocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/PrjOptiAlloc.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Tutorials</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue.pdf">Paper</a>
</li>
<li>
  <a href="https://fanwangecon.github.io/assets/FanWang_OptimalTargetingQueue_Present.pdf">Slides</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Sites
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://fanwangecon.github.io/REconTools/">R Tools for Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/R4Econ/">R Examples Data and Optimization</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stat4Econ/">R Examples Introductory Statistics</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Stata4Econ/">Stata Examples Regressions and Tables</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/M4Econ/">Matlab Examples Matrix and Graphs</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Math4Econ/">Matlab Introductory Math for Econ</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/Tex4Econ/">Latex and Paper Generation Examples</a>
    </li>
    <li>
      <a href="https://fanwangecon.github.io/pyfan/">Python Examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://fanwangecon.github.io/">Fan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fanwangecon/PrjOptiAlloc">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fanwangecon">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example Discrete and Bounded-Continuous Optimal Allocation for N=2</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FanWangEcon/PrjOptiAlloc/blob/master/vignettes/ffv_opt_n2_fn.Rmd"><code>vignettes/ffv_opt_n2_fn.Rmd</code></a></small>
      <div class="hidden name"><code>ffv_opt_n2_fn.Rmd</code></div>

    </div>

    
    
<p>Test Theorem 1 and Theorem 2 optimal allocation functions when N=2. Use randomly generated A and alpha parameters for two individuals’ discrete and bounded-continuous allocation problems.</p>
<p>Determine how to optimally allocate resources between two individuals. There are two structures:</p>
<ol style="list-style-type: decimal">
<li>Allocating bounded continuous resources between two indivdiuals, where the effects of resources could be heterogeneous and the costs of resources could differ. This problem is solved by the <a href="https://fanwangecon.github.io/PrjOptiAlloc/reference/ffp_opt_anlyz_rhgin.html">bounded continuous optimal allocation function</a>
</li>
<li>Allocating discrete resources between two individuals, where the effects of each additional unit on each individual is different and the two resources have the same cost. This problem is solved by the <a href="https://fanwangecon.github.io/PrjOptiAlloc/reference/ffp_opt_anlyz_rhgin_dis.html">discrete optimal allocation function</a>.</li>
</ol>
<p>For both problems, we cans solve the optimal allocation problem given different levels of aggregate resources, different planner inequality aversion parameters as well as biases.</p>
<p>The goal below is to generate the data input structure for these two problems in a comparable way. Generate problem solutions by calling the discrete and continuous optimal functions we have created, and generate additional outputs needed to visualize and understand the model solution. The goal is to link the results here to the basics of 2 dimensional indifference and resource sets, and illustrate how the solutions here complete each other, and add to existing results.</p>
<div id="input-and-output" class="section level2">
<h2 class="hasAnchor">
<a href="#input-and-output" class="anchor"></a>Input and Output</h2>
<p>This will be written as a function so that a great variety of cases and situations can be simulated and drawn. Intuitively, on the 2D surface, our objective is to show that choices are constrained in choice windows (choice boxes), there is a choice strike zone, in the continuous case, it is a rectangle, in the discrete case, it is a number of possibly uneven points. There will be a rightward expanding line inside this box, that is the income expansion path. In the discrete case, it is not a line, but traces through a set of points. In the continuous case, it is a line with possible kink (only no kink if disects the diagnol of the choice strike zone exactly). Each point along this line is associated with a different level of value, which is utility given optimal choices.</p>
<p>Note that when marginal effects are linear, strike zone budget lines are not straight but backward bending.</p>
<p>The input for strike zone are:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(A_i\)</span></li>
<li>
<span class="math inline">\(\alpha_i\)</span>, which stands in for price as well, <span class="math inline">\(\frac{\alpha_i}{p_i}\)</span>
</li>
<li>
<span class="math inline">\(\alpha_{il}\)</span>, which generates <span class="math inline">\(A_{il}\)</span> given <span class="math inline">\(A_i\)</span>
</li>
</ol>
<p>The inputs for the expansion expansion path additional includes:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\left\{\lambda\right\}_q\)</span> some vector of preference</li>
<li>
<span class="math inline">\(\left\{W\right\}_q\)</span> some vector of price</li>
</ol>
<p>The outputs of the structure here includes:</p>
<ol style="list-style-type: decimal">
<li>Continuous: A vector of y-intercepts for the continuous strike zone, and one single slope</li>
<li>Discrete: all choice combination points</li>
<li>Vector of <span class="math inline">\(\left\{x^{\ast},y^{\ast},v^{\ast}\right\}_{w, \lambda}\)</span> points for optimal choices as income expands and for different planner preference levels.</li>
</ol>
</div>
<div id="generate-data-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-data-inputs" class="anchor"></a>Generate Data Inputs</h2>
<p>We want to put the continuous and discrete problems in the same scale. They already are by construction, the x and y axis are in terms of <span class="math inline">\(EH_i\)</span> outcomes. The issue is to put the allocations in the same scale. The continuous and discrete inputs should have approximately the same scale in terms of their effects on outcomes. The aggregate effects of choices on outcomes is <span class="math inline">\(\mathcal{A}_i = \sum^{W^{units}}_l A_{i,l}\)</span>, the aggregate effects of the continuous linear input variable is <span class="math inline">\(W^{dollar}\cdot\frac{\alpha_i}{p_i}\)</span>.</p>
<p>For individual <span class="math inline">\(i=1,2\)</span>, one of the two individuals, we can set their total x-axis scale to be the same:</p>
<p><span class="math display">\[\sum^{W^{units}}_l A_{i,l} = W^{dollar}\cdot\frac{\alpha_i}{p_i}\]</span></p>
<p>Given the formulation above, the procedure to generate discrete and continuous consistent marginal effects parameters is:</p>
<ol style="list-style-type: decimal">
<li>Start with <span class="math inline">\(W^{dollar}\)</span>, and draw <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(p\)</span> from somewhat tightly bounded uniform distribution, so they are not too different.</li>
<li>Pick any <span class="math inline">\(W^{units}\)</span>, draw uniformly <span class="math inline">\(A_{il}\)</span> for both <span class="math inline">\(i=1\)</span> and <span class="math inline">\(i=2\)</span>, they must sum up to the right hand side.</li>
</ol>
<p>Now there are <span class="math inline">\(\frac{\alpha_i}{p_i}\)</span> as well as <span class="math inline">\(A_{il}\)</span>. The aggregate effects of allocating all discrete inputs for one individual, and the aggregate effects of allocating all continuous inputs for one individual on outcome for that individual are the same. This makes the discrete and continuous comparison on the same figure possible.</p>
<p>Write this as a function so that we can easily generate additional examples. The function should be able to output for more than two individuals, any number of individuals for testing.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">ffi_draw_n_alpha</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">fl_w_dollar</span> <span class="kw">=</span> <span class="fl">100</span>,
                             <span class="no">it_w_units_avg</span> <span class="kw">=</span> <span class="fl">5</span>,
                             <span class="no">fl_eh_max_inc_i</span> <span class="kw">=</span> <span class="fl">5</span>,
                             <span class="no">fl_min_max_eh_inc_ratio</span> <span class="kw">=</span> <span class="fl">1.5</span>,
                             <span class="no">fl_disc_cts_match_ratio</span> <span class="kw">=</span> <span class="fl">1.1</span>,
                             <span class="no">fl_A_i_alpha_i1_ratio</span> <span class="kw">=</span> <span class="fl">2</span>,
                             <span class="no">fl_A_i_relative_ratio</span> <span class="kw">=</span> <span class="fl">3</span>,
                             <span class="no">it_N</span> <span class="kw">=</span> <span class="fl">2</span>,
                             <span class="no">it_rand_seed</span> <span class="kw">=</span> <span class="fl">123</span>){
  <span class="co">#' @param it_w_units_avg float number of goods for cts at max, approxi number for dis</span>
  <span class="co">#' @param fl_eh_max_inc_i1 float maximum increase EH for one individual</span>
  <span class="co">#' @param fl_min_max_eh_inc_ratio float ratio of maximum and minimum outcome increase</span>
  <span class="co">#' @param it_N integer the number of individuals</span>
  <span class="co">#' @param fl_disc_cts_match_ratio float if 1, disc unit = it_w_units_avg</span>
  <span class="co">#' @param fl_A_i_alpha_i1_ratio float A_i divide the alphi_il ratio, discrete set this</span>

  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="no">it_rand_seed</span>)

  <span class="co"># Let price be the same, does not matter, only marginal effect over price ratio matters</span>
  <span class="no">fl_price</span> <span class="kw">&lt;-</span> <span class="no">fl_w_dollar</span>/<span class="no">it_w_units_avg</span>
  <span class="no">fl_cts_alpha_max</span> <span class="kw">&lt;-</span> ((<span class="no">fl_eh_max_inc_i</span>*<span class="no">fl_price</span>)/<span class="no">fl_w_dollar</span>)
  <span class="no">fl_cts_alpha_min</span> <span class="kw">&lt;-</span> <span class="no">fl_cts_alpha_max</span>/<span class="no">fl_min_max_eh_inc_ratio</span>

  <span class="co"># Generate two individuals at min and max, otherwise draw randomly between them as well</span>
  <span class="kw">if</span> (<span class="no">it_N</span> <span class="kw">==</span> <span class="fl">1</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Need to draw for at least two individuals"</span>)
  } <span class="kw">else</span> {
    <span class="no">ar_cts_alpha</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">fl_cts_alpha_min</span>, <span class="no">fl_cts_alpha_max</span>)
    <span class="kw">if</span> (<span class="no">it_N</span> <span class="kw">&gt;</span> <span class="fl">2</span>) {
      <span class="no">ar_cts_alpha_more</span> <span class="kw">&lt;-</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>((<span class="no">it_N</span>-<span class="fl">2</span>), <span class="kw">min</span><span class="kw">=</span><span class="no">fl_cts_alpha_min</span>, <span class="kw">max</span><span class="kw">=</span><span class="no">fl_cts_alpha_max</span>)
      <span class="no">ar_cts_alpha</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_cts_alpha</span>, <span class="no">ar_cts_alpha_more</span>)
    }
    <span class="no">ar_cts_alpha</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">ar_cts_alpha</span>, <span class="kw">decreasing</span><span class="kw">=</span><span class="fl">TRUE</span>)
  }

  <span class="co"># Aggregate W for Discrete</span>
  <span class="no">ar_A_i_sum</span> <span class="kw">&lt;-</span> <span class="no">fl_w_dollar</span>*(<span class="no">ar_cts_alpha</span>/<span class="no">fl_price</span>)

  <span class="co"># Draw A_il</span>
  <span class="no">ar_it_w_units</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">it_w_units_avg</span>/<span class="no">fl_disc_cts_match_ratio</span>,
        <span class="no">it_w_units_avg</span>*<span class="no">fl_disc_cts_match_ratio</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="no">it_N</span>)),
    <span class="no">it_N</span>, <span class="kw">replace</span><span class="kw">=</span><span class="fl">TRUE</span>)

  <span class="co"># Genereate alpha_il</span>
  <span class="no">ls_ar_alpha_il</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_it_w_units</span>, <span class="no">ar_A_i_sum</span>),
    <span class="fl">1</span>,
    <span class="kw">function</span>(<span class="no">row</span>, <span class="no">min</span>, <span class="no">max</span>) {
      <span class="no">it_draw</span> <span class="kw">&lt;-</span> <span class="no">row</span>[<span class="fl">1</span>]
      <span class="no">fl_sum</span> <span class="kw">&lt;-</span> <span class="no">row</span>[<span class="fl">2</span>]
      <span class="no">ar_unif</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">it_draw</span>,
                       <span class="kw">min</span><span class="kw">=</span><span class="no">fl_cts_alpha_min</span>,
                       <span class="kw">max</span><span class="kw">=</span><span class="no">fl_cts_alpha_max</span>)
      <span class="no">ar_unif</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="no">ar_unif</span>, <span class="kw">decreasing</span><span class="kw">=</span><span class="fl">TRUE</span>)
      <span class="no">ar_share</span> <span class="kw">&lt;-</span> <span class="no">ar_unif</span>/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">ar_unif</span>)
      <span class="no">ar_levels</span> <span class="kw">&lt;-</span> (<span class="no">ar_share</span>*<span class="no">fl_sum</span>*<span class="no">fl_disc_cts_match_ratio</span>)
      <span class="no">ar_share</span> <span class="kw">&lt;-</span> <span class="no">ar_share</span>[<span class="no">ar_levels</span> <span class="kw">&lt;</span> <span class="no">fl_sum</span>]
      <span class="no">ar_levels</span> <span class="kw">&lt;-</span> <span class="no">ar_levels</span>[<span class="no">ar_levels</span> <span class="kw">&lt;</span> <span class="no">fl_sum</span>]
      <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">ar_share</span><span class="kw">=</span><span class="no">ar_share</span>,
                  <span class="kw">ar_levels</span><span class="kw">=</span><span class="no">ar_levels</span>))
    })

  <span class="co"># Print All</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="no">ls_ar_alpha_il</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="no">fl_w_dollar</span>/<span class="no">fl_price</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">it_N</span>), <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">ls_ar_alpha_il</span><span class="kw">[[</span><span class="no">x</span>]]$<span class="no">ar_levels</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>((<span class="no">fl_w_dollar</span>*<span class="no">ar_cts_alpha</span>)/<span class="no">fl_price</span>)

  <span class="co"># Generate A_i that are consistent with alpha_i scales</span>
  <span class="co"># randomly draw two individual N2 where the differences is 2x of A_il</span>
  <span class="co"># Average of alpha_i1 of all individuals</span>
  <span class="no">fl_alpha_i1_avg</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">it_N</span>), <span class="kw">function</span>(<span class="no">x</span>) <span class="no">ls_ar_alpha_il</span><span class="kw">[[</span><span class="no">x</span>]]$<span class="no">ar_levels</span>[<span class="fl">1</span>]))
  <span class="co"># Average of A_i</span>
  <span class="co"># C:\Users\fan\R4Econ\math\solutions\fs_solu_x_lin.Rmd</span>
  <span class="no">fl_a</span> <span class="kw">&lt;-</span> <span class="no">fl_A_i_relative_ratio</span>
  <span class="no">fl_b</span> <span class="kw">&lt;-</span> <span class="no">fl_alpha_i1_avg</span>
  <span class="no">fl_A_i_gap</span> <span class="kw">=</span> (<span class="no">fl_b</span>*(<span class="no">fl_a</span> - <span class="fl">1</span>))/(<span class="fl">1</span> + <span class="no">fl_a</span>)
  <span class="no">ar_A_i</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">it_N</span>,<span class="kw">min</span><span class="kw">=</span><span class="no">fl_b</span> - <span class="no">fl_A_i_gap</span>, <span class="kw">max</span><span class="kw">=</span><span class="no">fl_b</span> + <span class="no">fl_A_i_gap</span>)

  <span class="co"># return otuputs</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">ar_A_i</span> <span class="kw">=</span> <span class="no">ar_A_i</span>,
              <span class="kw">ls_ar_alpha_il</span><span class="kw">=</span><span class="no">ls_ar_alpha_il</span>,
              <span class="kw">fl_price</span> <span class="kw">=</span> <span class="no">fl_price</span>,
              <span class="kw">ar_cts_alpha</span> <span class="kw">=</span> <span class="no">ar_cts_alpha</span>,
              <span class="kw">it_rand_seed</span><span class="kw">=</span><span class="no">it_rand_seed</span>))
}

<span class="co"># Call Function</span>
<span class="co"># ls_out_n4 &lt;- suppressMessages(ffi_draw_n_alpha(it_N = 4))</span>
<span class="co"># if called function without seed first, it_rand_seed fixed</span>
<span class="no">it_rand_seed</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">10</span>^<span class="fl">7</span>, <span class="fl">1</span>, <span class="kw">replace</span><span class="kw">=</span><span class="no">T</span>)
<span class="no">fl_w_dollar</span> <span class="kw">=</span> <span class="fl">100</span>
<span class="no">it_rand_seed</span> <span class="kw">&lt;-</span> <span class="fl">4596553</span>
<span class="no">it_N</span> <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">ls_out_n2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
  <span class="fu">ffi_draw_n_alpha</span>(<span class="kw">fl_w_dollar</span><span class="kw">=</span><span class="no">fl_w_dollar</span>,
                   <span class="kw">it_N</span> <span class="kw">=</span> <span class="no">it_N</span>, <span class="kw">it_rand_seed</span><span class="kw">=</span><span class="no">it_rand_seed</span>))
<span class="no">ls_out_n2</span></pre></body></html></div>
<pre><code>## $ar_A_i
## [1] 0.9479133 0.5343949
## 
## $ls_ar_alpha_il
## $ls_ar_alpha_il[[1]]
## $ls_ar_alpha_il[[1]]$ar_share
## [1] 0.2196900 0.2078849 0.2035559 0.1901881 0.1786811
## 
## $ls_ar_alpha_il[[1]]$ar_levels
## [1] 1.208295 1.143367 1.119558 1.046035 0.982746
## 
## 
## $ls_ar_alpha_il[[2]]
## $ls_ar_alpha_il[[2]]$ar_share
## [1] 0.2038343 0.1900006 0.1645504 0.1526126 0.1467636 0.1422386
## 
## $ls_ar_alpha_il[[2]]$ar_levels
## [1] 0.7473925 0.6966687 0.6033514 0.5595795 0.5381332 0.5215414
## 
## 
## 
## $fl_price
## [1] 20
## 
## $ar_cts_alpha
## [1] 1.0000000 0.6666667
## 
## $it_rand_seed
## [1] 4596553</code></pre>
<div id="generate-a-and-alpha" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-a-and-alpha" class="anchor"></a>Generate A and alpha</h3>
<p>These parameters persist and are used throughout the rest of the file for allocation allocations. Parameters are more or less shared by discrete and continuous parameters.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">spt_img_save</span> <span class="kw">&lt;-</span> <span class="st">'../_img/'</span>
<span class="no">spt_img_save_draft</span> <span class="kw">&lt;-</span> <span class="st">'C:/Users/fan/Documents/Dropbox (UH-ECON)/repos/HgtOptiAlloDraft/_img/'</span></pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># Draw data</span>
<span class="no">fl_beta_1</span> <span class="kw">=</span> <span class="fl">0.5</span>
<span class="no">fl_beta_2</span> <span class="kw">=</span> <span class="fl">1</span>-<span class="no">fl_beta_1</span>
<span class="no">fl_w_dollar</span> <span class="kw">=</span> <span class="fl">100</span>
<span class="no">it_w_units_avg</span> <span class="kw">=</span> <span class="fl">5</span>
<span class="no">it_rand_seed</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">10</span>^<span class="fl">7</span>, <span class="fl">1</span>, <span class="kw">replace</span><span class="kw">=</span><span class="no">T</span>)

<span class="no">it_w_units_avg</span> <span class="kw">=</span> <span class="fl">5</span>
<span class="no">it_rand_seed</span> <span class="kw">&lt;-</span> <span class="fl">8135788</span>

<span class="co"># it_w_units_avg = 5</span>
<span class="co"># it_rand_seed &lt;- 1234</span>

<span class="co"># it_w_units_avg = 4</span>
<span class="co"># it_rand_seed &lt;- 449879812</span>

<span class="no">it_N</span> <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">ls_out_n2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
  <span class="fu">ffi_draw_n_alpha</span>(<span class="kw">fl_w_dollar</span><span class="kw">=</span><span class="no">fl_w_dollar</span>,
                   <span class="kw">it_w_units_avg</span><span class="kw">=</span><span class="no">it_w_units_avg</span>,
                   <span class="kw">it_N</span> <span class="kw">=</span> <span class="no">it_N</span>, <span class="kw">it_rand_seed</span><span class="kw">=</span><span class="no">it_rand_seed</span>))

<span class="co"># Translate to 2D budget indiff units</span>
<span class="co"># fl_e = endowment points</span>
<span class="no">fl_A_1</span> <span class="kw">=</span> <span class="no">ls_out_n2</span>$<span class="no">ar_A_i</span>[<span class="fl">1</span>]
<span class="no">fl_A_2</span> <span class="kw">=</span> <span class="no">ls_out_n2</span>$<span class="no">ar_A_i</span>[<span class="fl">2</span>]
<span class="co"># fl_alpha_1l = alpha_il</span>
<span class="co"># fl_eh_alloc_il = outcome at alloations</span>
<span class="no">ar_alpha_1l</span> <span class="kw">=</span> <span class="no">ls_out_n2</span>$<span class="no">ls_ar_alpha_il</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">ar_levels</span>
<span class="no">ar_alpha_2l</span> <span class="kw">=</span> <span class="no">ls_out_n2</span>$<span class="no">ls_ar_alpha_il</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">ar_levels</span>
<span class="no">ar_alpha_1l_zr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="no">ls_out_n2</span>$<span class="no">ls_ar_alpha_il</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">ar_levels</span>)
<span class="no">ar_alpha_2l_zr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="no">ls_out_n2</span>$<span class="no">ls_ar_alpha_il</span><span class="kw">[[</span><span class="fl">2</span>]]$<span class="no">ar_levels</span>)
<span class="no">ar_A_1l</span> <span class="kw">&lt;-</span> <span class="no">fl_A_1</span> + <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">ar_alpha_1l_zr</span>, -<span class="fl">1</span>))
<span class="no">ar_A_2l</span> <span class="kw">&lt;-</span> <span class="no">fl_A_2</span> + <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">ar_alpha_2l_zr</span>, -<span class="fl">1</span>))
<span class="no">ar_eh_1l_zr</span> <span class="kw">&lt;-</span> <span class="no">fl_A_1</span> + <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="no">ar_alpha_1l_zr</span>)
<span class="no">ar_eh_2l_zr</span> <span class="kw">&lt;-</span> <span class="no">fl_A_2</span> + <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="no">ar_alpha_2l_zr</span>)
<span class="no">it_D_1l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_1l</span>)
<span class="no">it_D_2l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_2l</span>)
<span class="co"># Max Discrete Choice After which budget outside of choice strike zone fully</span>
<span class="no">it_w_max</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_1l</span>) + <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_2l</span>)
<span class="no">ar_w_solve_at_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="no">it_w_max</span>)

<span class="co"># Continuous</span>
<span class="no">fl_alpha_1</span> <span class="kw">=</span> <span class="no">ls_out_n2</span>$<span class="no">ar_cts_alpha</span>[<span class="fl">1</span>]
<span class="no">fl_alpha_2</span> <span class="kw">=</span> <span class="no">ls_out_n2</span>$<span class="no">ar_cts_alpha</span>[<span class="fl">2</span>]
<span class="no">fl_price</span> <span class="kw">=</span> <span class="no">ls_out_n2</span>$<span class="no">fl_price</span>
<span class="co"># continuous choice use discrete max as bounds</span>
<span class="no">fl_D_max_1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_1l</span>)
<span class="no">fl_D_max_2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_2l</span>)
<span class="no">fl_EH_max_1</span> <span class="kw">=</span> <span class="no">fl_A_1</span> + <span class="no">fl_D_max_1</span>*<span class="no">fl_alpha_1</span>
<span class="no">fl_EH_max_2</span> <span class="kw">=</span> <span class="no">fl_A_2</span> + <span class="no">fl_D_max_2</span>*<span class="no">fl_alpha_2</span>
<span class="co"># max_dollar</span>
<span class="no">fl_w_dollar_max</span> <span class="kw">=</span> <span class="no">fl_price</span>*<span class="no">it_w_max</span>
<span class="no">ar_w_dollars_strike_at_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="no">fl_w_dollar_max</span>, <span class="kw">length.out</span><span class="kw">=</span>(<span class="no">it_w_max</span>+<span class="fl">1</span>))
<span class="no">ar_w_dollars_solve_at_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="no">fl_w_dollar_max</span>, <span class="kw">length.out</span><span class="kw">=</span>(<span class="no">it_w_max</span>*<span class="fl">6</span>)+<span class="fl">1</span>)

<span class="co"># print</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'it_rand_seed:'</span>,<span class="no">it_rand_seed</span>))</pre></body></html></div>
<pre><code>## [1] "it_rand_seed:8135788"</code></pre>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'fl_A_1:'</span>, <span class="no">fl_A_1</span>, <span class="st">',fl_A_2:'</span>, <span class="no">fl_A_2</span>))</pre></body></html></div>
<pre><code>## [1] "fl_A_1:1.21673425481374,fl_A_2:0.958163167726895"</code></pre>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'fl_alpha_1:'</span>, <span class="no">fl_A_1</span>, <span class="st">',fl_alpha_2:'</span>, <span class="no">fl_A_2</span>))</pre></body></html></div>
<pre><code>## [1] "fl_alpha_1:1.21673425481374,fl_alpha_2:0.958163167726895"</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'ar_alpha_1l:'</span>, <span class="no">ar_alpha_1l</span>))</pre></body></html></div>
<pre><code>## [1] "ar_alpha_1l:1.10258826611402"  "ar_alpha_1l:0.998256934864124"
## [3] "ar_alpha_1l:0.974318847935741" "ar_alpha_1l:0.832411817148815"
## [5] "ar_alpha_1l:0.809088128226687" "ar_alpha_1l:0.783336005710612"</code></pre>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'ar_alpha_2l:'</span>, <span class="no">ar_alpha_2l</span>))</pre></body></html></div>
<pre><code>## [1] "ar_alpha_2l:0.862318390675336" "ar_alpha_2l:0.812810517766219"
## [3] "ar_alpha_2l:0.731285183772518" "ar_alpha_2l:0.680349434537137"
## [5] "ar_alpha_2l:0.579903139915456"</code></pre>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'ar_A_1l:'</span>, <span class="no">ar_A_1l</span>))</pre></body></html></div>
<pre><code>## [1] "ar_A_1l:1.21673425481374" "ar_A_1l:2.31932252092777"
## [3] "ar_A_1l:3.31757945579189" "ar_A_1l:4.29189830372763"
## [5] "ar_A_1l:5.12431012087645" "ar_A_1l:5.93339824910313"</code></pre>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'ar_A_2l:'</span>, <span class="no">ar_A_2l</span>))</pre></body></html></div>
<pre><code>## [1] "ar_A_2l:0.958163167726895" "ar_A_2l:1.82048155840223" 
## [3] "ar_A_2l:2.63329207616845"  "ar_A_2l:3.36457725994097" 
## [5] "ar_A_2l:4.04492669447811"</code></pre>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'ar_eh_1l_zr:'</span>, <span class="no">ar_eh_1l_zr</span>))</pre></body></html></div>
<pre><code>## [1] "ar_eh_1l_zr:1.21673425481374" "ar_eh_1l_zr:2.31932252092777"
## [3] "ar_eh_1l_zr:3.31757945579189" "ar_eh_1l_zr:4.29189830372763"
## [5] "ar_eh_1l_zr:5.12431012087645" "ar_eh_1l_zr:5.93339824910313"
## [7] "ar_eh_1l_zr:6.71673425481375"</code></pre>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'ar_eh_2l_zr:'</span>, <span class="no">ar_eh_2l_zr</span>))</pre></body></html></div>
<pre><code>## [1] "ar_eh_2l_zr:0.958163167726895" "ar_eh_2l_zr:1.82048155840223" 
## [3] "ar_eh_2l_zr:2.63329207616845"  "ar_eh_2l_zr:3.36457725994097" 
## [5] "ar_eh_2l_zr:4.04492669447811"  "ar_eh_2l_zr:4.62482983439356"</code></pre>
</div>
</div>
<div id="feasible-allocation-and-utility" class="section level2">
<h2 class="hasAnchor">
<a href="#feasible-allocation-and-utility" class="anchor"></a>Feasible Allocation and Utility</h2>
<p>In this section, we generate all possible combinations of feasible allocation across these two individuals, and also indifference curve points combinations at each choice points.</p>
<div id="discrete-resource-exhausting-allocation-points" class="section level3">
<h3 class="hasAnchor">
<a href="#discrete-resource-exhausting-allocation-points" class="anchor"></a>Discrete Resource Exhausting Allocation Points</h3>
<p>Given aggregate units of resources, from 1 to <em>it_w_units_avg</em>.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">ls_mt_strike_eh_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="kw">mode</span> <span class="kw">=</span> <span class="st">"list"</span>, <span class="kw">length</span> <span class="kw">=</span> <span class="no">it_w_units_avg</span>)

<span class="kw">for</span> (<span class="no">it_w</span> <span class="kw">in</span> <span class="no">ar_w_solve_at_disc</span>){

  <span class="no">ar_cur_w_ehlt_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>()
  <span class="no">ar_cur_w_unit_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>()

  <span class="kw">for</span> (<span class="no">it_1l</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_1l_zr</span>))){
    <span class="no">fl_eh_1l</span> <span class="kw">&lt;-</span> <span class="no">ar_eh_1l_zr</span>[<span class="no">it_1l</span>]

    <span class="kw">for</span> (<span class="no">it_2l</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_alpha_2l_zr</span>))){
      <span class="no">fl_eh_2l</span> <span class="kw">&lt;-</span> <span class="no">ar_eh_2l_zr</span>[<span class="no">it_2l</span>]

      <span class="co"># included alloca = 0 at L162</span>
      <span class="no">it_1l_2l_sum</span> <span class="kw">&lt;-</span> (<span class="no">it_1l</span>-<span class="fl">1</span>) + (<span class="no">it_2l</span>-<span class="fl">1</span>)
      <span class="kw">if</span> (<span class="no">it_1l_2l_sum</span> <span class="kw">==</span> <span class="no">it_w</span>){
        <span class="co"># at this point, EH_1 and EH_2</span>

        <span class="co"># Aggregate Resource is Fully Distributed</span>
        <span class="no">ar_cur_w_ehlt_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_cur_w_ehlt_combo</span>, <span class="no">fl_eh_1l</span>, <span class="no">fl_eh_2l</span>)
        <span class="no">ar_cur_w_unit_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_cur_w_unit_combo</span>, <span class="no">it_1l</span>-<span class="fl">1</span>, <span class="no">it_2l</span>-<span class="fl">1</span>)

      }
    }
  }

  <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">ar_cur_w_ehlt_combo</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_cur_w_ehlt_combo</span>)/<span class="fl">2</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">ar_cur_w_unit_combo</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_cur_w_unit_combo</span>)/<span class="fl">2</span>)
  <span class="no">mt_strike_eh_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">it_w</span>*<span class="no">fl_price</span>, <span class="no">it_w</span>,
                             <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">ar_cur_w_ehlt_combo</span>),
                             <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">ar_cur_w_unit_combo</span>))
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_strike_eh_disc</span>) <span class="kw">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'w_dollars'</span>, <span class="st">'w_units'</span>, <span class="st">'EH_1l'</span>, <span class="st">'EH_2l'</span>, <span class="st">'D_1l'</span>, <span class="st">'D_2l'</span>)
  <span class="no">ls_mt_strike_eh_disc</span><span class="kw">[[</span><span class="no">it_w</span>]] <span class="kw">&lt;-</span> <span class="no">mt_strike_eh_disc</span>

}

<span class="no">tb_strike_eh_disc_all</span> <span class="kw">&lt;-</span>
  <span class="fu">as_tibble</span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="no">ls_mt_strike_eh_disc</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">vartype</span> <span class="kw">=</span> <span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outtype</span> <span class="kw">=</span> <span class="st">'strike'</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">tb_strike_eh_disc_all</span>)</pre></body></html></div>
<pre><code>## # A tibble: 41 x 8
##    w_dollars w_units EH_1l EH_2l  D_1l  D_2l vartype  outtype
##        &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  
##  1        20       1  1.22 1.82      0     1 discrete strike 
##  2        20       1  2.32 0.958     1     0 discrete strike 
##  3        40       2  1.22 2.63      0     2 discrete strike 
##  4        40       2  2.32 1.82      1     1 discrete strike 
##  5        40       2  3.32 0.958     2     0 discrete strike 
##  6        60       3  1.22 3.36      0     3 discrete strike 
##  7        60       3  2.32 2.63      1     2 discrete strike 
##  8        60       3  3.32 1.82      2     1 discrete strike 
##  9        60       3  4.29 0.958     3     0 discrete strike 
## 10        80       4  1.22 4.04      0     4 discrete strike 
## # ... with 31 more rows</code></pre>
</div>
<div id="continuous-choice-strike-zone" class="section level3">
<h3 class="hasAnchor">
<a href="#continuous-choice-strike-zone" class="anchor"></a>Continuous Choice Strike Zone</h3>
<p>The continuous choice strike zone for the CRS problem with bounded choices is a box with straight downward sloping lines through representing budget lines. All lines are parallel to each other. We are interseted in the intercepts and slopes. Slopes are all the same, so just the intercepts. There is a smooth set of intercepts, but for graphing etc, we only need a finite set of lines representing the discrete problem’s resource points. And we need the bounding corner values.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co"># assume 1 is the x-axis and 2 is the y-axis</span>
<span class="no">ffi_cts_strike_crs_slope_intercept</span> <span class="kw">&lt;-</span>
  <span class="kw">function</span>(<span class="no">fl_w</span>, <span class="no">fl_alpha_price_rat_1</span>, <span class="no">fl_alpha_price_rat_2</span>, <span class="no">fl_A_1</span>, <span class="no">fl_A_2</span>) {

    <span class="no">fl_slope</span> <span class="kw">=</span>
      (-<span class="fl">1</span>)*(<span class="no">fl_alpha_price_rat_2</span>/<span class="no">fl_alpha_price_rat_1</span>)

    <span class="no">fl_intercept</span> <span class="kw">=</span>
      <span class="no">fl_w</span>*<span class="no">fl_alpha_price_rat_2</span> +
      (<span class="no">fl_alpha_price_rat_2</span>/<span class="no">fl_alpha_price_rat_1</span>)*<span class="no">fl_A_1</span> +
      <span class="no">fl_A_2</span>

    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">fl_slope</span><span class="kw">=</span><span class="no">fl_slope</span>, <span class="kw">fl_intercept</span><span class="kw">=</span><span class="no">fl_intercept</span>))
  }</pre></body></html></div>
<p>Call the continuous slope generator.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># Define Marginal Effects and Price Ratios</span>
<span class="no">fl_alpha_price_rat_1</span> <span class="kw">&lt;-</span> <span class="no">fl_alpha_1</span>/<span class="no">fl_price</span>
<span class="no">fl_alpha_price_rat_2</span> <span class="kw">&lt;-</span> <span class="no">fl_alpha_2</span>/<span class="no">fl_price</span>

<span class="co"># Continuous slope generator</span>
<span class="no">ls_ar_draws_shares</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">ar_w_dollars_strike_at_disc</span>,
                            <span class="no">ffi_cts_strike_crs_slope_intercept</span>,
                            <span class="kw">fl_alpha_price_rat_1</span><span class="kw">=</span><span class="no">fl_alpha_price_rat_1</span>,
                            <span class="kw">fl_alpha_price_rat_2</span><span class="kw">=</span><span class="no">fl_alpha_price_rat_2</span>,
                            <span class="kw">fl_A_1</span><span class="kw">=</span><span class="no">fl_A_1</span>,
                            <span class="kw">fl_A_2</span><span class="kw">=</span><span class="no">fl_A_2</span>)
<span class="no">mt_ar_draws_shares</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_w_dollars_strike_at_disc</span>, <span class="fu">as_tibble</span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">ls_ar_draws_shares</span>)) <span class="kw">%&gt;%</span> <span class="fu">unnest</span>()) <span class="kw">%&gt;%</span>
  <span class="fu">rowid_to_column</span>(<span class="kw">var</span> <span class="kw">=</span> <span class="st">"row_ctr"</span>)</pre></body></html></div>
<pre><code>## Warning: `cols` is now required when using unnest().
## Please use `cols = c(fl_slope, fl_intercept)`</code></pre>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># Print results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">mt_ar_draws_shares</span>)</pre></body></html></div>
<pre><code>##    row_ctr ar_w_dollars_strike_at_disc   fl_slope fl_intercept
## 1        1                           0 -0.6666667     1.769319
## 2        2                          20 -0.6666667     2.435986
## 3        3                          40 -0.6666667     3.102653
## 4        4                          60 -0.6666667     3.769319
## 5        5                          80 -0.6666667     4.435986
## 6        6                         100 -0.6666667     5.102653
## 7        7                         120 -0.6666667     5.769319
## 8        8                         140 -0.6666667     6.435986
## 9        9                         160 -0.6666667     7.102653
## 10      10                         180 -0.6666667     7.769319
## 11      11                         200 -0.6666667     8.435986
## 12      12                         220 -0.6666667     9.102653</code></pre>
<p>A grid of x-points and corresponding y-points at each of the slopes</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">ls_mt_strike_eh_cts</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">mt_ar_draws_shares</span>, <span class="fl">1</span>,
        <span class="kw">function</span>(<span class="no">row</span>) {
          <span class="no">it_row_ctr</span> <span class="kw">&lt;-</span> <span class="no">row</span>[<span class="fl">1</span>]
          <span class="no">fl_w_dollars</span> <span class="kw">&lt;-</span> <span class="no">row</span>[<span class="fl">2</span>]
          <span class="no">fl_slope</span> <span class="kw">&lt;-</span> <span class="no">row</span>[<span class="fl">3</span>]
          <span class="no">fl_intercept</span> <span class="kw">&lt;-</span> <span class="no">row</span>[<span class="fl">4</span>]
          <span class="no">ar_EH1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">fl_A_1</span>, <span class="no">fl_EH_max_1</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="fl">100</span>)
          <span class="no">ar_EH2</span> <span class="kw">&lt;-</span> <span class="no">fl_intercept</span> + <span class="no">fl_slope</span>*<span class="no">ar_EH1</span>

          <span class="no">ar_EH1</span> <span class="kw">&lt;-</span> <span class="no">ar_EH1</span>[<span class="no">ar_EH2</span><span class="kw">&lt;=</span><span class="no">fl_EH_max_2</span>]
          <span class="no">ar_EH2</span> <span class="kw">&lt;-</span> <span class="no">ar_EH2</span>[<span class="no">ar_EH2</span><span class="kw">&lt;=</span><span class="no">fl_EH_max_2</span>]

          <span class="no">ar_EH1</span> <span class="kw">&lt;-</span> <span class="no">ar_EH1</span>[<span class="no">ar_EH2</span><span class="kw">&gt;=</span><span class="no">fl_A_2</span>]
          <span class="no">ar_EH2</span> <span class="kw">&lt;-</span> <span class="no">ar_EH2</span>[<span class="no">ar_EH2</span><span class="kw">&gt;=</span><span class="no">fl_A_2</span>]

          <span class="no">ar_D_1l</span> <span class="kw">&lt;-</span> (<span class="no">ar_EH1</span> - <span class="no">fl_A_1</span>)/<span class="no">fl_alpha_1</span>
          <span class="no">ar_D_2l</span> <span class="kw">&lt;-</span> (<span class="no">ar_EH2</span> - <span class="no">fl_A_2</span>)/<span class="no">fl_alpha_2</span>

          <span class="no">fl_w_units</span> <span class="kw">&lt;-</span> (<span class="no">fl_w_dollars</span>/(<span class="no">fl_price</span>))
          <span class="no">mt_strike_eh_cts</span> <span class="kw">&lt;-</span>
            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">fl_w_dollars</span>, <span class="no">fl_w_units</span>,
                  <span class="no">ar_EH1</span>, <span class="no">ar_EH2</span>, <span class="no">ar_D_1l</span>, <span class="no">ar_D_2l</span>)
          <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">mt_strike_eh_cts</span>) <span class="kw">&lt;-</span> <span class="kw">NULL</span>

          <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_strike_eh_cts</span>) <span class="kw">&lt;-</span>
            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'w_dollars'</span>, <span class="st">'w_units'</span>,
              <span class="st">'EH_1l'</span>, <span class="st">'EH_2l'</span>, <span class="st">'D_1l'</span>, <span class="st">'D_2l'</span>)

          <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">mt_strike_eh_cts</span>)
        })

<span class="no">tb_strike_eh_cts_all</span> <span class="kw">&lt;-</span>
  <span class="fu">as_tibble</span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="no">ls_mt_strike_eh_cts</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">vartype</span> <span class="kw">=</span> <span class="st">'continuous'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outtype</span> <span class="kw">=</span> <span class="st">'strike'</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb_strike_eh_cts_all</span>, <span class="fl">10</span>))</pre></body></html></div>
<pre><code>## # A tibble: 10 x 8
##    w_dollars w_units EH_1l EH_2l   D_1l  D_2l vartype    outtype
##        &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;  
##  1         0       0  1.22 0.958 0      0     continuous strike 
##  2        20       1  1.22 1.62  0      1.    continuous strike 
##  3        20       1  1.28 1.58  0.0606 0.939 continuous strike 
##  4        20       1  1.34 1.54  0.121  0.879 continuous strike 
##  5        20       1  1.40 1.50  0.182  0.818 continuous strike 
##  6        20       1  1.46 1.46  0.242  0.758 continuous strike 
##  7        20       1  1.52 1.42  0.303  0.697 continuous strike 
##  8        20       1  1.58 1.38  0.364  0.636 continuous strike 
##  9        20       1  1.64 1.34  0.424  0.576 continuous strike 
## 10        20       1  1.70 1.30  0.485  0.515 continuous strike</code></pre>
</div>
</div>
<div id="optimal-choices" class="section level2">
<h2 class="hasAnchor">
<a href="#optimal-choices" class="anchor"></a>Optimal Choices</h2>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">fl_dis_w</span> <span class="kw">&lt;-</span> (<span class="no">it_w_units_avg</span> + <span class="fl">1</span>)
<span class="no">fl_cts_w</span> <span class="kw">&lt;-</span> <span class="no">fl_dis_w</span> <span class="co"># common price</span>
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, -<span class="fl">5</span>)
<span class="no">ar_rho</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.99</span>, -<span class="fl">0.01</span>, -<span class="fl">100</span>)
<span class="co"># ar_rho &lt;- c(0.99, -0.01, -6)</span>
<span class="co"># ar_rho &lt;- 1 - (10^(c(seq(-2,2, length.out=20))))</span></pre></body></html></div>
<div id="optimal-discrete-choices" class="section level3">
<h3 class="hasAnchor">
<a href="#optimal-discrete-choices" class="anchor"></a>Optimal Discrete Choices</h3>
<p>Given <span class="math inline">\(A_i\)</span> and <span class="math inline">\(\alpha_{il}\)</span>, solve for optimal discrete allocation</p>
<p>Build up discrete input frame</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="co"># ID and max Discrete Allocation</span>
<span class="no">mt_i_D</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">it_D_1l</span>, <span class="no">it_D_2l</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_i_D</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'id_i'</span>, <span class="st">'D_max_i'</span>)
<span class="no">tb_i_D</span> <span class="kw">&lt;-</span> <span class="fu">as_tibble</span>(<span class="no">mt_i_D</span>)
<span class="co"># A_i and alpha_il as matrix</span>
<span class="no">mt_A_alpha</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>,<span class="no">it_D_1l</span>), <span class="no">ar_alpha_1l</span>, <span class="no">ar_A_1l</span>, <span class="no">fl_beta_1</span>),
                    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>,<span class="no">it_D_2l</span>), <span class="no">ar_alpha_2l</span>, <span class="no">ar_A_2l</span>, <span class="no">fl_beta_2</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_A_alpha</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'id_i'</span>, <span class="st">'D_il'</span>, <span class="st">'alpha_il'</span>, <span class="st">'A_il'</span>, <span class="st">'beta_i'</span>)
<span class="co"># Combine to generate input_il matrix</span>
<span class="no">df_input_il</span> <span class="kw">&lt;-</span> <span class="no">tb_i_D</span> <span class="kw">%&gt;%</span>
  <span class="fu">uncount</span>(<span class="no">D_max_i</span>) <span class="kw">%&gt;%</span>
  <span class="fu">rowid_to_column</span>(<span class="kw">var</span> <span class="kw">=</span> <span class="st">"id_il"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">left_join</span>(<span class="no">tb_i_D</span>, <span class="kw">by</span><span class="kw">=</span><span class="st">'id_i'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">id_i</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">D_il</span> <span class="kw">=</span> <span class="fu">row_number</span>()) <span class="kw">%&gt;%</span>
  <span class="fu">left_join</span>(<span class="fu">as_tibble</span>(<span class="no">mt_A_alpha</span>), <span class="kw">by</span><span class="kw">=</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'id_i'</span><span class="kw">=</span><span class="st">'id_i'</span>, <span class="st">'D_il'</span><span class="kw">=</span><span class="st">'D_il'</span>)))</pre></body></html></div>
<p>Solve for optimal choices.</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">ls_dis_solu</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
  <span class="fu"><a href="../reference/ffp_opt_anlyz_rhgin_dis.html">ffp_opt_anlyz_rhgin_dis</a></span>(<span class="no">ar_rho</span>,
                          <span class="no">fl_dis_w</span>,
                          <span class="no">df_input_il</span>,
                          <span class="kw">bl_df_alloc_il</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                          <span class="kw">bl_return_V</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                          <span class="kw">bl_return_allQ_V</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                          <span class="kw">bl_return_inner_V</span> <span class="kw">=</span> <span class="fl">TRUE</span>)))
<span class="no">df_queue_il_long_n2</span> <span class="kw">&lt;-</span><span class="no">ls_dis_solu</span>$<span class="no">df_queue_il_long</span>
<span class="no">df_queue_il_wide_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_dis_solu</span>$<span class="no">df_queue_il_wide</span>
<span class="no">df_alloc_i_long_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_dis_solu</span>$<span class="no">df_alloc_i_long</span>
<span class="no">df_rho_gini_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_dis_solu</span>$<span class="no">df_rho_gini</span>
<span class="no">df_alloc_il_long_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_dis_solu</span>$<span class="no">df_alloc_il_long</span></pre></body></html></div>
<p>Solve and select only information relevant for showing how choices change along preference specific income expansion paths. This is very wasteful, but it’s OK. I only output optimal choices in the alloc_i matrix, which is resource specific. So to get the proper income expansion results, resolve at each element of resource from min to max</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">ls_mt_opti_eh_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_w_solve_at_disc</span>), <span class="fl">1</span>,
  <span class="kw">function</span>(<span class="no">row</span>){
    <span class="no">mt_opti_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
    <span class="fu"><a href="../reference/ffp_opt_anlyz_rhgin_dis.html">ffp_opt_anlyz_rhgin_dis</a></span>(
      <span class="no">ar_rho</span>,
      <span class="no">row</span>[<span class="fl">1</span>],
      <span class="no">df_input_il</span>,
      <span class="kw">bl_df_alloc_il</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
      <span class="kw">bl_return_V</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
      <span class="kw">bl_return_allQ_V</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
      <span class="kw">bl_return_inner_V</span> <span class="kw">=</span> <span class="fl">TRUE</span>)$<span class="no">df_alloc_i_long</span>)) <span class="kw">%&gt;%</span>
    <span class="fu">select</span>(<span class="no">rho_val</span>, <span class="no">D_star_i</span>, <span class="no">EH_star_i</span>) <span class="kw">%&gt;%</span>
    <span class="fu">pivot_wider</span>(<span class="kw">names_from</span> <span class="kw">=</span> <span class="no">id_i</span>,
                <span class="kw">values_from</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">D_star_i</span>, <span class="no">EH_star_i</span>)) <span class="kw">%&gt;%</span>
    <span class="fu">rename</span>(<span class="kw">EH_1l</span> <span class="kw">=</span> <span class="no">EH_star_i_1</span>, <span class="kw">EH_2l</span> <span class="kw">=</span> <span class="no">EH_star_i_2</span>,
           <span class="kw">D_1l</span> <span class="kw">=</span> <span class="no">D_star_i_1</span>, <span class="kw">D_2l</span> <span class="kw">=</span> <span class="no">D_star_i_2</span>) <span class="kw">%&gt;%</span>
    <span class="fu">mutate</span>(<span class="kw">w_units</span> <span class="kw">=</span> <span class="no">row</span>[<span class="fl">1</span>], <span class="kw">w_dollars</span> <span class="kw">=</span> <span class="no">row</span>[<span class="fl">1</span>]*<span class="no">fl_price</span>) <span class="kw">%&gt;%</span>
    <span class="fu">select</span>(<span class="no">w_dollars</span>, <span class="no">w_units</span>, <span class="no">EH_1l</span>, <span class="no">EH_2l</span>, <span class="no">D_1l</span>, <span class="no">D_2l</span>, <span class="no">rho_val</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">mt_opti_disc</span>)
  })</pre></body></html></div>
<pre><code>## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`
## Adding missing grouping variables: `id_i`</code></pre>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">tb_opti_eh_disc_all</span> <span class="kw">&lt;-</span>
  <span class="fu">as_tibble</span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="no">ls_mt_opti_eh_disc</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">vartype</span> <span class="kw">=</span> <span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outtype</span> <span class="kw">=</span> <span class="st">'optimal'</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb_opti_eh_disc_all</span>, <span class="fl">10</span>))</pre></body></html></div>
<pre><code>## # A tibble: 10 x 9
##    w_dollars w_units EH_1l EH_2l  D_1l  D_2l rho_val vartype  outtype
##        &lt;dbl&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  
##  1        20       1  2.32 0.958     1     0    0.99 discrete optimal
##  2        20       1  2.32 0.958     1     0   -0.01 discrete optimal
##  3        20       1  1.22 1.82      0     1 -100    discrete optimal
##  4        40       2  3.32 0.958     2     0    0.99 discrete optimal
##  5        40       2  2.32 1.82      1     1   -0.01 discrete optimal
##  6        40       2  2.32 1.82      1     1 -100    discrete optimal
##  7        60       3  4.29 0.958     3     0    0.99 discrete optimal
##  8        60       3  2.32 2.63      1     2   -0.01 discrete optimal
##  9        60       3  2.32 2.63      1     2 -100    discrete optimal
## 10        80       4  4.29 1.82      3     1    0.99 discrete optimal</code></pre>
</div>
<div id="optimal-continuous-choices" class="section level3">
<h3 class="hasAnchor">
<a href="#optimal-continuous-choices" class="anchor"></a>Optimal Continuous Choices</h3>
<p>Now I take advantage of the bounded linear solution and solve for the continuous allocation problem given the previously generated continuous parameters that are consistent (in the same general scale) as the discrete parameters used for the discrete allocations.</p>
<p>Build up continuous input frame</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="co"># ID and max Discrete Allocation</span>
<span class="co"># Note the problem here does not explicity</span>
<span class="no">mt_cts_Aalphabeta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>),
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">fl_A_1</span>, <span class="no">fl_A_2</span>),
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">fl_alpha_1</span>, <span class="no">fl_alpha_2</span>),
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">fl_beta_1</span>, <span class="no">fl_beta_2</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_cts_Aalphabeta</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'id_i'</span>, <span class="st">'A_i'</span>, <span class="st">'alpha_i'</span>, <span class="st">'beta_i'</span>)
<span class="no">tb_cts_Aalphabeta</span> <span class="kw">&lt;-</span> <span class="fu">as_tibble</span>(<span class="no">mt_cts_Aalphabeta</span>)</pre></body></html></div>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="no">tb_cts_Aalphabeta</span>
<span class="no">svr_id_i</span> <span class="kw">&lt;-</span> <span class="st">'id_i'</span>
<span class="no">svr_A_i</span> <span class="kw">&lt;-</span> <span class="st">'A_i'</span>
<span class="no">svr_alpha_i</span> <span class="kw">&lt;-</span> <span class="st">'alpha_i'</span>
<span class="no">svr_beta_i</span> <span class="kw">&lt;-</span> <span class="st">'beta_i'</span>
<span class="no">fl_N_agg</span> <span class="kw">&lt;-</span> <span class="no">fl_cts_w</span>/<span class="no">fl_price</span>
<span class="no">ls_lin_solu_all_rhos</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ffp_opt_anlyz_rhgin.html">ffp_opt_anlyz_rhgin</a></span>(<span class="no">df</span>, <span class="no">svr_id_i</span>, <span class="no">svr_A_i</span>, <span class="no">svr_alpha_i</span>, <span class="no">svr_beta_i</span>, <span class="no">fl_N_agg</span>, <span class="no">ar_rho</span>)</pre></body></html></div>
<pre><code>## Warning in FUN(newX[, i], ...): Data vector has only n=2, max-inequality/min-
## gini=0.333333333333333

## Warning in FUN(newX[, i], ...): Data vector has only n=2, max-inequality/min-
## gini=0.333333333333333

## Warning in FUN(newX[, i], ...): Data vector has only n=2, max-inequality/min-
## gini=0.333333333333333

## Warning in FUN(newX[, i], ...): Data vector has only n=2, max-inequality/min-
## gini=0.333333333333333

## Warning in FUN(newX[, i], ...): Data vector has only n=2, max-inequality/min-
## gini=0.333333333333333

## Warning in FUN(newX[, i], ...): Data vector has only n=2, max-inequality/min-
## gini=0.333333333333333</code></pre>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="no">df_opti_alloc_all_rho_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_lin_solu_all_rhos</span>$<span class="no">df_opti_alloc_all_rho</span>
<span class="no">mt_opti_alloc_all_rho_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_lin_solu_all_rhos</span>$<span class="no">mt_opti_alloc_all_rho</span>
<span class="no">mt_expc_outcm_all_rho_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_lin_solu_all_rhos</span>$<span class="no">mt_expc_outcm_all_rho</span>
<span class="no">mt_gini_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_lin_solu_all_rhos</span>$<span class="no">mt_gini</span></pre></body></html></div>
<p>Combine results so that the continuous optimal choices’ outputs are in the same dataframe structure as discrete and continuous strike zone choice sets and the discrete optimal solution points</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">ls_mt_opti_eh_cts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">ar_w_dollars_solve_at_disc</span>), <span class="fl">1</span>,
  <span class="kw">function</span>(<span class="no">row</span>){

    <span class="no">fl_w_dollars</span> <span class="kw">&lt;-</span> <span class="no">row</span>[<span class="fl">1</span>]
    <span class="no">fl_w_units</span> <span class="kw">&lt;-</span> <span class="no">fl_w_dollars</span>/<span class="no">fl_price</span>

    <span class="no">ls_lin_solu_all_rhos</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span>(
      <span class="fu"><a href="../reference/ffp_opt_anlyz_rhgin.html">ffp_opt_anlyz_rhgin</a></span>(
      <span class="no">df</span>, <span class="no">svr_id_i</span>, <span class="no">svr_A_i</span>, <span class="no">svr_alpha_i</span>, <span class="no">svr_beta_i</span>, <span class="no">fl_w_units</span>, <span class="no">ar_rho</span>)))
    <span class="no">mt_opti_alloc_all_rho_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_lin_solu_all_rhos</span>$<span class="no">mt_opti_alloc_all_rho</span>
    <span class="no">mt_expc_outcm_all_rho_n2</span> <span class="kw">&lt;-</span> <span class="no">ls_lin_solu_all_rhos</span>$<span class="no">mt_expc_outcm_all_rho</span>

    <span class="no">mt_opti_cts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">fl_w_dollars</span>, <span class="no">fl_w_units</span>,
                         <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">mt_expc_outcm_all_rho_n2</span>), <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">mt_opti_alloc_all_rho_n2</span>),
                         <span class="no">ar_rho</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_opti_cts</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'w_dollars'</span>, <span class="st">'w_units'</span>,
                               <span class="st">'EH_1l'</span>, <span class="st">'EH_2l'</span>, <span class="st">'D_1l'</span>, <span class="st">'D_2l'</span>, <span class="st">'rho_val'</span>)

    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu">as_tibble</span>(<span class="no">mt_opti_cts</span>))
  })

<span class="no">tb_opti_eh_cts_all</span> <span class="kw">&lt;-</span>
  <span class="fu">as_tibble</span>(<span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="no">ls_mt_opti_eh_cts</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">vartype</span> <span class="kw">=</span> <span class="st">'continuous'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">outtype</span> <span class="kw">=</span> <span class="st">'optimal'</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">tb_opti_eh_cts_all</span>, <span class="fl">10</span>))</pre></body></html></div>
<pre><code>## # A tibble: 10 x 9
##    w_dollars w_units EH_1l EH_2l  D_1l   D_2l rho_val vartype    outtype
##        &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;  
##  1      0      0      1.22 0.958 0     0         0.99 continuous optimal
##  2      0      0      1.22 0.958 0     0        -0.01 continuous optimal
##  3      0      0      1.22 0.958 0     0      -100    continuous optimal
##  4      3.33   0.167  1.38 0.958 0.167 0         0.99 continuous optimal
##  5      3.33   0.167  1.38 0.958 0.167 0        -0.01 continuous optimal
##  6      3.33   0.167  1.22 1.07  0     0.167  -100    continuous optimal
##  7      6.67   0.333  1.55 0.958 0.333 0         0.99 continuous optimal
##  8      6.67   0.333  1.49 0.998 0.274 0.0594   -0.01 continuous optimal
##  9      6.67   0.333  1.22 1.18  0     0.333  -100    continuous optimal
## 10     10      0.5    1.72 0.958 0.5   0         0.99 continuous optimal</code></pre>
<div id="bound-continuous-choices" class="section level4">
<h4 class="hasAnchor">
<a href="#bound-continuous-choices" class="anchor"></a>Bound Continuous Choices</h4>
<p>There are hard bounds on the level of allocations allowed at most for the two individuals. If allocation max exceeded for person <span class="math inline">\(i\)</span> but not person <span class="math inline">\(j\)</span>, then distribute allocation from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>.</p>
<ol style="list-style-type: decimal">
<li>generate new <em>D</em> variable for amount that exceeds bounds.</li>
<li>reset the excess allocation columns so that excess with existing does not exceed individual bound, cross <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>
</li>
<li>apply function to add to existing outcome additional allocation multiplied by marginal effects.</li>
</ol>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="co"># 1. generate new *D* variable for amount that exceeds bounds.</span>
<span class="no">tb_opti_eh_cts_all</span> <span class="kw">&lt;-</span> <span class="no">tb_opti_eh_cts_all</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">D_1l_excess</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_1l</span> <span class="kw">&gt;</span> <span class="no">fl_D_max_1</span>
                     ~ (<span class="no">D_1l</span> - <span class="no">fl_D_max_1</span>),
                     <span class="fl">TRUE</span>
                     ~ <span class="fl">0</span>),
         <span class="kw">D_2l_excess</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_2l</span> <span class="kw">&gt;</span> <span class="no">fl_D_max_2</span>
                     ~ (<span class="no">D_2l</span> - <span class="no">fl_D_max_2</span>),
                     <span class="fl">TRUE</span>
                     ~ <span class="fl">0</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">w_dollars</span>, <span class="no">EH_1l</span>, <span class="no">EH_2l</span>, <span class="no">D_1l</span>, <span class="no">D_2l</span>,
         <span class="no">D_1l_excess</span>, <span class="no">D_2l_excess</span>, <span class="fu">everything</span>())

<span class="co"># 2. if both exceed, then reset outcomes for both</span>
<span class="no">tb_opti_eh_cts_all</span> <span class="kw">&lt;-</span> <span class="no">tb_opti_eh_cts_all</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">EH_1l</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_1l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">D_2l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span>
                     ~ <span class="no">EH_1l</span> - <span class="no">D_1l_excess</span>*(<span class="no">fl_alpha_1</span>),
                     <span class="fl">TRUE</span> ~ <span class="no">EH_1l</span>),
         <span class="kw">EH_2l</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_1l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">D_2l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span>
                     ~ <span class="no">EH_2l</span> - <span class="no">D_2l_excess</span>*(<span class="no">fl_alpha_2</span>),
                     <span class="fl">TRUE</span> ~ <span class="no">EH_2l</span>))

<span class="co"># 3. 1 exceeds but 2 does not</span>
<span class="no">tb_opti_eh_cts_all</span> <span class="kw">&lt;-</span> <span class="no">tb_opti_eh_cts_all</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">EH_1l</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_1l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">D_2l_excess</span> <span class="kw">==</span> <span class="fl">0</span>
                     ~ <span class="no">EH_1l</span> - <span class="no">D_1l_excess</span>*(<span class="no">fl_alpha_1</span>),
                     <span class="fl">TRUE</span> ~ <span class="no">EH_1l</span>),
         <span class="kw">EH_2l</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_1l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">D_2l_excess</span> <span class="kw">==</span> <span class="fl">0</span>
                     ~ <span class="no">EH_2l</span> + <span class="no">D_1l_excess</span>*(<span class="no">fl_alpha_2</span>),
                     <span class="fl">TRUE</span> ~ <span class="no">EH_2l</span>))
<span class="co"># %&gt;%</span>
<span class="co">#   mutate(EH_2l =</span>
<span class="co">#            case_when(EH_2l &gt;= fl_EH_max_2 ~ fl_EH_max_2,</span>
<span class="co">#                      TRUE ~ EH_2l))</span>

<span class="co"># 4. 2 exceeds but 1 does not</span>
<span class="no">tb_opti_eh_cts_all</span> <span class="kw">&lt;-</span> <span class="no">tb_opti_eh_cts_all</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">EH_1l</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_1l_excess</span> <span class="kw">==</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">D_2l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span>
                     ~ <span class="no">EH_1l</span> + <span class="no">D_2l_excess</span>*(<span class="no">fl_alpha_1</span>),
                     <span class="fl">TRUE</span> ~ <span class="no">EH_1l</span>),
         <span class="kw">EH_2l</span> <span class="kw">=</span>
           <span class="fu">case_when</span>(<span class="no">D_1l_excess</span> <span class="kw">==</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">D_2l_excess</span> <span class="kw">&gt;</span> <span class="fl">0</span>
                     ~ <span class="no">EH_2l</span> - <span class="no">D_2l_excess</span>*(<span class="no">fl_alpha_2</span>),
                     <span class="fl">TRUE</span> ~ <span class="no">EH_2l</span>)) <span class="kw">%&gt;%</span>
  <span class="co"># mutate(EH_1l =</span>
  <span class="co">#          case_when(EH_1l &gt; fl_EH_max_1 ~ fl_EH_max_1,</span>
  <span class="co">#                    TRUE ~ EH_1l)) %&gt;%</span>
  <span class="fu">select</span>(-<span class="no">D_1l_excess</span>, -<span class="no">D_2l_excess</span>)</pre></body></html></div>
</div>
</div>
<div id="combine-discrete-and-continuous-optimal-choices-evaluate-value" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-discrete-and-continuous-optimal-choices-evaluate-value" class="anchor"></a>Combine Discrete and Continuous Optimal Choices Evaluate Value</h3>
<p>Combine the constrained choice sets and optimal choices together. Then evaluate utility at optimal choices</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="co"># Combine optimal choices as well as choicesets</span>
<span class="no">tb_all_points</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">tb_strike_eh_disc_all</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fl">NA</span>),
        <span class="no">tb_opti_eh_disc_all</span>,
        <span class="no">tb_strike_eh_cts_all</span> <span class="kw">%&gt;%</span> <span class="fu">mutate</span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fl">NA</span>),
        <span class="no">tb_opti_eh_cts_all</span>)

<span class="co"># Evaluate to obtain Value at Optimal Choices and Utility at Other</span>
<span class="co"># choice points.</span>
<span class="no">ffi_util_eval</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">EH_1l</span>, <span class="no">EH_2l</span>, <span class="no">rho_val</span>) {
  <span class="no">fl_util</span> <span class="kw">=</span> (<span class="no">fl_beta_1</span>*(<span class="no">EH_1l</span>^<span class="no">rho_val</span>) + <span class="no">fl_beta_2</span>*(<span class="no">EH_2l</span>^<span class="no">rho_val</span>))^(<span class="fl">1</span>/<span class="no">rho_val</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">fl_util</span>)
}
<span class="no">tb_all_points</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">ffi_util_eval</span>(<span class="no">EH_1l</span>, <span class="no">EH_2l</span>, <span class="no">rho_val</span>))

<span class="co"># Summary results</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tb_all_points</span>)</pre></body></html></div>
<pre><code>##    w_dollars        w_units           EH_1l           EH_2l       
##  Min.   :  0.0   Min.   : 0.000   Min.   :1.217   Min.   :0.9582  
##  1st Qu.: 80.0   1st Qu.: 4.000   1st Qu.:2.717   1st Qu.:1.7255  
##  Median :113.3   Median : 5.667   Median :4.292   Median :2.6333  
##  Mean   :110.7   Mean   : 5.533   Mean   :4.275   Mean   :2.6304  
##  3rd Qu.:143.3   3rd Qu.: 7.167   3rd Qu.:5.883   3rd Qu.:3.5440  
##  Max.   :220.0   Max.   :11.000   Max.   :7.217   Max.   :4.6248  
##                                                                   
##       D_1l             D_2l          vartype            outtype         
##  Min.   : 0.000   Min.   :0.0000   Length:777         Length:777        
##  1st Qu.: 1.500   1st Qu.:0.9513   Class :character   Class :character  
##  Median : 3.000   Median :2.3139   Mode  :character   Mode  :character  
##  Mean   : 3.144   Mean   :2.3890                                        
##  3rd Qu.: 4.599   3rd Qu.:3.8182                                        
##  Max.   :11.000   Max.   :6.7420                                        
##                                                                         
##     rho_val        val_at_choices  
##  Min.   :-100.00   Min.   :0.9648  
##  1st Qu.:-100.00   1st Qu.:2.3130  
##  Median :  -0.01   Median :3.4663  
##  Mean   : -33.01   Mean   :3.3946  
##  3rd Qu.:   0.99   3rd Qu.:4.3213  
##  Max.   :   0.99   Max.   :5.7522  
##  NA's   :543       NA's   :543</code></pre>
</div>
</div>
<div id="generate-indifference-curves-at-selected-points" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-indifference-curves-at-selected-points" class="anchor"></a>Generate Indifference Curves at Selected Points</h2>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>, <span class="kw">pos</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/search.html">search</a></span>()))

<span class="co"># A as x-axis, need bounds on A</span>
<span class="no">fl_A_min</span> <span class="kw">=</span> <span class="fl">0.01</span>
<span class="no">fl_A_max</span> <span class="kw">=</span> <span class="no">it_D_1l</span>+<span class="no">it_D_1l</span>/<span class="fl">2</span>
<span class="no">it_A_grid</span> <span class="kw">=</span> <span class="fl">1000</span>

<span class="co"># Define parameters</span>
<span class="co"># ar_lambda &lt;- 1 - (10^(c(seq(-2,2, length.out=3))))</span>
<span class="no">ar_beta</span> <span class="kw">&lt;-</span> <span class="no">fl_beta_1</span>

<span class="co"># Select v_points</span>
<span class="co"># Indifference at three points, min, max and middle of allocations</span>
<span class="co"># &amp; (rho_val == ar_rho[2])</span>
<span class="no">mt_v_star_rho_val</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>((<span class="no">outtype</span> <span class="kw">==</span> <span class="st">'optimal'</span>) <span class="kw">&amp;</span>
           (<span class="no">w_units</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">2</span>,<span class="no">it_w_max</span>-<span class="fl">2</span>,<span class="kw">length.out</span><span class="kw">=</span><span class="fl">3</span>)))
         ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">w_units</span>, <span class="no">vartype</span>, <span class="no">rho_val</span>, <span class="no">val_at_choices</span>)

<span class="co"># Combine for inputs to indiff function</span>
<span class="no">tb_pref</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">mt_v_star_rho_val</span>) <span class="kw">%&gt;%</span>
  <span class="fu">expand_grid</span>(<span class="no">ar_beta</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html">rename_all</a></span>(~<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'w_units'</span>,<span class="st">'vartype'</span>,<span class="st">'rho_val'</span>, <span class="st">'vstar'</span>, <span class="st">'beta'</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">rowid_to_column</span>(<span class="kw">var</span> <span class="kw">=</span> <span class="st">"indiff_id"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">indiff_id</span>, <span class="no">rho_val</span>, <span class="no">beta</span>, <span class="no">vstar</span>, <span class="no">w_units</span>, <span class="no">vartype</span>)

<span class="co"># Generate indifference points with apply and anonymous function</span>
<span class="co"># note must only select the numeric arrays</span>
<span class="no">ls_df_indiff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(
  <span class="no">tb_pref</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">indiff_id</span>, <span class="no">rho_val</span>, <span class="no">beta</span>, <span class="no">vstar</span>),
  <span class="fl">1</span>, <span class="kw">function</span>(<span class="no">x</span>){
    <span class="no">indiff_id</span> <span class="kw">&lt;-</span> <span class="no">x</span>[<span class="fl">1</span>]
    <span class="no">lambda</span> <span class="kw">&lt;-</span> <span class="no">x</span>[<span class="fl">2</span>]
    <span class="no">beta</span> <span class="kw">&lt;-</span> <span class="no">x</span>[<span class="fl">3</span>]
    <span class="no">vstar</span> <span class="kw">&lt;-</span> <span class="no">x</span>[<span class="fl">4</span>]

    <span class="no">ar_fl_A_indiff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">fl_A_min</span>, <span class="no">fl_A_max</span>, <span class="kw">length.out</span><span class="kw">=</span><span class="no">it_A_grid</span>)
    <span class="no">ar_fl_B_indiff</span> <span class="kw">&lt;-</span> (((<span class="no">vstar</span>^<span class="no">lambda</span>) -
                          (<span class="no">beta</span>*<span class="no">ar_fl_A_indiff</span>^(<span class="no">lambda</span>)))/(<span class="fl">1</span>-<span class="no">beta</span>))^(<span class="fl">1</span>/<span class="no">lambda</span>)
    <span class="no">mt_A_B_indiff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">indiff_id</span>, <span class="no">lambda</span>, <span class="no">beta</span>, <span class="no">vstar</span>,
                           <span class="no">ar_fl_A_indiff</span>, <span class="no">ar_fl_B_indiff</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">mt_A_B_indiff</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'indiff_id'</span>, <span class="st">'rho_val'</span>, <span class="st">'beta_1'</span>, <span class="st">'val_at_choices'</span>,
                                 <span class="st">'EH_1l'</span>, <span class="st">'EH_2l'</span>)
    <span class="no">tb_A_B_indiff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">as_tibble</a></span>(<span class="no">mt_A_B_indiff</span>) <span class="kw">%&gt;%</span>
      <span class="fu">rowid_to_column</span>(<span class="kw">var</span> <span class="kw">=</span> <span class="st">"A_grid_id"</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">EH_2l</span> <span class="kw">&gt;=</span> <span class="fl">0</span> <span class="kw">&amp;</span> <span class="no">EH_2l</span> <span class="kw">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">ar_fl_A_indiff</span>))
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">tb_A_B_indiff</span>)
  })
<span class="no">df_indiff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="no">rbind</span>, <span class="no">ls_df_indiff</span>) <span class="kw">%&gt;%</span> <span class="fu">drop_na</span>()
<span class="no">df_indiff</span> <span class="kw">&lt;-</span> <span class="no">df_indiff</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">tb_pref</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">indiff_id</span>, <span class="no">w_units</span>, <span class="no">vartype</span>), <span class="kw">by</span><span class="kw">=</span><span class="st">'indiff_id'</span>)</pre></body></html></div>
</div>
<div id="graph-choices-strike-set-and-optimal-choices" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-choices-strike-set-and-optimal-choices" class="anchor"></a>Graph Choices Strike Set and Optimal Choices</h2>
<p>To prepare for graphing, generat varous factors.</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="no">tb_all_points</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">rho_val</span>) ~ <span class="fl">9999</span>, <span class="fl">TRUE</span> ~ <span class="no">rho_val</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">vartype</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">vartype</span>),
         <span class="kw">outtype</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">outtype</span>),
         <span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">varouttype</span> <span class="kw">=</span> <span class="fu">fct_cross</span>(<span class="no">vartype</span>, <span class="no">outtype</span>, <span class="kw">sep</span><span class="kw">=</span><span class="st">'_'</span>))</pre></body></html></div>
<div id="graph-discrete-and-continuous-choice-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-discrete-and-continuous-choice-sets" class="anchor"></a>Graph Discrete and Continuous Choice Sets</h3>
<p>Graph Continuous Results</p>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="co"># Labeling</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcomes (Continuous + Discrete Choices)'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Additional discrete inputs have i and l specific non-increasing effects\n'</span>,
                      <span class="st">'Continuous choices assumed to have i specific linear effects'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two People Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 1'</span>
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 2'</span>

<span class="co"># Graphing</span>
<span class="no">plt_strike</span> <span class="kw">&lt;-</span>
  <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">outtype</span><span class="kw">==</span><span class="st">'strike'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">colour</span><span class="kw">=</span><span class="no">vartype</span>, <span class="kw">shape</span><span class="kw">=</span><span class="no">vartype</span>)) +
  <span class="fu">geom_jitter</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">4</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">0.01</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>, <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>()

<span class="co"># show</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_strike</span>)</pre></body></html></div>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-18-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="graph-discrete-choice-set-and-income-expansion-path-" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-discrete-choice-set-and-income-expansion-path-" class="anchor"></a>Graph Discrete Choice Set and Income Expansion Path.</h3>
<p>Income expansion given different planner preferences.</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="co"># Labeling</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcomes (Discrete Choices + Optimal)'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Planner Preference and Varying Discrete Income Expansion Path'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two People Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 1'</span>
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 2'</span>

<span class="co"># Graphing</span>
<span class="no">plt_disc</span> <span class="kw">&lt;-</span>
  <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>,
             <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val</span>, <span class="kw">shape</span><span class="kw">=</span><span class="no">rho_val</span>)) +
  <span class="fu">geom_jitter</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">7</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">0</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>, <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>()

<span class="co"># show</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_disc</span>)</pre></body></html></div>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-19-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="graph-continuous-choice-set-and-income-expansion-path" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-continuous-choice-set-and-income-expansion-path" class="anchor"></a>Graph Continuous Choice Set and Income Expansion Path</h3>
<p>Continuous choice set and income expansion path. Unlike in the discrete case, each additional increment has the same effect for the same individual. This is assuming linear effects. Alternatively, could assume the effects are decreasing.</p>
<div class="sourceCode" id="cb51"><html><body><pre class="r"><span class="co"># Labeling</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcomes (Continuous Choices + Optimal)'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Planner Preference and Varying Continuous Income Expansion Path\n'</span>,
                      <span class="st">'Assume marginal effects are heterogeneous for i but constant across l'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two People Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 1'</span>
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 2'</span>

<span class="co"># Graphing</span>
<span class="no">plt_cts</span> <span class="kw">&lt;-</span>
  <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'continuous'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>,
             <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val</span>, <span class="kw">shape</span><span class="kw">=</span><span class="no">rho_val</span>)) +
  <span class="fu">geom_jitter</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">5</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">0</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>, <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>()

<span class="co"># show</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_cts</span>)</pre></body></html></div>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-20-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="jointly-graph-optimal-discrete-and-continuous-choices" class="section level3">
<h3 class="hasAnchor">
<a href="#jointly-graph-optimal-discrete-and-continuous-choices" class="anchor"></a>Jointly Graph Optimal Discrete and Continuous Choices</h3>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="co"># Labeling</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Optimal Choices (Continuous + Discrete)'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Planner Preference and Varying Continuous Income Expansion Path\n'</span>,
                      <span class="st">'Assume marginal effects are heterogeneous for i but constant across l\n'</span>,
                      <span class="st">'Discrete and Continuous Problems are kind of on the same scale for comparison'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two People Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 1'</span>
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="st">'Expected Outcome Individual 2'</span>

<span class="co"># Graphing</span>
<span class="no">plt_opti</span> <span class="kw">&lt;-</span>
  <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">outtype</span><span class="kw">==</span><span class="st">'optimal'</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>,
             <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val</span>, <span class="kw">shape</span><span class="kw">=</span><span class="no">vartype</span>)) +
  <span class="fu">geom_jitter</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">0</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>, <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>()

<span class="co"># show</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_opti</span>)</pre></body></html></div>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-21-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="utility-at-optimal-choices-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#utility-at-optimal-choices-plots" class="anchor"></a>Utility At Optimal Choices Plots</h3>
<p>Given the previous optimal choice points that we selected: min, max and middle of feasible choice, now draw them out.</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="co"># Labeling</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Indifference Curves Aktinson Atkinson Utility (CES)'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Each Panel Different Beta Weights lambda is inequaliyt aversion'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Indifference Curve 2 Individuals.'</span>,
                     <span class="st">''</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="st">'Individual 1 EH'</span>
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="st">'Individual 2 EH'</span>

<span class="co"># indiff_id', 'rho_val', 'beta_1', 'val_at_choices',</span>
<span class="co">#                                'EH_1l', 'EH_2l</span>

<span class="co"># Graphing</span>
<span class="no">plt_indiff</span> <span class="kw">&lt;-</span>
  <span class="no">df_indiff</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>),
         <span class="kw">beta_1</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">beta_1</span>),
         <span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">val_at_choices</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val</span>)) +
  <span class="fu">facet_wrap</span>(~ <span class="no">vartype</span>) +
  <span class="fu">geom_point</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>, <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>()

<span class="co"># Graphing</span>
<span class="no">plt_indiff_cts</span> <span class="kw">&lt;-</span>
  <span class="no">df_indiff</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span> <span class="kw">==</span> <span class="st">'continuous'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>),
         <span class="kw">beta_1</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">beta_1</span>),
         <span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">val_at_choices</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val</span>)) +
  <span class="fu">geom_point</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>, <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>()

<span class="co"># Graphing</span>
<span class="no">plt_indiff_disc</span> <span class="kw">&lt;-</span>
  <span class="no">df_indiff</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span> <span class="kw">==</span> <span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>),
         <span class="kw">beta_1</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">beta_1</span>),
         <span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">val_at_choices</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val</span>)) +
  <span class="fu">geom_point</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">1</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>, <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>()

<span class="co"># show</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_indiff</span>)</pre></body></html></div>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-22-1.png" width="700" style="display: block; margin: auto;"></p>
<div id="discrete-expected-outcomes-grid" class="section level4">
<h4 class="hasAnchor">
<a href="#discrete-expected-outcomes-grid" class="anchor"></a>Discrete Expected Outcomes Grid</h4>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="co"># Data</span>
<span class="no">tb_dis</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'discrete'</span> <span class="kw">&amp;</span> <span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val_str</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span> ~ <span class="st">'Feasible'</span>))
<span class="no">tb_dis_frontier</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'discrete'</span> <span class="kw">&amp;</span> <span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span>)
<span class="no">tb_dis_idif</span> <span class="kw">&lt;-</span> <span class="no">df_indiff</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span> <span class="kw">==</span> <span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> -<span class="fl">0.01</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>),
         <span class="kw">beta_1</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">beta_1</span>),
         <span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">val_at_choices</span>))

<span class="co"># Plot 1: Indifference Simple (too many lines confusing)</span>
<span class="no">plt_indiff_oneline</span> <span class="kw">&lt;-</span> <span class="no">tb_dis_idif</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>)) +
  <span class="fu">geom_point</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>)

<span class="co"># Plot 2: Indifference Simple (too many lines confusing)</span>
<span class="no">plt_frontier</span> <span class="kw">&lt;-</span> <span class="fu">geom_line</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">tb_dis_frontier</span>,
                          <span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">group</span><span class="kw">=</span><span class="no">w_units</span>),
                          <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>)

<span class="co"># Plot 1 + 2 + 3: Choice + Indiff</span>
<span class="no">plt_disc_paper</span> <span class="kw">&lt;-</span>
  <span class="no">plt_indiff_oneline</span> +
  <span class="no">plt_frontier</span> +
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">tb_dis</span>,
              <span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>,
                  <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val_str</span>,
                  <span class="kw">shape</span><span class="kw">=</span><span class="no">rho_val_str</span>,
                  <span class="kw">size</span><span class="kw">=</span><span class="no">rho_val_str</span>))
                  <span class="co">#</span>

<span class="co"># Plot Axis Setting</span>
<span class="no">plt_disc_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_disc_paper</span> +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_1l</span>)-<span class="fl">0.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_1l</span>)+<span class="fl">0.4</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_2l</span>)-<span class="fl">0.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_2l</span>)+<span class="fl">0.4</span>)

<span class="co"># Labeling</span>
<span class="no">plt_disc_paper</span>$<span class="no">labels</span>$<span class="no">colour</span> <span class="kw">&lt;-</span> <span class="st">""</span>
<span class="no">plt_disc_paper</span>$<span class="no">labels</span>$<span class="no">shape</span> <span class="kw">&lt;-</span> <span class="st">""</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">Expected</span>~<span class="no">Outcomes</span>~<span class="no">Grid</span>~<span class="no">with</span>~<span class="no">Positive</span>~<span class="no">and</span>~<span class="no">Nonincreasing</span>~<span class="no">alpha</span>[<span class="no">il</span>]~<span class="st">'(Rectilinear)'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Red Dots = the maximum feasible expected outcomes grid \n'</span>,
                      <span class="st">'Black Solid Lines = indifference curves for &lt;U+03BB&gt;=-0.01\n'</span>,
                      <span class="st">'Black Dashed Lines = discrete aggregate resource levels'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two Candidate Recipients Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">1</span>]~<span class="st">'('</span>~<span class="no">D</span>[<span class="fl">1</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">1</span>)
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">2</span>]~<span class="st">'('</span>~<span class="no">D</span>[<span class="fl">2</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">2</span>)
<span class="no">plt_disc_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_disc_paper</span> +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span><span class="kw">=</span><span class="fl">8</span>) +
  <span class="fu">scale_size_manual</span>(<span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">4</span>)) +
  <span class="fu">guides</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">FALSE</span>)

  <span class="co"># scale_color_manual(values=c('#F8766D', '#7CAE00', '#00BFC4', '#C77CFF'))+</span>
  <span class="co">#</span>


<span class="co"># Save Plot</span>
<span class="kw">if</span> (<span class="no">bl_save_img</span>) {
  <span class="no">snm_disc</span> <span class="kw">&lt;-</span> <span class="st">'disc_exp_out_grid.png'</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save</span>, <span class="no">snm_disc</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>,
      <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">5</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_disc_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save_draft</span>, <span class="no">snm_disc</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>,
      <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">5</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_disc_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
  <span class="co"># Prin here</span>
}
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_disc_paper</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 1043 rows containing missing values (geom_point).</code></pre>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-23-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="discrete-utility-and-choices-jointly" class="section level4">
<h4 class="hasAnchor">
<a href="#discrete-utility-and-choices-jointly" class="anchor"></a>Discrete Utility and Choices Jointly</h4>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="co"># Data</span>
<span class="no">tb_dis</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val_str</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span> ~ <span class="st">'Feasible'</span>,
                                <span class="fl">TRUE</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'&lt;U+03BB&gt;='</span>,<span class="no">rho_val</span>)))
<span class="no">tb_dis_frontier</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'discrete'</span> <span class="kw">&amp;</span> <span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span>)
<span class="no">tb_dis_idif</span> <span class="kw">&lt;-</span> <span class="no">df_indiff</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span> <span class="kw">==</span> <span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> -<span class="fl">0.01</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>),
         <span class="kw">beta_1</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">beta_1</span>),
         <span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">val_at_choices</span>))

<span class="co"># Plot 1: Indifference Simple (too many lines confusing)</span>
<span class="no">plt_indiff_oneline</span> <span class="kw">&lt;-</span> <span class="no">tb_dis_idif</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>)) +
  <span class="fu">geom_point</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>)

<span class="co"># Plot 2: Indifference Simple (too many lines confusing)</span>
<span class="no">plt_frontier</span> <span class="kw">&lt;-</span> <span class="fu">geom_line</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">tb_dis_frontier</span>,
                          <span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">group</span><span class="kw">=</span><span class="no">w_units</span>),
                          <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"gray"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>)

<span class="co"># Plot 1 + 2 + 3: Choice + Indiff</span>
<span class="no">plt_disc_paper</span> <span class="kw">&lt;-</span>
  <span class="no">plt_indiff_oneline</span> +
  <span class="no">plt_frontier</span> +
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">tb_dis</span>,
              <span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>,
                  <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val_str</span>,
                  <span class="kw">shape</span><span class="kw">=</span><span class="no">rho_val_str</span>,
                  <span class="kw">size</span><span class="kw">=</span><span class="no">rho_val_str</span>))
                  <span class="co">#</span>

<span class="co"># Plot Axis Setting</span>
<span class="no">plt_disc_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_disc_paper</span> +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_1l</span>)-<span class="fl">0.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_1l</span>)+<span class="fl">0.4</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_2l</span>)-<span class="fl">0.4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_dis</span>$<span class="no">EH_2l</span>)+<span class="fl">0.4</span>)

<span class="co"># Labeling</span>
<span class="no">plt_disc_paper</span>$<span class="no">labels</span>$<span class="no">colour</span> <span class="kw">&lt;-</span> <span class="st">"&lt;U+03BB&gt; Levels"</span>
<span class="no">plt_disc_paper</span>$<span class="no">labels</span>$<span class="no">shape</span> <span class="kw">&lt;-</span> <span class="st">"&lt;U+03BB&gt; Levels"</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Optimal Choices as Resources Expand at Three Inequality Aversion (&lt;U+03BB&gt;) Levels'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Black Solid Lines = indifference curves for &lt;U+03BB&gt;=-0.01\n'</span>,
                      <span class="st">'Gray Dashed Lines = discrete aggregate resource levels'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two Candidate Recipients Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">1</span>]~<span class="st">'('</span>~<span class="no">D</span>[<span class="fl">1</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">1</span>)
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">2</span>]~<span class="st">'('</span>~<span class="no">D</span>[<span class="fl">2</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">2</span>)
<span class="no">plt_disc_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_disc_paper</span> +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span><span class="kw">=</span><span class="fl">8</span>) +
  <span class="fu">scale_size_manual</span>(<span class="kw">values</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">4</span>)) +
  <span class="fu">guides</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">FALSE</span>)

  <span class="co"># scale_color_manual(values=c('#F8766D', '#7CAE00', '#00BFC4', '#C77CFF'))+</span>
  <span class="co">#</span>

<span class="co"># Save Plot</span>
<span class="kw">if</span> (<span class="no">bl_save_img</span>) {
  <span class="no">snm_disc</span> <span class="kw">&lt;-</span> <span class="st">'disc_resource_expansion_path.png'</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save</span>, <span class="no">snm_disc</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>,
      <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">5</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_disc_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save_draft</span>, <span class="no">snm_disc</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>,
      <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">5</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_disc_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
}
<span class="co"># Prin here</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_disc_paper</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 1043 rows containing missing values (geom_point).</code></pre>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-24-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="continuous-expected-outcomes-grid" class="section level4">
<h4 class="hasAnchor">
<a href="#continuous-expected-outcomes-grid" class="anchor"></a>Continuous Expected Outcomes Grid</h4>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="co"># Data</span>
<span class="no">tb_cts</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'discrete'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">rho_val</span> <span class="kw">!=</span> <span class="fl">9999</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val_str</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span> ~ <span class="st">'Feasible Choices'</span>,
                                 <span class="fl">TRUE</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'&lt;U+03BB&gt;='</span>,<span class="no">rho_val</span>)))
<span class="no">tb_cts_frontier</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'continuous'</span> <span class="kw">&amp;</span> <span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span>)
<span class="no">tb_cts_idif</span> <span class="kw">&lt;-</span> <span class="no">df_indiff</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span> <span class="kw">==</span> <span class="st">'continuous'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> -<span class="fl">0.01</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>),
         <span class="kw">beta_1</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">beta_1</span>),
         <span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">val_at_choices</span>))

<span class="co"># Plot 1: Indiff Plot Limited Lines</span>
<span class="no">plt_indiff_cts_oneline</span> <span class="kw">&lt;-</span> <span class="no">tb_cts_idif</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>)) +
  <span class="fu">geom_point</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>)

<span class="co"># Plot 2: Indifference Simple (too many lines confusing)</span>
<span class="no">plt_frontier_cts</span> <span class="kw">&lt;-</span> <span class="fu">geom_line</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">tb_cts_frontier</span>,
                          <span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">group</span><span class="kw">=</span><span class="no">w_units</span>),
                          <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>)

<span class="co"># Plot 1 + 2 + 3: Choice + Indiff</span>
<span class="no">plt_cnts_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_indiff_cts_oneline</span> + <span class="no">plt_frontier_cts</span>

<span class="co"># Plot Axis Setting</span>
<span class="no">plt_cnts_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_cnts_paper</span> +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_1l</span>-<span class="fl">0.4</span>), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_1l</span>+<span class="fl">0.4</span>)) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_2l</span>-<span class="fl">0.4</span>), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_2l</span>+<span class="fl">0.4</span>))

<span class="co"># Labeling</span>
<span class="no">plt_cnts_paper</span>$<span class="no">labels</span>$<span class="no">colour</span> <span class="kw">&lt;-</span> <span class="st">"&lt;U+03BB&gt; Levels"</span>
<span class="no">plt_cnts_paper</span>$<span class="no">labels</span>$<span class="no">shape</span> <span class="kw">&lt;-</span> <span class="st">"&lt;U+03BB&gt; Levels"</span>
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Rectangular bounds on choices (hypercube for N&gt;2)\n'</span>,
                      <span class="st">'Black Solid Lines = indifference curves for &lt;U+03BB&gt;=-0.01\n'</span>,
                      <span class="st">'Black Dashed Lines = selected aggregate resource levels'</span>)
<span class="co"># st_title &lt;- paste0('Bounded Continuous Choice Resource Expansion Path with N=2')</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">'Expected Outcomes Grid with Bounded Linear Allocations'</span>)
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two Candidate Recipients Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">1</span>]~<span class="st">'('</span>~<span class="no">C</span>[<span class="fl">1</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">1</span>)
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">2</span>]~<span class="st">'('</span>~<span class="no">C</span>[<span class="fl">2</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">2</span>)
<span class="no">plt_cnts_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_cnts_paper</span> +
  <span class="fu">labs</span>(<span class="kw">title</span><span class="kw">=</span><span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span><span class="kw">=</span><span class="fl">8</span>)

<span class="co"># Save Plot</span>
<span class="kw">if</span> (<span class="no">bl_save_img</span>) {
  <span class="no">snm_cnts</span> <span class="kw">&lt;-</span> <span class="st">'cts_exp_out_grid.png'</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save</span>, <span class="no">snm_cnts</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>, <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">7</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_cnts_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save_draft</span>, <span class="no">snm_cnts</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>,
      <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">5</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_cnts_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
}
<span class="co"># Prin here</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_cnts_paper</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 1077 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 11 row(s) containing missing values (geom_path).</code></pre>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-25-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="continuous-utility-and-choices-jointly" class="section level4">
<h4 class="hasAnchor">
<a href="#continuous-utility-and-choices-jointly" class="anchor"></a>Continuous Utility and Choices Jointly</h4>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="co"># Data</span>
<span class="no">tb_cts</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'continuous'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">rho_val</span> <span class="kw">!=</span> <span class="fl">9999</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val_str</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span> ~ <span class="st">'Feasible Choices'</span>,
                                 <span class="fl">TRUE</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'&lt;U+03BB&gt;='</span>,<span class="no">rho_val</span>)))
<span class="no">tb_cts_frontier</span> <span class="kw">&lt;-</span> <span class="no">tb_all_points</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span><span class="kw">==</span><span class="st">'continuous'</span> <span class="kw">&amp;</span> <span class="no">rho_val</span> <span class="kw">==</span> <span class="fl">9999</span>)
<span class="no">tb_cts_idif</span> <span class="kw">&lt;-</span> <span class="no">df_indiff</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">vartype</span> <span class="kw">==</span> <span class="st">'continuous'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">rho_val</span> <span class="kw">==</span> -<span class="fl">0.01</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">rho_val</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">rho_val</span>),
         <span class="kw">beta_1</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">beta_1</span>),
         <span class="kw">val_at_choices</span> <span class="kw">=</span> <span class="fu">as_factor</span>(<span class="no">val_at_choices</span>))

<span class="co"># Plot 1: Indiff Plot Limited Lines</span>
<span class="no">plt_indiff_cts_oneline</span> <span class="kw">&lt;-</span> <span class="no">tb_cts_idif</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>)) +
  <span class="fu">geom_point</span>(<span class="kw">size</span><span class="kw">=</span><span class="fl">0.5</span>)

<span class="co"># Plot 2: Indifference Simple (too many lines confusing)</span>
<span class="no">plt_frontier_cts</span> <span class="kw">&lt;-</span> <span class="fu">geom_line</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">tb_cts_frontier</span>,
                          <span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">group</span><span class="kw">=</span><span class="no">w_units</span>),
                          <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"gray"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>)

<span class="co"># Plot 1 + 2 + 3: Choice + Indiff</span>
<span class="no">plt_cnts_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_indiff_cts_oneline</span> + <span class="no">plt_frontier_cts</span> +
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">tb_cts</span>,
             <span class="fu">aes</span>(<span class="kw">x</span><span class="kw">=</span><span class="no">EH_1l</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">EH_2l</span>, <span class="kw">colour</span><span class="kw">=</span><span class="no">rho_val_str</span>, <span class="kw">shape</span><span class="kw">=</span><span class="no">rho_val_str</span>),
             <span class="kw">size</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">width</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<pre><code>## Warning: Ignoring unknown parameters: width</code></pre>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="co"># Plot Axis Setting</span>
<span class="no">plt_cnts_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_cnts_paper</span> +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_1l</span>-<span class="fl">0.4</span>), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_1l</span>+<span class="fl">0.4</span>)) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_2l</span>-<span class="fl">0.4</span>), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">tb_cts</span>$<span class="no">EH_2l</span>+<span class="fl">0.4</span>))

<span class="co"># Labeling</span>
<span class="no">plt_cnts_paper</span>$<span class="no">labels</span>$<span class="no">colour</span> <span class="kw">&lt;-</span> <span class="st">"&lt;U+03BB&gt; Levels"</span>
<span class="no">plt_cnts_paper</span>$<span class="no">labels</span>$<span class="no">shape</span> <span class="kw">&lt;-</span> <span class="st">"&lt;U+03BB&gt; Levels"</span>
<span class="no">st_title</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Optimal Choices as Resources Expand at Three Inequality Aversion (&lt;U+03BB&gt;) Levels'</span>)
<span class="no">st_subtitle</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Black Solid Lines = indifference curves for &lt;U+03BB&gt;=-0.01\n'</span>,
                      <span class="st">'Gray Dashed Lines = selected aggregate resource levels'</span>)
<span class="co"># st_subtitle &lt;- paste0('Optimal choices as resource expands at three inequality aversion (&lt;U+03BB&gt;) Levels')</span>
<span class="no">st_caption</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Expected Outcome Two Candidate Recipients Example'</span>)
<span class="no">st_x_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">1</span>]~<span class="st">'('</span>~<span class="no">C</span>[<span class="fl">1</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">1</span>)
<span class="no">st_y_label</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="no">EH</span>[<span class="fl">2</span>]~<span class="st">'('</span>~<span class="no">C</span>[<span class="fl">2</span>]~<span class="st">'): '</span>~<span class="no">Expected</span>~<span class="no">Outcome</span>~<span class="no">Recipient</span>~<span class="fl">2</span>)
<span class="no">plt_cnts_paper</span> <span class="kw">&lt;-</span> <span class="no">plt_cnts_paper</span> +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="no">st_title</span>, <span class="kw">subtitle</span> <span class="kw">=</span> <span class="no">st_subtitle</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="no">st_x_label</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="no">st_y_label</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="no">st_caption</span>) +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span><span class="kw">=</span><span class="fl">8</span>)

<span class="co"># Save Plot</span>
<span class="kw">if</span> (<span class="no">bl_save_img</span>) {
  <span class="no">snm_cnts</span> <span class="kw">&lt;-</span> <span class="st">'cnts_resource_expansion_path.png'</span>
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save</span>, <span class="no">snm_cnts</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>, <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">7</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_cnts_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
  <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">spt_img_save_draft</span>, <span class="no">snm_cnts</span>),
        <span class="kw">width</span> <span class="kw">=</span> <span class="fl">135</span>, <span class="kw">height</span> <span class="kw">=</span> <span class="fl">96</span>, <span class="kw">units</span><span class="kw">=</span><span class="st">'mm'</span>, <span class="kw">res</span> <span class="kw">=</span> <span class="fl">300</span>,
      <span class="kw">pointsize</span><span class="kw">=</span><span class="fl">5</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_cnts_paper</span>)
  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()
}
<span class="co"># Prin here</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">plt_cnts_paper</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 1019 rows containing missing values (geom_point).</code></pre>
<p><img src="ffv_opt_n2_fn_files/figure-html/unnamed-chunk-26-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="no">ar_w_solve_at_disc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>,<span class="fl">18</span>)
<span class="no">it_alpha_1l_zr</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">it_alpha_2l_zr</span> <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="kw">for</span> (<span class="no">it_w</span> <span class="kw">in</span> <span class="no">ar_w_solve_at_disc</span>){

  <span class="no">ar_cur_w_ehlt_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>()
  <span class="no">ar_cur_w_unit_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>()

  <span class="kw">for</span> (<span class="no">it_1l</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="no">it_alpha_1l_zr</span>)){
    <span class="no">fl_eh_1l</span> <span class="kw">&lt;-</span> <span class="no">ar_eh_1l_zr</span>[<span class="no">it_1l</span>]

    <span class="kw">for</span> (<span class="no">it_2l</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="no">it_alpha_2l_zr</span>)){
      <span class="no">fl_eh_2l</span> <span class="kw">&lt;-</span> <span class="no">ar_eh_2l_zr</span>[<span class="no">it_2l</span>]

      <span class="co"># included alloca = 0 at L162</span>
      <span class="no">it_1l_2l_sum</span> <span class="kw">&lt;-</span> (<span class="no">it_1l</span>-<span class="fl">1</span>) + (<span class="no">it_2l</span>-<span class="fl">1</span>)
      <span class="kw">if</span> (<span class="no">it_1l_2l_sum</span> <span class="kw">==</span> <span class="no">it_w</span>){
        <span class="co"># at this point, EH_1 and EH_2</span>

        <span class="co"># Aggregate Resource is Fully Distributed</span>
        <span class="no">ar_cur_w_ehlt_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_cur_w_ehlt_combo</span>, <span class="no">fl_eh_1l</span>, <span class="no">fl_eh_2l</span>)
        <span class="no">ar_cur_w_unit_combo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ar_cur_w_unit_combo</span>, <span class="no">it_1l</span>-<span class="fl">1</span>, <span class="no">it_2l</span>-<span class="fl">1</span>)

      }
    }
  }

  <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">ar_cur_w_unit_combo</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">ar_cur_w_unit_combo</span>)/<span class="fl">2</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">ar_cur_w_unit_combo</span>)

  <span class="no">it_compo_one</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">it_w</span> + <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">it_alpha_1l_zr</span>, <span class="no">it_alpha_2l_zr</span>)))
  <span class="no">it_compo_two</span> <span class="kw">&lt;-</span> -(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fl">0</span>, <span class="no">it_w</span> - (<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">it_alpha_1l_zr</span>, <span class="no">it_alpha_2l_zr</span>) + <span class="fl">1</span>)))
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'iit_compo_one:'</span>, <span class="no">it_compo_one</span>, <span class="st">', it_compo_two:'</span>, <span class="no">it_compo_two</span>,
               <span class="st">', it_compo_one_two:'</span>, <span class="no">it_compo_one</span> + <span class="no">it_compo_two</span>))
}</pre></body></html></div>
<pre><code>##      [,1] [,2]
## [1,]    0    1
## [2,]    1    0
## [1] "iit_compo_one:2, it_compo_two:0, it_compo_one_two:2"
##      [,1] [,2] [,3]
## [1,]    0    1    2
## [2,]    2    1    0
## [1] "iit_compo_one:3, it_compo_two:0, it_compo_one_two:3"
##      [,1] [,2] [,3] [,4]
## [1,]    0    1    2    3
## [2,]    3    2    1    0
## [1] "iit_compo_one:4, it_compo_two:0, it_compo_one_two:4"
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    1    2    3    4
## [2,]    4    3    2    1    0
## [1] "iit_compo_one:5, it_compo_two:0, it_compo_one_two:5"
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    0    1    2    3    4    5
## [2,]    5    4    3    2    1    0
## [1] "iit_compo_one:6, it_compo_two:0, it_compo_one_two:6"
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    0    1    2    3    4    5    6
## [2,]    6    5    4    3    2    1    0
## [1] "iit_compo_one:7, it_compo_two:0, it_compo_one_two:7"
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    0    1    2    3    4    5    6    7
## [2,]    7    6    5    4    3    2    1    0
## [1] "iit_compo_one:8, it_compo_two:0, it_compo_one_two:8"
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## [1,]    0    1    2    3    4    5    6    7    8
## [2,]    8    7    6    5    4    3    2    1    0
## [1] "iit_compo_one:9, it_compo_two:0, it_compo_one_two:9"
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## [1,]    0    1    2    3    4    5    6    7    8     9
## [2,]    9    8    7    6    5    4    3    2    1     0
## [1] "iit_compo_one:10, it_compo_two:0, it_compo_one_two:10"
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## [1,]    1    2    3    4    5    6    7    8    9
## [2,]    9    8    7    6    5    4    3    2    1
## [1] "iit_compo_one:10, it_compo_two:0, it_compo_one_two:10"
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    2    3    4    5    6    7    8    9
## [2,]    9    8    7    6    5    4    3    2
## [1] "iit_compo_one:10, it_compo_two:0, it_compo_one_two:10"
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    3    4    5    6    7    8    9
## [2,]    9    8    7    6    5    4    3
## [1] "iit_compo_one:10, it_compo_two:-1, it_compo_one_two:9"
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    4    5    6    7    8    9
## [2,]    9    8    7    6    5    4
## [1] "iit_compo_one:10, it_compo_two:-2, it_compo_one_two:8"
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    5    6    7    8    9
## [2,]    9    8    7    6    5
## [1] "iit_compo_one:10, it_compo_two:-3, it_compo_one_two:7"
##      [,1] [,2] [,3] [,4]
## [1,]    6    7    8    9
## [2,]    9    8    7    6
## [1] "iit_compo_one:10, it_compo_two:-4, it_compo_one_two:6"
##      [,1] [,2] [,3]
## [1,]    7    8    9
## [2,]    9    8    7
## [1] "iit_compo_one:10, it_compo_two:-5, it_compo_one_two:5"
##      [,1] [,2]
## [1,]    8    9
## [2,]    9    8
## [1] "iit_compo_one:10, it_compo_two:-6, it_compo_one_two:4"
##      [,1]
## [1,]    9
## [2,]    9
## [1] "iit_compo_one:10, it_compo_two:-7, it_compo_one_two:3"</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://fanwangecon.github.io">Fan Wang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
